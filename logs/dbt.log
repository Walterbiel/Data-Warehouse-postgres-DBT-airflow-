[0m10:56:24.632032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c2c980f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c2e377950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c2c981090>]}


============================== 10:56:24.635564 | bd1368b0-3f39-46a0-91a3-1f18ebf4edae ==============================
[0m10:56:24.635564 [info ] [MainThread]: Running with dbt=1.6.0
[0m10:56:24.636016 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'write_json': 'True', 'warn_error': 'None', 'use_colors': 'True', 'quiet': 'False', 'invocation_command': 'dbt init', 'indirect_selection': 'eager', 'introspect': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'profiles_dir': '/home/walterg/.dbt', 'printer_width': '80', 'debug': 'False', 'log_path': 'logs', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_format': 'default', 'no_print': 'None', 'static_parser': 'True', 'fail_fast': 'False'}
[0m10:56:24.636417 [warn ] [MainThread]: [ConfigFolderDirectory]: Unable to parse dict {'dir': PosixPath('/home/walterg/.dbt')}
[0m10:56:24.636708 [info ] [MainThread]: Creating dbt configuration folder at 
[0m10:56:36.963087 [debug] [MainThread]: Starter project path: /home/walterg/Documentos/Data Projects/live-DW/Data-Warehouse-postgres-DBT-airflow-/.venv/lib/python3.11/site-packages/dbt/include/starter_project
[0m10:56:36.971357 [info ] [MainThread]: 
Your new dbt project "livedw" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m10:56:36.971819 [info ] [MainThread]: Setting up your profile.
[0m10:56:48.950321 [info ] [MainThread]: Profile livedw written to /home/walterg/.dbt/profiles.yml using target's sample configuration. Once updated, you'll be able to start developing with dbt.
[0m10:56:48.950839 [debug] [MainThread]: Command `dbt init` succeeded at 10:56:48.950745 after 24.32 seconds
[0m10:56:48.951132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c313760d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c31377190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c312e0390>]}
[0m10:56:48.951438 [debug] [MainThread]: Flushing usage events
[0m20:38:57.715007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d71d5d7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d7205d890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d71db4950>]}


============================== 20:38:57.718128 | dd8bd8ed-b51c-43b9-85ac-5c1309e0ba52 ==============================
[0m20:38:57.718128 [info ] [MainThread]: Running with dbt=1.6.0
[0m20:38:57.718593 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/walterg/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt init vendas_dw', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:38:57.719301 [debug] [MainThread]: Starter project path: /home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/.venv/lib/python3.11/site-packages/dbt/include/starter_project
[0m20:38:57.722421 [info ] [MainThread]: 
Your new dbt project "vendas_dw" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m20:38:57.722828 [info ] [MainThread]: Setting up your profile.
[0m20:39:01.989299 [error] [MainThread]: Encountered an error:
[Errno 13] Permission denied: '/home/walterg/.dbt/profiles.yml'
[0m20:39:01.991440 [error] [MainThread]: Traceback (most recent call last):
  File "/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 87, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 72, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/.venv/lib/python3.11/site-packages/dbt/cli/main.py", line 467, in init
    results = task.run()
              ^^^^^^^^^^
  File "/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/.venv/lib/python3.11/site-packages/dbt/task/init.py", line 308, in run
    self.create_profile_from_target(adapter, profile_name=profile_name)
  File "/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/.venv/lib/python3.11/site-packages/dbt/task/init.py", line 189, in create_profile_from_target
    self.create_profile_from_sample(adapter, profile_name)
  File "/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/.venv/lib/python3.11/site-packages/dbt/task/init.py", line 96, in create_profile_from_sample
    with open(profiles_filepath, "w") as f:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: '/home/walterg/.dbt/profiles.yml'

[0m20:39:01.992252 [debug] [MainThread]: Command `dbt init` failed at 20:39:01.992129 after 4.28 seconds
[0m20:39:01.992614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d720f29d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d71d11990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d71d11650>]}
[0m20:39:01.992951 [debug] [MainThread]: Flushing usage events
[0m20:51:45.325963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f1a845d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f1a8446d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f1a845a50>]}


============================== 20:51:45.328463 | 65f1f0ba-4438-49a4-86bf-64ad831c0462 ==============================
[0m20:51:45.328463 [info ] [MainThread]: Running with dbt=1.6.0
[0m20:51:45.329029 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'logs', 'fail_fast': 'False', 'profiles_dir': '/home/walterg/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m20:51:45.329488 [info ] [MainThread]: dbt version: 1.6.0
[0m20:51:45.329856 [info ] [MainThread]: python version: 3.11.2
[0m20:51:45.330239 [info ] [MainThread]: python path: /home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/.venv/bin/python3
[0m20:51:45.330576 [info ] [MainThread]: os info: Linux-6.10.7-policorp-amd64-x86_64-with-glibc2.36
[0m20:51:45.368019 [info ] [MainThread]: Using profiles dir at /home/walterg/.dbt
[0m20:51:45.368469 [info ] [MainThread]: Using profiles.yml file at /home/walterg/.dbt/profiles.yml
[0m20:51:45.368835 [info ] [MainThread]: Using dbt_project.yml file at /home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/dbt_project.yml
[0m20:51:45.373352 [info ] [MainThread]: adapter type: postgres
[0m20:51:45.374272 [info ] [MainThread]: adapter version: 1.6.0
[0m20:51:45.375046 [info ] [MainThread]: Configuration:
[0m20:51:45.375467 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:51:45.375903 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m20:51:45.376278 [info ] [MainThread]: Required dependencies:
[0m20:51:45.376724 [debug] [MainThread]: Executing "git --help"
[0m20:51:45.379051 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:51:45.380208 [debug] [MainThread]: STDERR: "b''"
[0m20:51:45.380957 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:51:45.381217 [info ] [MainThread]: Connection:
[0m20:51:45.381464 [info ] [MainThread]:   host: dpg-d0khna8gjchc73ae1r1g-a.oregon-postgres.render.com
[0m20:51:45.381705 [info ] [MainThread]:   port: 5432
[0m20:51:45.381936 [info ] [MainThread]:   user: postgresadmin
[0m20:51:45.382203 [info ] [MainThread]:   database: general_rtxt
[0m20:51:45.382455 [info ] [MainThread]:   schema: bronze
[0m20:51:45.382706 [info ] [MainThread]:   connect_timeout: 10
[0m20:51:45.382934 [info ] [MainThread]:   role: None
[0m20:51:45.383249 [info ] [MainThread]:   search_path: None
[0m20:51:45.383595 [info ] [MainThread]:   keepalives_idle: 0
[0m20:51:45.383926 [info ] [MainThread]:   sslmode: None
[0m20:51:45.384177 [info ] [MainThread]:   sslcert: None
[0m20:51:45.384418 [info ] [MainThread]:   sslkey: None
[0m20:51:45.384682 [info ] [MainThread]:   sslrootcert: None
[0m20:51:45.384927 [info ] [MainThread]:   application_name: dbt
[0m20:51:45.385165 [info ] [MainThread]:   retries: 1
[0m20:51:45.385463 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m20:51:45.386047 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:51:45.386312 [debug] [MainThread]: Using postgres connection "debug"
[0m20:51:45.386581 [debug] [MainThread]: On debug: select 1 as id
[0m20:51:45.386827 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:51:46.890966 [debug] [MainThread]: SQL status: SELECT 1 in 2.0 seconds
[0m20:51:46.891875 [debug] [MainThread]: On debug: Close
[0m20:51:46.892343 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:51:46.892689 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:51:46.892951 [info ] [MainThread]: Project loading failed for the following reason:
 project path </home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/dbt_project.yml> not found

[0m20:51:46.893444 [debug] [MainThread]: Command `dbt debug` failed at 20:51:46.893333 after 1.57 seconds
[0m20:51:46.893791 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:51:46.894078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f1ab52790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f1cdb4290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f1f524a50>]}
[0m20:51:46.894399 [debug] [MainThread]: Flushing usage events
[0m20:52:59.369033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d7ac4e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d5820f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d7ac4f90>]}


============================== 20:52:59.371848 | 6c36d2f5-34e5-4ddb-85a4-a2823b81ecb8 ==============================
[0m20:52:59.371848 [info ] [MainThread]: Running with dbt=1.6.0
[0m20:52:59.372270 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/walterg/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:52:59.372672 [info ] [MainThread]: dbt version: 1.6.0
[0m20:52:59.372947 [info ] [MainThread]: python version: 3.11.2
[0m20:52:59.373223 [info ] [MainThread]: python path: /home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/.venv/bin/python3
[0m20:52:59.373500 [info ] [MainThread]: os info: Linux-6.10.7-policorp-amd64-x86_64-with-glibc2.36
[0m20:52:59.407281 [info ] [MainThread]: Using profiles dir at /home/walterg/.dbt
[0m20:52:59.407681 [info ] [MainThread]: Using profiles.yml file at /home/walterg/.dbt/profiles.yml
[0m20:52:59.407948 [info ] [MainThread]: Using dbt_project.yml file at /home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/dbt_project.yml
[0m20:52:59.408380 [info ] [MainThread]: adapter type: postgres
[0m20:52:59.408684 [info ] [MainThread]: adapter version: 1.6.0
[0m20:52:59.408954 [info ] [MainThread]: Configuration:
[0m20:52:59.409200 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:52:59.409456 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m20:52:59.409723 [info ] [MainThread]: Required dependencies:
[0m20:52:59.409980 [debug] [MainThread]: Executing "git --help"
[0m20:52:59.411884 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:52:59.412301 [debug] [MainThread]: STDERR: "b''"
[0m20:52:59.412802 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:52:59.413307 [info ] [MainThread]: Connection:
[0m20:52:59.413869 [info ] [MainThread]:   host: dpg-d0khna8gjchc73ae1r1g-a.oregon-postgres.render.com
[0m20:52:59.414327 [info ] [MainThread]:   port: 5432
[0m20:52:59.414584 [info ] [MainThread]:   user: postgresadmin
[0m20:52:59.414818 [info ] [MainThread]:   database: general_rtxt
[0m20:52:59.415050 [info ] [MainThread]:   schema: bronze
[0m20:52:59.415295 [info ] [MainThread]:   connect_timeout: 10
[0m20:52:59.415571 [info ] [MainThread]:   role: None
[0m20:52:59.415817 [info ] [MainThread]:   search_path: None
[0m20:52:59.416050 [info ] [MainThread]:   keepalives_idle: 0
[0m20:52:59.416288 [info ] [MainThread]:   sslmode: None
[0m20:52:59.416538 [info ] [MainThread]:   sslcert: None
[0m20:52:59.416779 [info ] [MainThread]:   sslkey: None
[0m20:52:59.417039 [info ] [MainThread]:   sslrootcert: None
[0m20:52:59.417308 [info ] [MainThread]:   application_name: dbt
[0m20:52:59.417621 [info ] [MainThread]:   retries: 1
[0m20:52:59.417997 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m20:52:59.418583 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:52:59.418937 [debug] [MainThread]: Using postgres connection "debug"
[0m20:52:59.419236 [debug] [MainThread]: On debug: select 1 as id
[0m20:52:59.419529 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:53:00.826106 [debug] [MainThread]: SQL status: SELECT 1 in 1.0 seconds
[0m20:53:00.827606 [debug] [MainThread]: On debug: Close
[0m20:53:00.827977 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:53:00.828249 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:53:00.828516 [info ] [MainThread]: Project loading failed for the following reason:
 project path </home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/dbt_project.yml> not found

[0m20:53:00.829009 [debug] [MainThread]: Command `dbt debug` failed at 20:53:00.828907 after 1.47 seconds
[0m20:53:00.829307 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:53:00.829601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d5549c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d6e1e350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91d50075d0>]}
[0m20:53:00.829915 [debug] [MainThread]: Flushing usage events
[0m20:58:38.034188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd35a7ead90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd35a76ea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd35a731110>]}


============================== 20:58:38.036633 | e1a27fc2-ef0e-42c4-8235-636708ee5390 ==============================
[0m20:58:38.036633 [info ] [MainThread]: Running with dbt=1.6.0
[0m20:58:38.037073 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/walterg/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:58:38.037492 [info ] [MainThread]: dbt version: 1.6.0
[0m20:58:38.037781 [info ] [MainThread]: python version: 3.11.2
[0m20:58:38.038062 [info ] [MainThread]: python path: /home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/.venv/bin/python3
[0m20:58:38.038313 [info ] [MainThread]: os info: Linux-6.10.7-policorp-amd64-x86_64-with-glibc2.36
[0m20:58:38.072926 [info ] [MainThread]: Using profiles dir at /home/walterg/.dbt
[0m20:58:38.073341 [info ] [MainThread]: Using profiles.yml file at /home/walterg/.dbt/profiles.yml
[0m20:58:38.073617 [info ] [MainThread]: Using dbt_project.yml file at /home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/dbt_project.yml
[0m20:58:38.074031 [info ] [MainThread]: adapter type: postgres
[0m20:58:38.074306 [info ] [MainThread]: adapter version: 1.6.0
[0m20:58:38.074592 [info ] [MainThread]: Configuration:
[0m20:58:38.074845 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:58:38.075100 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m20:58:38.075343 [info ] [MainThread]: Required dependencies:
[0m20:58:38.075624 [debug] [MainThread]: Executing "git --help"
[0m20:58:38.078222 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:58:38.078681 [debug] [MainThread]: STDERR: "b''"
[0m20:58:38.078936 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:58:38.079188 [info ] [MainThread]: Connection:
[0m20:58:38.079450 [info ] [MainThread]:   host: dpg-d0khna8gjchc73ae1r1g-a.oregon-postgres.render.com
[0m20:58:38.079724 [info ] [MainThread]:   port: 5432
[0m20:58:38.079952 [info ] [MainThread]:   user: postgresadmin
[0m20:58:38.080182 [info ] [MainThread]:   database: general_rtxt
[0m20:58:38.080412 [info ] [MainThread]:   schema: bronze
[0m20:58:38.080661 [info ] [MainThread]:   connect_timeout: 10
[0m20:58:38.080888 [info ] [MainThread]:   role: None
[0m20:58:38.081113 [info ] [MainThread]:   search_path: None
[0m20:58:38.081338 [info ] [MainThread]:   keepalives_idle: 0
[0m20:58:38.081585 [info ] [MainThread]:   sslmode: None
[0m20:58:38.081809 [info ] [MainThread]:   sslcert: None
[0m20:58:38.082031 [info ] [MainThread]:   sslkey: None
[0m20:58:38.082254 [info ] [MainThread]:   sslrootcert: None
[0m20:58:38.082484 [info ] [MainThread]:   application_name: dbt
[0m20:58:38.082723 [info ] [MainThread]:   retries: 1
[0m20:58:38.082992 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m20:58:38.083458 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:58:38.083804 [debug] [MainThread]: Using postgres connection "debug"
[0m20:58:38.084060 [debug] [MainThread]: On debug: select 1 as id
[0m20:58:38.084309 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:58:39.692890 [debug] [MainThread]: SQL status: SELECT 1 in 2.0 seconds
[0m20:58:39.694430 [debug] [MainThread]: On debug: Close
[0m20:58:39.694857 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:58:39.695154 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:58:39.695405 [info ] [MainThread]: Project loading failed for the following reason:
 project path </home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/dbt_project.yml> not found

[0m20:58:39.695890 [debug] [MainThread]: Command `dbt debug` failed at 20:58:39.695806 after 1.67 seconds
[0m20:58:39.696160 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:58:39.696418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd35a4a2b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd35a301410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd35a755310>]}
[0m20:58:39.696735 [debug] [MainThread]: Flushing usage events
[0m20:59:50.268446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa57b656fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa57b32d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa57dcbb550>]}


============================== 20:59:50.270889 | 38f951c9-a450-421c-be95-700a06bec0b9 ==============================
[0m20:59:50.270889 [info ] [MainThread]: Running with dbt=1.6.0
[0m20:59:50.271320 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/walterg/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:59:50.271660 [info ] [MainThread]: dbt version: 1.6.0
[0m20:59:50.271928 [info ] [MainThread]: python version: 3.11.2
[0m20:59:50.272183 [info ] [MainThread]: python path: /home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/.venv/bin/python3
[0m20:59:50.272435 [info ] [MainThread]: os info: Linux-6.10.7-policorp-amd64-x86_64-with-glibc2.36
[0m20:59:50.307016 [info ] [MainThread]: Using profiles dir at /home/walterg/.dbt
[0m20:59:50.307430 [info ] [MainThread]: Using profiles.yml file at /home/walterg/.dbt/profiles.yml
[0m20:59:50.307701 [info ] [MainThread]: Using dbt_project.yml file at /home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/dbt_project.yml
[0m20:59:50.308082 [info ] [MainThread]: adapter type: postgres
[0m20:59:50.308328 [info ] [MainThread]: adapter version: 1.6.0
[0m20:59:50.324032 [info ] [MainThread]: Configuration:
[0m20:59:50.324423 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:59:50.324689 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:59:50.324928 [info ] [MainThread]: Required dependencies:
[0m20:59:50.325187 [debug] [MainThread]: Executing "git --help"
[0m20:59:50.327036 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:59:50.327434 [debug] [MainThread]: STDERR: "b''"
[0m20:59:50.327694 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:59:50.327944 [info ] [MainThread]: Connection:
[0m20:59:50.328207 [info ] [MainThread]:   host: dpg-d0khna8gjchc73ae1r1g-a.oregon-postgres.render.com
[0m20:59:50.328452 [info ] [MainThread]:   port: 5432
[0m20:59:50.328735 [info ] [MainThread]:   user: postgresadmin
[0m20:59:50.329009 [info ] [MainThread]:   database: general_rtxt
[0m20:59:50.329247 [info ] [MainThread]:   schema: bronze
[0m20:59:50.329494 [info ] [MainThread]:   connect_timeout: 10
[0m20:59:50.329755 [info ] [MainThread]:   role: None
[0m20:59:50.330083 [info ] [MainThread]:   search_path: None
[0m20:59:50.330331 [info ] [MainThread]:   keepalives_idle: 0
[0m20:59:50.330582 [info ] [MainThread]:   sslmode: None
[0m20:59:50.330923 [info ] [MainThread]:   sslcert: None
[0m20:59:50.331306 [info ] [MainThread]:   sslkey: None
[0m20:59:50.331737 [info ] [MainThread]:   sslrootcert: None
[0m20:59:50.332034 [info ] [MainThread]:   application_name: dbt
[0m20:59:50.332269 [info ] [MainThread]:   retries: 1
[0m20:59:50.332601 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m20:59:50.333158 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:59:50.333421 [debug] [MainThread]: Using postgres connection "debug"
[0m20:59:50.333675 [debug] [MainThread]: On debug: select 1 as id
[0m20:59:50.333893 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:59:51.783365 [debug] [MainThread]: SQL status: SELECT 1 in 1.0 seconds
[0m20:59:51.784692 [debug] [MainThread]: On debug: Close
[0m20:59:51.785117 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:59:51.785394 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:59:51.785881 [debug] [MainThread]: Command `dbt debug` succeeded at 20:59:51.785786 after 1.52 seconds
[0m20:59:51.786139 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:59:51.786402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa57af0c710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa57addd290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa57d78b950>]}
[0m20:59:51.786725 [debug] [MainThread]: Flushing usage events
[0m21:01:27.930068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2ec80fa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2ecb20810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2ed398c90>]}


============================== 21:01:27.932878 | 991cddf2-601e-4706-bde7-f64a0499254c ==============================
[0m21:01:27.932878 [info ] [MainThread]: Running with dbt=1.6.0
[0m21:01:27.933307 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/walterg/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:01:27.993504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '991cddf2-601e-4706-bde7-f64a0499254c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2ed37b450>]}
[0m21:01:28.004513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '991cddf2-601e-4706-bde7-f64a0499254c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2ecb33cd0>]}
[0m21:01:28.005168 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m21:01:28.016743 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m21:01:28.017285 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:01:28.017625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '991cddf2-601e-4706-bde7-f64a0499254c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2ece8cc10>]}
[0m21:01:28.473061 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vendas_dw.bronze
- models.vendas_dw.gold
- models.vendas_dw.silver
[0m21:01:28.476657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '991cddf2-601e-4706-bde7-f64a0499254c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2ede8c810>]}
[0m21:01:28.483726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '991cddf2-601e-4706-bde7-f64a0499254c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2ec3e1650>]}
[0m21:01:28.484145 [info ] [MainThread]: Found 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m21:01:28.484434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '991cddf2-601e-4706-bde7-f64a0499254c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2ec324350>]}
[0m21:01:28.485552 [info ] [MainThread]: 
[0m21:01:28.485891 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:01:28.486279 [debug] [MainThread]: Command end result
[0m21:01:28.492302 [debug] [MainThread]: Command `dbt run` succeeded at 21:01:28.492144 after 0.57 seconds
[0m21:01:28.492690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2eceee7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2f18c2450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2ecb20810>]}
[0m21:01:28.493033 [debug] [MainThread]: Flushing usage events
[0m21:03:14.461412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa63a84ab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa63a5b5810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa63a5ab1d0>]}


============================== 21:03:14.464391 | 7e88acd1-c58b-44b7-86f7-6f724c4ffe20 ==============================
[0m21:03:14.464391 [info ] [MainThread]: Running with dbt=1.6.0
[0m21:03:14.464860 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'debug': 'False', 'profiles_dir': '/home/walterg/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:03:14.523978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e88acd1-c58b-44b7-86f7-6f724c4ffe20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa63a70d990>]}
[0m21:03:14.534966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e88acd1-c58b-44b7-86f7-6f724c4ffe20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa63a70d950>]}
[0m21:03:14.535606 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m21:03:14.542250 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m21:03:14.556624 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:03:14.556987 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:03:14.557304 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vendas_dw.gold
- models.vendas_dw.silver
- models.vendas_dw.bronze
[0m21:03:14.560997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e88acd1-c58b-44b7-86f7-6f724c4ffe20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa63a55d990>]}
[0m21:03:14.569900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e88acd1-c58b-44b7-86f7-6f724c4ffe20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa639d3c250>]}
[0m21:03:14.570390 [info ] [MainThread]: Found 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m21:03:14.570733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e88acd1-c58b-44b7-86f7-6f724c4ffe20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa63e178d50>]}
[0m21:03:14.571895 [info ] [MainThread]: 
[0m21:03:14.572258 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:03:14.572689 [debug] [MainThread]: Command end result
[0m21:03:14.577828 [debug] [MainThread]: Command `dbt run` succeeded at 21:03:14.577655 after 0.12 seconds
[0m21:03:14.578224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa63f220c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa63f210690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa63f2bb710>]}
[0m21:03:14.578556 [debug] [MainThread]: Flushing usage events
[0m21:04:32.306686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e7724d590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e772b2b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e77116b50>]}


============================== 21:04:32.308990 | e28567d8-b2fb-4e02-bc93-5fb7482ae812 ==============================
[0m21:04:32.308990 [info ] [MainThread]: Running with dbt=1.6.0
[0m21:04:32.309404 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'fail_fast': 'False', 'profiles_dir': '/home/walterg/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt parse', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:04:32.368866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e28567d8-b2fb-4e02-bc93-5fb7482ae812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e772363d0>]}
[0m21:04:32.379975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e28567d8-b2fb-4e02-bc93-5fb7482ae812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e772b25d0>]}
[0m21:04:32.380628 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m21:04:32.387213 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m21:04:32.402055 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:04:32.402408 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:04:32.402737 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vendas_dw.gold
- models.vendas_dw.bronze
- models.vendas_dw.silver
[0m21:04:32.406367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e28567d8-b2fb-4e02-bc93-5fb7482ae812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e775678d0>]}
[0m21:04:32.407031 [info ] [MainThread]: Performance info: /home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/target/perf_info.json
[0m21:04:32.415066 [debug] [MainThread]: Command `dbt parse` succeeded at 21:04:32.414914 after 0.11 seconds
[0m21:04:32.415459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e772b2990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e76f0fe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e77220950>]}
[0m21:04:32.415863 [debug] [MainThread]: Flushing usage events
[0m21:05:20.862328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5df1552490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5df1dc7110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5df157f950>]}


============================== 21:05:20.864981 | 6ca61b9d-dd83-45a3-abbb-2ba7ecb93631 ==============================
[0m21:05:20.864981 [info ] [MainThread]: Running with dbt=1.6.0
[0m21:05:20.865430 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/walterg/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:05:20.933857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ca61b9d-dd83-45a3-abbb-2ba7ecb93631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5df0f48350>]}
[0m21:05:20.944830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ca61b9d-dd83-45a3-abbb-2ba7ecb93631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5df0f48350>]}
[0m21:05:20.945496 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m21:05:20.951953 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m21:05:20.957518 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:05:20.957944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6ca61b9d-dd83-45a3-abbb-2ba7ecb93631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5df0e3ec90>]}
[0m21:05:21.427496 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.bronze
- models.silver
- models.gold
[0m21:05:21.431059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ca61b9d-dd83-45a3-abbb-2ba7ecb93631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5df191d710>]}
[0m21:05:21.438500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ca61b9d-dd83-45a3-abbb-2ba7ecb93631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5df0dd86d0>]}
[0m21:05:21.438928 [info ] [MainThread]: Found 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m21:05:21.439237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ca61b9d-dd83-45a3-abbb-2ba7ecb93631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5df0d74190>]}
[0m21:05:21.440420 [info ] [MainThread]: 
[0m21:05:21.440861 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:05:21.441285 [debug] [MainThread]: Command end result
[0m21:05:21.447316 [debug] [MainThread]: Command `dbt run` succeeded at 21:05:21.447159 after 0.59 seconds
[0m21:05:21.447770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5df191d790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5df5e3f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5df19371d0>]}
[0m21:05:21.448188 [debug] [MainThread]: Flushing usage events
[0m21:07:08.515736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2f1652c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2f1651590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2f13a8a50>]}


============================== 21:07:08.518545 | ca90f062-cd96-4284-b27a-8c6ba9767fba ==============================
[0m21:07:08.518545 [info ] [MainThread]: Running with dbt=1.6.0
[0m21:07:08.519019 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/walterg/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:07:08.577512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca90f062-cd96-4284-b27a-8c6ba9767fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2f1323390>]}
[0m21:07:08.588518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca90f062-cd96-4284-b27a-8c6ba9767fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2f1a09710>]}
[0m21:07:08.589157 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m21:07:08.596280 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m21:07:08.602017 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:07:08.602524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ca90f062-cd96-4284-b27a-8c6ba9767fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2f1351190>]}
[0m21:07:09.058353 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vendas_dw.silver
- models.vendas_dw.bronze
- models.vendas_dw.gold
[0m21:07:09.062202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca90f062-cd96-4284-b27a-8c6ba9767fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2f166da90>]}
[0m21:07:09.070000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca90f062-cd96-4284-b27a-8c6ba9767fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2f10ff850>]}
[0m21:07:09.070512 [info ] [MainThread]: Found 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m21:07:09.071008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca90f062-cd96-4284-b27a-8c6ba9767fba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2f156a690>]}
[0m21:07:09.072523 [info ] [MainThread]: 
[0m21:07:09.072977 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:07:09.073428 [debug] [MainThread]: Command end result
[0m21:07:09.079435 [debug] [MainThread]: Command `dbt run` succeeded at 21:07:09.079281 after 0.57 seconds
[0m21:07:09.079929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2f1629610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2f167e3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2f1304950>]}
[0m21:07:09.080306 [debug] [MainThread]: Flushing usage events
[0m21:08:09.634372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd968f30850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd96b90f510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd968cb80d0>]}


============================== 21:08:09.637254 | 306a9842-1f4b-4d1b-92d0-106a9bf49df0 ==============================
[0m21:08:09.637254 [info ] [MainThread]: Running with dbt=1.6.0
[0m21:08:09.637706 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'debug': 'False', 'profiles_dir': '/home/walterg/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:08:09.698097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '306a9842-1f4b-4d1b-92d0-106a9bf49df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd968b11350>]}
[0m21:08:09.709514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '306a9842-1f4b-4d1b-92d0-106a9bf49df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd968cf5750>]}
[0m21:08:09.710184 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m21:08:09.716950 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m21:08:09.732831 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:08:09.733242 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:08:09.733576 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vendas_dw.silver
- models.vendas_dw.gold
- models.vendas_dw.bronze
[0m21:08:09.737770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '306a9842-1f4b-4d1b-92d0-106a9bf49df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9692f0910>]}
[0m21:08:09.745378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '306a9842-1f4b-4d1b-92d0-106a9bf49df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9688398d0>]}
[0m21:08:09.745887 [info ] [MainThread]: Found 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m21:08:09.746262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '306a9842-1f4b-4d1b-92d0-106a9bf49df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd96da5b590>]}
[0m21:08:09.747531 [info ] [MainThread]: 
[0m21:08:09.747972 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:08:09.748514 [debug] [MainThread]: Command end result
[0m21:08:09.754343 [debug] [MainThread]: Command `dbt run` succeeded at 21:08:09.754201 after 0.13 seconds
[0m21:08:09.754717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd96d9b0690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd968cb8510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd968cb83d0>]}
[0m21:08:09.755037 [debug] [MainThread]: Flushing usage events
[0m21:10:13.648981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff40b590cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff40b573bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff40b029990>]}


============================== 21:10:13.651569 | 1deb3218-7b39-4155-9a36-895b69f642d1 ==============================
[0m21:10:13.651569 [info ] [MainThread]: Running with dbt=1.6.0
[0m21:10:13.651983 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/walterg/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m21:10:13.680322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1deb3218-7b39-4155-9a36-895b69f642d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff40aa07850>]}
[0m21:10:13.682710 [debug] [MainThread]: Command `dbt clean` succeeded at 21:10:13.682622 after 0.04 seconds
[0m21:10:13.683027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff40bbccd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff40fa20990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff40b059910>]}
[0m21:10:13.683347 [debug] [MainThread]: Flushing usage events
[0m21:10:16.239021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc76f685ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc76f572810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc76f20d090>]}


============================== 21:10:16.241351 | 0c3b4568-7656-4d5c-8f3e-896d3631a47d ==============================
[0m21:10:16.241351 [info ] [MainThread]: Running with dbt=1.6.0
[0m21:10:16.241820 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'version_check': 'True', 'profiles_dir': '/home/walterg/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt parse', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:10:16.301367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c3b4568-7656-4d5c-8f3e-896d3631a47d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc76f65d350>]}
[0m21:10:16.312528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c3b4568-7656-4d5c-8f3e-896d3631a47d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc76eb08590>]}
[0m21:10:16.313161 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m21:10:16.319773 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m21:10:16.320305 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:10:16.320661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0c3b4568-7656-4d5c-8f3e-896d3631a47d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc76f0dd150>]}
[0m21:10:16.774998 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vendas_dw.bronze
- models.vendas_dw.silver
- models.vendas_dw.gold
[0m21:10:16.778626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c3b4568-7656-4d5c-8f3e-896d3631a47d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc76f789d90>]}
[0m21:10:16.779311 [info ] [MainThread]: Performance info: /home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/target/perf_info.json
[0m21:10:16.786025 [debug] [MainThread]: Command `dbt parse` succeeded at 21:10:16.785874 after 0.55 seconds
[0m21:10:16.786378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc76f572990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc76f676510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc76f8c8610>]}
[0m21:10:16.786752 [debug] [MainThread]: Flushing usage events
[0m21:10:19.603601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93e3c55650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93e3dfed10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93e40f7f10>]}


============================== 21:10:19.606455 | f3abc9f4-cbc9-472d-8a38-00f21b17ac2d ==============================
[0m21:10:19.606455 [info ] [MainThread]: Running with dbt=1.6.0
[0m21:10:19.606927 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'profiles_dir': '/home/walterg/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:10:19.667829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3abc9f4-cbc9-472d-8a38-00f21b17ac2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93e39fef10>]}
[0m21:10:19.679166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3abc9f4-cbc9-472d-8a38-00f21b17ac2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93e393dad0>]}
[0m21:10:19.679842 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m21:10:19.686975 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m21:10:19.701757 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:10:19.702121 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:10:19.702428 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vendas_dw.gold
- models.vendas_dw.silver
- models.vendas_dw.bronze
[0m21:10:19.706143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3abc9f4-cbc9-472d-8a38-00f21b17ac2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93e4ac8a10>]}
[0m21:10:19.714877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3abc9f4-cbc9-472d-8a38-00f21b17ac2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93e3831450>]}
[0m21:10:19.715566 [info ] [MainThread]: Found 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m21:10:19.716112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3abc9f4-cbc9-472d-8a38-00f21b17ac2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93e7850950>]}
[0m21:10:19.717308 [info ] [MainThread]: 
[0m21:10:19.717734 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:10:19.718237 [debug] [MainThread]: Command end result
[0m21:10:19.723669 [debug] [MainThread]: Command `dbt run` succeeded at 21:10:19.723466 after 0.13 seconds
[0m21:10:19.724188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93e3e2ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93e4f769d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93e8914690>]}
[0m21:10:19.724736 [debug] [MainThread]: Flushing usage events
[0m21:12:34.999007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e58a8d390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e58823c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e5862b9d0>]}


============================== 21:12:35.001652 | e7f538a9-e1b1-45f6-aa10-538b696c1624 ==============================
[0m21:12:35.001652 [info ] [MainThread]: Running with dbt=1.6.0
[0m21:12:35.002080 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/walterg/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m21:12:35.061896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7f538a9-e1b1-45f6-aa10-538b696c1624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e5833d150>]}
[0m21:12:35.072898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7f538a9-e1b1-45f6-aa10-538b696c1624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e594c8810>]}
[0m21:12:35.073556 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m21:12:35.080865 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m21:12:35.096999 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:12:35.097383 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:12:35.097737 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vendas_dw.bronze
- models.vendas_dw.gold
- models.vendas_dw.silver
[0m21:12:35.101987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7f538a9-e1b1-45f6-aa10-538b696c1624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e5860d9d0>]}
[0m21:12:35.110275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7f538a9-e1b1-45f6-aa10-538b696c1624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e5818d950>]}
[0m21:12:35.110903 [info ] [MainThread]: Found 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m21:12:35.111390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7f538a9-e1b1-45f6-aa10-538b696c1624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e5c23cd50>]}
[0m21:12:35.113027 [info ] [MainThread]: 
[0m21:12:35.113561 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:12:35.114121 [debug] [MainThread]: Command end result
[0m21:12:35.120312 [debug] [MainThread]: Command `dbt run` succeeded at 21:12:35.120126 after 0.13 seconds
[0m21:12:35.120728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e59199a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e5d25b290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e5d25b350>]}
[0m21:12:35.121073 [debug] [MainThread]: Flushing usage events
[0m21:13:47.769119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eac6b5f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eac6c0a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ead1dff50>]}


============================== 21:13:47.772068 | 39873dd6-efd7-4b0d-9205-72b1066bde16 ==============================
[0m21:13:47.772068 [info ] [MainThread]: Running with dbt=1.6.0
[0m21:13:47.772539 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'profiles_dir': '/home/walterg/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:13:47.833832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39873dd6-efd7-4b0d-9205-72b1066bde16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eac63a510>]}
[0m21:13:47.845074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39873dd6-efd7-4b0d-9205-72b1066bde16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eac982d50>]}
[0m21:13:47.845786 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m21:13:47.852727 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m21:13:47.868554 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 0 files changed.
[0m21:13:47.869009 [debug] [MainThread]: Partial parsing: added file: vendas_dw://models/vendas_dw/silver/fct_vendas.sql
[0m21:13:47.869321 [debug] [MainThread]: Partial parsing: added file: vendas_dw://models/vendas_dw/bronze/sources.yml
[0m21:13:47.869612 [debug] [MainThread]: Partial parsing: added file: vendas_dw://models/vendas_dw/gold/indicadores_vendas.sql
[0m21:13:47.869871 [debug] [MainThread]: Partial parsing: added file: vendas_dw://models/vendas_dw/bronze/vendas.sql
[0m21:13:47.920368 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vendas_dw.gold
- models.vendas_dw.bronze
- models.vendas_dw.silver
[0m21:13:47.924098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39873dd6-efd7-4b0d-9205-72b1066bde16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eac19dc90>]}
[0m21:13:47.933099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39873dd6-efd7-4b0d-9205-72b1066bde16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eabdfd5d0>]}
[0m21:13:47.933694 [info ] [MainThread]: Found 3 models, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m21:13:47.934129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39873dd6-efd7-4b0d-9205-72b1066bde16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eac969550>]}
[0m21:13:47.935945 [info ] [MainThread]: 
[0m21:13:47.936687 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:13:47.937838 [debug] [ThreadPool]: Acquiring new postgres connection 'list_general_rtxt'
[0m21:13:47.946401 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt"
[0m21:13:47.946817 [debug] [ThreadPool]: On list_general_rtxt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt"} */

    select distinct nspname from pg_namespace
  
[0m21:13:47.947056 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:13:49.521723 [debug] [ThreadPool]: SQL status: SELECT 9 in 2.0 seconds
[0m21:13:49.522911 [debug] [ThreadPool]: On list_general_rtxt: Close
[0m21:13:49.524597 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_general_rtxt, now list_general_rtxt_bronze)
[0m21:13:49.575776 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze"
[0m21:13:49.576150 [debug] [ThreadPool]: On list_general_rtxt_bronze: BEGIN
[0m21:13:49.576381 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:13:51.176908 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m21:13:51.177589 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze"
[0m21:13:51.178119 [debug] [ThreadPool]: On list_general_rtxt_bronze: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt_bronze"} */
select
      'general_rtxt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze'
    union all
    select
      'general_rtxt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze'
    union all
    select
      'general_rtxt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze'
  
[0m21:13:51.381203 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m21:13:51.382535 [debug] [ThreadPool]: On list_general_rtxt_bronze: ROLLBACK
[0m21:13:51.569532 [debug] [ThreadPool]: On list_general_rtxt_bronze: Close
[0m21:13:51.574045 [debug] [MainThread]: Using postgres connection "master"
[0m21:13:51.574413 [debug] [MainThread]: On master: BEGIN
[0m21:13:51.574689 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:13:53.033276 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m21:13:53.034085 [debug] [MainThread]: Using postgres connection "master"
[0m21:13:53.034662 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:13:53.270738 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m21:13:53.272735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39873dd6-efd7-4b0d-9205-72b1066bde16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eac6fe250>]}
[0m21:13:53.273130 [debug] [MainThread]: On master: ROLLBACK
[0m21:13:53.460206 [debug] [MainThread]: Using postgres connection "master"
[0m21:13:53.460950 [debug] [MainThread]: On master: BEGIN
[0m21:13:53.877918 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:13:53.878555 [debug] [MainThread]: On master: COMMIT
[0m21:13:53.878821 [debug] [MainThread]: Using postgres connection "master"
[0m21:13:53.879064 [debug] [MainThread]: On master: COMMIT
[0m21:13:54.091439 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:13:54.092137 [debug] [MainThread]: On master: Close
[0m21:13:54.093064 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:13:54.093466 [info ] [MainThread]: 
[0m21:13:54.096734 [debug] [Thread-1 (]: Began running node model.vendas_dw.vendas
[0m21:13:54.097246 [info ] [Thread-1 (]: 1 of 3 START sql view model bronze.vendas ...................................... [RUN]
[0m21:13:54.097845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_general_rtxt_bronze, now model.vendas_dw.vendas)
[0m21:13:54.098191 [debug] [Thread-1 (]: Began compiling node model.vendas_dw.vendas
[0m21:13:54.103172 [debug] [Thread-1 (]: Writing injected SQL for node "model.vendas_dw.vendas"
[0m21:13:54.103990 [debug] [Thread-1 (]: Timing info for model.vendas_dw.vendas (compile): 21:13:54.098398 => 21:13:54.103813
[0m21:13:54.104313 [debug] [Thread-1 (]: Began executing node model.vendas_dw.vendas
[0m21:13:54.131366 [debug] [Thread-1 (]: Writing runtime sql for node "model.vendas_dw.vendas"
[0m21:13:54.132493 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.vendas"
[0m21:13:54.132857 [debug] [Thread-1 (]: On model.vendas_dw.vendas: BEGIN
[0m21:13:54.133145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:55.492182 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m21:13:55.492670 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.vendas"
[0m21:13:55.492985 [debug] [Thread-1 (]: On model.vendas_dw.vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.vendas"} */

  create view "general_rtxt"."bronze"."vendas__dbt_tmp"
    
    
  as (
    SELECT * FROM "seu_banco"."bronze"."vendas"
  );
[0m21:13:55.679637 [debug] [Thread-1 (]: Postgres adapter: Postgres error: cross-database references are not implemented: "seu_banco.bronze.vendas"
LINE 7:     SELECT * FROM "seu_banco"."bronze"."vendas"
                          ^

[0m21:13:55.680127 [debug] [Thread-1 (]: On model.vendas_dw.vendas: ROLLBACK
[0m21:13:55.864922 [debug] [Thread-1 (]: Timing info for model.vendas_dw.vendas (execute): 21:13:54.104542 => 21:13:55.864657
[0m21:13:55.865302 [debug] [Thread-1 (]: On model.vendas_dw.vendas: Close
[0m21:13:55.873777 [debug] [Thread-1 (]: Database Error in model vendas (models/vendas_dw/bronze/vendas.sql)
  cross-database references are not implemented: "seu_banco.bronze.vendas"
  LINE 7:     SELECT * FROM "seu_banco"."bronze"."vendas"
                            ^
  compiled Code at target/run/vendas_dw/models/vendas_dw/bronze/vendas.sql
[0m21:13:55.874270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39873dd6-efd7-4b0d-9205-72b1066bde16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eac3d7a10>]}
[0m21:13:55.874778 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model bronze.vendas ............................. [[31mERROR[0m in 1.78s]
[0m21:13:55.875318 [debug] [Thread-1 (]: Finished running node model.vendas_dw.vendas
[0m21:13:55.877578 [debug] [Thread-3 (]: Began running node model.vendas_dw.fct_vendas
[0m21:13:55.878411 [info ] [Thread-3 (]: 2 of 3 SKIP relation bronze.fct_vendas ......................................... [[33mSKIP[0m]
[0m21:13:55.879178 [debug] [Thread-3 (]: Finished running node model.vendas_dw.fct_vendas
[0m21:13:55.880394 [debug] [Thread-2 (]: Began running node model.vendas_dw.indicadores_vendas
[0m21:13:55.880966 [info ] [Thread-2 (]: 3 of 3 SKIP relation bronze.indicadores_vendas ................................. [[33mSKIP[0m]
[0m21:13:55.881404 [debug] [Thread-2 (]: Finished running node model.vendas_dw.indicadores_vendas
[0m21:13:55.883284 [debug] [MainThread]: Using postgres connection "master"
[0m21:13:55.883666 [debug] [MainThread]: On master: BEGIN
[0m21:13:55.883908 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:13:57.255526 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m21:13:57.256070 [debug] [MainThread]: On master: COMMIT
[0m21:13:57.256313 [debug] [MainThread]: Using postgres connection "master"
[0m21:13:57.256578 [debug] [MainThread]: On master: COMMIT
[0m21:13:57.442605 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:13:57.443324 [debug] [MainThread]: On master: Close
[0m21:13:57.443930 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:13:57.444204 [debug] [MainThread]: Connection 'model.vendas_dw.vendas' was properly closed.
[0m21:13:57.444526 [info ] [MainThread]: 
[0m21:13:57.444836 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 9.51 seconds (9.51s).
[0m21:13:57.445409 [debug] [MainThread]: Command end result
[0m21:13:57.451330 [info ] [MainThread]: 
[0m21:13:57.451766 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:13:57.452069 [info ] [MainThread]: 
[0m21:13:57.452350 [error] [MainThread]: [33mDatabase Error in model vendas (models/vendas_dw/bronze/vendas.sql)[0m
[0m21:13:57.452648 [error] [MainThread]:   cross-database references are not implemented: "seu_banco.bronze.vendas"
[0m21:13:57.452904 [error] [MainThread]:   LINE 7:     SELECT * FROM "seu_banco"."bronze"."vendas"
[0m21:13:57.453171 [error] [MainThread]:                             ^
[0m21:13:57.453426 [error] [MainThread]:   compiled Code at target/run/vendas_dw/models/vendas_dw/bronze/vendas.sql
[0m21:13:57.453735 [info ] [MainThread]: 
[0m21:13:57.454053 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m21:13:57.454593 [debug] [MainThread]: Command `dbt run` failed at 21:13:57.454467 after 9.69 seconds
[0m21:13:57.454976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ead1a45d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ead1a4710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eac6b62d0>]}
[0m21:13:57.455307 [debug] [MainThread]: Flushing usage events
[0m21:14:52.364188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e38053f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e3836d450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e38053950>]}


============================== 21:14:52.366537 | 97b5ca3a-3847-4497-8210-998a6839bdf7 ==============================
[0m21:14:52.366537 [info ] [MainThread]: Running with dbt=1.6.0
[0m21:14:52.366991 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/walterg/.dbt', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:14:52.428258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97b5ca3a-3847-4497-8210-998a6839bdf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e380c27d0>]}
[0m21:14:52.439948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97b5ca3a-3847-4497-8210-998a6839bdf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e3821ec50>]}
[0m21:14:52.440642 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m21:14:52.448012 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m21:14:52.464251 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:14:52.465004 [debug] [MainThread]: Partial parsing: updated file: vendas_dw://models/vendas_dw/bronze/sources.yml
[0m21:14:52.517331 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vendas_dw.gold
- models.vendas_dw.bronze
- models.vendas_dw.silver
[0m21:14:52.521131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97b5ca3a-3847-4497-8210-998a6839bdf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e37d3fc90>]}
[0m21:14:52.530128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97b5ca3a-3847-4497-8210-998a6839bdf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e37793e10>]}
[0m21:14:52.530664 [info ] [MainThread]: Found 3 models, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m21:14:52.530971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97b5ca3a-3847-4497-8210-998a6839bdf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e37b7ea10>]}
[0m21:14:52.532685 [info ] [MainThread]: 
[0m21:14:52.533400 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:14:52.534756 [debug] [ThreadPool]: Acquiring new postgres connection 'list_general_rtxt'
[0m21:14:52.600178 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt"
[0m21:14:52.600579 [debug] [ThreadPool]: On list_general_rtxt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt"} */

    select distinct nspname from pg_namespace
  
[0m21:14:52.600819 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:14:54.357728 [debug] [ThreadPool]: SQL status: SELECT 9 in 2.0 seconds
[0m21:14:54.359283 [debug] [ThreadPool]: On list_general_rtxt: Close
[0m21:14:54.361086 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_general_rtxt, now list_general_rtxt_bronze)
[0m21:14:54.365385 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze"
[0m21:14:54.365763 [debug] [ThreadPool]: On list_general_rtxt_bronze: BEGIN
[0m21:14:54.365990 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:14:55.830181 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m21:14:55.830918 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze"
[0m21:14:55.831167 [debug] [ThreadPool]: On list_general_rtxt_bronze: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt_bronze"} */
select
      'general_rtxt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze'
    union all
    select
      'general_rtxt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze'
    union all
    select
      'general_rtxt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze'
  
[0m21:14:56.022474 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m21:14:56.024687 [debug] [ThreadPool]: On list_general_rtxt_bronze: ROLLBACK
[0m21:14:56.216008 [debug] [ThreadPool]: On list_general_rtxt_bronze: Close
[0m21:14:56.221259 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:56.221661 [debug] [MainThread]: On master: BEGIN
[0m21:14:56.221914 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:14:57.602469 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m21:14:57.603254 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:57.603549 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:14:57.800138 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m21:14:57.801869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97b5ca3a-3847-4497-8210-998a6839bdf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e38f6aad0>]}
[0m21:14:57.802301 [debug] [MainThread]: On master: ROLLBACK
[0m21:14:57.996335 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:57.997000 [debug] [MainThread]: On master: BEGIN
[0m21:14:58.369684 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:14:58.370370 [debug] [MainThread]: On master: COMMIT
[0m21:14:58.370693 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:58.370934 [debug] [MainThread]: On master: COMMIT
[0m21:14:58.588074 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:14:58.589004 [debug] [MainThread]: On master: Close
[0m21:14:58.589646 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:14:58.589994 [info ] [MainThread]: 
[0m21:14:58.592792 [debug] [Thread-1 (]: Began running node model.vendas_dw.vendas
[0m21:14:58.593684 [info ] [Thread-1 (]: 1 of 3 START sql view model bronze.vendas ...................................... [RUN]
[0m21:14:58.594327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_general_rtxt_bronze, now model.vendas_dw.vendas)
[0m21:14:58.594675 [debug] [Thread-1 (]: Began compiling node model.vendas_dw.vendas
[0m21:14:58.599732 [debug] [Thread-1 (]: Writing injected SQL for node "model.vendas_dw.vendas"
[0m21:14:58.600386 [debug] [Thread-1 (]: Timing info for model.vendas_dw.vendas (compile): 21:14:58.594890 => 21:14:58.600233
[0m21:14:58.600784 [debug] [Thread-1 (]: Began executing node model.vendas_dw.vendas
[0m21:14:58.625900 [debug] [Thread-1 (]: Writing runtime sql for node "model.vendas_dw.vendas"
[0m21:14:58.626594 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.vendas"
[0m21:14:58.626954 [debug] [Thread-1 (]: On model.vendas_dw.vendas: BEGIN
[0m21:14:58.627215 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:15:00.051833 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m21:15:00.052264 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.vendas"
[0m21:15:00.052545 [debug] [Thread-1 (]: On model.vendas_dw.vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.vendas"} */

  create view "general_rtxt"."bronze"."vendas__dbt_tmp"
    
    
  as (
    SELECT * FROM "general_rtxt"."bronze"."vendas"
  );
[0m21:15:00.257615 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:15:00.262352 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.vendas"
[0m21:15:00.262767 [debug] [Thread-1 (]: On model.vendas_dw.vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.vendas"} */
alter table "general_rtxt"."bronze"."vendas" rename to "vendas__dbt_backup"
[0m21:15:00.462991 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:15:00.465752 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.vendas"
[0m21:15:00.466104 [debug] [Thread-1 (]: On model.vendas_dw.vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.vendas"} */
alter table "general_rtxt"."bronze"."vendas__dbt_tmp" rename to "vendas"
[0m21:15:00.659439 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:15:00.672549 [debug] [Thread-1 (]: On model.vendas_dw.vendas: COMMIT
[0m21:15:00.672967 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.vendas"
[0m21:15:00.673228 [debug] [Thread-1 (]: On model.vendas_dw.vendas: COMMIT
[0m21:15:00.871895 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:15:00.878378 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.vendas"
[0m21:15:00.878795 [debug] [Thread-1 (]: On model.vendas_dw.vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.vendas"} */
drop table if exists "general_rtxt"."bronze"."vendas__dbt_backup" cascade
[0m21:15:01.530640 [debug] [Thread-1 (]: SQL status: DROP TABLE in 1.0 seconds
[0m21:15:01.532016 [debug] [Thread-1 (]: Timing info for model.vendas_dw.vendas (execute): 21:14:58.601058 => 21:15:01.531870
[0m21:15:01.532362 [debug] [Thread-1 (]: On model.vendas_dw.vendas: Close
[0m21:15:01.533067 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97b5ca3a-3847-4497-8210-998a6839bdf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e38069e90>]}
[0m21:15:01.533615 [info ] [Thread-1 (]: 1 of 3 OK created sql view model bronze.vendas ................................. [[32mCREATE VIEW[0m in 2.94s]
[0m21:15:01.534083 [debug] [Thread-1 (]: Finished running node model.vendas_dw.vendas
[0m21:15:01.535460 [debug] [Thread-3 (]: Began running node model.vendas_dw.fct_vendas
[0m21:15:01.536558 [info ] [Thread-3 (]: 2 of 3 START sql view model bronze.fct_vendas .................................. [RUN]
[0m21:15:01.537704 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.vendas_dw.fct_vendas'
[0m21:15:01.538038 [debug] [Thread-3 (]: Began compiling node model.vendas_dw.fct_vendas
[0m21:15:01.540301 [debug] [Thread-3 (]: Writing injected SQL for node "model.vendas_dw.fct_vendas"
[0m21:15:01.541115 [debug] [Thread-3 (]: Timing info for model.vendas_dw.fct_vendas (compile): 21:15:01.538244 => 21:15:01.540891
[0m21:15:01.541498 [debug] [Thread-3 (]: Began executing node model.vendas_dw.fct_vendas
[0m21:15:01.546337 [debug] [Thread-3 (]: Writing runtime sql for node "model.vendas_dw.fct_vendas"
[0m21:15:01.547151 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m21:15:01.547635 [debug] [Thread-3 (]: On model.vendas_dw.fct_vendas: BEGIN
[0m21:15:01.548160 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:15:03.154174 [debug] [Thread-3 (]: SQL status: BEGIN in 2.0 seconds
[0m21:15:03.154759 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m21:15:03.155059 [debug] [Thread-3 (]: On model.vendas_dw.fct_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_vendas"} */

  create view "general_rtxt"."bronze"."fct_vendas__dbt_tmp"
    
    
  as (
    WITH vendas_clean AS (
    SELECT
        id_venda,
        id_produto,
        preco,
        quantidade,
        data_venda::date AS data_venda,
        id_cliente,
        id_loja,
        id_vendedor,
        meio_pagamento,
        parcelamento
    FROM "general_rtxt"."bronze"."vendas"
)
SELECT * FROM vendas_clean
  );
[0m21:15:03.344143 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "bronze.vendas" does not exist
LINE 19:     FROM "general_rtxt"."bronze"."vendas"
                  ^

[0m21:15:03.344810 [debug] [Thread-3 (]: On model.vendas_dw.fct_vendas: ROLLBACK
[0m21:15:03.535067 [debug] [Thread-3 (]: Timing info for model.vendas_dw.fct_vendas (execute): 21:15:01.541716 => 21:15:03.534666
[0m21:15:03.535555 [debug] [Thread-3 (]: On model.vendas_dw.fct_vendas: Close
[0m21:15:03.538377 [debug] [Thread-3 (]: Database Error in model fct_vendas (models/vendas_dw/silver/fct_vendas.sql)
  relation "bronze.vendas" does not exist
  LINE 19:     FROM "general_rtxt"."bronze"."vendas"
                    ^
  compiled Code at target/run/vendas_dw/models/vendas_dw/silver/fct_vendas.sql
[0m21:15:03.538913 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97b5ca3a-3847-4497-8210-998a6839bdf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e383459d0>]}
[0m21:15:03.539421 [error] [Thread-3 (]: 2 of 3 ERROR creating sql view model bronze.fct_vendas ......................... [[31mERROR[0m in 2.00s]
[0m21:15:03.540007 [debug] [Thread-3 (]: Finished running node model.vendas_dw.fct_vendas
[0m21:15:03.542268 [debug] [Thread-2 (]: Began running node model.vendas_dw.indicadores_vendas
[0m21:15:03.542770 [info ] [Thread-2 (]: 3 of 3 SKIP relation bronze.indicadores_vendas ................................. [[33mSKIP[0m]
[0m21:15:03.543158 [debug] [Thread-2 (]: Finished running node model.vendas_dw.indicadores_vendas
[0m21:15:03.547303 [debug] [MainThread]: Using postgres connection "master"
[0m21:15:03.547753 [debug] [MainThread]: On master: BEGIN
[0m21:15:03.548111 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:15:04.943888 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m21:15:04.944605 [debug] [MainThread]: On master: COMMIT
[0m21:15:04.945174 [debug] [MainThread]: Using postgres connection "master"
[0m21:15:04.945698 [debug] [MainThread]: On master: COMMIT
[0m21:15:05.132722 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:15:05.133377 [debug] [MainThread]: On master: Close
[0m21:15:05.133990 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:15:05.134251 [debug] [MainThread]: Connection 'model.vendas_dw.vendas' was properly closed.
[0m21:15:05.134488 [debug] [MainThread]: Connection 'model.vendas_dw.fct_vendas' was properly closed.
[0m21:15:05.134781 [info ] [MainThread]: 
[0m21:15:05.135061 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 12.60 seconds (12.60s).
[0m21:15:05.135676 [debug] [MainThread]: Command end result
[0m21:15:05.141673 [info ] [MainThread]: 
[0m21:15:05.142172 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:15:05.142509 [info ] [MainThread]: 
[0m21:15:05.142820 [error] [MainThread]: [33mDatabase Error in model fct_vendas (models/vendas_dw/silver/fct_vendas.sql)[0m
[0m21:15:05.143087 [error] [MainThread]:   relation "bronze.vendas" does not exist
[0m21:15:05.143398 [error] [MainThread]:   LINE 19:     FROM "general_rtxt"."bronze"."vendas"
[0m21:15:05.143701 [error] [MainThread]:                     ^
[0m21:15:05.143965 [error] [MainThread]:   compiled Code at target/run/vendas_dw/models/vendas_dw/silver/fct_vendas.sql
[0m21:15:05.144256 [info ] [MainThread]: 
[0m21:15:05.144697 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
[0m21:15:05.145308 [debug] [MainThread]: Command `dbt run` failed at 21:15:05.145192 after 12.79 seconds
[0m21:15:05.145707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e39aed210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e3835bed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e39981a90>]}
[0m21:15:05.146052 [debug] [MainThread]: Flushing usage events
[0m21:16:18.774543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74ea4bca10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74ea420490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74eafa7950>]}


============================== 21:16:18.776862 | 800e2787-4480-4702-8c9a-850fe25caf2f ==============================
[0m21:16:18.776862 [info ] [MainThread]: Running with dbt=1.6.0
[0m21:16:18.777289 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'fail_fast': 'False', 'profiles_dir': '/home/walterg/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m21:16:18.837522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '800e2787-4480-4702-8c9a-850fe25caf2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74ebe4d310>]}
[0m21:16:18.848643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '800e2787-4480-4702-8c9a-850fe25caf2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74ea464ad0>]}
[0m21:16:18.849294 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m21:16:18.856724 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m21:16:18.876244 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:16:18.876886 [debug] [MainThread]: Partial parsing: updated file: vendas_dw://models/vendas_dw/bronze/vendas.sql
[0m21:16:18.908671 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vendas_dw.gold
- models.vendas_dw.bronze
- models.vendas_dw.silver
[0m21:16:18.912347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '800e2787-4480-4702-8c9a-850fe25caf2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e9fb40d0>]}
[0m21:16:18.920965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '800e2787-4480-4702-8c9a-850fe25caf2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e9f8a510>]}
[0m21:16:18.921441 [info ] [MainThread]: Found 3 models, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m21:16:18.921818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '800e2787-4480-4702-8c9a-850fe25caf2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e9f4e910>]}
[0m21:16:18.923246 [info ] [MainThread]: 
[0m21:16:18.923995 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:16:18.925742 [debug] [ThreadPool]: Acquiring new postgres connection 'list_general_rtxt'
[0m21:16:18.934131 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt"
[0m21:16:18.934530 [debug] [ThreadPool]: On list_general_rtxt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt"} */

    select distinct nspname from pg_namespace
  
[0m21:16:18.934785 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:16:20.357012 [debug] [ThreadPool]: SQL status: SELECT 9 in 1.0 seconds
[0m21:16:20.358620 [debug] [ThreadPool]: On list_general_rtxt: Close
[0m21:16:20.360655 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_general_rtxt, now list_general_rtxt_bronze)
[0m21:16:20.365214 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze"
[0m21:16:20.365605 [debug] [ThreadPool]: On list_general_rtxt_bronze: BEGIN
[0m21:16:20.365860 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:16:22.032253 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m21:16:22.032765 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze"
[0m21:16:22.033014 [debug] [ThreadPool]: On list_general_rtxt_bronze: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt_bronze"} */
select
      'general_rtxt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze'
    union all
    select
      'general_rtxt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze'
    union all
    select
      'general_rtxt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze'
  
[0m21:16:22.223722 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m21:16:22.225601 [debug] [ThreadPool]: On list_general_rtxt_bronze: ROLLBACK
[0m21:16:22.428550 [debug] [ThreadPool]: On list_general_rtxt_bronze: Close
[0m21:16:22.433853 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:22.434235 [debug] [MainThread]: On master: BEGIN
[0m21:16:22.434489 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:16:23.817891 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m21:16:23.818604 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:23.819331 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:16:24.017133 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m21:16:24.018535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '800e2787-4480-4702-8c9a-850fe25caf2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74ea135a50>]}
[0m21:16:24.018931 [debug] [MainThread]: On master: ROLLBACK
[0m21:16:24.205136 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:24.205882 [debug] [MainThread]: On master: BEGIN
[0m21:16:24.597577 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:16:24.598431 [debug] [MainThread]: On master: COMMIT
[0m21:16:24.598954 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:24.599269 [debug] [MainThread]: On master: COMMIT
[0m21:16:24.788123 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:16:24.788968 [debug] [MainThread]: On master: Close
[0m21:16:24.789841 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:16:24.790153 [info ] [MainThread]: 
[0m21:16:24.793543 [debug] [Thread-1 (]: Began running node model.vendas_dw.vendas
[0m21:16:24.794658 [info ] [Thread-1 (]: 1 of 3 START sql table model bronze.vendas ..................................... [RUN]
[0m21:16:24.795216 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_general_rtxt_bronze, now model.vendas_dw.vendas)
[0m21:16:24.795614 [debug] [Thread-1 (]: Began compiling node model.vendas_dw.vendas
[0m21:16:24.801184 [debug] [Thread-1 (]: Writing injected SQL for node "model.vendas_dw.vendas"
[0m21:16:24.802101 [debug] [Thread-1 (]: Timing info for model.vendas_dw.vendas (compile): 21:16:24.795845 => 21:16:24.801839
[0m21:16:24.802527 [debug] [Thread-1 (]: Began executing node model.vendas_dw.vendas
[0m21:16:24.877525 [debug] [Thread-1 (]: Writing runtime sql for node "model.vendas_dw.vendas"
[0m21:16:24.878155 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.vendas"
[0m21:16:24.878464 [debug] [Thread-1 (]: On model.vendas_dw.vendas: BEGIN
[0m21:16:24.878754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:26.264380 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m21:16:26.265364 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.vendas"
[0m21:16:26.265692 [debug] [Thread-1 (]: On model.vendas_dw.vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.vendas"} */

  
    

  create  table "general_rtxt"."bronze"."vendas__dbt_tmp"
  
  
    as
  
  (
    
SELECT * FROM "general_rtxt"."bronze"."vendas"
  );
  
[0m21:16:26.452022 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "bronze.vendas" does not exist
LINE 13: SELECT * FROM "general_rtxt"."bronze"."vendas"
                       ^

[0m21:16:26.452822 [debug] [Thread-1 (]: On model.vendas_dw.vendas: ROLLBACK
[0m21:16:26.639452 [debug] [Thread-1 (]: Timing info for model.vendas_dw.vendas (execute): 21:16:24.802754 => 21:16:26.639067
[0m21:16:26.639898 [debug] [Thread-1 (]: On model.vendas_dw.vendas: Close
[0m21:16:26.642580 [debug] [Thread-1 (]: Database Error in model vendas (models/vendas_dw/bronze/vendas.sql)
  relation "bronze.vendas" does not exist
  LINE 13: SELECT * FROM "general_rtxt"."bronze"."vendas"
                         ^
  compiled Code at target/run/vendas_dw/models/vendas_dw/bronze/vendas.sql
[0m21:16:26.643088 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '800e2787-4480-4702-8c9a-850fe25caf2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e9ff8290>]}
[0m21:16:26.643603 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model bronze.vendas ............................ [[31mERROR[0m in 1.85s]
[0m21:16:26.644099 [debug] [Thread-1 (]: Finished running node model.vendas_dw.vendas
[0m21:16:26.646810 [debug] [Thread-3 (]: Began running node model.vendas_dw.fct_vendas
[0m21:16:26.647326 [info ] [Thread-3 (]: 2 of 3 SKIP relation bronze.fct_vendas ......................................... [[33mSKIP[0m]
[0m21:16:26.647681 [debug] [Thread-3 (]: Finished running node model.vendas_dw.fct_vendas
[0m21:16:26.650825 [debug] [Thread-2 (]: Began running node model.vendas_dw.indicadores_vendas
[0m21:16:26.651432 [info ] [Thread-2 (]: 3 of 3 SKIP relation bronze.indicadores_vendas ................................. [[33mSKIP[0m]
[0m21:16:26.651920 [debug] [Thread-2 (]: Finished running node model.vendas_dw.indicadores_vendas
[0m21:16:26.654558 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:26.655137 [debug] [MainThread]: On master: BEGIN
[0m21:16:26.655390 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:16:28.026576 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m21:16:28.027263 [debug] [MainThread]: On master: COMMIT
[0m21:16:28.027734 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:28.027969 [debug] [MainThread]: On master: COMMIT
[0m21:16:28.213682 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:16:28.214355 [debug] [MainThread]: On master: Close
[0m21:16:28.214972 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:16:28.215233 [debug] [MainThread]: Connection 'model.vendas_dw.vendas' was properly closed.
[0m21:16:28.215546 [info ] [MainThread]: 
[0m21:16:28.215861 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 9.29 seconds (9.29s).
[0m21:16:28.216422 [debug] [MainThread]: Command end result
[0m21:16:28.222432 [info ] [MainThread]: 
[0m21:16:28.222895 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:16:28.223181 [info ] [MainThread]: 
[0m21:16:28.223451 [error] [MainThread]: [33mDatabase Error in model vendas (models/vendas_dw/bronze/vendas.sql)[0m
[0m21:16:28.223727 [error] [MainThread]:   relation "bronze.vendas" does not exist
[0m21:16:28.223980 [error] [MainThread]:   LINE 13: SELECT * FROM "general_rtxt"."bronze"."vendas"
[0m21:16:28.224233 [error] [MainThread]:                          ^
[0m21:16:28.224503 [error] [MainThread]:   compiled Code at target/run/vendas_dw/models/vendas_dw/bronze/vendas.sql
[0m21:16:28.224791 [info ] [MainThread]: 
[0m21:16:28.225098 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m21:16:28.225643 [debug] [MainThread]: Command `dbt run` failed at 21:16:28.225557 after 9.46 seconds
[0m21:16:28.225971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74ef003050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74ef0c4a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74ea1ac790>]}
[0m21:16:28.226309 [debug] [MainThread]: Flushing usage events
[0m21:21:40.567612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ecf74e9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed02f3bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ecf4110d0>]}


============================== 21:21:40.569991 | 78431dcf-dc22-474b-a259-050de698e68a ==============================
[0m21:21:40.569991 [info ] [MainThread]: Running with dbt=1.6.0
[0m21:21:40.570425 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/walterg/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:21:40.598686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78431dcf-dc22-474b-a259-050de698e68a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ecf1215d0>]}
[0m21:21:40.601811 [debug] [MainThread]: Command `dbt clean` succeeded at 21:21:40.601721 after 0.04 seconds
[0m21:21:40.602128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ecf312990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ecf10fe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ecf73d810>]}
[0m21:21:40.602422 [debug] [MainThread]: Flushing usage events
[0m21:21:43.084268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facc763a390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facc796b450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facc9f9abd0>]}


============================== 21:21:43.086739 | 6982d7ff-6801-4d4c-b047-3ffc73dd620f ==============================
[0m21:21:43.086739 [info ] [MainThread]: Running with dbt=1.6.0
[0m21:21:43.087161 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'version_check': 'True', 'profiles_dir': '/home/walterg/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt parse', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:21:43.146270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6982d7ff-6801-4d4c-b047-3ffc73dd620f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facc763ab50>]}
[0m21:21:43.157396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6982d7ff-6801-4d4c-b047-3ffc73dd620f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facc84be410>]}
[0m21:21:43.158035 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m21:21:43.164731 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m21:21:43.165261 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:21:43.165583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6982d7ff-6801-4d4c-b047-3ffc73dd620f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facc73c9b10>]}
[0m21:21:43.671125 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vendas_dw.silver
- models.vendas_dw.gold
- models.vendas_dw.bronze
[0m21:21:43.674789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6982d7ff-6801-4d4c-b047-3ffc73dd620f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facc723ea50>]}
[0m21:21:43.675454 [info ] [MainThread]: Performance info: /home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/target/perf_info.json
[0m21:21:43.683047 [debug] [MainThread]: Command `dbt parse` succeeded at 21:21:43.682889 after 0.61 seconds
[0m21:21:43.683422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facc7955210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facc731d5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faccc37ec90>]}
[0m21:21:43.683795 [debug] [MainThread]: Flushing usage events
[0m21:21:46.238688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbc076aad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbbcdc5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbbc6991d0>]}


============================== 21:21:46.241890 | cc3d67ee-c8d2-4ae0-93a6-f5a5c15fe2cf ==============================
[0m21:21:46.241890 [info ] [MainThread]: Running with dbt=1.6.0
[0m21:21:46.242389 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/walterg/.dbt', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:21:46.299567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc3d67ee-c8d2-4ae0-93a6-f5a5c15fe2cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbbc583b90>]}
[0m21:21:46.312996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc3d67ee-c8d2-4ae0-93a6-f5a5c15fe2cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbbc234f10>]}
[0m21:21:46.313688 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m21:21:46.320311 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m21:21:46.335741 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:21:46.336099 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:21:46.336594 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vendas_dw.bronze
- models.vendas_dw.silver
- models.vendas_dw.gold
[0m21:21:46.340349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc3d67ee-c8d2-4ae0-93a6-f5a5c15fe2cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbbc2f9b50>]}
[0m21:21:46.349229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc3d67ee-c8d2-4ae0-93a6-f5a5c15fe2cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbbbda3110>]}
[0m21:21:46.349738 [info ] [MainThread]: Found 2 models, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m21:21:46.350034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc3d67ee-c8d2-4ae0-93a6-f5a5c15fe2cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbbc728e50>]}
[0m21:21:46.351341 [info ] [MainThread]: 
[0m21:21:46.352008 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:21:46.353182 [debug] [ThreadPool]: Acquiring new postgres connection 'list_general_rtxt'
[0m21:21:46.363138 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt"
[0m21:21:46.363586 [debug] [ThreadPool]: On list_general_rtxt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt"} */

    select distinct nspname from pg_namespace
  
[0m21:21:46.363835 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:21:48.257169 [debug] [ThreadPool]: SQL status: SELECT 9 in 2.0 seconds
[0m21:21:48.258356 [debug] [ThreadPool]: On list_general_rtxt: Close
[0m21:21:48.259940 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_general_rtxt, now list_general_rtxt_bronze)
[0m21:21:48.264588 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze"
[0m21:21:48.264973 [debug] [ThreadPool]: On list_general_rtxt_bronze: BEGIN
[0m21:21:48.265212 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:21:49.684267 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m21:21:49.685262 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze"
[0m21:21:49.685573 [debug] [ThreadPool]: On list_general_rtxt_bronze: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt_bronze"} */
select
      'general_rtxt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze'
    union all
    select
      'general_rtxt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze'
    union all
    select
      'general_rtxt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze'
  
[0m21:21:49.875613 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m21:21:49.877284 [debug] [ThreadPool]: On list_general_rtxt_bronze: ROLLBACK
[0m21:21:50.064672 [debug] [ThreadPool]: On list_general_rtxt_bronze: Close
[0m21:21:50.069131 [debug] [MainThread]: Using postgres connection "master"
[0m21:21:50.069494 [debug] [MainThread]: On master: BEGIN
[0m21:21:50.069747 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:21:51.489069 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m21:21:51.489737 [debug] [MainThread]: Using postgres connection "master"
[0m21:21:51.490037 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:21:51.686998 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m21:21:51.688505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc3d67ee-c8d2-4ae0-93a6-f5a5c15fe2cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbbc566090>]}
[0m21:21:51.688993 [debug] [MainThread]: On master: ROLLBACK
[0m21:21:51.874428 [debug] [MainThread]: Using postgres connection "master"
[0m21:21:51.875159 [debug] [MainThread]: On master: BEGIN
[0m21:21:52.248279 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:21:52.248998 [debug] [MainThread]: On master: COMMIT
[0m21:21:52.249249 [debug] [MainThread]: Using postgres connection "master"
[0m21:21:52.249489 [debug] [MainThread]: On master: COMMIT
[0m21:21:52.436729 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:21:52.437576 [debug] [MainThread]: On master: Close
[0m21:21:52.438184 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:21:52.438543 [info ] [MainThread]: 
[0m21:21:52.441405 [debug] [Thread-1 (]: Began running node model.vendas_dw.fct_vendas
[0m21:21:52.442309 [info ] [Thread-1 (]: 1 of 2 START sql view model bronze.fct_vendas .................................. [RUN]
[0m21:21:52.443590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_general_rtxt_bronze, now model.vendas_dw.fct_vendas)
[0m21:21:52.443888 [debug] [Thread-1 (]: Began compiling node model.vendas_dw.fct_vendas
[0m21:21:52.449266 [debug] [Thread-1 (]: Writing injected SQL for node "model.vendas_dw.fct_vendas"
[0m21:21:52.450167 [debug] [Thread-1 (]: Timing info for model.vendas_dw.fct_vendas (compile): 21:21:52.444091 => 21:21:52.449947
[0m21:21:52.450529 [debug] [Thread-1 (]: Began executing node model.vendas_dw.fct_vendas
[0m21:21:52.475135 [debug] [Thread-1 (]: Writing runtime sql for node "model.vendas_dw.fct_vendas"
[0m21:21:52.475928 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m21:21:52.476279 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: BEGIN
[0m21:21:52.476585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:21:53.923584 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m21:21:53.924278 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m21:21:53.924580 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_vendas"} */

  create view "general_rtxt"."bronze"."fct_vendas__dbt_tmp"
    
    
  as (
    SELECT
    id_venda,
    id_produto,
    preco,
    quantidade,
    CAST(data_venda AS date) AS data_venda,
    id_cliente,
    id_loja,
    id_vendedor,
    meio_pagamento,
    parcelamento
FROM "general_rtxt"."bronze"."vendas"
  );
[0m21:21:54.116657 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "bronze.vendas" does not exist
LINE 18: FROM "general_rtxt"."bronze"."vendas"
              ^

[0m21:21:54.117099 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: ROLLBACK
[0m21:21:54.306625 [debug] [Thread-1 (]: Timing info for model.vendas_dw.fct_vendas (execute): 21:21:52.450741 => 21:21:54.306189
[0m21:21:54.307410 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: Close
[0m21:21:54.310444 [debug] [Thread-1 (]: Database Error in model fct_vendas (models/vendas_dw/silver/fct_vendas.sql)
  relation "bronze.vendas" does not exist
  LINE 18: FROM "general_rtxt"."bronze"."vendas"
                ^
  compiled Code at target/run/vendas_dw/models/vendas_dw/silver/fct_vendas.sql
[0m21:21:54.311004 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc3d67ee-c8d2-4ae0-93a6-f5a5c15fe2cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbbb984090>]}
[0m21:21:54.311532 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model bronze.fct_vendas ......................... [[31mERROR[0m in 1.87s]
[0m21:21:54.312096 [debug] [Thread-1 (]: Finished running node model.vendas_dw.fct_vendas
[0m21:21:54.313812 [debug] [Thread-3 (]: Began running node model.vendas_dw.indicadores_vendas
[0m21:21:54.314260 [info ] [Thread-3 (]: 2 of 2 SKIP relation bronze.indicadores_vendas ................................. [[33mSKIP[0m]
[0m21:21:54.314669 [debug] [Thread-3 (]: Finished running node model.vendas_dw.indicadores_vendas
[0m21:21:54.317762 [debug] [MainThread]: Using postgres connection "master"
[0m21:21:54.318729 [debug] [MainThread]: On master: BEGIN
[0m21:21:54.319740 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:21:55.870840 [debug] [MainThread]: SQL status: BEGIN in 2.0 seconds
[0m21:21:55.871791 [debug] [MainThread]: On master: COMMIT
[0m21:21:55.872568 [debug] [MainThread]: Using postgres connection "master"
[0m21:21:55.873176 [debug] [MainThread]: On master: COMMIT
[0m21:21:56.061418 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:21:56.062379 [debug] [MainThread]: On master: Close
[0m21:21:56.062998 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:21:56.063272 [debug] [MainThread]: Connection 'model.vendas_dw.fct_vendas' was properly closed.
[0m21:21:56.063599 [info ] [MainThread]: 
[0m21:21:56.063889 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 9.71 seconds (9.71s).
[0m21:21:56.064409 [debug] [MainThread]: Command end result
[0m21:21:56.072887 [info ] [MainThread]: 
[0m21:21:56.073404 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:21:56.073728 [info ] [MainThread]: 
[0m21:21:56.074060 [error] [MainThread]: [33mDatabase Error in model fct_vendas (models/vendas_dw/silver/fct_vendas.sql)[0m
[0m21:21:56.074357 [error] [MainThread]:   relation "bronze.vendas" does not exist
[0m21:21:56.074686 [error] [MainThread]:   LINE 18: FROM "general_rtxt"."bronze"."vendas"
[0m21:21:56.074954 [error] [MainThread]:                 ^
[0m21:21:56.075227 [error] [MainThread]:   compiled Code at target/run/vendas_dw/models/vendas_dw/silver/fct_vendas.sql
[0m21:21:56.075617 [info ] [MainThread]: 
[0m21:21:56.076049 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m21:21:56.076684 [debug] [MainThread]: Command `dbt run` failed at 21:21:56.076591 after 9.84 seconds
[0m21:21:56.077067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbbc5f2c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbbbd754d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbbc7d2290>]}
[0m21:21:56.077468 [debug] [MainThread]: Flushing usage events
[0m21:22:15.154033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefb5d7db50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefb68ee5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefb5d678d0>]}


============================== 21:22:15.156453 | 120c6131-734c-4222-932f-015d5e9bcbe2 ==============================
[0m21:22:15.156453 [info ] [MainThread]: Running with dbt=1.6.0
[0m21:22:15.156998 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'profiles_dir': '/home/walterg/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:22:15.157396 [info ] [MainThread]: dbt version: 1.6.0
[0m21:22:15.157815 [info ] [MainThread]: python version: 3.11.2
[0m21:22:15.158338 [info ] [MainThread]: python path: /home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/.venv/bin/python3
[0m21:22:15.158760 [info ] [MainThread]: os info: Linux-6.10.7-policorp-amd64-x86_64-with-glibc2.36
[0m21:22:15.197602 [info ] [MainThread]: Using profiles dir at /home/walterg/.dbt
[0m21:22:15.198567 [info ] [MainThread]: Using profiles.yml file at /home/walterg/.dbt/profiles.yml
[0m21:22:15.199233 [info ] [MainThread]: Using dbt_project.yml file at /home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/dbt_project.yml
[0m21:22:15.200219 [info ] [MainThread]: adapter type: postgres
[0m21:22:15.201079 [info ] [MainThread]: adapter version: 1.6.0
[0m21:22:15.232152 [info ] [MainThread]: Configuration:
[0m21:22:15.233041 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:22:15.233776 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:22:15.234566 [info ] [MainThread]: Required dependencies:
[0m21:22:15.235240 [debug] [MainThread]: Executing "git --help"
[0m21:22:15.238354 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:22:15.239087 [debug] [MainThread]: STDERR: "b''"
[0m21:22:15.239671 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:22:15.240188 [info ] [MainThread]: Connection:
[0m21:22:15.240716 [info ] [MainThread]:   host: dpg-d0khna8gjchc73ae1r1g-a.oregon-postgres.render.com
[0m21:22:15.241249 [info ] [MainThread]:   port: 5432
[0m21:22:15.241802 [info ] [MainThread]:   user: postgresadmin
[0m21:22:15.242283 [info ] [MainThread]:   database: general_rtxt
[0m21:22:15.242907 [info ] [MainThread]:   schema: bronze
[0m21:22:15.243427 [info ] [MainThread]:   connect_timeout: 10
[0m21:22:15.243967 [info ] [MainThread]:   role: None
[0m21:22:15.244457 [info ] [MainThread]:   search_path: None
[0m21:22:15.245023 [info ] [MainThread]:   keepalives_idle: 0
[0m21:22:15.245735 [info ] [MainThread]:   sslmode: None
[0m21:22:15.246303 [info ] [MainThread]:   sslcert: None
[0m21:22:15.246872 [info ] [MainThread]:   sslkey: None
[0m21:22:15.247468 [info ] [MainThread]:   sslrootcert: None
[0m21:22:15.248051 [info ] [MainThread]:   application_name: dbt
[0m21:22:15.248707 [info ] [MainThread]:   retries: 1
[0m21:22:15.249543 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m21:22:15.250710 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:22:15.251315 [debug] [MainThread]: Using postgres connection "debug"
[0m21:22:15.251952 [debug] [MainThread]: On debug: select 1 as id
[0m21:22:15.252569 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:22:16.649152 [debug] [MainThread]: SQL status: SELECT 1 in 1.0 seconds
[0m21:22:16.650496 [debug] [MainThread]: On debug: Close
[0m21:22:16.650968 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:22:16.651265 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:22:16.651737 [debug] [MainThread]: Command `dbt debug` succeeded at 21:22:16.651654 after 1.50 seconds
[0m21:22:16.651993 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:22:16.652259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefb81c8d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefb5df3c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefb5afa110>]}
[0m21:22:16.652572 [debug] [MainThread]: Flushing usage events
[0m21:25:34.763875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97652f5750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9765742250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9764fb4f90>]}


============================== 21:25:34.766276 | 65e03dec-3f99-4af9-9d42-758267a6ba8f ==============================
[0m21:25:34.766276 [info ] [MainThread]: Running with dbt=1.6.0
[0m21:25:34.766704 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/walterg/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:25:34.808779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65e03dec-3f99-4af9-9d42-758267a6ba8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9764f452d0>]}
[0m21:25:34.814176 [debug] [MainThread]: Command `dbt clean` succeeded at 21:25:34.814015 after 0.06 seconds
[0m21:25:34.814811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9765614b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9769b65d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9769cbbc10>]}
[0m21:25:34.815434 [debug] [MainThread]: Flushing usage events
[0m21:25:37.320412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e55196910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e52a7d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e52a39a10>]}


============================== 21:25:37.322933 | de1b3318-fcd1-4d9d-b9a2-3facee6d354e ==============================
[0m21:25:37.322933 [info ] [MainThread]: Running with dbt=1.6.0
[0m21:25:37.323365 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/walterg/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt parse', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:25:37.386659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de1b3318-fcd1-4d9d-b9a2-3facee6d354e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e52f78310>]}
[0m21:25:37.397651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de1b3318-fcd1-4d9d-b9a2-3facee6d354e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e52435310>]}
[0m21:25:37.398309 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m21:25:37.405974 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m21:25:37.406515 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:25:37.406843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'de1b3318-fcd1-4d9d-b9a2-3facee6d354e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e5274fd50>]}
[0m21:25:37.906549 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vendas_dw.silver
- models.vendas_dw.gold
- models.vendas_dw.bronze
[0m21:25:37.910332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de1b3318-fcd1-4d9d-b9a2-3facee6d354e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e524a0510>]}
[0m21:25:37.911111 [info ] [MainThread]: Performance info: /home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/target/perf_info.json
[0m21:25:37.918989 [debug] [MainThread]: Command `dbt parse` succeeded at 21:25:37.918835 after 0.60 seconds
[0m21:25:37.919390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e52419590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e574c4c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e57402f50>]}
[0m21:25:37.919780 [debug] [MainThread]: Flushing usage events
[0m21:25:40.480754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8de505710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8e0f83ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8de721950>]}


============================== 21:25:40.483194 | 934264dd-4aa2-4442-9802-710bf2e36259 ==============================
[0m21:25:40.483194 [info ] [MainThread]: Running with dbt=1.6.0
[0m21:25:40.483654 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/walterg/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m21:25:40.542026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '934264dd-4aa2-4442-9802-710bf2e36259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8de558850>]}
[0m21:25:40.553082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '934264dd-4aa2-4442-9802-710bf2e36259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8de834f50>]}
[0m21:25:40.553743 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m21:25:40.560448 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m21:25:40.576210 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:25:40.576696 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:25:40.577270 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vendas_dw.gold
- models.vendas_dw.bronze
- models.vendas_dw.silver
[0m21:25:40.581648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '934264dd-4aa2-4442-9802-710bf2e36259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8dddc6e90>]}
[0m21:25:40.590335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '934264dd-4aa2-4442-9802-710bf2e36259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8ddd33410>]}
[0m21:25:40.590899 [info ] [MainThread]: Found 2 models, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m21:25:40.591442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '934264dd-4aa2-4442-9802-710bf2e36259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8de675dd0>]}
[0m21:25:40.593095 [info ] [MainThread]: 
[0m21:25:40.593963 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:25:40.595509 [debug] [ThreadPool]: Acquiring new postgres connection 'list_general_rtxt'
[0m21:25:40.603732 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt"
[0m21:25:40.604118 [debug] [ThreadPool]: On list_general_rtxt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt"} */

    select distinct nspname from pg_namespace
  
[0m21:25:40.604365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:25:42.010773 [debug] [ThreadPool]: SQL status: SELECT 9 in 1.0 seconds
[0m21:25:42.011922 [debug] [ThreadPool]: On list_general_rtxt: Close
[0m21:25:42.015007 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_general_rtxt, now list_general_rtxt_bronze)
[0m21:25:42.019741 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze"
[0m21:25:42.020119 [debug] [ThreadPool]: On list_general_rtxt_bronze: BEGIN
[0m21:25:42.020369 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:25:43.601845 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m21:25:43.602427 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze"
[0m21:25:43.602700 [debug] [ThreadPool]: On list_general_rtxt_bronze: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt_bronze"} */
select
      'general_rtxt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze'
    union all
    select
      'general_rtxt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze'
    union all
    select
      'general_rtxt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze'
  
[0m21:25:43.791657 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m21:25:43.793221 [debug] [ThreadPool]: On list_general_rtxt_bronze: ROLLBACK
[0m21:25:43.979923 [debug] [ThreadPool]: On list_general_rtxt_bronze: Close
[0m21:25:43.984196 [debug] [MainThread]: Using postgres connection "master"
[0m21:25:43.984574 [debug] [MainThread]: On master: BEGIN
[0m21:25:43.984802 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:25:45.348228 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m21:25:45.348945 [debug] [MainThread]: Using postgres connection "master"
[0m21:25:45.349620 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:25:45.541832 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m21:25:45.543251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '934264dd-4aa2-4442-9802-710bf2e36259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8de72c150>]}
[0m21:25:45.543627 [debug] [MainThread]: On master: ROLLBACK
[0m21:25:45.730568 [debug] [MainThread]: Using postgres connection "master"
[0m21:25:45.731306 [debug] [MainThread]: On master: BEGIN
[0m21:25:46.103154 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:25:46.103976 [debug] [MainThread]: On master: COMMIT
[0m21:25:46.104212 [debug] [MainThread]: Using postgres connection "master"
[0m21:25:46.104437 [debug] [MainThread]: On master: COMMIT
[0m21:25:46.290983 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:25:46.291539 [debug] [MainThread]: On master: Close
[0m21:25:46.292163 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:25:46.292462 [info ] [MainThread]: 
[0m21:25:46.295072 [debug] [Thread-1 (]: Began running node model.vendas_dw.fct_vendas
[0m21:25:46.295719 [info ] [Thread-1 (]: 1 of 2 START sql view model bronze.fct_vendas .................................. [RUN]
[0m21:25:46.296463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_general_rtxt_bronze, now model.vendas_dw.fct_vendas)
[0m21:25:46.297087 [debug] [Thread-1 (]: Began compiling node model.vendas_dw.fct_vendas
[0m21:25:46.302453 [debug] [Thread-1 (]: Writing injected SQL for node "model.vendas_dw.fct_vendas"
[0m21:25:46.303328 [debug] [Thread-1 (]: Timing info for model.vendas_dw.fct_vendas (compile): 21:25:46.297308 => 21:25:46.303133
[0m21:25:46.303759 [debug] [Thread-1 (]: Began executing node model.vendas_dw.fct_vendas
[0m21:25:46.329019 [debug] [Thread-1 (]: Writing runtime sql for node "model.vendas_dw.fct_vendas"
[0m21:25:46.329804 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m21:25:46.330114 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: BEGIN
[0m21:25:46.330384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:25:47.728768 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m21:25:47.729192 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m21:25:47.729469 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_vendas"} */

  create view "general_rtxt"."bronze"."fct_vendas__dbt_tmp"
    
    
  as (
    SELECT
    id_venda,
    id_produto,
    preco,
    quantidade,
    CAST(data_venda AS date) AS data_venda,
    id_cliente,
    id_loja,
    id_vendedor,
    meio_pagamento,
    parcelamento
FROM "general_rtxt"."bronze"."vendas"
  );
[0m21:25:47.913249 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "bronze.vendas" does not exist
LINE 18: FROM "general_rtxt"."bronze"."vendas"
              ^

[0m21:25:47.914032 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: ROLLBACK
[0m21:25:48.099951 [debug] [Thread-1 (]: Timing info for model.vendas_dw.fct_vendas (execute): 21:25:46.304045 => 21:25:48.099447
[0m21:25:48.100354 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: Close
[0m21:25:48.102983 [debug] [Thread-1 (]: Database Error in model fct_vendas (models/vendas_dw/silver/fct_vendas.sql)
  relation "bronze.vendas" does not exist
  LINE 18: FROM "general_rtxt"."bronze"."vendas"
                ^
  compiled Code at target/run/vendas_dw/models/vendas_dw/silver/fct_vendas.sql
[0m21:25:48.103447 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '934264dd-4aa2-4442-9802-710bf2e36259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8de53d190>]}
[0m21:25:48.103957 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model bronze.fct_vendas ......................... [[31mERROR[0m in 1.81s]
[0m21:25:48.104454 [debug] [Thread-1 (]: Finished running node model.vendas_dw.fct_vendas
[0m21:25:48.106742 [debug] [Thread-3 (]: Began running node model.vendas_dw.indicadores_vendas
[0m21:25:48.107529 [info ] [Thread-3 (]: 2 of 2 SKIP relation bronze.indicadores_vendas ................................. [[33mSKIP[0m]
[0m21:25:48.108449 [debug] [Thread-3 (]: Finished running node model.vendas_dw.indicadores_vendas
[0m21:25:48.110887 [debug] [MainThread]: Using postgres connection "master"
[0m21:25:48.111249 [debug] [MainThread]: On master: BEGIN
[0m21:25:48.111509 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:25:49.535670 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m21:25:49.536355 [debug] [MainThread]: On master: COMMIT
[0m21:25:49.536955 [debug] [MainThread]: Using postgres connection "master"
[0m21:25:49.537372 [debug] [MainThread]: On master: COMMIT
[0m21:25:49.751195 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:25:49.752092 [debug] [MainThread]: On master: Close
[0m21:25:49.752696 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:25:49.752940 [debug] [MainThread]: Connection 'model.vendas_dw.fct_vendas' was properly closed.
[0m21:25:49.753213 [info ] [MainThread]: 
[0m21:25:49.753517 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 9.16 seconds (9.16s).
[0m21:25:49.754056 [debug] [MainThread]: Command end result
[0m21:25:49.759774 [info ] [MainThread]: 
[0m21:25:49.760178 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:25:49.760456 [info ] [MainThread]: 
[0m21:25:49.760764 [error] [MainThread]: [33mDatabase Error in model fct_vendas (models/vendas_dw/silver/fct_vendas.sql)[0m
[0m21:25:49.761034 [error] [MainThread]:   relation "bronze.vendas" does not exist
[0m21:25:49.761352 [error] [MainThread]:   LINE 18: FROM "general_rtxt"."bronze"."vendas"
[0m21:25:49.761670 [error] [MainThread]:                 ^
[0m21:25:49.761929 [error] [MainThread]:   compiled Code at target/run/vendas_dw/models/vendas_dw/silver/fct_vendas.sql
[0m21:25:49.762191 [info ] [MainThread]: 
[0m21:25:49.762500 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m21:25:49.763061 [debug] [MainThread]: Command `dbt run` failed at 21:25:49.762967 after 9.29 seconds
[0m21:25:49.763376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8de52bd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8de529550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8e0c23e50>]}
[0m21:25:49.763694 [debug] [MainThread]: Flushing usage events
[0m21:48:00.801079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5512479a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5512506990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55127a3810>]}


============================== 21:48:00.803900 | 41c44081-739e-4e96-805c-1849bf68eb57 ==============================
[0m21:48:00.803900 [info ] [MainThread]: Running with dbt=1.6.0
[0m21:48:00.804376 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'partial_parse': 'True', 'profiles_dir': '/home/walterg/.dbt', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'quiet': 'False', 'target_path': 'None', 'log_format': 'default', 'debug': 'False', 'introspect': 'True', 'static_parser': 'True', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'write_json': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'warn_error': 'None', 'fail_fast': 'False'}
[0m21:48:00.863375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41c44081-739e-4e96-805c-1849bf68eb57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5513046ed0>]}
[0m21:48:00.875808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41c44081-739e-4e96-805c-1849bf68eb57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5513046ed0>]}
[0m21:48:00.876465 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m21:48:00.883318 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m21:48:00.889772 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:48:00.890270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '41c44081-739e-4e96-805c-1849bf68eb57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5511b33210>]}
[0m21:48:01.388489 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vendas_dw.silver
- models.vendas_dw.gold
- models.vendas_dw.bronze
[0m21:48:01.392147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41c44081-739e-4e96-805c-1849bf68eb57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5511fa4950>]}
[0m21:48:01.400769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41c44081-739e-4e96-805c-1849bf68eb57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5511bc1f50>]}
[0m21:48:01.401307 [info ] [MainThread]: Found 2 models, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m21:48:01.401627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41c44081-739e-4e96-805c-1849bf68eb57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5511bf5910>]}
[0m21:48:01.403603 [info ] [MainThread]: 
[0m21:48:01.404376 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:48:01.406098 [debug] [ThreadPool]: Acquiring new postgres connection 'list_general_rtxt'
[0m21:48:01.413991 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt"
[0m21:48:01.414406 [debug] [ThreadPool]: On list_general_rtxt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt"} */

    select distinct nspname from pg_namespace
  
[0m21:48:01.414707 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:48:02.826956 [debug] [ThreadPool]: SQL status: SELECT 9 in 1.0 seconds
[0m21:48:02.828449 [debug] [ThreadPool]: On list_general_rtxt: Close
[0m21:48:02.830827 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_general_rtxt, now list_general_rtxt_bronze)
[0m21:48:02.835087 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze"
[0m21:48:02.835446 [debug] [ThreadPool]: On list_general_rtxt_bronze: BEGIN
[0m21:48:02.835694 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:48:04.317789 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m21:48:04.318687 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze"
[0m21:48:04.318948 [debug] [ThreadPool]: On list_general_rtxt_bronze: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt_bronze"} */
select
      'general_rtxt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze'
    union all
    select
      'general_rtxt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze'
    union all
    select
      'general_rtxt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze'
  
[0m21:48:04.509441 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m21:48:04.510974 [debug] [ThreadPool]: On list_general_rtxt_bronze: ROLLBACK
[0m21:48:04.696956 [debug] [ThreadPool]: On list_general_rtxt_bronze: Close
[0m21:48:04.701970 [debug] [MainThread]: Using postgres connection "master"
[0m21:48:04.702344 [debug] [MainThread]: On master: BEGIN
[0m21:48:04.702608 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:48:06.175298 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m21:48:06.175697 [debug] [MainThread]: Using postgres connection "master"
[0m21:48:06.175998 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:48:06.368245 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m21:48:06.369683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41c44081-739e-4e96-805c-1849bf68eb57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f551267c890>]}
[0m21:48:06.370089 [debug] [MainThread]: On master: ROLLBACK
[0m21:48:06.553534 [debug] [MainThread]: Using postgres connection "master"
[0m21:48:06.554322 [debug] [MainThread]: On master: BEGIN
[0m21:48:06.929994 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:48:06.930616 [debug] [MainThread]: On master: COMMIT
[0m21:48:06.930878 [debug] [MainThread]: Using postgres connection "master"
[0m21:48:06.931117 [debug] [MainThread]: On master: COMMIT
[0m21:48:07.115035 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:48:07.115676 [debug] [MainThread]: On master: Close
[0m21:48:07.116448 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:48:07.116754 [info ] [MainThread]: 
[0m21:48:07.119732 [debug] [Thread-1 (]: Began running node model.vendas_dw.fct_vendas
[0m21:48:07.120612 [info ] [Thread-1 (]: 1 of 2 START sql view model bronze.fct_vendas .................................. [RUN]
[0m21:48:07.121379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_general_rtxt_bronze, now model.vendas_dw.fct_vendas)
[0m21:48:07.121693 [debug] [Thread-1 (]: Began compiling node model.vendas_dw.fct_vendas
[0m21:48:07.127126 [debug] [Thread-1 (]: Writing injected SQL for node "model.vendas_dw.fct_vendas"
[0m21:48:07.128075 [debug] [Thread-1 (]: Timing info for model.vendas_dw.fct_vendas (compile): 21:48:07.121895 => 21:48:07.127810
[0m21:48:07.128756 [debug] [Thread-1 (]: Began executing node model.vendas_dw.fct_vendas
[0m21:48:07.156060 [debug] [Thread-1 (]: Writing runtime sql for node "model.vendas_dw.fct_vendas"
[0m21:48:07.156729 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m21:48:07.157033 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: BEGIN
[0m21:48:07.157304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:48:08.552005 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m21:48:08.552462 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m21:48:08.552901 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_vendas"} */

  create view "general_rtxt"."bronze"."fct_vendas__dbt_tmp"
    
    
  as (
    SELECT
    id_venda,
    id_produto,
    preco,
    quantidade,
    CAST(data_venda AS date) AS data_venda,
    id_cliente,
    id_loja,
    id_vendedor,
    meio_pagamento,
    parcelamento
FROM "general_rtxt"."bronze"."vendas"
  );
[0m21:48:08.740303 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:48:08.745727 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m21:48:08.746138 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_vendas"} */
alter table "general_rtxt"."bronze"."fct_vendas__dbt_tmp" rename to "fct_vendas"
[0m21:48:08.932811 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:48:08.943493 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: COMMIT
[0m21:48:08.943902 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m21:48:08.944167 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: COMMIT
[0m21:48:09.131033 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:48:09.137242 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m21:48:09.137682 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_vendas"} */
drop view if exists "general_rtxt"."bronze"."fct_vendas__dbt_backup" cascade
[0m21:48:09.324236 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:48:09.325700 [debug] [Thread-1 (]: Timing info for model.vendas_dw.fct_vendas (execute): 21:48:07.129289 => 21:48:09.325556
[0m21:48:09.326056 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: Close
[0m21:48:09.326793 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41c44081-739e-4e96-805c-1849bf68eb57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5511f35cd0>]}
[0m21:48:09.327342 [info ] [Thread-1 (]: 1 of 2 OK created sql view model bronze.fct_vendas ............................. [[32mCREATE VIEW[0m in 2.21s]
[0m21:48:09.328002 [debug] [Thread-1 (]: Finished running node model.vendas_dw.fct_vendas
[0m21:48:09.329973 [debug] [Thread-3 (]: Began running node model.vendas_dw.indicadores_vendas
[0m21:48:09.330435 [info ] [Thread-3 (]: 2 of 2 START sql view model bronze.indicadores_vendas .......................... [RUN]
[0m21:48:09.331065 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.vendas_dw.indicadores_vendas'
[0m21:48:09.331352 [debug] [Thread-3 (]: Began compiling node model.vendas_dw.indicadores_vendas
[0m21:48:09.335068 [debug] [Thread-3 (]: Writing injected SQL for node "model.vendas_dw.indicadores_vendas"
[0m21:48:09.336073 [debug] [Thread-3 (]: Timing info for model.vendas_dw.indicadores_vendas (compile): 21:48:09.331569 => 21:48:09.335769
[0m21:48:09.336584 [debug] [Thread-3 (]: Began executing node model.vendas_dw.indicadores_vendas
[0m21:48:09.340590 [debug] [Thread-3 (]: Writing runtime sql for node "model.vendas_dw.indicadores_vendas"
[0m21:48:09.341297 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.indicadores_vendas"
[0m21:48:09.341593 [debug] [Thread-3 (]: On model.vendas_dw.indicadores_vendas: BEGIN
[0m21:48:09.341845 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:48:10.751081 [debug] [Thread-3 (]: SQL status: BEGIN in 1.0 seconds
[0m21:48:10.751713 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.indicadores_vendas"
[0m21:48:10.752136 [debug] [Thread-3 (]: On model.vendas_dw.indicadores_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.indicadores_vendas"} */

  create view "general_rtxt"."bronze"."indicadores_vendas__dbt_tmp"
    
    
  as (
    SELECT
    data_venda,
    id_loja,
    SUM(preco * quantidade) AS receita_total,
    COUNT(DISTINCT id_venda) AS qtd_vendas
FROM "general_rtxt"."bronze"."fct_vendas"
GROUP BY data_venda, id_loja
  );
[0m21:48:10.938936 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:48:10.941915 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.indicadores_vendas"
[0m21:48:10.942320 [debug] [Thread-3 (]: On model.vendas_dw.indicadores_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.indicadores_vendas"} */
alter table "general_rtxt"."bronze"."indicadores_vendas__dbt_tmp" rename to "indicadores_vendas"
[0m21:48:11.212855 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:48:11.214783 [debug] [Thread-3 (]: On model.vendas_dw.indicadores_vendas: COMMIT
[0m21:48:11.215146 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.indicadores_vendas"
[0m21:48:11.215445 [debug] [Thread-3 (]: On model.vendas_dw.indicadores_vendas: COMMIT
[0m21:48:11.401117 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m21:48:11.403491 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.indicadores_vendas"
[0m21:48:11.403915 [debug] [Thread-3 (]: On model.vendas_dw.indicadores_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.indicadores_vendas"} */
drop view if exists "general_rtxt"."bronze"."indicadores_vendas__dbt_backup" cascade
[0m21:48:11.594744 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:48:11.596079 [debug] [Thread-3 (]: Timing info for model.vendas_dw.indicadores_vendas (execute): 21:48:09.336850 => 21:48:11.595936
[0m21:48:11.596434 [debug] [Thread-3 (]: On model.vendas_dw.indicadores_vendas: Close
[0m21:48:11.597137 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41c44081-739e-4e96-805c-1849bf68eb57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5511f5b790>]}
[0m21:48:11.597663 [info ] [Thread-3 (]: 2 of 2 OK created sql view model bronze.indicadores_vendas ..................... [[32mCREATE VIEW[0m in 2.27s]
[0m21:48:11.598148 [debug] [Thread-3 (]: Finished running node model.vendas_dw.indicadores_vendas
[0m21:48:11.601583 [debug] [MainThread]: Using postgres connection "master"
[0m21:48:11.601918 [debug] [MainThread]: On master: BEGIN
[0m21:48:11.602156 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:48:12.979158 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m21:48:12.979884 [debug] [MainThread]: On master: COMMIT
[0m21:48:12.980296 [debug] [MainThread]: Using postgres connection "master"
[0m21:48:12.980540 [debug] [MainThread]: On master: COMMIT
[0m21:48:13.167615 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:48:13.168562 [debug] [MainThread]: On master: Close
[0m21:48:13.169196 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:48:13.169462 [debug] [MainThread]: Connection 'model.vendas_dw.fct_vendas' was properly closed.
[0m21:48:13.169702 [debug] [MainThread]: Connection 'model.vendas_dw.indicadores_vendas' was properly closed.
[0m21:48:13.169978 [info ] [MainThread]: 
[0m21:48:13.170261 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 11.77 seconds (11.77s).
[0m21:48:13.170909 [debug] [MainThread]: Command end result
[0m21:48:13.176612 [info ] [MainThread]: 
[0m21:48:13.177027 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:48:13.177318 [info ] [MainThread]: 
[0m21:48:13.177642 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:48:13.178092 [debug] [MainThread]: Command `dbt run` succeeded at 21:48:13.177991 after 12.38 seconds
[0m21:48:13.178415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55127d69d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55127d65d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5516e77450>]}
[0m21:48:13.178749 [debug] [MainThread]: Flushing usage events
[0m21:55:53.839012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cdcb01710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cdf332810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cdca38b10>]}


============================== 21:55:53.841748 | 6b98b1aa-ccc6-4f72-a051-5aa4e1ce7422 ==============================
[0m21:55:53.841748 [info ] [MainThread]: Running with dbt=1.6.0
[0m21:55:53.842214 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'partial_parse': 'True', 'fail_fast': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'use_experimental_parser': 'False', 'warn_error': 'None', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run', 'quiet': 'False', 'version_check': 'True', 'log_format': 'default', 'target_path': 'None', 'debug': 'False', 'profiles_dir': '/home/walterg/.dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m21:55:53.906227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b98b1aa-ccc6-4f72-a051-5aa4e1ce7422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cdc7d3190>]}
[0m21:55:53.918621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b98b1aa-ccc6-4f72-a051-5aa4e1ce7422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cdce1e5d0>]}
[0m21:55:53.919291 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m21:55:53.926276 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m21:55:53.943944 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:55:53.944491 [debug] [MainThread]: Partial parsing: updated file: vendas_dw://models/vendas_dw/gold/indicadores_vendas.sql
[0m21:55:53.978591 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vendas_dw.bronze
- models.vendas_dw.silver
- models.vendas_dw.gold
[0m21:55:53.982256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b98b1aa-ccc6-4f72-a051-5aa4e1ce7422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cdc315990>]}
[0m21:55:53.991640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b98b1aa-ccc6-4f72-a051-5aa4e1ce7422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cdc34cf10>]}
[0m21:55:53.992171 [info ] [MainThread]: Found 2 models, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m21:55:53.992506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b98b1aa-ccc6-4f72-a051-5aa4e1ce7422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cdc29a310>]}
[0m21:55:53.993920 [info ] [MainThread]: 
[0m21:55:53.994613 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:55:53.995743 [debug] [ThreadPool]: Acquiring new postgres connection 'list_general_rtxt'
[0m21:55:54.005076 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt"
[0m21:55:54.005511 [debug] [ThreadPool]: On list_general_rtxt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt"} */

    select distinct nspname from pg_namespace
  
[0m21:55:54.005758 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:55:55.461466 [debug] [ThreadPool]: SQL status: SELECT 9 in 1.0 seconds
[0m21:55:55.462835 [debug] [ThreadPool]: On list_general_rtxt: Close
[0m21:55:55.464583 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_general_rtxt, now list_general_rtxt_bronze)
[0m21:55:55.468887 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze"
[0m21:55:55.469254 [debug] [ThreadPool]: On list_general_rtxt_bronze: BEGIN
[0m21:55:55.469496 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:55:56.909567 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m21:55:56.910256 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze"
[0m21:55:56.910799 [debug] [ThreadPool]: On list_general_rtxt_bronze: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt_bronze"} */
select
      'general_rtxt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze'
    union all
    select
      'general_rtxt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze'
    union all
    select
      'general_rtxt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze'
  
[0m21:55:57.098059 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m21:55:57.099786 [debug] [ThreadPool]: On list_general_rtxt_bronze: ROLLBACK
[0m21:55:57.286162 [debug] [ThreadPool]: On list_general_rtxt_bronze: Close
[0m21:55:57.291072 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:57.291432 [debug] [MainThread]: On master: BEGIN
[0m21:55:57.291684 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:55:58.665182 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m21:55:58.665611 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:58.665930 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:55:58.894823 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m21:55:58.896369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b98b1aa-ccc6-4f72-a051-5aa4e1ce7422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cdda4fa90>]}
[0m21:55:58.896790 [debug] [MainThread]: On master: ROLLBACK
[0m21:55:59.082749 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:59.083419 [debug] [MainThread]: On master: BEGIN
[0m21:55:59.453395 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:55:59.454665 [debug] [MainThread]: On master: COMMIT
[0m21:55:59.455034 [debug] [MainThread]: Using postgres connection "master"
[0m21:55:59.455267 [debug] [MainThread]: On master: COMMIT
[0m21:55:59.643283 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:55:59.644160 [debug] [MainThread]: On master: Close
[0m21:55:59.645101 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:55:59.645432 [info ] [MainThread]: 
[0m21:55:59.648967 [debug] [Thread-1 (]: Began running node model.vendas_dw.fct_vendas
[0m21:55:59.650220 [info ] [Thread-1 (]: 1 of 2 START sql view model bronze.fct_vendas .................................. [RUN]
[0m21:55:59.650937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_general_rtxt_bronze, now model.vendas_dw.fct_vendas)
[0m21:55:59.651410 [debug] [Thread-1 (]: Began compiling node model.vendas_dw.fct_vendas
[0m21:55:59.656914 [debug] [Thread-1 (]: Writing injected SQL for node "model.vendas_dw.fct_vendas"
[0m21:55:59.657647 [debug] [Thread-1 (]: Timing info for model.vendas_dw.fct_vendas (compile): 21:55:59.651753 => 21:55:59.657437
[0m21:55:59.657981 [debug] [Thread-1 (]: Began executing node model.vendas_dw.fct_vendas
[0m21:55:59.683398 [debug] [Thread-1 (]: Writing runtime sql for node "model.vendas_dw.fct_vendas"
[0m21:55:59.684114 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m21:55:59.684491 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: BEGIN
[0m21:55:59.684775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:56:01.117353 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m21:56:01.118186 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m21:56:01.118825 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_vendas"} */

  create view "general_rtxt"."bronze"."fct_vendas__dbt_tmp"
    
    
  as (
    SELECT
    id_venda,
    id_produto,
    preco,
    quantidade,
    CAST(data_venda AS date) AS data_venda,
    id_cliente,
    id_loja,
    id_vendedor,
    meio_pagamento,
    parcelamento
FROM "general_rtxt"."bronze"."vendas"
  );
[0m21:56:01.327045 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:56:01.332029 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m21:56:01.332433 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_vendas"} */
alter table "general_rtxt"."bronze"."fct_vendas" rename to "fct_vendas__dbt_backup"
[0m21:56:01.521637 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:56:01.524665 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m21:56:01.525032 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_vendas"} */
alter table "general_rtxt"."bronze"."fct_vendas__dbt_tmp" rename to "fct_vendas"
[0m21:56:01.713588 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:56:01.726190 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: COMMIT
[0m21:56:01.726634 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m21:56:01.726927 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: COMMIT
[0m21:56:01.915015 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:56:01.921846 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m21:56:01.922258 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_vendas"} */
drop view if exists "general_rtxt"."bronze"."fct_vendas__dbt_backup" cascade
[0m21:56:02.113439 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:56:02.115276 [debug] [Thread-1 (]: Timing info for model.vendas_dw.fct_vendas (execute): 21:55:59.658185 => 21:56:02.115125
[0m21:56:02.115652 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: Close
[0m21:56:02.116380 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b98b1aa-ccc6-4f72-a051-5aa4e1ce7422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cdc827950>]}
[0m21:56:02.116923 [info ] [Thread-1 (]: 1 of 2 OK created sql view model bronze.fct_vendas ............................. [[32mCREATE VIEW[0m in 2.47s]
[0m21:56:02.117434 [debug] [Thread-1 (]: Finished running node model.vendas_dw.fct_vendas
[0m21:56:02.119710 [debug] [Thread-3 (]: Began running node model.vendas_dw.indicadores_vendas
[0m21:56:02.120608 [info ] [Thread-3 (]: 2 of 2 START sql view model bronze.indicadores_vendas .......................... [RUN]
[0m21:56:02.121253 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.vendas_dw.indicadores_vendas'
[0m21:56:02.121552 [debug] [Thread-3 (]: Began compiling node model.vendas_dw.indicadores_vendas
[0m21:56:02.125313 [debug] [Thread-3 (]: Writing injected SQL for node "model.vendas_dw.indicadores_vendas"
[0m21:56:02.126164 [debug] [Thread-3 (]: Timing info for model.vendas_dw.indicadores_vendas (compile): 21:56:02.121756 => 21:56:02.125932
[0m21:56:02.126561 [debug] [Thread-3 (]: Began executing node model.vendas_dw.indicadores_vendas
[0m21:56:02.130681 [debug] [Thread-3 (]: Writing runtime sql for node "model.vendas_dw.indicadores_vendas"
[0m21:56:02.131324 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.indicadores_vendas"
[0m21:56:02.131635 [debug] [Thread-3 (]: On model.vendas_dw.indicadores_vendas: BEGIN
[0m21:56:02.131915 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:56:03.533440 [debug] [Thread-3 (]: SQL status: BEGIN in 1.0 seconds
[0m21:56:03.534150 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.indicadores_vendas"
[0m21:56:03.534456 [debug] [Thread-3 (]: On model.vendas_dw.indicadores_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.indicadores_vendas"} */

  create view "general_rtxt"."bronze"."indicadores_vendas__dbt_tmp"
    
    
  as (
    WITH base AS (
    SELECT
        data_venda,
        id_loja,
        preco,
        quantidade,
        id_venda
    FROM "general_rtxt"."bronze"."fct_vendas"
)
SELECT
    data_venda,
    id_loja,
    SUM(preco * quantidade) AS receita_total,
    COUNT(DISTINCT id_venda) AS qtd_vendas
FROM base
GROUP BY data_venda, id_loja
  );
[0m21:56:03.730348 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:56:03.732962 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.indicadores_vendas"
[0m21:56:03.733341 [debug] [Thread-3 (]: On model.vendas_dw.indicadores_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.indicadores_vendas"} */
alter table "general_rtxt"."bronze"."indicadores_vendas__dbt_tmp" rename to "indicadores_vendas"
[0m21:56:03.918054 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:56:03.920082 [debug] [Thread-3 (]: On model.vendas_dw.indicadores_vendas: COMMIT
[0m21:56:03.920457 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.indicadores_vendas"
[0m21:56:03.920758 [debug] [Thread-3 (]: On model.vendas_dw.indicadores_vendas: COMMIT
[0m21:56:04.116103 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m21:56:04.119685 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.indicadores_vendas"
[0m21:56:04.120306 [debug] [Thread-3 (]: On model.vendas_dw.indicadores_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.indicadores_vendas"} */
drop view if exists "general_rtxt"."bronze"."indicadores_vendas__dbt_backup" cascade
[0m21:56:04.308742 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:56:04.310414 [debug] [Thread-3 (]: Timing info for model.vendas_dw.indicadores_vendas (execute): 21:56:02.126802 => 21:56:04.310264
[0m21:56:04.310771 [debug] [Thread-3 (]: On model.vendas_dw.indicadores_vendas: Close
[0m21:56:04.311529 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b98b1aa-ccc6-4f72-a051-5aa4e1ce7422', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cdc272550>]}
[0m21:56:04.312035 [info ] [Thread-3 (]: 2 of 2 OK created sql view model bronze.indicadores_vendas ..................... [[32mCREATE VIEW[0m in 2.19s]
[0m21:56:04.312524 [debug] [Thread-3 (]: Finished running node model.vendas_dw.indicadores_vendas
[0m21:56:04.315591 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:04.315939 [debug] [MainThread]: On master: BEGIN
[0m21:56:04.316217 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:56:05.880405 [debug] [MainThread]: SQL status: BEGIN in 2.0 seconds
[0m21:56:05.881125 [debug] [MainThread]: On master: COMMIT
[0m21:56:05.881671 [debug] [MainThread]: Using postgres connection "master"
[0m21:56:05.881911 [debug] [MainThread]: On master: COMMIT
[0m21:56:06.068716 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:56:06.069354 [debug] [MainThread]: On master: Close
[0m21:56:06.070495 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:56:06.070788 [debug] [MainThread]: Connection 'model.vendas_dw.fct_vendas' was properly closed.
[0m21:56:06.071006 [debug] [MainThread]: Connection 'model.vendas_dw.indicadores_vendas' was properly closed.
[0m21:56:06.071290 [info ] [MainThread]: 
[0m21:56:06.071581 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 12.08 seconds (12.08s).
[0m21:56:06.072186 [debug] [MainThread]: Command end result
[0m21:56:06.077919 [info ] [MainThread]: 
[0m21:56:06.078327 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:56:06.078699 [info ] [MainThread]: 
[0m21:56:06.079077 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:56:06.079538 [debug] [MainThread]: Command `dbt run` succeeded at 21:56:06.079427 after 12.25 seconds
[0m21:56:06.079860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cdcd30c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ce14b6650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ce14b7690>]}
[0m21:56:06.080156 [debug] [MainThread]: Flushing usage events
[0m21:58:09.286781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa96ff05750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa96fe95d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa96fe86290>]}


============================== 21:58:09.290392 | b87dde5b-6fb5-4e7e-8cca-b90a573a4a3b ==============================
[0m21:58:09.290392 [info ] [MainThread]: Running with dbt=1.6.0
[0m21:58:09.290836 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'partial_parse': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/home/walterg/.dbt', 'debug': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'static_parser': 'True', 'introspect': 'True', 'write_json': 'True', 'use_colors': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'version_check': 'True', 'invocation_command': 'dbt clean', 'quiet': 'False', 'printer_width': '80', 'target_path': 'None', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs'}
[0m21:58:09.319170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b87dde5b-6fb5-4e7e-8cca-b90a573a4a3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa96fe74290>]}
[0m21:58:09.322233 [debug] [MainThread]: Command `dbt clean` succeeded at 21:58:09.322159 after 0.04 seconds
[0m21:58:09.322572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97004a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa97163c110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9702da110>]}
[0m21:58:09.322874 [debug] [MainThread]: Flushing usage events
[0m21:58:15.452420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e88a5d6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e88788210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e88a36290>]}


============================== 21:58:15.455705 | c694610b-63df-4252-82e0-0eecd664f6cb ==============================
[0m21:58:15.455705 [info ] [MainThread]: Running with dbt=1.6.0
[0m21:58:15.456177 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'debug': 'False', 'target_path': 'None', 'use_colors': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'indirect_selection': 'eager', 'write_json': 'True', 'invocation_command': 'dbt parse', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'introspect': 'True', 'static_parser': 'True', 'version_check': 'True', 'printer_width': '80', 'log_format': 'default', 'profiles_dir': '/home/walterg/.dbt'}
[0m21:58:15.515187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c694610b-63df-4252-82e0-0eecd664f6cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e88705ad0>]}
[0m21:58:15.527741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c694610b-63df-4252-82e0-0eecd664f6cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e888bee50>]}
[0m21:58:15.528380 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m21:58:15.535360 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m21:58:15.535913 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:58:15.536255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c694610b-63df-4252-82e0-0eecd664f6cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e88789290>]}
[0m21:58:16.033434 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vendas_dw.silver
- models.vendas_dw.bronze
- models.vendas_dw.gold
[0m21:58:16.037111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c694610b-63df-4252-82e0-0eecd664f6cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e87d90d10>]}
[0m21:58:16.037786 [info ] [MainThread]: Performance info: /home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/target/perf_info.json
[0m21:58:16.044695 [debug] [MainThread]: Command `dbt parse` succeeded at 21:58:16.044524 after 0.60 seconds
[0m21:58:16.045194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e88afbd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e887d7290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e8d124810>]}
[0m21:58:16.045535 [debug] [MainThread]: Flushing usage events
[0m21:58:21.142238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11eeeba490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11eef23ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11eef5f150>]}


============================== 21:58:21.144989 | 7f5d0041-b3e8-49cf-828e-7dc5601d11a4 ==============================
[0m21:58:21.144989 [info ] [MainThread]: Running with dbt=1.6.0
[0m21:58:21.145452 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'fail_fast': 'False', 'debug': 'False', 'version_check': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_format': 'default', 'invocation_command': 'dbt run', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'introspect': 'True', 'quiet': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'write_json': 'True', 'profiles_dir': '/home/walterg/.dbt', 'cache_selected_only': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None'}
[0m21:58:21.207047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f5d0041-b3e8-49cf-828e-7dc5601d11a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11eeb65450>]}
[0m21:58:21.219807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f5d0041-b3e8-49cf-828e-7dc5601d11a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11eeeafa50>]}
[0m21:58:21.220685 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m21:58:21.228056 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m21:58:21.243670 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:58:21.244034 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:58:21.244503 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vendas_dw.gold
- models.vendas_dw.silver
- models.vendas_dw.bronze
[0m21:58:21.248515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f5d0041-b3e8-49cf-828e-7dc5601d11a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11eeb64650>]}
[0m21:58:21.258088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f5d0041-b3e8-49cf-828e-7dc5601d11a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11ee941290>]}
[0m21:58:21.258555 [info ] [MainThread]: Found 2 models, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m21:58:21.258847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f5d0041-b3e8-49cf-828e-7dc5601d11a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11eee31010>]}
[0m21:58:21.260213 [info ] [MainThread]: 
[0m21:58:21.260911 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:58:21.262371 [debug] [ThreadPool]: Acquiring new postgres connection 'list_general_rtxt'
[0m21:58:21.271204 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt"
[0m21:58:21.271745 [debug] [ThreadPool]: On list_general_rtxt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt"} */

    select distinct nspname from pg_namespace
  
[0m21:58:21.272029 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:58:22.651673 [debug] [ThreadPool]: SQL status: SELECT 9 in 1.0 seconds
[0m21:58:22.653390 [debug] [ThreadPool]: On list_general_rtxt: Close
[0m21:58:22.655734 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_general_rtxt, now list_general_rtxt_bronze)
[0m21:58:22.660780 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze"
[0m21:58:22.661149 [debug] [ThreadPool]: On list_general_rtxt_bronze: BEGIN
[0m21:58:22.661396 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:58:24.042556 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m21:58:24.043636 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze"
[0m21:58:24.044012 [debug] [ThreadPool]: On list_general_rtxt_bronze: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt_bronze"} */
select
      'general_rtxt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze'
    union all
    select
      'general_rtxt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze'
    union all
    select
      'general_rtxt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze'
  
[0m21:58:24.232204 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m21:58:24.234074 [debug] [ThreadPool]: On list_general_rtxt_bronze: ROLLBACK
[0m21:58:24.417784 [debug] [ThreadPool]: On list_general_rtxt_bronze: Close
[0m21:58:24.423256 [debug] [MainThread]: Using postgres connection "master"
[0m21:58:24.423649 [debug] [MainThread]: On master: BEGIN
[0m21:58:24.423887 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:58:25.821189 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m21:58:25.821616 [debug] [MainThread]: Using postgres connection "master"
[0m21:58:25.821961 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:58:26.037048 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m21:58:26.039045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f5d0041-b3e8-49cf-828e-7dc5601d11a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11eed30d10>]}
[0m21:58:26.039468 [debug] [MainThread]: On master: ROLLBACK
[0m21:58:26.230664 [debug] [MainThread]: Using postgres connection "master"
[0m21:58:26.231172 [debug] [MainThread]: On master: BEGIN
[0m21:58:26.657853 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:58:26.658528 [debug] [MainThread]: On master: COMMIT
[0m21:58:26.658775 [debug] [MainThread]: Using postgres connection "master"
[0m21:58:26.658998 [debug] [MainThread]: On master: COMMIT
[0m21:58:26.848640 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:58:26.849158 [debug] [MainThread]: On master: Close
[0m21:58:26.850456 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:58:26.851063 [info ] [MainThread]: 
[0m21:58:26.854282 [debug] [Thread-1 (]: Began running node model.vendas_dw.fct_vendas
[0m21:58:26.855224 [info ] [Thread-1 (]: 1 of 2 START sql view model bronze.fct_vendas .................................. [RUN]
[0m21:58:26.856202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_general_rtxt_bronze, now model.vendas_dw.fct_vendas)
[0m21:58:26.856599 [debug] [Thread-1 (]: Began compiling node model.vendas_dw.fct_vendas
[0m21:58:26.861763 [debug] [Thread-1 (]: Writing injected SQL for node "model.vendas_dw.fct_vendas"
[0m21:58:26.862604 [debug] [Thread-1 (]: Timing info for model.vendas_dw.fct_vendas (compile): 21:58:26.856810 => 21:58:26.862391
[0m21:58:26.862967 [debug] [Thread-1 (]: Began executing node model.vendas_dw.fct_vendas
[0m21:58:26.889464 [debug] [Thread-1 (]: Writing runtime sql for node "model.vendas_dw.fct_vendas"
[0m21:58:26.890257 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m21:58:26.890594 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: BEGIN
[0m21:58:26.890855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:58:28.293065 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m21:58:28.293762 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m21:58:28.294060 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_vendas"} */

  create view "general_rtxt"."bronze"."fct_vendas__dbt_tmp"
    
    
  as (
    SELECT
    id_venda,
    id_produto,
    preco,
    quantidade,
    CAST(data_venda AS date) AS data_venda,
    id_cliente,
    id_loja,
    id_vendedor,
    meio_pagamento,
    parcelamento
FROM "general_rtxt"."bronze"."vendas"
  );
[0m21:58:28.481798 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:58:28.486956 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m21:58:28.487373 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_vendas"} */
alter table "general_rtxt"."bronze"."fct_vendas" rename to "fct_vendas__dbt_backup"
[0m21:58:28.676677 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:58:28.679440 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m21:58:28.679835 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_vendas"} */
alter table "general_rtxt"."bronze"."fct_vendas__dbt_tmp" rename to "fct_vendas"
[0m21:58:28.866742 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:58:28.879240 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: COMMIT
[0m21:58:28.879682 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m21:58:28.879981 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: COMMIT
[0m21:58:29.067971 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:58:29.074981 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m21:58:29.075399 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_vendas"} */
drop view if exists "general_rtxt"."bronze"."fct_vendas__dbt_backup" cascade
[0m21:58:29.266598 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:58:29.268374 [debug] [Thread-1 (]: Timing info for model.vendas_dw.fct_vendas (execute): 21:58:26.863172 => 21:58:29.268230
[0m21:58:29.268749 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: Close
[0m21:58:29.269445 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f5d0041-b3e8-49cf-828e-7dc5601d11a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11ef1e4110>]}
[0m21:58:29.269989 [info ] [Thread-1 (]: 1 of 2 OK created sql view model bronze.fct_vendas ............................. [[32mCREATE VIEW[0m in 2.41s]
[0m21:58:29.270522 [debug] [Thread-1 (]: Finished running node model.vendas_dw.fct_vendas
[0m21:58:29.272187 [debug] [Thread-3 (]: Began running node model.vendas_dw.indicadores_vendas
[0m21:58:29.273296 [info ] [Thread-3 (]: 2 of 2 START sql view model bronze.indicadores_vendas .......................... [RUN]
[0m21:58:29.274114 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.vendas_dw.indicadores_vendas'
[0m21:58:29.274444 [debug] [Thread-3 (]: Began compiling node model.vendas_dw.indicadores_vendas
[0m21:58:29.276831 [debug] [Thread-3 (]: Writing injected SQL for node "model.vendas_dw.indicadores_vendas"
[0m21:58:29.277548 [debug] [Thread-3 (]: Timing info for model.vendas_dw.indicadores_vendas (compile): 21:58:29.274667 => 21:58:29.277365
[0m21:58:29.277867 [debug] [Thread-3 (]: Began executing node model.vendas_dw.indicadores_vendas
[0m21:58:29.281280 [debug] [Thread-3 (]: Writing runtime sql for node "model.vendas_dw.indicadores_vendas"
[0m21:58:29.282022 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.indicadores_vendas"
[0m21:58:29.282457 [debug] [Thread-3 (]: On model.vendas_dw.indicadores_vendas: BEGIN
[0m21:58:29.282927 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:58:30.732561 [debug] [Thread-3 (]: SQL status: BEGIN in 1.0 seconds
[0m21:58:30.733465 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.indicadores_vendas"
[0m21:58:30.733817 [debug] [Thread-3 (]: On model.vendas_dw.indicadores_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.indicadores_vendas"} */

  create view "general_rtxt"."bronze"."indicadores_vendas__dbt_tmp"
    
    
  as (
    WITH base AS (
    SELECT
        data_venda,
        id_loja,
        preco,
        quantidade,
        id_venda
    FROM "general_rtxt"."bronze"."fct_vendas"
)
SELECT
    data_venda,
    id_loja,
    SUM(preco * quantidade) AS receita_total,
    COUNT(DISTINCT id_venda) AS qtd_vendas
FROM base
GROUP BY data_venda, id_loja
  );
[0m21:58:30.923058 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m21:58:30.925766 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.indicadores_vendas"
[0m21:58:30.926121 [debug] [Thread-3 (]: On model.vendas_dw.indicadores_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.indicadores_vendas"} */
alter table "general_rtxt"."bronze"."indicadores_vendas__dbt_tmp" rename to "indicadores_vendas"
[0m21:58:31.115088 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:58:31.117002 [debug] [Thread-3 (]: On model.vendas_dw.indicadores_vendas: COMMIT
[0m21:58:31.117305 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.indicadores_vendas"
[0m21:58:31.117589 [debug] [Thread-3 (]: On model.vendas_dw.indicadores_vendas: COMMIT
[0m21:58:31.304253 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m21:58:31.307273 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.indicadores_vendas"
[0m21:58:31.307637 [debug] [Thread-3 (]: On model.vendas_dw.indicadores_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.indicadores_vendas"} */
drop view if exists "general_rtxt"."bronze"."indicadores_vendas__dbt_backup" cascade
[0m21:58:31.495844 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m21:58:31.497371 [debug] [Thread-3 (]: Timing info for model.vendas_dw.indicadores_vendas (execute): 21:58:29.278071 => 21:58:31.497235
[0m21:58:31.497691 [debug] [Thread-3 (]: On model.vendas_dw.indicadores_vendas: Close
[0m21:58:31.498390 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f5d0041-b3e8-49cf-828e-7dc5601d11a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11eebf2f90>]}
[0m21:58:31.498886 [info ] [Thread-3 (]: 2 of 2 OK created sql view model bronze.indicadores_vendas ..................... [[32mCREATE VIEW[0m in 2.22s]
[0m21:58:31.499358 [debug] [Thread-3 (]: Finished running node model.vendas_dw.indicadores_vendas
[0m21:58:31.501426 [debug] [MainThread]: Using postgres connection "master"
[0m21:58:31.501783 [debug] [MainThread]: On master: BEGIN
[0m21:58:31.502041 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:58:32.871567 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m21:58:32.872566 [debug] [MainThread]: On master: COMMIT
[0m21:58:32.873175 [debug] [MainThread]: Using postgres connection "master"
[0m21:58:32.873456 [debug] [MainThread]: On master: COMMIT
[0m21:58:33.062130 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:58:33.062958 [debug] [MainThread]: On master: Close
[0m21:58:33.063610 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:58:33.063873 [debug] [MainThread]: Connection 'model.vendas_dw.fct_vendas' was properly closed.
[0m21:58:33.064088 [debug] [MainThread]: Connection 'model.vendas_dw.indicadores_vendas' was properly closed.
[0m21:58:33.064364 [info ] [MainThread]: 
[0m21:58:33.064670 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 11.80 seconds (11.80s).
[0m21:58:33.065258 [debug] [MainThread]: Command end result
[0m21:58:33.070946 [info ] [MainThread]: 
[0m21:58:33.071366 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:58:33.071658 [info ] [MainThread]: 
[0m21:58:33.071938 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:58:33.072331 [debug] [MainThread]: Command `dbt run` succeeded at 21:58:33.072258 after 11.94 seconds
[0m21:58:33.072645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11ef135450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11f38b6650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11f38b7690>]}
[0m21:58:33.072941 [debug] [MainThread]: Flushing usage events
[0m21:59:46.262237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f249a2aa210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f249a2ab950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f249a2d0f10>]}


============================== 21:59:46.265191 | b4c91867-d7db-4972-93ea-8ace052af16d ==============================
[0m21:59:46.265191 [info ] [MainThread]: Running with dbt=1.6.0
[0m21:59:46.265672 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'log_format': 'default', 'warn_error': 'None', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'version_check': 'True', 'invocation_command': 'dbt debug', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/home/walterg/.dbt', 'use_colors': 'True', 'partial_parse': 'True', 'introspect': 'True', 'static_parser': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'target_path': 'None', 'use_experimental_parser': 'False'}
[0m21:59:46.266057 [info ] [MainThread]: dbt version: 1.6.0
[0m21:59:46.266343 [info ] [MainThread]: python version: 3.11.2
[0m21:59:46.266621 [info ] [MainThread]: python path: /home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/.venv/bin/python3
[0m21:59:46.266876 [info ] [MainThread]: os info: Linux-6.10.7-policorp-amd64-x86_64-with-glibc2.36
[0m21:59:46.301915 [info ] [MainThread]: Using profiles dir at /home/walterg/.dbt
[0m21:59:46.302334 [info ] [MainThread]: Using profiles.yml file at /home/walterg/.dbt/profiles.yml
[0m21:59:46.302620 [info ] [MainThread]: Using dbt_project.yml file at /home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/dbt_project.yml
[0m21:59:46.303044 [info ] [MainThread]: adapter type: postgres
[0m21:59:46.303303 [info ] [MainThread]: adapter version: 1.6.0
[0m21:59:46.320831 [info ] [MainThread]: Configuration:
[0m21:59:46.321220 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:59:46.321490 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:59:46.321739 [info ] [MainThread]: Required dependencies:
[0m21:59:46.322003 [debug] [MainThread]: Executing "git --help"
[0m21:59:46.324043 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:59:46.324771 [debug] [MainThread]: STDERR: "b''"
[0m21:59:46.325019 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:59:46.325271 [info ] [MainThread]: Connection:
[0m21:59:46.325549 [info ] [MainThread]:   host: dpg-d0khna8gjchc73ae1r1g-a.oregon-postgres.render.com
[0m21:59:46.325869 [info ] [MainThread]:   port: 5432
[0m21:59:46.326144 [info ] [MainThread]:   user: postgresadmin
[0m21:59:46.326385 [info ] [MainThread]:   database: general_rtxt
[0m21:59:46.326645 [info ] [MainThread]:   schema: bronze
[0m21:59:46.326886 [info ] [MainThread]:   connect_timeout: 10
[0m21:59:46.327117 [info ] [MainThread]:   role: None
[0m21:59:46.327341 [info ] [MainThread]:   search_path: None
[0m21:59:46.327587 [info ] [MainThread]:   keepalives_idle: 0
[0m21:59:46.327821 [info ] [MainThread]:   sslmode: None
[0m21:59:46.328048 [info ] [MainThread]:   sslcert: None
[0m21:59:46.328274 [info ] [MainThread]:   sslkey: None
[0m21:59:46.328596 [info ] [MainThread]:   sslrootcert: None
[0m21:59:46.328853 [info ] [MainThread]:   application_name: dbt
[0m21:59:46.329081 [info ] [MainThread]:   retries: 1
[0m21:59:46.329416 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m21:59:46.330036 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:59:46.330301 [debug] [MainThread]: Using postgres connection "debug"
[0m21:59:46.330534 [debug] [MainThread]: On debug: select 1 as id
[0m21:59:46.330759 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:59:47.925079 [debug] [MainThread]: SQL status: SELECT 1 in 2.0 seconds
[0m21:59:47.926394 [debug] [MainThread]: On debug: Close
[0m21:59:47.926788 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:59:47.927054 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:59:47.927430 [debug] [MainThread]: Command `dbt debug` succeeded at 21:59:47.927342 after 1.67 seconds
[0m21:59:47.927718 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:59:47.927978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f249ee92450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f249b1ac810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2499713890>]}
[0m21:59:47.928271 [debug] [MainThread]: Flushing usage events
[0m22:02:37.816827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21e7bd6050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21e7476910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21e88d4f10>]}


============================== 22:02:37.820241 | 8a49e3bb-3d24-4769-8725-fd66a3c39752 ==============================
[0m22:02:37.820241 [info ] [MainThread]: Running with dbt=1.6.0
[0m22:02:37.820946 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'log_cache_events': 'False', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'use_colors': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'printer_width': '80', 'profiles_dir': '/home/walterg/.dbt', 'static_parser': 'True', 'quiet': 'False', 'log_format': 'default', 'debug': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'no_print': 'None'}
[0m22:02:37.890553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a49e3bb-3d24-4769-8725-fd66a3c39752', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21e74a3610>]}
[0m22:02:37.904570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a49e3bb-3d24-4769-8725-fd66a3c39752', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21e74a3610>]}
[0m22:02:37.905314 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m22:02:37.912823 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m22:02:37.930995 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m22:02:37.931719 [debug] [MainThread]: Partial parsing: updated file: vendas_dw://models/vendas_dw/silver/fct_vendas.sql
[0m22:02:37.932420 [debug] [MainThread]: Partial parsing: updated file: vendas_dw://models/vendas_dw/gold/indicadores_vendas.sql
[0m22:02:37.975065 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vendas_dw.bronze
- models.vendas_dw.silver
- models.vendas_dw.gold
[0m22:02:37.981366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a49e3bb-3d24-4769-8725-fd66a3c39752', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21e6fd6190>]}
[0m22:02:37.994333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a49e3bb-3d24-4769-8725-fd66a3c39752', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21e6df0cd0>]}
[0m22:02:37.994945 [info ] [MainThread]: Found 2 models, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m22:02:37.995370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a49e3bb-3d24-4769-8725-fd66a3c39752', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21e6f08910>]}
[0m22:02:37.997270 [info ] [MainThread]: 
[0m22:02:37.998222 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:02:38.000143 [debug] [ThreadPool]: Acquiring new postgres connection 'list_general_rtxt'
[0m22:02:38.011356 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt"
[0m22:02:38.011922 [debug] [ThreadPool]: On list_general_rtxt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt"} */

    select distinct nspname from pg_namespace
  
[0m22:02:38.012279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:02:39.487431 [debug] [ThreadPool]: SQL status: SELECT 9 in 1.0 seconds
[0m22:02:39.488563 [debug] [ThreadPool]: On list_general_rtxt: Close
[0m22:02:39.490225 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_general_rtxt, now list_general_rtxt_bronze)
[0m22:02:39.494696 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze"
[0m22:02:39.495075 [debug] [ThreadPool]: On list_general_rtxt_bronze: BEGIN
[0m22:02:39.495348 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:02:40.868679 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m22:02:40.869571 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze"
[0m22:02:40.870261 [debug] [ThreadPool]: On list_general_rtxt_bronze: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt_bronze"} */
select
      'general_rtxt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze'
    union all
    select
      'general_rtxt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze'
    union all
    select
      'general_rtxt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze'
  
[0m22:02:41.117845 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m22:02:41.120129 [debug] [ThreadPool]: On list_general_rtxt_bronze: ROLLBACK
[0m22:02:41.306657 [debug] [ThreadPool]: On list_general_rtxt_bronze: Close
[0m22:02:41.311670 [debug] [MainThread]: Using postgres connection "master"
[0m22:02:41.312039 [debug] [MainThread]: On master: BEGIN
[0m22:02:41.312293 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:02:42.722527 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m22:02:42.723189 [debug] [MainThread]: Using postgres connection "master"
[0m22:02:42.723496 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:02:42.916751 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m22:02:42.918381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a49e3bb-3d24-4769-8725-fd66a3c39752', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21e74a2c90>]}
[0m22:02:42.918780 [debug] [MainThread]: On master: ROLLBACK
[0m22:02:43.107755 [debug] [MainThread]: Using postgres connection "master"
[0m22:02:43.108150 [debug] [MainThread]: On master: BEGIN
[0m22:02:43.478845 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:02:43.479664 [debug] [MainThread]: On master: COMMIT
[0m22:02:43.480314 [debug] [MainThread]: Using postgres connection "master"
[0m22:02:43.480911 [debug] [MainThread]: On master: COMMIT
[0m22:02:43.667141 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:02:43.667888 [debug] [MainThread]: On master: Close
[0m22:02:43.668638 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:02:43.669055 [info ] [MainThread]: 
[0m22:02:43.672206 [debug] [Thread-1 (]: Began running node model.vendas_dw.fct_vendas
[0m22:02:43.672869 [info ] [Thread-1 (]: 1 of 2 START sql table model bronze.fct_vendas ................................. [RUN]
[0m22:02:43.673589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_general_rtxt_bronze, now model.vendas_dw.fct_vendas)
[0m22:02:43.673960 [debug] [Thread-1 (]: Began compiling node model.vendas_dw.fct_vendas
[0m22:02:43.679911 [debug] [Thread-1 (]: Writing injected SQL for node "model.vendas_dw.fct_vendas"
[0m22:02:43.680807 [debug] [Thread-1 (]: Timing info for model.vendas_dw.fct_vendas (compile): 22:02:43.674183 => 22:02:43.680513
[0m22:02:43.681275 [debug] [Thread-1 (]: Began executing node model.vendas_dw.fct_vendas
[0m22:02:43.712827 [debug] [Thread-1 (]: Writing runtime sql for node "model.vendas_dw.fct_vendas"
[0m22:02:43.713883 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m22:02:43.714423 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: BEGIN
[0m22:02:43.714919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:02:45.339279 [debug] [Thread-1 (]: SQL status: BEGIN in 2.0 seconds
[0m22:02:45.339767 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m22:02:45.340091 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_vendas"} */

  
    

  create  table "general_rtxt"."bronze"."fct_vendas__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    id_venda,
    id_produto,
    preco,
    quantidade,
    CAST(data_venda AS date) AS data_venda,
    id_cliente,
    id_loja,
    id_vendedor,
    meio_pagamento,
    parcelamento
FROM "general_rtxt"."bronze"."vendas"
  );
  
[0m22:03:14.724068 [debug] [Thread-1 (]: SQL status: SELECT 2000000 in 29.0 seconds
[0m22:03:14.728818 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m22:03:14.729227 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_vendas"} */
alter table "general_rtxt"."bronze"."fct_vendas" rename to "fct_vendas__dbt_backup"
[0m22:03:14.917229 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:03:14.920028 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m22:03:14.920422 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_vendas"} */
alter table "general_rtxt"."bronze"."fct_vendas__dbt_tmp" rename to "fct_vendas"
[0m22:03:15.113666 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:03:15.129643 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: COMMIT
[0m22:03:15.130052 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m22:03:15.130336 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: COMMIT
[0m22:03:15.329261 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:03:15.336098 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m22:03:15.336517 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_vendas"} */
drop view if exists "general_rtxt"."bronze"."fct_vendas__dbt_backup" cascade
[0m22:03:15.531135 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:03:15.532831 [debug] [Thread-1 (]: Timing info for model.vendas_dw.fct_vendas (execute): 22:02:43.681576 => 22:03:15.532680
[0m22:03:15.533168 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: Close
[0m22:03:15.533864 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a49e3bb-3d24-4769-8725-fd66a3c39752', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21e6e5f950>]}
[0m22:03:15.534356 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bronze.fct_vendas ............................ [[32mSELECT 2000000[0m in 31.86s]
[0m22:03:15.534834 [debug] [Thread-1 (]: Finished running node model.vendas_dw.fct_vendas
[0m22:03:15.536204 [debug] [Thread-3 (]: Began running node model.vendas_dw.indicadores_vendas
[0m22:03:15.536915 [info ] [Thread-3 (]: 2 of 2 START sql table model bronze.indicadores_vendas ......................... [RUN]
[0m22:03:15.537618 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.vendas_dw.indicadores_vendas'
[0m22:03:15.537932 [debug] [Thread-3 (]: Began compiling node model.vendas_dw.indicadores_vendas
[0m22:03:15.541319 [debug] [Thread-3 (]: Writing injected SQL for node "model.vendas_dw.indicadores_vendas"
[0m22:03:15.542017 [debug] [Thread-3 (]: Timing info for model.vendas_dw.indicadores_vendas (compile): 22:03:15.538135 => 22:03:15.541850
[0m22:03:15.542319 [debug] [Thread-3 (]: Began executing node model.vendas_dw.indicadores_vendas
[0m22:03:15.545616 [debug] [Thread-3 (]: Writing runtime sql for node "model.vendas_dw.indicadores_vendas"
[0m22:03:15.546264 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.indicadores_vendas"
[0m22:03:15.546593 [debug] [Thread-3 (]: On model.vendas_dw.indicadores_vendas: BEGIN
[0m22:03:15.546846 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:03:16.958083 [debug] [Thread-3 (]: SQL status: BEGIN in 1.0 seconds
[0m22:03:16.958643 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.indicadores_vendas"
[0m22:03:16.958960 [debug] [Thread-3 (]: On model.vendas_dw.indicadores_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.indicadores_vendas"} */

  
    

  create  table "general_rtxt"."bronze"."indicadores_vendas__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT
        data_venda,
        id_loja,
        preco,
        quantidade,
        id_venda
    FROM "general_rtxt"."bronze"."fct_vendas"
)
SELECT
    data_venda,
    id_loja,
    SUM(preco * quantidade) AS receita_total,
    COUNT(DISTINCT id_venda) AS qtd_vendas
FROM base
GROUP BY data_venda, id_loja
  );
  
[0m22:04:04.316401 [debug] [Thread-3 (]: SQL status: SELECT 40155 in 47.0 seconds
[0m22:04:04.319505 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.indicadores_vendas"
[0m22:04:04.319878 [debug] [Thread-3 (]: On model.vendas_dw.indicadores_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.indicadores_vendas"} */
alter table "general_rtxt"."bronze"."indicadores_vendas__dbt_tmp" rename to "indicadores_vendas"
[0m22:04:04.519081 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:04:04.520810 [debug] [Thread-3 (]: On model.vendas_dw.indicadores_vendas: COMMIT
[0m22:04:04.521177 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.indicadores_vendas"
[0m22:04:04.521445 [debug] [Thread-3 (]: On model.vendas_dw.indicadores_vendas: COMMIT
[0m22:04:04.718882 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m22:04:04.723502 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.indicadores_vendas"
[0m22:04:04.723904 [debug] [Thread-3 (]: On model.vendas_dw.indicadores_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.indicadores_vendas"} */
drop table if exists "general_rtxt"."bronze"."indicadores_vendas__dbt_backup" cascade
[0m22:04:04.912632 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:04:04.914316 [debug] [Thread-3 (]: Timing info for model.vendas_dw.indicadores_vendas (execute): 22:03:15.542534 => 22:04:04.914178
[0m22:04:04.914640 [debug] [Thread-3 (]: On model.vendas_dw.indicadores_vendas: Close
[0m22:04:04.915336 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a49e3bb-3d24-4769-8725-fd66a3c39752', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21e6d07c50>]}
[0m22:04:04.915850 [info ] [Thread-3 (]: 2 of 2 OK created sql table model bronze.indicadores_vendas .................... [[32mSELECT 40155[0m in 49.38s]
[0m22:04:04.916318 [debug] [Thread-3 (]: Finished running node model.vendas_dw.indicadores_vendas
[0m22:04:04.919126 [debug] [MainThread]: Using postgres connection "master"
[0m22:04:04.919488 [debug] [MainThread]: On master: BEGIN
[0m22:04:04.919755 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:04:06.416624 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m22:04:06.417131 [debug] [MainThread]: On master: COMMIT
[0m22:04:06.417675 [debug] [MainThread]: Using postgres connection "master"
[0m22:04:06.418049 [debug] [MainThread]: On master: COMMIT
[0m22:04:06.616594 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:04:06.617030 [debug] [MainThread]: On master: Close
[0m22:04:06.618068 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:04:06.618557 [debug] [MainThread]: Connection 'model.vendas_dw.fct_vendas' was properly closed.
[0m22:04:06.618808 [debug] [MainThread]: Connection 'model.vendas_dw.indicadores_vendas' was properly closed.
[0m22:04:06.619093 [info ] [MainThread]: 
[0m22:04:06.619437 [info ] [MainThread]: Finished running 2 table models in 0 hours 1 minutes and 28.62 seconds (88.62s).
[0m22:04:06.620368 [debug] [MainThread]: Command end result
[0m22:04:06.626802 [info ] [MainThread]: 
[0m22:04:06.627200 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:04:06.627516 [info ] [MainThread]: 
[0m22:04:06.627846 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:04:06.628275 [debug] [MainThread]: Command `dbt run` succeeded at 22:04:06.628183 after 88.82 seconds
[0m22:04:06.628620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21ec17afd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21ec17a510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21ec17b550>]}
[0m22:04:06.628918 [debug] [MainThread]: Flushing usage events
[0m22:04:34.364371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45df49a1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45dfd1e990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45df3321d0>]}


============================== 22:04:34.367175 | 4bb2bbd3-84f7-4527-95bd-727a1b3c46e8 ==============================
[0m22:04:34.367175 [info ] [MainThread]: Running with dbt=1.6.0
[0m22:04:34.367650 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'quiet': 'False', 'fail_fast': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'use_experimental_parser': 'False', 'version_check': 'True', 'static_parser': 'True', 'printer_width': '80', 'profiles_dir': '/home/walterg/.dbt', 'log_format': 'default', 'write_json': 'True', 'target_path': 'None', 'partial_parse': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt run', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'use_colors': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True'}
[0m22:04:34.428128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4bb2bbd3-84f7-4527-95bd-727a1b3c46e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45df49b6d0>]}
[0m22:04:34.440531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4bb2bbd3-84f7-4527-95bd-727a1b3c46e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45de9204d0>]}
[0m22:04:34.441209 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m22:04:34.449380 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m22:04:34.465633 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m22:04:34.466447 [debug] [MainThread]: Partial parsing: updated file: vendas_dw://models/vendas_dw/gold/indicadores_vendas.sql
[0m22:04:34.466840 [debug] [MainThread]: Partial parsing: updated file: vendas_dw://models/vendas_dw/silver/fct_vendas.sql
[0m22:04:34.502209 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vendas_dw.gold
- models.vendas_dw.bronze
- models.vendas_dw.silver
[0m22:04:34.506212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4bb2bbd3-84f7-4527-95bd-727a1b3c46e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45dfe4dd50>]}
[0m22:04:34.518278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4bb2bbd3-84f7-4527-95bd-727a1b3c46e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45de7f8190>]}
[0m22:04:34.519021 [info ] [MainThread]: Found 2 models, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m22:04:34.519546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bb2bbd3-84f7-4527-95bd-727a1b3c46e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45de883b10>]}
[0m22:04:34.521391 [info ] [MainThread]: 
[0m22:04:34.522304 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:04:34.523997 [debug] [ThreadPool]: Acquiring new postgres connection 'list_general_rtxt'
[0m22:04:34.530872 [debug] [ThreadPool]: Acquiring new postgres connection 'list_general_rtxt'
[0m22:04:34.535921 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt"
[0m22:04:34.538730 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt"
[0m22:04:34.539218 [debug] [ThreadPool]: On list_general_rtxt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt"} */

    select distinct nspname from pg_namespace
  
[0m22:04:34.539599 [debug] [ThreadPool]: On list_general_rtxt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt"} */

    select distinct nspname from pg_namespace
  
[0m22:04:34.539928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:04:34.540215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:04:35.973763 [debug] [ThreadPool]: SQL status: SELECT 9 in 1.0 seconds
[0m22:04:35.975342 [debug] [ThreadPool]: On list_general_rtxt: Close
[0m22:04:35.993131 [debug] [ThreadPool]: SQL status: SELECT 9 in 1.0 seconds
[0m22:04:35.994520 [debug] [ThreadPool]: On list_general_rtxt: Close
[0m22:04:35.995694 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_general_rtxt, now create_general_rtxt_bronze_silver)
[0m22:04:35.996237 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_general_rtxt, now create_general_rtxt_bronze_gold)
[0m22:04:35.996829 [debug] [ThreadPool]: Creating schema "database: "general_rtxt"
schema: "bronze_silver"
"
[0m22:04:35.997369 [debug] [ThreadPool]: Creating schema "database: "general_rtxt"
schema: "bronze_gold"
"
[0m22:04:36.001286 [debug] [ThreadPool]: Using postgres connection "create_general_rtxt_bronze_silver"
[0m22:04:36.003361 [debug] [ThreadPool]: Using postgres connection "create_general_rtxt_bronze_gold"
[0m22:04:36.003872 [debug] [ThreadPool]: On create_general_rtxt_bronze_silver: BEGIN
[0m22:04:36.004375 [debug] [ThreadPool]: On create_general_rtxt_bronze_gold: BEGIN
[0m22:04:36.004691 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:04:36.004970 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:04:37.413452 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m22:04:37.414190 [debug] [ThreadPool]: Using postgres connection "create_general_rtxt_bronze_gold"
[0m22:04:37.414522 [debug] [ThreadPool]: On create_general_rtxt_bronze_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "create_general_rtxt_bronze_gold"} */
create schema if not exists "bronze_gold"
[0m22:04:37.552489 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m22:04:37.552878 [debug] [ThreadPool]: Using postgres connection "create_general_rtxt_bronze_silver"
[0m22:04:37.553114 [debug] [ThreadPool]: On create_general_rtxt_bronze_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "create_general_rtxt_bronze_silver"} */
create schema if not exists "bronze_silver"
[0m22:04:37.612790 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m22:04:37.613673 [debug] [ThreadPool]: On create_general_rtxt_bronze_gold: COMMIT
[0m22:04:37.613954 [debug] [ThreadPool]: Using postgres connection "create_general_rtxt_bronze_gold"
[0m22:04:37.614204 [debug] [ThreadPool]: On create_general_rtxt_bronze_gold: COMMIT
[0m22:04:37.748436 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m22:04:37.749573 [debug] [ThreadPool]: On create_general_rtxt_bronze_silver: COMMIT
[0m22:04:37.749855 [debug] [ThreadPool]: Using postgres connection "create_general_rtxt_bronze_silver"
[0m22:04:37.750094 [debug] [ThreadPool]: On create_general_rtxt_bronze_silver: COMMIT
[0m22:04:37.801380 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m22:04:37.801801 [debug] [ThreadPool]: On create_general_rtxt_bronze_gold: Close
[0m22:04:37.940371 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m22:04:37.941188 [debug] [ThreadPool]: On create_general_rtxt_bronze_silver: Close
[0m22:04:37.943071 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_general_rtxt_bronze_silver, now list_general_rtxt_bronze_silver)
[0m22:04:37.947960 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_silver"
[0m22:04:37.949164 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_general_rtxt_bronze_gold, now list_general_rtxt_bronze_gold)
[0m22:04:37.949784 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: BEGIN
[0m22:04:37.951419 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_gold"
[0m22:04:37.951799 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:04:37.952139 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: BEGIN
[0m22:04:37.952765 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:04:39.332223 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m22:04:39.332675 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_silver"
[0m22:04:39.332936 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt_bronze_silver"} */
select
      'general_rtxt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze_silver'
    union all
    select
      'general_rtxt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze_silver'
    union all
    select
      'general_rtxt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze_silver'
  
[0m22:04:39.526413 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m22:04:39.527129 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_gold"
[0m22:04:39.527692 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt_bronze_gold"} */
select
      'general_rtxt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze_gold'
    union all
    select
      'general_rtxt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze_gold'
    union all
    select
      'general_rtxt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze_gold'
  
[0m22:04:39.562574 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m22:04:39.564562 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: ROLLBACK
[0m22:04:39.723911 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m22:04:39.725412 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: ROLLBACK
[0m22:04:39.751075 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: Close
[0m22:04:39.913745 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: Close
[0m22:04:39.917390 [debug] [MainThread]: Using postgres connection "master"
[0m22:04:39.917760 [debug] [MainThread]: On master: BEGIN
[0m22:04:39.918006 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:04:41.407759 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m22:04:41.408863 [debug] [MainThread]: Using postgres connection "master"
[0m22:04:41.409298 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:04:41.712205 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m22:04:41.713300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bb2bbd3-84f7-4527-95bd-727a1b3c46e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45de968150>]}
[0m22:04:41.713844 [debug] [MainThread]: On master: ROLLBACK
[0m22:04:41.929359 [debug] [MainThread]: Using postgres connection "master"
[0m22:04:41.929787 [debug] [MainThread]: On master: BEGIN
[0m22:04:42.297450 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:04:42.298229 [debug] [MainThread]: On master: COMMIT
[0m22:04:42.298678 [debug] [MainThread]: Using postgres connection "master"
[0m22:04:42.298928 [debug] [MainThread]: On master: COMMIT
[0m22:04:42.489218 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:04:42.490247 [debug] [MainThread]: On master: Close
[0m22:04:42.491449 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:04:42.491857 [info ] [MainThread]: 
[0m22:04:42.495133 [debug] [Thread-1 (]: Began running node model.vendas_dw.fct_vendas
[0m22:04:42.495651 [info ] [Thread-1 (]: 1 of 2 START sql table model bronze_gold.fct_vendas ............................ [RUN]
[0m22:04:42.496177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_general_rtxt_bronze_gold, now model.vendas_dw.fct_vendas)
[0m22:04:42.496460 [debug] [Thread-1 (]: Began compiling node model.vendas_dw.fct_vendas
[0m22:04:42.502041 [debug] [Thread-1 (]: Writing injected SQL for node "model.vendas_dw.fct_vendas"
[0m22:04:42.502752 [debug] [Thread-1 (]: Timing info for model.vendas_dw.fct_vendas (compile): 22:04:42.496677 => 22:04:42.502577
[0m22:04:42.503130 [debug] [Thread-1 (]: Began executing node model.vendas_dw.fct_vendas
[0m22:04:42.530207 [debug] [Thread-1 (]: Writing runtime sql for node "model.vendas_dw.fct_vendas"
[0m22:04:42.530861 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m22:04:42.531159 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: BEGIN
[0m22:04:42.531421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:04:43.938460 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m22:04:43.939312 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m22:04:43.939802 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_vendas"} */

  
    

  create  table "general_rtxt"."bronze_gold"."fct_vendas__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    id_venda,
    id_produto,
    preco,
    quantidade,
    CAST(data_venda AS date) AS data_venda,
    id_cliente,
    id_loja,
    id_vendedor,
    meio_pagamento,
    parcelamento
FROM "general_rtxt"."bronze"."vendas"
  );
  
[0m22:05:15.117082 [debug] [Thread-1 (]: SQL status: SELECT 2000000 in 31.0 seconds
[0m22:05:15.123998 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m22:05:15.124411 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_vendas"} */
alter table "general_rtxt"."bronze_gold"."fct_vendas__dbt_tmp" rename to "fct_vendas"
[0m22:05:15.313202 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:05:15.327462 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: COMMIT
[0m22:05:15.328038 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m22:05:15.328530 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: COMMIT
[0m22:05:15.515957 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:05:15.525896 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m22:05:15.526363 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_vendas"} */
drop table if exists "general_rtxt"."bronze_gold"."fct_vendas__dbt_backup" cascade
[0m22:05:15.712739 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m22:05:15.714401 [debug] [Thread-1 (]: Timing info for model.vendas_dw.fct_vendas (execute): 22:04:42.503355 => 22:05:15.714257
[0m22:05:15.714770 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: Close
[0m22:05:15.715504 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bb2bbd3-84f7-4527-95bd-727a1b3c46e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45de9bf6d0>]}
[0m22:05:15.716250 [info ] [Thread-1 (]: 1 of 2 OK created sql table model bronze_gold.fct_vendas ....................... [[32mSELECT 2000000[0m in 33.22s]
[0m22:05:15.717102 [debug] [Thread-1 (]: Finished running node model.vendas_dw.fct_vendas
[0m22:05:15.718923 [debug] [Thread-3 (]: Began running node model.vendas_dw.indicadores_vendas
[0m22:05:15.719514 [info ] [Thread-3 (]: 2 of 2 START sql table model bronze_silver.indicadores_vendas .................. [RUN]
[0m22:05:15.720312 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.vendas_dw.indicadores_vendas'
[0m22:05:15.720778 [debug] [Thread-3 (]: Began compiling node model.vendas_dw.indicadores_vendas
[0m22:05:15.723746 [debug] [Thread-3 (]: Writing injected SQL for node "model.vendas_dw.indicadores_vendas"
[0m22:05:15.724543 [debug] [Thread-3 (]: Timing info for model.vendas_dw.indicadores_vendas (compile): 22:05:15.721009 => 22:05:15.724331
[0m22:05:15.724877 [debug] [Thread-3 (]: Began executing node model.vendas_dw.indicadores_vendas
[0m22:05:15.728422 [debug] [Thread-3 (]: Writing runtime sql for node "model.vendas_dw.indicadores_vendas"
[0m22:05:15.729215 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.indicadores_vendas"
[0m22:05:15.729641 [debug] [Thread-3 (]: On model.vendas_dw.indicadores_vendas: BEGIN
[0m22:05:15.729947 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:05:17.136319 [debug] [Thread-3 (]: SQL status: BEGIN in 1.0 seconds
[0m22:05:17.136751 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.indicadores_vendas"
[0m22:05:17.137072 [debug] [Thread-3 (]: On model.vendas_dw.indicadores_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.indicadores_vendas"} */

  
    

  create  table "general_rtxt"."bronze_silver"."indicadores_vendas__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT
        data_venda,
        id_loja,
        preco,
        quantidade,
        id_venda
    FROM "general_rtxt"."bronze_gold"."fct_vendas"
)
SELECT
    data_venda,
    id_loja,
    SUM(preco * quantidade) AS receita_total,
    COUNT(DISTINCT id_venda) AS qtd_vendas
FROM base
GROUP BY data_venda, id_loja
  );
  
[0m22:05:30.219525 [debug] [Thread-3 (]: Postgres adapter: Postgres error: could not write to file "base/pgsql_tmp/pgsql_tmp1146165.0": No space left on device

[0m22:05:30.220309 [debug] [Thread-3 (]: On model.vendas_dw.indicadores_vendas: ROLLBACK
[0m22:05:30.406281 [debug] [Thread-3 (]: Timing info for model.vendas_dw.indicadores_vendas (execute): 22:05:15.725084 => 22:05:30.405952
[0m22:05:30.406836 [debug] [Thread-3 (]: On model.vendas_dw.indicadores_vendas: Close
[0m22:05:30.410902 [debug] [Thread-3 (]: Database Error in model indicadores_vendas (models/vendas_dw/gold/indicadores_vendas.sql)
  could not write to file "base/pgsql_tmp/pgsql_tmp1146165.0": No space left on device
  compiled Code at target/run/vendas_dw/models/vendas_dw/gold/indicadores_vendas.sql
[0m22:05:30.411630 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bb2bbd3-84f7-4527-95bd-727a1b3c46e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45de706410>]}
[0m22:05:30.412397 [error] [Thread-3 (]: 2 of 2 ERROR creating sql table model bronze_silver.indicadores_vendas ......... [[31mERROR[0m in 14.69s]
[0m22:05:30.413232 [debug] [Thread-3 (]: Finished running node model.vendas_dw.indicadores_vendas
[0m22:05:30.416288 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:30.416767 [debug] [MainThread]: On master: BEGIN
[0m22:05:30.417048 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:31.890670 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m22:05:31.891531 [debug] [MainThread]: On master: COMMIT
[0m22:05:31.891772 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:31.891999 [debug] [MainThread]: On master: COMMIT
[0m22:05:32.089929 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:05:32.090688 [debug] [MainThread]: On master: Close
[0m22:05:32.091290 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:32.091567 [debug] [MainThread]: Connection 'list_general_rtxt_bronze_silver' was properly closed.
[0m22:05:32.091807 [debug] [MainThread]: Connection 'model.vendas_dw.fct_vendas' was properly closed.
[0m22:05:32.092020 [debug] [MainThread]: Connection 'model.vendas_dw.indicadores_vendas' was properly closed.
[0m22:05:32.092300 [info ] [MainThread]: 
[0m22:05:32.092590 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 57.57 seconds (57.57s).
[0m22:05:32.093171 [debug] [MainThread]: Command end result
[0m22:05:32.099542 [info ] [MainThread]: 
[0m22:05:32.099968 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:05:32.100235 [info ] [MainThread]: 
[0m22:05:32.100507 [error] [MainThread]: [33mDatabase Error in model indicadores_vendas (models/vendas_dw/gold/indicadores_vendas.sql)[0m
[0m22:05:32.100784 [error] [MainThread]:   could not write to file "base/pgsql_tmp/pgsql_tmp1146165.0": No space left on device
[0m22:05:32.101066 [error] [MainThread]:   compiled Code at target/run/vendas_dw/models/vendas_dw/gold/indicadores_vendas.sql
[0m22:05:32.101368 [info ] [MainThread]: 
[0m22:05:32.101891 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m22:05:32.102534 [debug] [MainThread]: Command `dbt run` failed at 22:05:32.102386 after 57.74 seconds
[0m22:05:32.103001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45dee85610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45dee85bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45e3a31550>]}
[0m22:05:32.103436 [debug] [MainThread]: Flushing usage events
[0m22:12:43.906789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9fe6a5e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9fdd918d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9fda5f590>]}


============================== 22:12:43.909622 | 2f7ad99c-41d1-4313-90a3-9a9eae981273 ==============================
[0m22:12:43.909622 [info ] [MainThread]: Running with dbt=1.6.0
[0m22:12:43.910164 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'warn_error': 'None', 'profiles_dir': '/home/walterg/.dbt', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'indirect_selection': 'eager', 'fail_fast': 'False', 'debug': 'False', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'write_json': 'True', 'printer_width': '80', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'log_format': 'default'}
[0m22:12:43.971185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f7ad99c-41d1-4313-90a3-9a9eae981273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9fd968bd0>]}
[0m22:12:43.983594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f7ad99c-41d1-4313-90a3-9a9eae981273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9fdc3ff50>]}
[0m22:12:43.984222 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m22:12:43.991725 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m22:12:44.007648 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:12:44.008295 [debug] [MainThread]: Partial parsing: updated file: vendas_dw://models/vendas_dw/silver/sources.yml
[0m22:12:44.058740 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vendas_dw.bronze
- models.vendas_dw.gold
- models.vendas_dw.silver
[0m22:12:44.062408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f7ad99c-41d1-4313-90a3-9a9eae981273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9fdafc6d0>]}
[0m22:12:44.070910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f7ad99c-41d1-4313-90a3-9a9eae981273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9fd631b50>]}
[0m22:12:44.071664 [info ] [MainThread]: Found 2 models, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m22:12:44.072078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f7ad99c-41d1-4313-90a3-9a9eae981273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9ff658d50>]}
[0m22:12:44.073672 [info ] [MainThread]: 
[0m22:12:44.074338 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:12:44.076193 [debug] [ThreadPool]: Acquiring new postgres connection 'list_general_rtxt'
[0m22:12:44.077676 [debug] [ThreadPool]: Acquiring new postgres connection 'list_general_rtxt'
[0m22:12:44.085945 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt"
[0m22:12:44.088789 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt"
[0m22:12:44.089190 [debug] [ThreadPool]: On list_general_rtxt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt"} */

    select distinct nspname from pg_namespace
  
[0m22:12:44.089568 [debug] [ThreadPool]: On list_general_rtxt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt"} */

    select distinct nspname from pg_namespace
  
[0m22:12:44.090114 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:12:44.090823 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:12:45.498824 [debug] [ThreadPool]: SQL status: SELECT 11 in 1.0 seconds
[0m22:12:45.500783 [debug] [ThreadPool]: On list_general_rtxt: Close
[0m22:12:45.550461 [debug] [ThreadPool]: SQL status: SELECT 11 in 1.0 seconds
[0m22:12:45.552052 [debug] [ThreadPool]: On list_general_rtxt: Close
[0m22:12:45.553547 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_general_rtxt, now list_general_rtxt_bronze_silver)
[0m22:12:45.554217 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_general_rtxt, now list_general_rtxt_bronze_gold)
[0m22:12:45.558855 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_silver"
[0m22:12:45.561852 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_gold"
[0m22:12:45.562359 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: BEGIN
[0m22:12:45.562845 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: BEGIN
[0m22:12:45.563205 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:12:45.563657 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:12:46.947232 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m22:12:46.948049 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_gold"
[0m22:12:46.948295 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt_bronze_gold"} */
select
      'general_rtxt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze_gold'
    union all
    select
      'general_rtxt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze_gold'
    union all
    select
      'general_rtxt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze_gold'
  
[0m22:12:46.998635 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m22:12:46.999331 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_silver"
[0m22:12:46.999611 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt_bronze_silver"} */
select
      'general_rtxt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze_silver'
    union all
    select
      'general_rtxt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze_silver'
    union all
    select
      'general_rtxt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze_silver'
  
[0m22:12:47.148873 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m22:12:47.150302 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: ROLLBACK
[0m22:12:47.197060 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m22:12:47.198306 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: ROLLBACK
[0m22:12:47.337913 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: Close
[0m22:12:47.385580 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: Close
[0m22:12:47.389891 [debug] [MainThread]: Using postgres connection "master"
[0m22:12:47.390252 [debug] [MainThread]: On master: BEGIN
[0m22:12:47.390506 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:12:48.877541 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m22:12:48.878026 [debug] [MainThread]: Using postgres connection "master"
[0m22:12:48.878332 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:12:49.073759 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m22:12:49.074851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f7ad99c-41d1-4313-90a3-9a9eae981273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9fd1a7c90>]}
[0m22:12:49.075259 [debug] [MainThread]: On master: ROLLBACK
[0m22:12:49.285312 [debug] [MainThread]: Using postgres connection "master"
[0m22:12:49.286069 [debug] [MainThread]: On master: BEGIN
[0m22:12:49.661099 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:12:49.661962 [debug] [MainThread]: On master: COMMIT
[0m22:12:49.662301 [debug] [MainThread]: Using postgres connection "master"
[0m22:12:49.662556 [debug] [MainThread]: On master: COMMIT
[0m22:12:49.848862 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:12:49.849270 [debug] [MainThread]: On master: Close
[0m22:12:49.849925 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:12:49.850258 [info ] [MainThread]: 
[0m22:12:49.854368 [debug] [Thread-1 (]: Began running node model.vendas_dw.fct_vendas
[0m22:12:49.855280 [info ] [Thread-1 (]: 1 of 2 START sql table model bronze_gold.fct_vendas ............................ [RUN]
[0m22:12:49.856649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_general_rtxt_bronze_silver, now model.vendas_dw.fct_vendas)
[0m22:12:49.856994 [debug] [Thread-1 (]: Began compiling node model.vendas_dw.fct_vendas
[0m22:12:49.862177 [debug] [Thread-1 (]: Writing injected SQL for node "model.vendas_dw.fct_vendas"
[0m22:12:49.862854 [debug] [Thread-1 (]: Timing info for model.vendas_dw.fct_vendas (compile): 22:12:49.857195 => 22:12:49.862700
[0m22:12:49.863156 [debug] [Thread-1 (]: Began executing node model.vendas_dw.fct_vendas
[0m22:12:49.890987 [debug] [Thread-1 (]: Writing runtime sql for node "model.vendas_dw.fct_vendas"
[0m22:12:49.891663 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m22:12:49.891969 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: BEGIN
[0m22:12:49.892227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:12:51.479885 [debug] [Thread-1 (]: SQL status: BEGIN in 2.0 seconds
[0m22:12:51.480314 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m22:12:51.480668 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_vendas"} */

  
    

  create  table "general_rtxt"."bronze_gold"."fct_vendas__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    id_venda,
    id_produto,
    preco,
    quantidade,
    CAST(data_venda AS date) AS data_venda,
    id_cliente,
    id_loja,
    id_vendedor,
    meio_pagamento,
    parcelamento
FROM "general_rtxt"."bronze"."vendas"
  );
  
[0m22:12:57.925008 [debug] [Thread-1 (]: Postgres adapter: Postgres error: could not extend file "base/16389/16615" with FileFallocate(): No space left on device
HINT:  Check free disk space.

[0m22:12:57.926032 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: ROLLBACK
[0m22:12:58.110470 [debug] [Thread-1 (]: Timing info for model.vendas_dw.fct_vendas (execute): 22:12:49.863357 => 22:12:58.110041
[0m22:12:58.110874 [debug] [Thread-1 (]: On model.vendas_dw.fct_vendas: Close
[0m22:12:58.113488 [debug] [Thread-1 (]: Database Error in model fct_vendas (models/vendas_dw/silver/fct_vendas.sql)
  could not extend file "base/16389/16615" with FileFallocate(): No space left on device
  HINT:  Check free disk space.
  compiled Code at target/run/vendas_dw/models/vendas_dw/silver/fct_vendas.sql
[0m22:12:58.113978 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f7ad99c-41d1-4313-90a3-9a9eae981273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9fd1913d0>]}
[0m22:12:58.114498 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model bronze_gold.fct_vendas ................... [[31mERROR[0m in 8.26s]
[0m22:12:58.114997 [debug] [Thread-1 (]: Finished running node model.vendas_dw.fct_vendas
[0m22:12:58.117494 [debug] [Thread-3 (]: Began running node model.vendas_dw.indicadores_vendas
[0m22:12:58.118374 [info ] [Thread-3 (]: 2 of 2 SKIP relation bronze_silver.indicadores_vendas .......................... [[33mSKIP[0m]
[0m22:12:58.119112 [debug] [Thread-3 (]: Finished running node model.vendas_dw.indicadores_vendas
[0m22:12:58.122166 [debug] [MainThread]: Using postgres connection "master"
[0m22:12:58.122611 [debug] [MainThread]: On master: BEGIN
[0m22:12:58.122948 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:12:59.578739 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m22:12:59.579273 [debug] [MainThread]: On master: COMMIT
[0m22:12:59.579520 [debug] [MainThread]: Using postgres connection "master"
[0m22:12:59.579766 [debug] [MainThread]: On master: COMMIT
[0m22:12:59.784194 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:12:59.784720 [debug] [MainThread]: On master: Close
[0m22:12:59.785337 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:12:59.785622 [debug] [MainThread]: Connection 'model.vendas_dw.fct_vendas' was properly closed.
[0m22:12:59.785833 [debug] [MainThread]: Connection 'list_general_rtxt_bronze_gold' was properly closed.
[0m22:12:59.786107 [info ] [MainThread]: 
[0m22:12:59.786388 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 15.71 seconds (15.71s).
[0m22:12:59.786944 [debug] [MainThread]: Command end result
[0m22:12:59.792927 [info ] [MainThread]: 
[0m22:12:59.793363 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:12:59.793799 [info ] [MainThread]: 
[0m22:12:59.794216 [error] [MainThread]: [33mDatabase Error in model fct_vendas (models/vendas_dw/silver/fct_vendas.sql)[0m
[0m22:12:59.794672 [error] [MainThread]:   could not extend file "base/16389/16615" with FileFallocate(): No space left on device
[0m22:12:59.795032 [error] [MainThread]:   HINT:  Check free disk space.
[0m22:12:59.795424 [error] [MainThread]:   compiled Code at target/run/vendas_dw/models/vendas_dw/silver/fct_vendas.sql
[0m22:12:59.795974 [info ] [MainThread]: 
[0m22:12:59.796522 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m22:12:59.797265 [debug] [MainThread]: Command `dbt run` failed at 22:12:59.797084 after 15.90 seconds
[0m22:12:59.797921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9fd5c45d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa024b7450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9fde268d0>]}
[0m22:12:59.798742 [debug] [MainThread]: Flushing usage events
[0m19:57:26.356507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1b6cea650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1b6471c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1b631f650>]}


============================== 19:57:26.360693 | b5872429-2e2b-4937-93e7-6d0b11c9f59d ==============================
[0m19:57:26.360693 [info ] [MainThread]: Running with dbt=1.6.0
[0m19:57:26.361204 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/home/walterg/.dbt', 'indirect_selection': 'eager', 'target_path': 'None', 'log_cache_events': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'debug': 'False', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'quiet': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'log_format': 'default', 'write_json': 'True', 'printer_width': '80', 'version_check': 'True', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'static_parser': 'True', 'introspect': 'True', 'no_print': 'None', 'use_colors': 'True'}
[0m19:57:26.431509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5872429-2e2b-4937-93e7-6d0b11c9f59d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1b64e2890>]}
[0m19:57:26.443790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5872429-2e2b-4937-93e7-6d0b11c9f59d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1b644dc50>]}
[0m19:57:26.444585 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m19:57:26.451692 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m19:57:26.477333 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 9 files added, 1 files changed.
[0m19:57:26.477804 [debug] [MainThread]: Partial parsing: added file: vendas_dw://models/vendas_dw/silver/dim_produtos.sql
[0m19:57:26.478113 [debug] [MainThread]: Partial parsing: added file: vendas_dw://models/vendas_dw/gold/fct_devolucoes.sql
[0m19:57:26.478398 [debug] [MainThread]: Partial parsing: added file: vendas_dw://models/vendas_dw/silver/dim_lojas.sql
[0m19:57:26.478656 [debug] [MainThread]: Partial parsing: added file: vendas_dw://models/vendas_dw/silver/stg_devolucoes.sql
[0m19:57:26.478916 [debug] [MainThread]: Partial parsing: added file: vendas_dw://models/vendas_dw/gold/mart_receita_mensal_categoria.sql
[0m19:57:26.479172 [debug] [MainThread]: Partial parsing: added file: vendas_dw://models/vendas_dw/silver/stg_vendas.sql
[0m19:57:26.479437 [debug] [MainThread]: Partial parsing: added file: vendas_dw://models/vendas_dw/gold/fct_vendas.sql
[0m19:57:26.479689 [debug] [MainThread]: Partial parsing: added file: vendas_dw://models/vendas_dw/silver/dim_vendedores.sql
[0m19:57:26.479938 [debug] [MainThread]: Partial parsing: added file: vendas_dw://models/vendas_dw/gold/mart_receita_diaria_loja.sql
[0m19:57:26.480431 [debug] [MainThread]: Partial parsing: updated file: vendas_dw://models/vendas_dw/silver/sources.yml
[0m19:57:26.531080 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two models with the name "fct_vendas".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for ref("fct_vendas").
  
  To fix this, change the name of one of these resources:
  - model.vendas_dw.fct_vendas (models/vendas_dw/silver/fct_vendas.sql)
  - model.vendas_dw.fct_vendas (models/vendas_dw/gold/fct_vendas.sql)
[0m19:57:26.531643 [debug] [MainThread]: Command `dbt run` failed at 19:57:26.531559 after 0.18 seconds
[0m19:57:26.531950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1b631f510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1b64703d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1b589f4d0>]}
[0m19:57:26.532269 [debug] [MainThread]: Flushing usage events
[0m19:57:45.206911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f697c9b43d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f697b01eed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f697a1ff610>]}


============================== 19:57:45.210837 | c1e31114-2851-4c49-96b8-ba08d033af50 ==============================
[0m19:57:45.210837 [info ] [MainThread]: Running with dbt=1.6.0
[0m19:57:45.211276 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'write_json': 'True', 'introspect': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'printer_width': '80', 'partial_parse': 'True', 'static_parser': 'True', 'use_colors': 'True', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt debug', 'quiet': 'False', 'log_cache_events': 'False', 'version_check': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/home/walterg/.dbt', 'target_path': 'None'}
[0m19:57:45.211674 [info ] [MainThread]: dbt version: 1.6.0
[0m19:57:45.211963 [info ] [MainThread]: python version: 3.11.2
[0m19:57:45.212221 [info ] [MainThread]: python path: /home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/.venv/bin/python3
[0m19:57:45.212496 [info ] [MainThread]: os info: Linux-6.10.7-policorp-amd64-x86_64-with-glibc2.36
[0m19:57:45.246137 [info ] [MainThread]: Using profiles dir at /home/walterg/.dbt
[0m19:57:45.246573 [info ] [MainThread]: Using profiles.yml file at /home/walterg/.dbt/profiles.yml
[0m19:57:45.246857 [info ] [MainThread]: Using dbt_project.yml file at /home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/dbt_project.yml
[0m19:57:45.247403 [info ] [MainThread]: adapter type: postgres
[0m19:57:45.247884 [info ] [MainThread]: adapter version: 1.6.0
[0m19:57:45.265872 [info ] [MainThread]: Configuration:
[0m19:57:45.266352 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:57:45.266620 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:57:45.266882 [info ] [MainThread]: Required dependencies:
[0m19:57:45.267187 [debug] [MainThread]: Executing "git --help"
[0m19:57:45.270545 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:57:45.271079 [debug] [MainThread]: STDERR: "b''"
[0m19:57:45.271775 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:57:45.272269 [info ] [MainThread]: Connection:
[0m19:57:45.272552 [info ] [MainThread]:   host: dpg-d0khna8gjchc73ae1r1g-a.oregon-postgres.render.com
[0m19:57:45.272798 [info ] [MainThread]:   port: 5432
[0m19:57:45.273060 [info ] [MainThread]:   user: postgresadmin
[0m19:57:45.273347 [info ] [MainThread]:   database: general_rtxt
[0m19:57:45.273614 [info ] [MainThread]:   schema: bronze
[0m19:57:45.273878 [info ] [MainThread]:   connect_timeout: 10
[0m19:57:45.274147 [info ] [MainThread]:   role: None
[0m19:57:45.274425 [info ] [MainThread]:   search_path: None
[0m19:57:45.274668 [info ] [MainThread]:   keepalives_idle: 0
[0m19:57:45.274908 [info ] [MainThread]:   sslmode: None
[0m19:57:45.275147 [info ] [MainThread]:   sslcert: None
[0m19:57:45.275404 [info ] [MainThread]:   sslkey: None
[0m19:57:45.275645 [info ] [MainThread]:   sslrootcert: None
[0m19:57:45.275886 [info ] [MainThread]:   application_name: dbt
[0m19:57:45.276128 [info ] [MainThread]:   retries: 1
[0m19:57:45.276451 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m19:57:45.276917 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m19:57:45.277176 [debug] [MainThread]: Using postgres connection "debug"
[0m19:57:45.277433 [debug] [MainThread]: On debug: select 1 as id
[0m19:57:45.277665 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:57:47.005137 [debug] [MainThread]: SQL status: SELECT 1 in 2.0 seconds
[0m19:57:47.006209 [debug] [MainThread]: On debug: Close
[0m19:57:47.006685 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:57:47.006961 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:57:47.007372 [debug] [MainThread]: Command `dbt debug` succeeded at 19:57:47.007280 after 1.81 seconds
[0m19:57:47.007642 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:57:47.007900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f697a6e6ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f697bf4b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f697a1d1b90>]}
[0m19:57:47.008199 [debug] [MainThread]: Flushing usage events
[0m19:57:51.779284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7cf1a21d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7cef068d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7cf1b4e10>]}


============================== 19:57:51.782576 | e1d44de7-04fa-432b-9cc3-34c2eee6d0d9 ==============================
[0m19:57:51.782576 [info ] [MainThread]: Running with dbt=1.6.0
[0m19:57:51.783029 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'quiet': 'False', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'profiles_dir': '/home/walterg/.dbt', 'indirect_selection': 'eager', 'no_print': 'None', 'fail_fast': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'debug': 'False', 'write_json': 'True', 'version_check': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_format': 'default', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'use_colors': 'True', 'log_cache_events': 'False'}
[0m19:57:51.842737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1d44de7-04fa-432b-9cc3-34c2eee6d0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7ce94f810>]}
[0m19:57:51.855393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1d44de7-04fa-432b-9cc3-34c2eee6d0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7ceb8ce10>]}
[0m19:57:51.856131 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m19:57:51.863837 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m19:57:51.881034 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 9 files added, 1 files changed.
[0m19:57:51.881634 [debug] [MainThread]: Partial parsing: added file: vendas_dw://models/vendas_dw/gold/fct_devolucoes.sql
[0m19:57:51.882055 [debug] [MainThread]: Partial parsing: added file: vendas_dw://models/vendas_dw/gold/mart_receita_diaria_loja.sql
[0m19:57:51.882415 [debug] [MainThread]: Partial parsing: added file: vendas_dw://models/vendas_dw/silver/dim_produtos.sql
[0m19:57:51.882710 [debug] [MainThread]: Partial parsing: added file: vendas_dw://models/vendas_dw/gold/fct_vendas.sql
[0m19:57:51.882996 [debug] [MainThread]: Partial parsing: added file: vendas_dw://models/vendas_dw/silver/stg_devolucoes.sql
[0m19:57:51.883297 [debug] [MainThread]: Partial parsing: added file: vendas_dw://models/vendas_dw/gold/mart_receita_mensal_categoria.sql
[0m19:57:51.883575 [debug] [MainThread]: Partial parsing: added file: vendas_dw://models/vendas_dw/silver/dim_vendedores.sql
[0m19:57:51.883844 [debug] [MainThread]: Partial parsing: added file: vendas_dw://models/vendas_dw/silver/dim_lojas.sql
[0m19:57:51.884105 [debug] [MainThread]: Partial parsing: added file: vendas_dw://models/vendas_dw/silver/stg_vendas.sql
[0m19:57:51.884569 [debug] [MainThread]: Partial parsing: updated file: vendas_dw://models/vendas_dw/silver/sources.yml
[0m19:57:51.935633 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two models with the name "fct_vendas".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for ref("fct_vendas").
  
  To fix this, change the name of one of these resources:
  - model.vendas_dw.fct_vendas (models/vendas_dw/silver/fct_vendas.sql)
  - model.vendas_dw.fct_vendas (models/vendas_dw/gold/fct_vendas.sql)
[0m19:57:51.936263 [debug] [MainThread]: Command `dbt run` failed at 19:57:51.936133 after 0.16 seconds
[0m19:57:51.936620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7ceb8d190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7cee79990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7cf1c6550>]}
[0m19:57:51.936933 [debug] [MainThread]: Flushing usage events
[0m19:58:30.294922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff7b16590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff79f3290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff7b7cd90>]}


============================== 19:58:30.298179 | 16e0634f-0fbf-4d65-9668-3b5e543ec78c ==============================
[0m19:58:30.298179 [info ] [MainThread]: Running with dbt=1.6.0
[0m20:04:29.908155 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'invocation_command': 'dbt run', 'no_print': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'write_json': 'True', 'partial_parse': 'True', 'profiles_dir': '/home/walterg/.dbt', 'target_path': 'None', 'warn_error': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'debug': 'False', 'fail_fast': 'False', 'introspect': 'True', 'version_check': 'True', 'quiet': 'False', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'log_format': 'default'}
[0m20:04:29.968758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16e0634f-0fbf-4d65-9668-3b5e543ec78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff7be6b90>]}
[0m20:04:29.980965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16e0634f-0fbf-4d65-9668-3b5e543ec78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff78d43d0>]}
[0m20:04:29.981599 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m20:04:29.989065 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m20:04:30.004830 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 9 files added, 1 files changed.
[0m20:04:30.005327 [debug] [MainThread]: Partial parsing: added file: vendas_dw://models/vendas_dw/gold/fct_vendas.sql
[0m20:04:30.005601 [debug] [MainThread]: Partial parsing: added file: vendas_dw://models/vendas_dw/silver/stg_devolucoes.sql
[0m20:04:30.005854 [debug] [MainThread]: Partial parsing: added file: vendas_dw://models/vendas_dw/silver/dim_produtos.sql
[0m20:04:30.006097 [debug] [MainThread]: Partial parsing: added file: vendas_dw://models/vendas_dw/gold/fct_devolucoes.sql
[0m20:04:30.006357 [debug] [MainThread]: Partial parsing: added file: vendas_dw://models/vendas_dw/silver/stg_vendas.sql
[0m20:04:30.006600 [debug] [MainThread]: Partial parsing: added file: vendas_dw://models/vendas_dw/silver/dim_vendedores.sql
[0m20:04:30.006844 [debug] [MainThread]: Partial parsing: added file: vendas_dw://models/vendas_dw/silver/dim_lojas.sql
[0m20:04:30.007089 [debug] [MainThread]: Partial parsing: added file: vendas_dw://models/vendas_dw/gold/mart_receita_diaria_loja.sql
[0m20:04:30.007358 [debug] [MainThread]: Partial parsing: added file: vendas_dw://models/vendas_dw/gold/mart_receita_mensal_categoria.sql
[0m20:04:30.007683 [debug] [MainThread]: Partial parsing: updated file: vendas_dw://models/vendas_dw/silver/sources.yml
[0m20:04:30.007952 [debug] [MainThread]: Partial parsing: deleted file: vendas_dw://models/vendas_dw/silver/fct_vendas.sql
[0m20:04:30.079096 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vendas_dw.bronze
- models.vendas_dw.silver
- models.vendas_dw.gold
[0m20:04:30.082895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16e0634f-0fbf-4d65-9668-3b5e543ec78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff73019d0>]}
[0m20:04:30.100048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16e0634f-0fbf-4d65-9668-3b5e543ec78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff72e1590>]}
[0m20:04:30.100535 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m20:04:30.100844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16e0634f-0fbf-4d65-9668-3b5e543ec78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff7ffd6d0>]}
[0m20:04:30.102418 [info ] [MainThread]: 
[0m20:04:30.103082 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:04:30.105008 [debug] [ThreadPool]: Acquiring new postgres connection 'list_general_rtxt'
[0m20:04:30.105796 [debug] [ThreadPool]: Acquiring new postgres connection 'list_general_rtxt'
[0m20:04:30.115228 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt"
[0m20:04:30.118420 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt"
[0m20:04:30.119026 [debug] [ThreadPool]: On list_general_rtxt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt"} */

    select distinct nspname from pg_namespace
  
[0m20:04:30.119597 [debug] [ThreadPool]: On list_general_rtxt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt"} */

    select distinct nspname from pg_namespace
  
[0m20:04:30.119977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:04:30.120273 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:04:31.646590 [debug] [ThreadPool]: SQL status: SELECT 7 in 2.0 seconds
[0m20:04:31.648449 [debug] [ThreadPool]: On list_general_rtxt: Close
[0m20:04:31.719976 [debug] [ThreadPool]: SQL status: SELECT 7 in 2.0 seconds
[0m20:04:31.721634 [debug] [ThreadPool]: On list_general_rtxt: Close
[0m20:04:31.723794 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_general_rtxt, now list_general_rtxt_bronze_silver)
[0m20:04:31.728743 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_silver"
[0m20:04:31.729978 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_general_rtxt, now list_general_rtxt_bronze)
[0m20:04:31.730324 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: BEGIN
[0m20:04:31.731965 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze"
[0m20:04:31.732338 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:04:31.732674 [debug] [ThreadPool]: On list_general_rtxt_bronze: BEGIN
[0m20:04:31.733118 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:04:33.143594 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m20:04:33.144186 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_silver"
[0m20:04:33.144470 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt_bronze_silver"} */
select
      'general_rtxt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze_silver'
    union all
    select
      'general_rtxt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze_silver'
    union all
    select
      'general_rtxt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze_silver'
  
[0m20:04:33.296961 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m20:04:33.297606 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze"
[0m20:04:33.297863 [debug] [ThreadPool]: On list_general_rtxt_bronze: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt_bronze"} */
select
      'general_rtxt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze'
    union all
    select
      'general_rtxt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze'
    union all
    select
      'general_rtxt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze'
  
[0m20:04:33.421963 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m20:04:33.423668 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: ROLLBACK
[0m20:04:33.511875 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m20:04:33.513383 [debug] [ThreadPool]: On list_general_rtxt_bronze: ROLLBACK
[0m20:04:33.609309 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: Close
[0m20:04:33.721383 [debug] [ThreadPool]: On list_general_rtxt_bronze: Close
[0m20:04:33.726281 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:33.726674 [debug] [MainThread]: On master: BEGIN
[0m20:04:33.726941 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:04:35.075824 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m20:04:35.076743 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:35.077073 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:04:35.276605 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m20:04:35.278285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16e0634f-0fbf-4d65-9668-3b5e543ec78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff781d310>]}
[0m20:04:35.278671 [debug] [MainThread]: On master: ROLLBACK
[0m20:04:35.463445 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:35.464395 [debug] [MainThread]: On master: BEGIN
[0m20:04:35.833364 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:04:35.834200 [debug] [MainThread]: On master: COMMIT
[0m20:04:35.834465 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:35.834708 [debug] [MainThread]: On master: COMMIT
[0m20:04:36.020721 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:04:36.021676 [debug] [MainThread]: On master: Close
[0m20:04:36.022516 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:04:36.022817 [info ] [MainThread]: 
[0m20:04:36.030714 [debug] [Thread-1 (]: Began running node model.vendas_dw.dim_lojas
[0m20:04:36.031313 [debug] [Thread-2 (]: Began running node model.vendas_dw.dim_produtos
[0m20:04:36.031917 [info ] [Thread-1 (]: 1 of 10 START sql table model bronze.dim_lojas ................................. [RUN]
[0m20:04:36.032354 [debug] [Thread-3 (]: Began running node model.vendas_dw.dim_vendedores
[0m20:04:36.032796 [debug] [Thread-4 (]: Began running node model.vendas_dw.stg_devolucoes
[0m20:04:36.033294 [info ] [Thread-2 (]: 2 of 10 START sql table model bronze.dim_produtos .............................. [RUN]
[0m20:04:36.033916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_general_rtxt_bronze, now model.vendas_dw.dim_lojas)
[0m20:04:36.034414 [info ] [Thread-3 (]: 3 of 10 START sql table model bronze.dim_vendedores ............................ [RUN]
[0m20:04:36.034896 [info ] [Thread-4 (]: 4 of 10 START sql table model bronze.stg_devolucoes ............................ [RUN]
[0m20:04:36.035539 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_general_rtxt_bronze_silver, now model.vendas_dw.dim_produtos)
[0m20:04:36.036099 [debug] [Thread-1 (]: Began compiling node model.vendas_dw.dim_lojas
[0m20:04:36.036846 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.vendas_dw.dim_vendedores'
[0m20:04:36.037496 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.vendas_dw.stg_devolucoes'
[0m20:04:36.037953 [debug] [Thread-2 (]: Began compiling node model.vendas_dw.dim_produtos
[0m20:04:36.043919 [debug] [Thread-1 (]: Writing injected SQL for node "model.vendas_dw.dim_lojas"
[0m20:04:36.044608 [debug] [Thread-3 (]: Began compiling node model.vendas_dw.dim_vendedores
[0m20:04:36.045221 [debug] [Thread-4 (]: Began compiling node model.vendas_dw.stg_devolucoes
[0m20:04:36.047856 [debug] [Thread-2 (]: Writing injected SQL for node "model.vendas_dw.dim_produtos"
[0m20:04:36.050478 [debug] [Thread-3 (]: Writing injected SQL for node "model.vendas_dw.dim_vendedores"
[0m20:04:36.054339 [debug] [Thread-4 (]: Writing injected SQL for node "model.vendas_dw.stg_devolucoes"
[0m20:04:36.055344 [debug] [Thread-1 (]: Timing info for model.vendas_dw.dim_lojas (compile): 20:04:36.038255 => 20:04:36.054952
[0m20:04:36.056310 [debug] [Thread-2 (]: Timing info for model.vendas_dw.dim_produtos (compile): 20:04:36.045514 => 20:04:36.056108
[0m20:04:36.056688 [debug] [Thread-3 (]: Timing info for model.vendas_dw.dim_vendedores (compile): 20:04:36.048387 => 20:04:36.056542
[0m20:04:36.057375 [debug] [Thread-4 (]: Timing info for model.vendas_dw.stg_devolucoes (compile): 20:04:36.051002 => 20:04:36.056968
[0m20:04:36.057718 [debug] [Thread-1 (]: Began executing node model.vendas_dw.dim_lojas
[0m20:04:36.058087 [debug] [Thread-2 (]: Began executing node model.vendas_dw.dim_produtos
[0m20:04:36.058641 [debug] [Thread-3 (]: Began executing node model.vendas_dw.dim_vendedores
[0m20:04:36.059217 [debug] [Thread-4 (]: Began executing node model.vendas_dw.stg_devolucoes
[0m20:04:36.093750 [debug] [Thread-1 (]: Writing runtime sql for node "model.vendas_dw.dim_lojas"
[0m20:04:36.095428 [debug] [Thread-2 (]: Writing runtime sql for node "model.vendas_dw.dim_produtos"
[0m20:04:36.100453 [debug] [Thread-3 (]: Writing runtime sql for node "model.vendas_dw.dim_vendedores"
[0m20:04:36.104521 [debug] [Thread-4 (]: Writing runtime sql for node "model.vendas_dw.stg_devolucoes"
[0m20:04:36.105490 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m20:04:36.106021 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m20:04:36.106751 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m20:04:36.107144 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m20:04:36.107481 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: BEGIN
[0m20:04:36.108020 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: BEGIN
[0m20:04:36.108343 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: BEGIN
[0m20:04:36.108855 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: BEGIN
[0m20:04:36.109166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:04:36.109498 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:04:36.109945 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:04:36.110470 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:04:37.504658 [debug] [Thread-4 (]: SQL status: BEGIN in 1.0 seconds
[0m20:04:37.505429 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m20:04:37.505713 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_devolucoes"} */

  
    

  create  table "general_rtxt"."bronze"."stg_devolucoes__dbt_tmp"
  
  
    as
  
  (
    

with source as (

    select
        cast(id_venda       as bigint)              as id_venda,
        cast(id_produto     as int)                 as id_produto,
        cast(preco          as numeric(12,2))       as preco,
        cast(quantidade     as int)                 as quantidade,
        cast(data_venda     as date)                as data_venda,
        cast(data_devolucao as date)                as data_devolucao,
        cast(id_cliente     as int)                 as id_cliente,
        cast(id_loja        as int)                 as id_loja,
        cast(id_vendedor    as int)                 as id_vendedor,
        motivo
    from "general_rtxt"."bronze"."devolucoes"

)

select *
from source;
  );
  
[0m20:04:37.673195 [debug] [Thread-3 (]: SQL status: BEGIN in 2.0 seconds
[0m20:04:37.673801 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m20:04:37.674081 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_vendedores"} */

  
    

  create  table "general_rtxt"."bronze"."dim_vendedores__dbt_tmp"
  
  
    as
  
  (
    

with source as (

    select
        cast(id                as int)   as id_vendedor,
        nome_vendedor,
        cast(data_admissao     as date)  as data_admissao,
        endereco_vendedor,
        cast(data_nascimento   as date)  as data_nascimento
    from "general_rtxt"."bronze"."vendedores"

)

select *
from source;
  );
  
[0m20:04:37.694594 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 32: from source;
                    ^

[0m20:04:37.695220 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: ROLLBACK
[0m20:04:37.717468 [debug] [Thread-1 (]: SQL status: BEGIN in 2.0 seconds
[0m20:04:37.718081 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m20:04:37.718386 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_lojas"} */

  
    

  create  table "general_rtxt"."bronze"."dim_lojas__dbt_tmp"
  
  
    as
  
  (
    

with source as (

    select
        cast(id_loja  as int)   as id_loja,
        nome_loja,
        logradouro,
        cast("número" as int)   as numero,
        bairro,
        cidade,
        estado,
        cep
    from "general_rtxt"."bronze"."lojas"

)

select *
from source;
  );
  
[0m20:04:37.724676 [debug] [Thread-2 (]: SQL status: BEGIN in 2.0 seconds
[0m20:04:37.725591 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m20:04:37.725862 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_produtos"} */

  
    

  create  table "general_rtxt"."bronze"."dim_produtos__dbt_tmp"
  
  
    as
  
  (
    

with source as (

    select
        cast(id_produto         as int)           as id_produto,
        nome_produto,
        categoria,
        cast(percentual_imposto as numeric(5,2))  as percentual_imposto
    from "general_rtxt"."bronze"."produtos"

)

select *
from source;
  );
  
[0m20:04:37.860984 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 27: from source;
                    ^

[0m20:04:37.861452 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: ROLLBACK
[0m20:04:37.882910 [debug] [Thread-4 (]: Timing info for model.vendas_dw.stg_devolucoes (execute): 20:04:36.100901 => 20:04:37.882448
[0m20:04:37.883299 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: Close
[0m20:04:37.894734 [debug] [Thread-4 (]: Database Error in model stg_devolucoes (models/vendas_dw/silver/stg_devolucoes.sql)
  syntax error at or near ";"
  LINE 32: from source;
                      ^
  compiled Code at target/run/vendas_dw/models/vendas_dw/silver/stg_devolucoes.sql
[0m20:04:37.895220 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16e0634f-0fbf-4d65-9668-3b5e543ec78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff712dd90>]}
[0m20:04:37.895712 [error] [Thread-4 (]: 4 of 10 ERROR creating sql table model bronze.stg_devolucoes ................... [[31mERROR[0m in 1.86s]
[0m20:04:37.896185 [debug] [Thread-4 (]: Finished running node model.vendas_dw.stg_devolucoes
[0m20:04:37.896543 [debug] [Thread-4 (]: Began running node model.vendas_dw.stg_vendas
[0m20:04:37.896913 [info ] [Thread-4 (]: 5 of 10 START sql table model bronze.stg_vendas ................................ [RUN]
[0m20:04:37.897538 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.vendas_dw.stg_devolucoes, now model.vendas_dw.stg_vendas)
[0m20:04:37.898985 [debug] [Thread-4 (]: Began compiling node model.vendas_dw.stg_vendas
[0m20:04:37.901492 [debug] [Thread-4 (]: Writing injected SQL for node "model.vendas_dw.stg_vendas"
[0m20:04:37.902376 [debug] [Thread-4 (]: Timing info for model.vendas_dw.stg_vendas (compile): 20:04:37.899315 => 20:04:37.902136
[0m20:04:37.902952 [debug] [Thread-4 (]: Began executing node model.vendas_dw.stg_vendas
[0m20:04:37.906160 [debug] [Thread-4 (]: Writing runtime sql for node "model.vendas_dw.stg_vendas"
[0m20:04:37.906666 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 30: from source;
                    ^

[0m20:04:37.907075 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: ROLLBACK
[0m20:04:37.907482 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_vendas"
[0m20:04:37.907833 [debug] [Thread-4 (]: On model.vendas_dw.stg_vendas: BEGIN
[0m20:04:37.908125 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:04:37.914462 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 26: from source;
                    ^

[0m20:04:37.915327 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: ROLLBACK
[0m20:04:38.046697 [debug] [Thread-3 (]: Timing info for model.vendas_dw.dim_vendedores (execute): 20:04:36.095894 => 20:04:38.046434
[0m20:04:38.047062 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: Close
[0m20:04:38.053415 [debug] [Thread-3 (]: Database Error in model dim_vendedores (models/vendas_dw/silver/dim_vendedores.sql)
  syntax error at or near ";"
  LINE 27: from source;
                      ^
  compiled Code at target/run/vendas_dw/models/vendas_dw/silver/dim_vendedores.sql
[0m20:04:38.053846 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16e0634f-0fbf-4d65-9668-3b5e543ec78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff7231ed0>]}
[0m20:04:38.054289 [error] [Thread-3 (]: 3 of 10 ERROR creating sql table model bronze.dim_vendedores ................... [[31mERROR[0m in 2.02s]
[0m20:04:38.054744 [debug] [Thread-3 (]: Finished running node model.vendas_dw.dim_vendedores
[0m20:04:38.055086 [debug] [Thread-3 (]: Began running node model.vendas_dw.fct_devolucoes
[0m20:04:38.055910 [info ] [Thread-3 (]: 6 of 10 SKIP relation bronze.fct_devolucoes .................................... [[33mSKIP[0m]
[0m20:04:38.056319 [debug] [Thread-3 (]: Finished running node model.vendas_dw.fct_devolucoes
[0m20:04:38.098741 [debug] [Thread-1 (]: Timing info for model.vendas_dw.dim_lojas (execute): 20:04:36.059550 => 20:04:38.098138
[0m20:04:38.099442 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: Close
[0m20:04:38.101260 [debug] [Thread-1 (]: Database Error in model dim_lojas (models/vendas_dw/silver/dim_lojas.sql)
  syntax error at or near ";"
  LINE 30: from source;
                      ^
  compiled Code at target/run/vendas_dw/models/vendas_dw/silver/dim_lojas.sql
[0m20:04:38.102017 [debug] [Thread-2 (]: Timing info for model.vendas_dw.dim_produtos (execute): 20:04:36.080291 => 20:04:38.101706
[0m20:04:38.102522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16e0634f-0fbf-4d65-9668-3b5e543ec78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff7b17e50>]}
[0m20:04:38.102886 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: Close
[0m20:04:38.103389 [error] [Thread-1 (]: 1 of 10 ERROR creating sql table model bronze.dim_lojas ........................ [[31mERROR[0m in 2.07s]
[0m20:04:38.104021 [debug] [Thread-1 (]: Finished running node model.vendas_dw.dim_lojas
[0m20:04:38.105878 [debug] [Thread-2 (]: Database Error in model dim_produtos (models/vendas_dw/silver/dim_produtos.sql)
  syntax error at or near ";"
  LINE 26: from source;
                      ^
  compiled Code at target/run/vendas_dw/models/vendas_dw/silver/dim_produtos.sql
[0m20:04:38.106769 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16e0634f-0fbf-4d65-9668-3b5e543ec78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff7133bd0>]}
[0m20:04:38.107339 [error] [Thread-2 (]: 2 of 10 ERROR creating sql table model bronze.dim_produtos ..................... [[31mERROR[0m in 2.07s]
[0m20:04:38.107798 [debug] [Thread-2 (]: Finished running node model.vendas_dw.dim_produtos
[0m20:04:39.327584 [debug] [Thread-4 (]: SQL status: BEGIN in 1.0 seconds
[0m20:04:39.328178 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_vendas"
[0m20:04:39.328494 [debug] [Thread-4 (]: On model.vendas_dw.stg_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_vendas"} */

  
    

  create  table "general_rtxt"."bronze"."stg_vendas__dbt_tmp"
  
  
    as
  
  (
    

with source as (

    select
        cast(id_venda      as bigint)               as id_venda,
        cast(id_produto    as int)                  as id_produto,
        cast(preco         as numeric(12,2))        as preco,
        cast(quantidade    as int)                  as quantidade,
        cast(data_venda    as date)                 as data_venda,
        cast(id_cliente    as int)                  as id_cliente,
        cast(id_loja       as int)                  as id_loja,
        cast(id_vendedor   as int)                  as id_vendedor,
        lower(trim(meio_pagamento))                 as meio_pagamento,
        cast(parcelamento  as smallint)             as parcelamento
    from "general_rtxt"."bronze"."vendas"

)

select *
from source;
  );
  
[0m20:04:39.553023 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 32: from source;
                    ^

[0m20:04:39.553672 [debug] [Thread-4 (]: On model.vendas_dw.stg_vendas: ROLLBACK
[0m20:04:39.741466 [debug] [Thread-4 (]: Timing info for model.vendas_dw.stg_vendas (execute): 20:04:37.903172 => 20:04:39.740788
[0m20:04:39.741967 [debug] [Thread-4 (]: On model.vendas_dw.stg_vendas: Close
[0m20:04:39.744023 [debug] [Thread-4 (]: Database Error in model stg_vendas (models/vendas_dw/silver/stg_vendas.sql)
  syntax error at or near ";"
  LINE 32: from source;
                      ^
  compiled Code at target/run/vendas_dw/models/vendas_dw/silver/stg_vendas.sql
[0m20:04:39.744535 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16e0634f-0fbf-4d65-9668-3b5e543ec78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff72e1ad0>]}
[0m20:04:39.745036 [error] [Thread-4 (]: 5 of 10 ERROR creating sql table model bronze.stg_vendas ....................... [[31mERROR[0m in 1.85s]
[0m20:04:39.745521 [debug] [Thread-4 (]: Finished running node model.vendas_dw.stg_vendas
[0m20:04:39.747325 [debug] [Thread-3 (]: Began running node model.vendas_dw.fct_vendas
[0m20:04:39.748065 [info ] [Thread-3 (]: 7 of 10 SKIP relation bronze.fct_vendas ........................................ [[33mSKIP[0m]
[0m20:04:39.748523 [debug] [Thread-3 (]: Finished running node model.vendas_dw.fct_vendas
[0m20:04:39.751371 [debug] [Thread-2 (]: Began running node model.vendas_dw.indicadores_vendas
[0m20:04:39.751792 [debug] [Thread-4 (]: Began running node model.vendas_dw.mart_receita_diaria_loja
[0m20:04:39.752102 [info ] [Thread-2 (]: 8 of 10 SKIP relation bronze_silver.indicadores_vendas ......................... [[33mSKIP[0m]
[0m20:04:39.752479 [debug] [Thread-1 (]: Began running node model.vendas_dw.mart_receita_mensal_categoria
[0m20:04:39.752854 [info ] [Thread-4 (]: 9 of 10 SKIP relation bronze.mart_receita_diaria_loja .......................... [[33mSKIP[0m]
[0m20:04:39.753276 [debug] [Thread-2 (]: Finished running node model.vendas_dw.indicadores_vendas
[0m20:04:39.753649 [info ] [Thread-1 (]: 10 of 10 SKIP relation bronze.mart_receita_mensal_categoria .................... [[33mSKIP[0m]
[0m20:04:39.754066 [debug] [Thread-4 (]: Finished running node model.vendas_dw.mart_receita_diaria_loja
[0m20:04:39.755051 [debug] [Thread-1 (]: Finished running node model.vendas_dw.mart_receita_mensal_categoria
[0m20:04:39.757826 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:39.758270 [debug] [MainThread]: On master: BEGIN
[0m20:04:39.758623 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:04:41.191366 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m20:04:41.191954 [debug] [MainThread]: On master: COMMIT
[0m20:04:41.192216 [debug] [MainThread]: Using postgres connection "master"
[0m20:04:41.192482 [debug] [MainThread]: On master: COMMIT
[0m20:04:41.381658 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:04:41.382572 [debug] [MainThread]: On master: Close
[0m20:04:41.383196 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:04:41.383479 [debug] [MainThread]: Connection 'model.vendas_dw.dim_produtos' was properly closed.
[0m20:04:41.383702 [debug] [MainThread]: Connection 'model.vendas_dw.dim_lojas' was properly closed.
[0m20:04:41.383920 [debug] [MainThread]: Connection 'model.vendas_dw.dim_vendedores' was properly closed.
[0m20:04:41.384135 [debug] [MainThread]: Connection 'model.vendas_dw.stg_vendas' was properly closed.
[0m20:04:41.384456 [info ] [MainThread]: 
[0m20:04:41.384728 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 11.28 seconds (11.28s).
[0m20:04:41.385690 [debug] [MainThread]: Command end result
[0m20:04:41.392032 [info ] [MainThread]: 
[0m20:04:41.392483 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m20:04:41.392766 [info ] [MainThread]: 
[0m20:04:41.393033 [error] [MainThread]: [33mDatabase Error in model stg_devolucoes (models/vendas_dw/silver/stg_devolucoes.sql)[0m
[0m20:04:41.393315 [error] [MainThread]:   syntax error at or near ";"
[0m20:04:41.393578 [error] [MainThread]:   LINE 32: from source;
[0m20:04:41.393826 [error] [MainThread]:                       ^
[0m20:04:41.394070 [error] [MainThread]:   compiled Code at target/run/vendas_dw/models/vendas_dw/silver/stg_devolucoes.sql
[0m20:04:41.394350 [info ] [MainThread]: 
[0m20:04:41.394640 [error] [MainThread]: [33mDatabase Error in model dim_vendedores (models/vendas_dw/silver/dim_vendedores.sql)[0m
[0m20:04:41.394994 [error] [MainThread]:   syntax error at or near ";"
[0m20:04:41.395403 [error] [MainThread]:   LINE 27: from source;
[0m20:04:41.395800 [error] [MainThread]:                       ^
[0m20:04:41.396133 [error] [MainThread]:   compiled Code at target/run/vendas_dw/models/vendas_dw/silver/dim_vendedores.sql
[0m20:04:41.396505 [info ] [MainThread]: 
[0m20:04:41.396962 [error] [MainThread]: [33mDatabase Error in model dim_lojas (models/vendas_dw/silver/dim_lojas.sql)[0m
[0m20:04:41.397404 [error] [MainThread]:   syntax error at or near ";"
[0m20:04:41.397773 [error] [MainThread]:   LINE 30: from source;
[0m20:04:41.398086 [error] [MainThread]:                       ^
[0m20:04:41.398372 [error] [MainThread]:   compiled Code at target/run/vendas_dw/models/vendas_dw/silver/dim_lojas.sql
[0m20:04:41.398679 [info ] [MainThread]: 
[0m20:04:41.399139 [error] [MainThread]: [33mDatabase Error in model dim_produtos (models/vendas_dw/silver/dim_produtos.sql)[0m
[0m20:04:41.399444 [error] [MainThread]:   syntax error at or near ";"
[0m20:04:41.399715 [error] [MainThread]:   LINE 26: from source;
[0m20:04:41.399972 [error] [MainThread]:                       ^
[0m20:04:41.400229 [error] [MainThread]:   compiled Code at target/run/vendas_dw/models/vendas_dw/silver/dim_produtos.sql
[0m20:04:41.400522 [info ] [MainThread]: 
[0m20:04:41.400761 [error] [MainThread]: [33mDatabase Error in model stg_vendas (models/vendas_dw/silver/stg_vendas.sql)[0m
[0m20:04:41.400995 [error] [MainThread]:   syntax error at or near ";"
[0m20:04:41.401217 [error] [MainThread]:   LINE 32: from source;
[0m20:04:41.401456 [error] [MainThread]:                       ^
[0m20:04:41.401680 [error] [MainThread]:   compiled Code at target/run/vendas_dw/models/vendas_dw/silver/stg_vendas.sql
[0m20:04:41.401923 [info ] [MainThread]: 
[0m20:04:41.402186 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=5 TOTAL=10
[0m20:04:41.402641 [debug] [MainThread]: Command `dbt run` failed at 20:04:41.402553 after 371.11 seconds
[0m20:04:41.403022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff7ee6bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff7e431d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feff78d0c90>]}
[0m20:04:41.403420 [debug] [MainThread]: Flushing usage events
[0m20:14:17.871683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08708321d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0870671f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f087099dcd0>]}


============================== 20:14:17.874953 | ae8541f4-1ea5-42ca-943f-3c62d47b16e9 ==============================
[0m20:14:17.874953 [info ] [MainThread]: Running with dbt=1.6.0
[0m20:14:17.875458 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'use_colors': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/home/walterg/.dbt', 'target_path': 'None', 'printer_width': '80', 'fail_fast': 'False', 'quiet': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'use_experimental_parser': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'warn_error': 'None', 'no_print': 'None', 'partial_parse': 'True'}
[0m20:14:17.938505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae8541f4-1ea5-42ca-943f-3c62d47b16e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08709ab190>]}
[0m20:14:17.950797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae8541f4-1ea5-42ca-943f-3c62d47b16e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0870182f90>]}
[0m20:14:17.951456 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m20:14:17.958466 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m20:14:17.974792 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m20:14:17.975390 [debug] [MainThread]: Partial parsing: updated file: vendas_dw://models/vendas_dw/silver/dim_lojas.sql
[0m20:14:17.975743 [debug] [MainThread]: Partial parsing: updated file: vendas_dw://models/vendas_dw/silver/dim_vendedores.sql
[0m20:14:17.976036 [debug] [MainThread]: Partial parsing: updated file: vendas_dw://models/vendas_dw/silver/stg_devolucoes.sql
[0m20:14:17.976373 [debug] [MainThread]: Partial parsing: updated file: vendas_dw://models/vendas_dw/silver/dim_produtos.sql
[0m20:14:17.976784 [debug] [MainThread]: Partial parsing: updated file: vendas_dw://models/vendas_dw/silver/stg_vendas.sql
[0m20:14:18.019035 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vendas_dw.bronze
- models.vendas_dw.gold
- models.vendas_dw.silver
[0m20:14:18.022885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae8541f4-1ea5-42ca-943f-3c62d47b16e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f086fd3d990>]}
[0m20:14:18.032035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae8541f4-1ea5-42ca-943f-3c62d47b16e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08701b9310>]}
[0m20:14:18.032565 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m20:14:18.032870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae8541f4-1ea5-42ca-943f-3c62d47b16e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08706a8050>]}
[0m20:14:18.034596 [info ] [MainThread]: 
[0m20:14:18.035333 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:14:18.037407 [debug] [ThreadPool]: Acquiring new postgres connection 'list_general_rtxt'
[0m20:14:18.044507 [debug] [ThreadPool]: Acquiring new postgres connection 'list_general_rtxt'
[0m20:14:18.049468 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt"
[0m20:14:18.051983 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt"
[0m20:14:18.052506 [debug] [ThreadPool]: On list_general_rtxt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt"} */

    select distinct nspname from pg_namespace
  
[0m20:14:18.053056 [debug] [ThreadPool]: On list_general_rtxt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt"} */

    select distinct nspname from pg_namespace
  
[0m20:14:18.053419 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:14:18.053718 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:14:19.542820 [debug] [ThreadPool]: SQL status: SELECT 7 in 1.0 seconds
[0m20:14:19.544868 [debug] [ThreadPool]: On list_general_rtxt: Close
[0m20:14:19.652864 [debug] [ThreadPool]: SQL status: SELECT 7 in 2.0 seconds
[0m20:14:19.654541 [debug] [ThreadPool]: On list_general_rtxt: Close
[0m20:14:19.657020 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_general_rtxt, now list_general_rtxt_bronze_silver)
[0m20:14:19.661541 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_silver"
[0m20:14:19.662445 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_general_rtxt, now list_general_rtxt_bronze)
[0m20:14:19.662749 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: BEGIN
[0m20:14:19.664457 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze"
[0m20:14:19.664930 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:14:19.665453 [debug] [ThreadPool]: On list_general_rtxt_bronze: BEGIN
[0m20:14:19.665866 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:14:21.115000 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m20:14:21.115414 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze"
[0m20:14:21.115673 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m20:14:21.115944 [debug] [ThreadPool]: On list_general_rtxt_bronze: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt_bronze"} */
select
      'general_rtxt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze'
    union all
    select
      'general_rtxt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze'
    union all
    select
      'general_rtxt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze'
  
[0m20:14:21.116260 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_silver"
[0m20:14:21.116630 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt_bronze_silver"} */
select
      'general_rtxt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze_silver'
    union all
    select
      'general_rtxt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze_silver'
    union all
    select
      'general_rtxt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze_silver'
  
[0m20:14:21.318527 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m20:14:21.320215 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: ROLLBACK
[0m20:14:21.320565 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m20:14:21.321763 [debug] [ThreadPool]: On list_general_rtxt_bronze: ROLLBACK
[0m20:14:21.558586 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: Close
[0m20:14:21.602956 [debug] [ThreadPool]: On list_general_rtxt_bronze: Close
[0m20:14:21.608263 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:21.608619 [debug] [MainThread]: On master: BEGIN
[0m20:14:21.608843 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:14:22.975668 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m20:14:22.976312 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:22.976608 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:14:23.166765 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m20:14:23.168002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae8541f4-1ea5-42ca-943f-3c62d47b16e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f087203dd90>]}
[0m20:14:23.168406 [debug] [MainThread]: On master: ROLLBACK
[0m20:14:23.354691 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:23.355314 [debug] [MainThread]: On master: BEGIN
[0m20:14:23.723968 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:14:23.724524 [debug] [MainThread]: On master: COMMIT
[0m20:14:23.724759 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:23.724982 [debug] [MainThread]: On master: COMMIT
[0m20:14:23.929347 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:14:23.929996 [debug] [MainThread]: On master: Close
[0m20:14:23.930636 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:14:23.930926 [info ] [MainThread]: 
[0m20:14:23.933778 [debug] [Thread-1 (]: Began running node model.vendas_dw.dim_lojas
[0m20:14:23.934407 [debug] [Thread-2 (]: Began running node model.vendas_dw.dim_produtos
[0m20:14:23.934943 [debug] [Thread-3 (]: Began running node model.vendas_dw.dim_vendedores
[0m20:14:23.935570 [debug] [Thread-4 (]: Began running node model.vendas_dw.stg_devolucoes
[0m20:14:23.935978 [info ] [Thread-1 (]: 1 of 10 START sql table model bronze.dim_lojas ................................. [RUN]
[0m20:14:23.936495 [info ] [Thread-2 (]: 2 of 10 START sql table model bronze.dim_produtos .............................. [RUN]
[0m20:14:23.936928 [info ] [Thread-3 (]: 3 of 10 START sql table model bronze.dim_vendedores ............................ [RUN]
[0m20:14:23.937380 [info ] [Thread-4 (]: 4 of 10 START sql table model bronze.stg_devolucoes ............................ [RUN]
[0m20:14:23.938031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_general_rtxt_bronze, now model.vendas_dw.dim_lojas)
[0m20:14:23.938576 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_general_rtxt_bronze_silver, now model.vendas_dw.dim_produtos)
[0m20:14:23.939273 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.vendas_dw.dim_vendedores'
[0m20:14:23.939901 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.vendas_dw.stg_devolucoes'
[0m20:14:23.940316 [debug] [Thread-1 (]: Began compiling node model.vendas_dw.dim_lojas
[0m20:14:23.940912 [debug] [Thread-2 (]: Began compiling node model.vendas_dw.dim_produtos
[0m20:14:23.941500 [debug] [Thread-3 (]: Began compiling node model.vendas_dw.dim_vendedores
[0m20:14:23.941862 [debug] [Thread-4 (]: Began compiling node model.vendas_dw.stg_devolucoes
[0m20:14:23.948135 [debug] [Thread-1 (]: Writing injected SQL for node "model.vendas_dw.dim_lojas"
[0m20:14:23.951470 [debug] [Thread-2 (]: Writing injected SQL for node "model.vendas_dw.dim_produtos"
[0m20:14:23.954219 [debug] [Thread-3 (]: Writing injected SQL for node "model.vendas_dw.dim_vendedores"
[0m20:14:23.957428 [debug] [Thread-4 (]: Writing injected SQL for node "model.vendas_dw.stg_devolucoes"
[0m20:14:23.958761 [debug] [Thread-1 (]: Timing info for model.vendas_dw.dim_lojas (compile): 20:14:23.942279 => 20:14:23.958304
[0m20:14:23.959684 [debug] [Thread-2 (]: Timing info for model.vendas_dw.dim_produtos (compile): 20:14:23.948567 => 20:14:23.959388
[0m20:14:23.960452 [debug] [Thread-1 (]: Began executing node model.vendas_dw.dim_lojas
[0m20:14:23.960969 [debug] [Thread-3 (]: Timing info for model.vendas_dw.dim_vendedores (compile): 20:14:23.951908 => 20:14:23.960775
[0m20:14:23.961367 [debug] [Thread-2 (]: Began executing node model.vendas_dw.dim_produtos
[0m20:14:23.961764 [debug] [Thread-4 (]: Timing info for model.vendas_dw.stg_devolucoes (compile): 20:14:23.954603 => 20:14:23.961616
[0m20:14:23.984382 [debug] [Thread-3 (]: Began executing node model.vendas_dw.dim_vendedores
[0m20:14:23.992531 [debug] [Thread-1 (]: Writing runtime sql for node "model.vendas_dw.dim_lojas"
[0m20:14:23.996285 [debug] [Thread-2 (]: Writing runtime sql for node "model.vendas_dw.dim_produtos"
[0m20:14:23.996904 [debug] [Thread-4 (]: Began executing node model.vendas_dw.stg_devolucoes
[0m20:14:24.000704 [debug] [Thread-3 (]: Writing runtime sql for node "model.vendas_dw.dim_vendedores"
[0m20:14:24.004527 [debug] [Thread-4 (]: Writing runtime sql for node "model.vendas_dw.stg_devolucoes"
[0m20:14:24.005113 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m20:14:24.005853 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m20:14:24.006407 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m20:14:24.006779 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: BEGIN
[0m20:14:24.007181 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m20:14:24.007491 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: BEGIN
[0m20:14:24.007814 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: BEGIN
[0m20:14:24.008146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:24.008517 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: BEGIN
[0m20:14:24.008890 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:14:24.009224 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:14:24.009799 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:14:25.396804 [debug] [Thread-4 (]: SQL status: BEGIN in 1.0 seconds
[0m20:14:25.397688 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m20:14:25.397984 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_devolucoes"} */

  
    

  create  table "general_rtxt"."bronze"."stg_devolucoes__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id_venda       as bigint)              as id_venda,
        cast(id_produto     as int)                 as id_produto,
        cast(preco          as numeric(12,2))       as preco,
        cast(quantidade     as int)                 as quantidade,
        cast(data_venda     as date)                as data_venda,
        cast(data_devolucao as date)                as data_devolucao,
        cast(id_cliente     as int)                 as id_cliente,
        cast(id_loja        as int)                 as id_loja,
        cast(id_vendedor    as int)                 as id_vendedor,
        motivo
    from "general_rtxt"."bronze"."devolucoes"

)

select *
from src;
  );
  
[0m20:14:25.406475 [debug] [Thread-2 (]: SQL status: BEGIN in 1.0 seconds
[0m20:14:25.407071 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m20:14:25.407408 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_produtos"} */

  
    

  create  table "general_rtxt"."bronze"."dim_produtos__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id_produto         as int)           as id_produto,
        nome_produto,
        categoria,
        cast(percentual_imposto as numeric(5,2))  as percentual_imposto
    from "general_rtxt"."bronze"."produtos"

)

select *
from src;
  );
  
[0m20:14:25.586797 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 32: from src;
                 ^

[0m20:14:25.587224 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: ROLLBACK
[0m20:14:25.597773 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 26: from src;
                 ^

[0m20:14:25.598315 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: ROLLBACK
[0m20:14:25.603870 [debug] [Thread-3 (]: SQL status: BEGIN in 2.0 seconds
[0m20:14:25.604362 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m20:14:25.604639 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_vendedores"} */

  
    

  create  table "general_rtxt"."bronze"."dim_vendedores__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id                as int)   as id_vendedor,
        nome_vendedor,
        cast(data_admissao     as date)  as data_admissao,
        endereco_vendedor,
        cast(data_nascimento   as date)  as data_nascimento
    from "general_rtxt"."bronze"."vendedores"

)

select *
from src;
  );
  
[0m20:14:25.622835 [debug] [Thread-1 (]: SQL status: BEGIN in 2.0 seconds
[0m20:14:25.623352 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m20:14:25.623634 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_lojas"} */

  
    

  create  table "general_rtxt"."bronze"."dim_lojas__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id_loja  as int)   as id_loja,
        nome_loja,
        logradouro,
        cast("número" as int)   as numero,
        bairro,
        cidade,
        estado,
        cep
    from "general_rtxt"."bronze"."lojas"

)

select *
from src;
  );
  
[0m20:14:25.774343 [debug] [Thread-4 (]: Timing info for model.vendas_dw.stg_devolucoes (execute): 20:14:24.001533 => 20:14:25.773807
[0m20:14:25.774849 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: Close
[0m20:14:25.777700 [debug] [Thread-4 (]: Database Error in model stg_devolucoes (models/vendas_dw/silver/stg_devolucoes.sql)
  syntax error at or near ";"
  LINE 32: from src;
                   ^
  compiled Code at target/run/vendas_dw/models/vendas_dw/silver/stg_devolucoes.sql
[0m20:14:25.778150 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae8541f4-1ea5-42ca-943f-3c62d47b16e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f086fc34c50>]}
[0m20:14:25.778635 [error] [Thread-4 (]: 4 of 10 ERROR creating sql table model bronze.stg_devolucoes ................... [[31mERROR[0m in 1.84s]
[0m20:14:25.779095 [debug] [Thread-4 (]: Finished running node model.vendas_dw.stg_devolucoes
[0m20:14:25.779484 [debug] [Thread-4 (]: Began running node model.vendas_dw.stg_vendas
[0m20:14:25.779827 [info ] [Thread-4 (]: 5 of 10 START sql table model bronze.stg_vendas ................................ [RUN]
[0m20:14:25.781569 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.vendas_dw.stg_devolucoes, now model.vendas_dw.stg_vendas)
[0m20:14:25.781944 [debug] [Thread-4 (]: Began compiling node model.vendas_dw.stg_vendas
[0m20:14:25.784396 [debug] [Thread-4 (]: Writing injected SQL for node "model.vendas_dw.stg_vendas"
[0m20:14:25.785500 [debug] [Thread-4 (]: Timing info for model.vendas_dw.stg_vendas (compile): 20:14:25.782179 => 20:14:25.785284
[0m20:14:25.785834 [debug] [Thread-4 (]: Began executing node model.vendas_dw.stg_vendas
[0m20:14:25.789148 [debug] [Thread-4 (]: Writing runtime sql for node "model.vendas_dw.stg_vendas"
[0m20:14:25.790100 [debug] [Thread-2 (]: Timing info for model.vendas_dw.dim_produtos (execute): 20:14:23.992966 => 20:14:25.789841
[0m20:14:25.790710 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 27: from src;
                 ^

[0m20:14:25.791291 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: Close
[0m20:14:25.791646 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_vendas"
[0m20:14:25.792099 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: ROLLBACK
[0m20:14:25.792744 [debug] [Thread-4 (]: On model.vendas_dw.stg_vendas: BEGIN
[0m20:14:25.794366 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:14:25.795752 [debug] [Thread-2 (]: Database Error in model dim_produtos (models/vendas_dw/silver/dim_produtos.sql)
  syntax error at or near ";"
  LINE 26: from src;
                   ^
  compiled Code at target/run/vendas_dw/models/vendas_dw/silver/dim_produtos.sql
[0m20:14:25.796305 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae8541f4-1ea5-42ca-943f-3c62d47b16e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08701f8610>]}
[0m20:14:25.796784 [error] [Thread-2 (]: 2 of 10 ERROR creating sql table model bronze.dim_produtos ..................... [[31mERROR[0m in 1.86s]
[0m20:14:25.797226 [debug] [Thread-2 (]: Finished running node model.vendas_dw.dim_produtos
[0m20:14:25.797629 [debug] [Thread-2 (]: Began running node model.vendas_dw.fct_devolucoes
[0m20:14:25.797934 [info ] [Thread-2 (]: 6 of 10 SKIP relation bronze.fct_devolucoes .................................... [[33mSKIP[0m]
[0m20:14:25.798700 [debug] [Thread-2 (]: Finished running node model.vendas_dw.fct_devolucoes
[0m20:14:25.808570 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 30: from src;
                 ^

[0m20:14:25.809565 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: ROLLBACK
[0m20:14:25.979787 [debug] [Thread-3 (]: Timing info for model.vendas_dw.dim_vendedores (execute): 20:14:23.997443 => 20:14:25.979321
[0m20:14:25.980434 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: Close
[0m20:14:25.982174 [debug] [Thread-3 (]: Database Error in model dim_vendedores (models/vendas_dw/silver/dim_vendedores.sql)
  syntax error at or near ";"
  LINE 27: from src;
                   ^
  compiled Code at target/run/vendas_dw/models/vendas_dw/silver/dim_vendedores.sql
[0m20:14:25.982584 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae8541f4-1ea5-42ca-943f-3c62d47b16e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f086fd25750>]}
[0m20:14:25.983008 [error] [Thread-3 (]: 3 of 10 ERROR creating sql table model bronze.dim_vendedores ................... [[31mERROR[0m in 2.04s]
[0m20:14:25.983498 [debug] [Thread-3 (]: Finished running node model.vendas_dw.dim_vendedores
[0m20:14:25.996077 [debug] [Thread-1 (]: Timing info for model.vendas_dw.dim_lojas (execute): 20:14:23.963397 => 20:14:25.995435
[0m20:14:25.997438 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: Close
[0m20:14:26.000571 [debug] [Thread-1 (]: Database Error in model dim_lojas (models/vendas_dw/silver/dim_lojas.sql)
  syntax error at or near ";"
  LINE 30: from src;
                   ^
  compiled Code at target/run/vendas_dw/models/vendas_dw/silver/dim_lojas.sql
[0m20:14:26.001049 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae8541f4-1ea5-42ca-943f-3c62d47b16e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f086fc19e50>]}
[0m20:14:26.001507 [error] [Thread-1 (]: 1 of 10 ERROR creating sql table model bronze.dim_lojas ........................ [[31mERROR[0m in 2.06s]
[0m20:14:26.001952 [debug] [Thread-1 (]: Finished running node model.vendas_dw.dim_lojas
[0m20:14:27.180172 [debug] [Thread-4 (]: SQL status: BEGIN in 1.0 seconds
[0m20:14:27.181088 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_vendas"
[0m20:14:27.181402 [debug] [Thread-4 (]: On model.vendas_dw.stg_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_vendas"} */

  
    

  create  table "general_rtxt"."bronze"."stg_vendas__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id_venda      as bigint)               as id_venda,
        cast(id_produto    as int)                  as id_produto,
        cast(preco         as numeric(12,2))        as preco,
        cast(quantidade    as int)                  as quantidade,
        cast(data_venda    as date)                 as data_venda,
        cast(id_cliente    as int)                  as id_cliente,
        cast(id_loja       as int)                  as id_loja,
        cast(id_vendedor   as int)                  as id_vendedor,
        lower(trim(meio_pagamento))                 as meio_pagamento,
        cast(parcelamento  as smallint)             as parcelamento
    from "general_rtxt"."bronze"."vendas"

)

select *
from src;
  );
  
[0m20:14:27.377628 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 32: from src;
                 ^

[0m20:14:27.378230 [debug] [Thread-4 (]: On model.vendas_dw.stg_vendas: ROLLBACK
[0m20:14:27.563979 [debug] [Thread-4 (]: Timing info for model.vendas_dw.stg_vendas (execute): 20:14:25.786035 => 20:14:27.563547
[0m20:14:27.564557 [debug] [Thread-4 (]: On model.vendas_dw.stg_vendas: Close
[0m20:14:27.566369 [debug] [Thread-4 (]: Database Error in model stg_vendas (models/vendas_dw/silver/stg_vendas.sql)
  syntax error at or near ";"
  LINE 32: from src;
                   ^
  compiled Code at target/run/vendas_dw/models/vendas_dw/silver/stg_vendas.sql
[0m20:14:27.566775 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae8541f4-1ea5-42ca-943f-3c62d47b16e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f086fd1a4d0>]}
[0m20:14:27.567196 [error] [Thread-4 (]: 5 of 10 ERROR creating sql table model bronze.stg_vendas ....................... [[31mERROR[0m in 1.79s]
[0m20:14:27.567648 [debug] [Thread-4 (]: Finished running node model.vendas_dw.stg_vendas
[0m20:14:27.569332 [debug] [Thread-2 (]: Began running node model.vendas_dw.fct_vendas
[0m20:14:27.570064 [info ] [Thread-2 (]: 7 of 10 SKIP relation bronze.fct_vendas ........................................ [[33mSKIP[0m]
[0m20:14:27.570641 [debug] [Thread-2 (]: Finished running node model.vendas_dw.fct_vendas
[0m20:14:27.573403 [debug] [Thread-1 (]: Began running node model.vendas_dw.indicadores_vendas
[0m20:14:27.574445 [debug] [Thread-4 (]: Began running node model.vendas_dw.mart_receita_diaria_loja
[0m20:14:27.574829 [info ] [Thread-1 (]: 8 of 10 SKIP relation bronze_silver.indicadores_vendas ......................... [[33mSKIP[0m]
[0m20:14:27.575377 [debug] [Thread-3 (]: Began running node model.vendas_dw.mart_receita_mensal_categoria
[0m20:14:27.575780 [info ] [Thread-4 (]: 9 of 10 SKIP relation bronze.mart_receita_diaria_loja .......................... [[33mSKIP[0m]
[0m20:14:27.576189 [debug] [Thread-1 (]: Finished running node model.vendas_dw.indicadores_vendas
[0m20:14:27.576597 [info ] [Thread-3 (]: 10 of 10 SKIP relation bronze.mart_receita_mensal_categoria .................... [[33mSKIP[0m]
[0m20:14:27.576971 [debug] [Thread-4 (]: Finished running node model.vendas_dw.mart_receita_diaria_loja
[0m20:14:27.577903 [debug] [Thread-3 (]: Finished running node model.vendas_dw.mart_receita_mensal_categoria
[0m20:14:27.581210 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:27.581694 [debug] [MainThread]: On master: BEGIN
[0m20:14:27.581925 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:14:28.951313 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m20:14:28.952096 [debug] [MainThread]: On master: COMMIT
[0m20:14:28.952362 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:28.952588 [debug] [MainThread]: On master: COMMIT
[0m20:14:29.139484 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:14:29.140020 [debug] [MainThread]: On master: Close
[0m20:14:29.140620 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:14:29.140852 [debug] [MainThread]: Connection 'model.vendas_dw.dim_lojas' was properly closed.
[0m20:14:29.141061 [debug] [MainThread]: Connection 'model.vendas_dw.dim_produtos' was properly closed.
[0m20:14:29.141290 [debug] [MainThread]: Connection 'model.vendas_dw.dim_vendedores' was properly closed.
[0m20:14:29.141507 [debug] [MainThread]: Connection 'model.vendas_dw.stg_vendas' was properly closed.
[0m20:14:29.141805 [info ] [MainThread]: 
[0m20:14:29.142080 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 11.11 seconds (11.11s).
[0m20:14:29.143121 [debug] [MainThread]: Command end result
[0m20:14:29.149569 [info ] [MainThread]: 
[0m20:14:29.149978 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m20:14:29.150337 [info ] [MainThread]: 
[0m20:14:29.150659 [error] [MainThread]: [33mDatabase Error in model stg_devolucoes (models/vendas_dw/silver/stg_devolucoes.sql)[0m
[0m20:14:29.150961 [error] [MainThread]:   syntax error at or near ";"
[0m20:14:29.151262 [error] [MainThread]:   LINE 32: from src;
[0m20:14:29.151562 [error] [MainThread]:                    ^
[0m20:14:29.151844 [error] [MainThread]:   compiled Code at target/run/vendas_dw/models/vendas_dw/silver/stg_devolucoes.sql
[0m20:14:29.152198 [info ] [MainThread]: 
[0m20:14:29.152533 [error] [MainThread]: [33mDatabase Error in model dim_produtos (models/vendas_dw/silver/dim_produtos.sql)[0m
[0m20:14:29.152826 [error] [MainThread]:   syntax error at or near ";"
[0m20:14:29.153109 [error] [MainThread]:   LINE 26: from src;
[0m20:14:29.153453 [error] [MainThread]:                    ^
[0m20:14:29.153772 [error] [MainThread]:   compiled Code at target/run/vendas_dw/models/vendas_dw/silver/dim_produtos.sql
[0m20:14:29.154140 [info ] [MainThread]: 
[0m20:14:29.154700 [error] [MainThread]: [33mDatabase Error in model dim_vendedores (models/vendas_dw/silver/dim_vendedores.sql)[0m
[0m20:14:29.155196 [error] [MainThread]:   syntax error at or near ";"
[0m20:14:29.155571 [error] [MainThread]:   LINE 27: from src;
[0m20:14:29.156012 [error] [MainThread]:                    ^
[0m20:14:29.156400 [error] [MainThread]:   compiled Code at target/run/vendas_dw/models/vendas_dw/silver/dim_vendedores.sql
[0m20:14:29.156701 [info ] [MainThread]: 
[0m20:14:29.156989 [error] [MainThread]: [33mDatabase Error in model dim_lojas (models/vendas_dw/silver/dim_lojas.sql)[0m
[0m20:14:29.157271 [error] [MainThread]:   syntax error at or near ";"
[0m20:14:29.157574 [error] [MainThread]:   LINE 30: from src;
[0m20:14:29.157855 [error] [MainThread]:                    ^
[0m20:14:29.158121 [error] [MainThread]:   compiled Code at target/run/vendas_dw/models/vendas_dw/silver/dim_lojas.sql
[0m20:14:29.158422 [info ] [MainThread]: 
[0m20:14:29.158739 [error] [MainThread]: [33mDatabase Error in model stg_vendas (models/vendas_dw/silver/stg_vendas.sql)[0m
[0m20:14:29.159048 [error] [MainThread]:   syntax error at or near ";"
[0m20:14:29.159372 [error] [MainThread]:   LINE 32: from src;
[0m20:14:29.159739 [error] [MainThread]:                    ^
[0m20:14:29.160026 [error] [MainThread]:   compiled Code at target/run/vendas_dw/models/vendas_dw/silver/stg_vendas.sql
[0m20:14:29.160366 [info ] [MainThread]: 
[0m20:14:29.160813 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=5 TOTAL=10
[0m20:14:29.161357 [debug] [MainThread]: Command `dbt run` failed at 20:14:29.161230 after 11.30 seconds
[0m20:14:29.161705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f087038bdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f087038b3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f087068da90>]}
[0m20:14:29.162018 [debug] [MainThread]: Flushing usage events
[0m20:18:17.151362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9655aa9150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9655d4aa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9655a17e50>]}


============================== 20:18:17.154178 | 88b9f625-de85-42f6-9e17-de93c8d757db ==============================
[0m20:18:17.154178 [info ] [MainThread]: Running with dbt=1.6.0
[0m20:18:17.154731 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'fail_fast': 'False', 'introspect': 'True', 'partial_parse': 'True', 'no_print': 'None', 'printer_width': '80', 'debug': 'False', 'log_format': 'default', 'profiles_dir': '/home/walterg/.dbt', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'indirect_selection': 'eager', 'static_parser': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select silver', 'write_json': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'warn_error': 'None'}
[0m20:18:17.215498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88b9f625-de85-42f6-9e17-de93c8d757db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f965574c390>]}
[0m20:18:17.228231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88b9f625-de85-42f6-9e17-de93c8d757db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9655917450>]}
[0m20:18:17.228897 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m20:18:17.236615 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m20:18:17.244549 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:18:17.245052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '88b9f625-de85-42f6-9e17-de93c8d757db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9655d4aa50>]}
[0m20:18:17.766489 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.vendas_dw.bronze
- models.vendas_dw.silver
- models.vendas_dw.gold
[0m20:18:17.770409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88b9f625-de85-42f6-9e17-de93c8d757db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f965573e090>]}
[0m20:18:17.779783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88b9f625-de85-42f6-9e17-de93c8d757db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f965519fd50>]}
[0m20:18:17.780625 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m20:18:17.781035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88b9f625-de85-42f6-9e17-de93c8d757db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f965a25ed90>]}
[0m20:18:17.781686 [warn ] [MainThread]: The selection criterion 'silver' does not match any nodes
[0m20:18:17.782794 [info ] [MainThread]: 
[0m20:18:17.783122 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:18:17.783574 [debug] [MainThread]: Command end result
[0m20:18:17.789667 [debug] [MainThread]: Command `dbt run` succeeded at 20:18:17.789509 after 0.64 seconds
[0m20:18:17.790086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9655de0a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9655e8e010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9655bf11d0>]}
[0m20:18:17.790456 [debug] [MainThread]: Flushing usage events
[0m20:20:03.903708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22a2b62510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22a26b5950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22a36e3410>]}


============================== 20:20:03.906618 | 62764b78-46d9-4dab-ad3c-bf7f176a12ec ==============================
[0m20:20:03.906618 [info ] [MainThread]: Running with dbt=1.6.0
[0m20:20:03.907100 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'log_format': 'default', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'warn_error': 'None', 'write_json': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt clean', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'introspect': 'True', 'profiles_dir': '/home/walterg/.dbt', 'quiet': 'False', 'version_check': 'True', 'target_path': 'None'}
[0m20:20:03.934769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62764b78-46d9-4dab-ad3c-bf7f176a12ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22a2b63710>]}
[0m20:20:03.943850 [debug] [MainThread]: Command `dbt clean` succeeded at 20:20:03.943762 after 0.05 seconds
[0m20:20:03.944269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22a2b6c6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22a29c2f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22a2937690>]}
[0m20:20:03.944654 [debug] [MainThread]: Flushing usage events
[0m20:20:06.338495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f282cb99a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f282c8f6810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f282cbcd3d0>]}


============================== 20:20:06.342309 | 888124a2-2157-401b-b885-f578090b0b1b ==============================
[0m20:20:06.342309 [info ] [MainThread]: Running with dbt=1.6.0
[0m20:20:06.342763 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'partial_parse': 'True', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'introspect': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'printer_width': '80', 'invocation_command': 'dbt run', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'use_colors': 'True', 'version_check': 'True', 'fail_fast': 'False', 'no_print': 'None', 'log_format': 'default', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'profiles_dir': '/home/walterg/.dbt', 'log_cache_events': 'False', 'static_parser': 'True', 'write_json': 'True'}
[0m20:20:06.401495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '888124a2-2157-401b-b885-f578090b0b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f282c579c90>]}
[0m20:20:06.413589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '888124a2-2157-401b-b885-f578090b0b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f282c579c90>]}
[0m20:20:06.414207 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m20:20:06.421227 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m20:20:06.421753 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:20:06.422054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '888124a2-2157-401b-b885-f578090b0b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f282ca31cd0>]}
[0m20:20:06.932307 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.bronze
- models.gold
- models.silver
[0m20:20:06.936164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '888124a2-2157-401b-b885-f578090b0b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f282c177490>]}
[0m20:20:06.944784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '888124a2-2157-401b-b885-f578090b0b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f282c002fd0>]}
[0m20:20:06.945223 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m20:20:06.945531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '888124a2-2157-401b-b885-f578090b0b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f282c137ad0>]}
[0m20:20:06.947224 [info ] [MainThread]: 
[0m20:20:06.948172 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:20:06.949712 [debug] [ThreadPool]: Acquiring new postgres connection 'list_general_rtxt'
[0m20:20:06.956221 [debug] [ThreadPool]: Acquiring new postgres connection 'list_general_rtxt'
[0m20:20:06.960871 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt"
[0m20:20:06.962882 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt"
[0m20:20:06.963362 [debug] [ThreadPool]: On list_general_rtxt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt"} */

    select distinct nspname from pg_namespace
  
[0m20:20:06.963767 [debug] [ThreadPool]: On list_general_rtxt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt"} */

    select distinct nspname from pg_namespace
  
[0m20:20:06.964327 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:20:06.964972 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:20:08.445981 [debug] [ThreadPool]: SQL status: SELECT 7 in 1.0 seconds
[0m20:20:08.447922 [debug] [ThreadPool]: On list_general_rtxt: Close
[0m20:20:08.534602 [debug] [ThreadPool]: SQL status: SELECT 7 in 2.0 seconds
[0m20:20:08.536199 [debug] [ThreadPool]: On list_general_rtxt: Close
[0m20:20:08.538795 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_general_rtxt, now list_general_rtxt_bronze_silver)
[0m20:20:08.539892 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_general_rtxt, now list_general_rtxt_bronze)
[0m20:20:08.544702 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_silver"
[0m20:20:08.547308 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze"
[0m20:20:08.547720 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: BEGIN
[0m20:20:08.548409 [debug] [ThreadPool]: On list_general_rtxt_bronze: BEGIN
[0m20:20:08.548887 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:20:08.549445 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:20:10.010776 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m20:20:10.011698 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze"
[0m20:20:10.011952 [debug] [ThreadPool]: On list_general_rtxt_bronze: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt_bronze"} */
select
      'general_rtxt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze'
    union all
    select
      'general_rtxt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze'
    union all
    select
      'general_rtxt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze'
  
[0m20:20:10.075364 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m20:20:10.076280 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_silver"
[0m20:20:10.076887 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt_bronze_silver"} */
select
      'general_rtxt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze_silver'
    union all
    select
      'general_rtxt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze_silver'
    union all
    select
      'general_rtxt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze_silver'
  
[0m20:20:10.203074 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m20:20:10.205091 [debug] [ThreadPool]: On list_general_rtxt_bronze: ROLLBACK
[0m20:20:10.266951 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m20:20:10.268649 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: ROLLBACK
[0m20:20:10.391808 [debug] [ThreadPool]: On list_general_rtxt_bronze: Close
[0m20:20:10.463444 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: Close
[0m20:20:10.467567 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:10.468194 [debug] [MainThread]: On master: BEGIN
[0m20:20:10.468449 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:20:11.844426 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m20:20:11.845098 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:11.845393 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:20:12.040439 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m20:20:12.041842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '888124a2-2157-401b-b885-f578090b0b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f282c8f5b90>]}
[0m20:20:12.042220 [debug] [MainThread]: On master: ROLLBACK
[0m20:20:12.226319 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:12.227049 [debug] [MainThread]: On master: BEGIN
[0m20:20:12.597505 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:20:12.598381 [debug] [MainThread]: On master: COMMIT
[0m20:20:12.598889 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:12.599394 [debug] [MainThread]: On master: COMMIT
[0m20:20:12.783307 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:20:12.783905 [debug] [MainThread]: On master: Close
[0m20:20:12.784756 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:20:12.785084 [info ] [MainThread]: 
[0m20:20:12.788340 [debug] [Thread-1 (]: Began running node model.vendas_dw.dim_lojas
[0m20:20:12.788962 [debug] [Thread-2 (]: Began running node model.vendas_dw.dim_produtos
[0m20:20:12.789503 [debug] [Thread-3 (]: Began running node model.vendas_dw.dim_vendedores
[0m20:20:12.790014 [debug] [Thread-4 (]: Began running node model.vendas_dw.stg_devolucoes
[0m20:20:12.790513 [info ] [Thread-1 (]: 1 of 10 START sql table model bronze.dim_lojas ................................. [RUN]
[0m20:20:12.791197 [info ] [Thread-2 (]: 2 of 10 START sql table model bronze.dim_produtos .............................. [RUN]
[0m20:20:12.791753 [info ] [Thread-3 (]: 3 of 10 START sql table model bronze.dim_vendedores ............................ [RUN]
[0m20:20:12.792364 [info ] [Thread-4 (]: 4 of 10 START sql table model bronze.stg_devolucoes ............................ [RUN]
[0m20:20:12.793184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_general_rtxt_bronze_silver, now model.vendas_dw.dim_lojas)
[0m20:20:12.793926 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_general_rtxt_bronze, now model.vendas_dw.dim_produtos)
[0m20:20:12.794985 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.vendas_dw.dim_vendedores'
[0m20:20:12.796110 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.vendas_dw.stg_devolucoes'
[0m20:20:12.796805 [debug] [Thread-1 (]: Began compiling node model.vendas_dw.dim_lojas
[0m20:20:12.797459 [debug] [Thread-2 (]: Began compiling node model.vendas_dw.dim_produtos
[0m20:20:12.797911 [debug] [Thread-3 (]: Began compiling node model.vendas_dw.dim_vendedores
[0m20:20:12.798215 [debug] [Thread-4 (]: Began compiling node model.vendas_dw.stg_devolucoes
[0m20:20:12.804499 [debug] [Thread-1 (]: Writing injected SQL for node "model.vendas_dw.dim_lojas"
[0m20:20:12.807431 [debug] [Thread-2 (]: Writing injected SQL for node "model.vendas_dw.dim_produtos"
[0m20:20:12.810582 [debug] [Thread-3 (]: Writing injected SQL for node "model.vendas_dw.dim_vendedores"
[0m20:20:12.813703 [debug] [Thread-4 (]: Writing injected SQL for node "model.vendas_dw.stg_devolucoes"
[0m20:20:12.815378 [debug] [Thread-3 (]: Timing info for model.vendas_dw.dim_vendedores (compile): 20:20:12.807933 => 20:20:12.815144
[0m20:20:12.815835 [debug] [Thread-3 (]: Began executing node model.vendas_dw.dim_vendedores
[0m20:20:12.816212 [debug] [Thread-2 (]: Timing info for model.vendas_dw.dim_produtos (compile): 20:20:12.804987 => 20:20:12.816031
[0m20:20:12.816682 [debug] [Thread-4 (]: Timing info for model.vendas_dw.stg_devolucoes (compile): 20:20:12.811100 => 20:20:12.816477
[0m20:20:12.817332 [debug] [Thread-1 (]: Timing info for model.vendas_dw.dim_lojas (compile): 20:20:12.798498 => 20:20:12.817068
[0m20:20:12.838675 [debug] [Thread-2 (]: Began executing node model.vendas_dw.dim_produtos
[0m20:20:12.845623 [debug] [Thread-3 (]: Writing runtime sql for node "model.vendas_dw.dim_vendedores"
[0m20:20:12.846278 [debug] [Thread-4 (]: Began executing node model.vendas_dw.stg_devolucoes
[0m20:20:12.846951 [debug] [Thread-1 (]: Began executing node model.vendas_dw.dim_lojas
[0m20:20:12.851008 [debug] [Thread-2 (]: Writing runtime sql for node "model.vendas_dw.dim_produtos"
[0m20:20:12.855893 [debug] [Thread-4 (]: Writing runtime sql for node "model.vendas_dw.stg_devolucoes"
[0m20:20:12.860316 [debug] [Thread-1 (]: Writing runtime sql for node "model.vendas_dw.dim_lojas"
[0m20:20:12.861464 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m20:20:12.861832 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: BEGIN
[0m20:20:12.862235 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:20:12.862747 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m20:20:12.863180 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m20:20:12.863557 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: BEGIN
[0m20:20:12.863883 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m20:20:12.864209 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: BEGIN
[0m20:20:12.864573 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:20:12.864926 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: BEGIN
[0m20:20:12.865251 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:20:12.865746 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:20:14.333863 [debug] [Thread-2 (]: SQL status: BEGIN in 1.0 seconds
[0m20:20:14.334408 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m20:20:14.334699 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_produtos"} */

  
    

  create  table "general_rtxt"."bronze"."dim_produtos__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id_produto         as int)           as id_produto,
        nome_produto,
        categoria,
        cast(percentual_imposto as numeric(5,2))  as percentual_imposto
    from "general_rtxt"."bronze"."produtos"

)

select *
from src
  );
  
[0m20:20:14.421922 [debug] [Thread-3 (]: SQL status: BEGIN in 2.0 seconds
[0m20:20:14.422445 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m20:20:14.422725 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_vendedores"} */

  
    

  create  table "general_rtxt"."bronze"."dim_vendedores__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id                as int)   as id_vendedor,
        nome_vendedor,
        cast(data_admissao     as date)  as data_admissao,
        endereco_vendedor,
        cast(data_nascimento   as date)  as data_nascimento
    from "general_rtxt"."bronze"."vendedores"

)

select *
from src
  );
  
[0m20:20:14.473417 [debug] [Thread-1 (]: SQL status: BEGIN in 2.0 seconds
[0m20:20:14.474113 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m20:20:14.474402 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_lojas"} */

  
    

  create  table "general_rtxt"."bronze"."dim_lojas__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id_loja  as int)   as id_loja,
        nome_loja,
        logradouro,
        cast("número" as int)   as numero,
        bairro,
        cidade,
        estado,
        cep
    from "general_rtxt"."bronze"."lojas"

)

select *
from src
  );
  
[0m20:20:14.501128 [debug] [Thread-4 (]: SQL status: BEGIN in 2.0 seconds
[0m20:20:14.501699 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m20:20:14.501982 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_devolucoes"} */

  
    

  create  table "general_rtxt"."bronze"."stg_devolucoes__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id_venda       as bigint)              as id_venda,
        cast(id_produto     as int)                 as id_produto,
        cast(preco          as numeric(12,2))       as preco,
        cast(quantidade     as int)                 as quantidade,
        cast(data_venda     as date)                as data_venda,
        cast(data_devolucao as date)                as data_devolucao,
        cast(id_cliente     as int)                 as id_cliente,
        cast(id_loja        as int)                 as id_loja,
        cast(id_vendedor    as int)                 as id_vendedor,
        motivo
    from "general_rtxt"."bronze"."devolucoes"

)

select *
from src
  );
  
[0m20:20:14.528296 [debug] [Thread-2 (]: SQL status: SELECT 300 in 0.0 seconds
[0m20:20:14.533039 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m20:20:14.533471 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_produtos"} */
alter table "general_rtxt"."bronze"."dim_produtos__dbt_tmp" rename to "dim_produtos"
[0m20:20:14.614085 [debug] [Thread-3 (]: SQL status: SELECT 120 in 0.0 seconds
[0m20:20:14.617367 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m20:20:14.617679 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_vendedores"} */
alter table "general_rtxt"."bronze"."dim_vendedores__dbt_tmp" rename to "dim_vendedores"
[0m20:20:14.668151 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m20:20:14.671076 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m20:20:14.671430 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_lojas"} */
alter table "general_rtxt"."bronze"."dim_lojas__dbt_tmp" rename to "dim_lojas"
[0m20:20:14.760990 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:20:14.774560 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: COMMIT
[0m20:20:14.774969 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m20:20:14.775233 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: COMMIT
[0m20:20:14.814649 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:20:14.816914 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: COMMIT
[0m20:20:14.817204 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m20:20:14.817481 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: COMMIT
[0m20:20:14.857711 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:20:14.860119 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: COMMIT
[0m20:20:14.860472 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m20:20:14.860736 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: COMMIT
[0m20:20:15.025019 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m20:20:15.031587 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m20:20:15.032226 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m20:20:15.032998 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_produtos"} */
drop table if exists "general_rtxt"."bronze"."dim_produtos__dbt_backup" cascade
[0m20:20:15.035137 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m20:20:15.035608 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_vendedores"} */
drop table if exists "general_rtxt"."bronze"."dim_vendedores__dbt_backup" cascade
[0m20:20:15.048729 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:20:15.051204 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m20:20:15.051559 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_lojas"} */
drop table if exists "general_rtxt"."bronze"."dim_lojas__dbt_backup" cascade
[0m20:20:15.221426 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:20:15.223187 [debug] [Thread-2 (]: Timing info for model.vendas_dw.dim_produtos (execute): 20:20:12.847529 => 20:20:15.223052
[0m20:20:15.223740 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:20:15.224545 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: Close
[0m20:20:15.225773 [debug] [Thread-3 (]: Timing info for model.vendas_dw.dim_vendedores (execute): 20:20:12.817662 => 20:20:15.225637
[0m20:20:15.226224 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: Close
[0m20:20:15.226835 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '888124a2-2157-401b-b885-f578090b0b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f282bea2cd0>]}
[0m20:20:15.228142 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '888124a2-2157-401b-b885-f578090b0b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f282d847d90>]}
[0m20:20:15.227397 [info ] [Thread-2 (]: 2 of 10 OK created sql table model bronze.dim_produtos ......................... [[32mSELECT 300[0m in 2.43s]
[0m20:20:15.228921 [info ] [Thread-3 (]: 3 of 10 OK created sql table model bronze.dim_vendedores ....................... [[32mSELECT 120[0m in 2.43s]
[0m20:20:15.229663 [debug] [Thread-2 (]: Finished running node model.vendas_dw.dim_produtos
[0m20:20:15.230146 [debug] [Thread-3 (]: Finished running node model.vendas_dw.dim_vendedores
[0m20:20:15.230571 [debug] [Thread-2 (]: Began running node model.vendas_dw.stg_vendas
[0m20:20:15.231479 [info ] [Thread-2 (]: 5 of 10 START sql table model bronze.stg_vendas ................................ [RUN]
[0m20:20:15.232082 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.vendas_dw.dim_produtos, now model.vendas_dw.stg_vendas)
[0m20:20:15.232708 [debug] [Thread-2 (]: Began compiling node model.vendas_dw.stg_vendas
[0m20:20:15.235084 [debug] [Thread-2 (]: Writing injected SQL for node "model.vendas_dw.stg_vendas"
[0m20:20:15.235827 [debug] [Thread-2 (]: Timing info for model.vendas_dw.stg_vendas (compile): 20:20:15.232956 => 20:20:15.235650
[0m20:20:15.236153 [debug] [Thread-2 (]: Began executing node model.vendas_dw.stg_vendas
[0m20:20:15.239845 [debug] [Thread-2 (]: Writing runtime sql for node "model.vendas_dw.stg_vendas"
[0m20:20:15.240440 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.stg_vendas"
[0m20:20:15.240745 [debug] [Thread-2 (]: On model.vendas_dw.stg_vendas: BEGIN
[0m20:20:15.241006 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:20:15.310925 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:20:15.312289 [debug] [Thread-1 (]: Timing info for model.vendas_dw.dim_lojas (execute): 20:20:12.856306 => 20:20:15.312133
[0m20:20:15.312608 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: Close
[0m20:20:15.313295 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '888124a2-2157-401b-b885-f578090b0b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f282c167c10>]}
[0m20:20:15.313776 [info ] [Thread-1 (]: 1 of 10 OK created sql table model bronze.dim_lojas ............................ [[32mSELECT 15[0m in 2.52s]
[0m20:20:15.314220 [debug] [Thread-1 (]: Finished running node model.vendas_dw.dim_lojas
[0m20:20:15.712990 [debug] [Thread-4 (]: SQL status: SELECT 30000 in 1.0 seconds
[0m20:20:15.715669 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m20:20:15.716010 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_devolucoes"} */
alter table "general_rtxt"."bronze"."stg_devolucoes__dbt_tmp" rename to "stg_devolucoes"
[0m20:20:15.902729 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:20:15.904991 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: COMMIT
[0m20:20:15.905373 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m20:20:15.905634 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: COMMIT
[0m20:20:16.115396 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m20:20:16.117773 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m20:20:16.118103 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_devolucoes"} */
drop table if exists "general_rtxt"."bronze"."stg_devolucoes__dbt_backup" cascade
[0m20:20:16.308284 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:20:16.309752 [debug] [Thread-4 (]: Timing info for model.vendas_dw.stg_devolucoes (execute): 20:20:12.851620 => 20:20:16.309618
[0m20:20:16.310064 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: Close
[0m20:20:16.310711 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '888124a2-2157-401b-b885-f578090b0b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f282c165ad0>]}
[0m20:20:16.311156 [info ] [Thread-4 (]: 4 of 10 OK created sql table model bronze.stg_devolucoes ....................... [[32mSELECT 30000[0m in 3.52s]
[0m20:20:16.311636 [debug] [Thread-4 (]: Finished running node model.vendas_dw.stg_devolucoes
[0m20:20:16.313233 [debug] [Thread-3 (]: Began running node model.vendas_dw.fct_devolucoes
[0m20:20:16.313833 [info ] [Thread-3 (]: 6 of 10 START sql table model bronze.fct_devolucoes ............................ [RUN]
[0m20:20:16.314364 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.vendas_dw.dim_vendedores, now model.vendas_dw.fct_devolucoes)
[0m20:20:16.314660 [debug] [Thread-3 (]: Began compiling node model.vendas_dw.fct_devolucoes
[0m20:20:16.317009 [debug] [Thread-3 (]: Writing injected SQL for node "model.vendas_dw.fct_devolucoes"
[0m20:20:16.317757 [debug] [Thread-3 (]: Timing info for model.vendas_dw.fct_devolucoes (compile): 20:20:16.314860 => 20:20:16.317549
[0m20:20:16.318132 [debug] [Thread-3 (]: Began executing node model.vendas_dw.fct_devolucoes
[0m20:20:16.322832 [debug] [Thread-3 (]: Writing runtime sql for node "model.vendas_dw.fct_devolucoes"
[0m20:20:16.323598 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.fct_devolucoes"
[0m20:20:16.324016 [debug] [Thread-3 (]: On model.vendas_dw.fct_devolucoes: BEGIN
[0m20:20:16.324308 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:20:16.643115 [debug] [Thread-2 (]: SQL status: BEGIN in 1.0 seconds
[0m20:20:16.643908 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.stg_vendas"
[0m20:20:16.644346 [debug] [Thread-2 (]: On model.vendas_dw.stg_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_vendas"} */

  
    

  create  table "general_rtxt"."bronze"."stg_vendas__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id_venda      as bigint)               as id_venda,
        cast(id_produto    as int)                  as id_produto,
        cast(preco         as numeric(12,2))        as preco,
        cast(quantidade    as int)                  as quantidade,
        cast(data_venda    as date)                 as data_venda,
        cast(id_cliente    as int)                  as id_cliente,
        cast(id_loja       as int)                  as id_loja,
        cast(id_vendedor   as int)                  as id_vendedor,
        lower(trim(meio_pagamento))                 as meio_pagamento,
        cast(parcelamento  as smallint)             as parcelamento
    from "general_rtxt"."bronze"."vendas"

)

select *
from src
  );
  
[0m20:20:17.911475 [debug] [Thread-3 (]: SQL status: BEGIN in 2.0 seconds
[0m20:20:17.912109 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.fct_devolucoes"
[0m20:20:17.912410 [debug] [Thread-3 (]: On model.vendas_dw.fct_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_devolucoes"} */

  
    

  create  table "general_rtxt"."bronze"."fct_devolucoes__dbt_tmp"
  
  
    as
  
  (
    

with devol as (
    select * from "general_rtxt"."bronze"."stg_devolucoes"
)

select
    id_venda,
    id_produto,
    id_loja,
    id_vendedor,
    id_cliente,
    data_venda,
    data_devolucao,
    quantidade,
    preco,
    quantidade * preco                             as valor_devolvido,
    motivo
from devol;
  );
  
[0m20:20:18.112031 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 30: from devol;
                   ^

[0m20:20:18.112685 [debug] [Thread-3 (]: On model.vendas_dw.fct_devolucoes: ROLLBACK
[0m20:20:18.313862 [debug] [Thread-3 (]: Timing info for model.vendas_dw.fct_devolucoes (execute): 20:20:16.318382 => 20:20:18.313453
[0m20:20:18.314357 [debug] [Thread-3 (]: On model.vendas_dw.fct_devolucoes: Close
[0m20:20:18.317333 [debug] [Thread-3 (]: Database Error in model fct_devolucoes (models/vendas_dw/gold/fct_devolucoes.sql)
  syntax error at or near ";"
  LINE 30: from devol;
                     ^
  compiled Code at target/run/vendas_dw/models/vendas_dw/gold/fct_devolucoes.sql
[0m20:20:18.317755 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '888124a2-2157-401b-b885-f578090b0b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f282bf14a50>]}
[0m20:20:18.318183 [error] [Thread-3 (]: 6 of 10 ERROR creating sql table model bronze.fct_devolucoes ................... [[31mERROR[0m in 2.00s]
[0m20:20:18.318658 [debug] [Thread-3 (]: Finished running node model.vendas_dw.fct_devolucoes
[0m20:21:28.212856 [debug] [Thread-2 (]: SQL status: SELECT 2000500 in 72.0 seconds
[0m20:21:28.215619 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.stg_vendas"
[0m20:21:28.216006 [debug] [Thread-2 (]: On model.vendas_dw.stg_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_vendas"} */
alter table "general_rtxt"."bronze"."stg_vendas__dbt_tmp" rename to "stg_vendas"
[0m20:21:28.401311 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:21:28.403843 [debug] [Thread-2 (]: On model.vendas_dw.stg_vendas: COMMIT
[0m20:21:28.404202 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.stg_vendas"
[0m20:21:28.404483 [debug] [Thread-2 (]: On model.vendas_dw.stg_vendas: COMMIT
[0m20:21:28.591465 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m20:21:28.594478 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.stg_vendas"
[0m20:21:28.594862 [debug] [Thread-2 (]: On model.vendas_dw.stg_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_vendas"} */
drop table if exists "general_rtxt"."bronze"."stg_vendas__dbt_backup" cascade
[0m20:21:28.779659 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:21:28.781520 [debug] [Thread-2 (]: Timing info for model.vendas_dw.stg_vendas (execute): 20:20:15.236556 => 20:21:28.781383
[0m20:21:28.781836 [debug] [Thread-2 (]: On model.vendas_dw.stg_vendas: Close
[0m20:21:28.782538 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '888124a2-2157-401b-b885-f578090b0b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f282bfe5210>]}
[0m20:21:28.783021 [info ] [Thread-2 (]: 5 of 10 OK created sql table model bronze.stg_vendas ........................... [[32mSELECT 2000500[0m in 73.55s]
[0m20:21:28.783482 [debug] [Thread-2 (]: Finished running node model.vendas_dw.stg_vendas
[0m20:21:28.785271 [debug] [Thread-4 (]: Began running node model.vendas_dw.fct_vendas
[0m20:21:28.786487 [info ] [Thread-4 (]: 7 of 10 START sql table model bronze.fct_vendas ................................ [RUN]
[0m20:21:28.787346 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.vendas_dw.stg_devolucoes, now model.vendas_dw.fct_vendas)
[0m20:21:28.787797 [debug] [Thread-4 (]: Began compiling node model.vendas_dw.fct_vendas
[0m20:21:28.790851 [debug] [Thread-4 (]: Writing injected SQL for node "model.vendas_dw.fct_vendas"
[0m20:21:28.791488 [debug] [Thread-4 (]: Timing info for model.vendas_dw.fct_vendas (compile): 20:21:28.788116 => 20:21:28.791340
[0m20:21:28.791784 [debug] [Thread-4 (]: Began executing node model.vendas_dw.fct_vendas
[0m20:21:28.795058 [debug] [Thread-4 (]: Writing runtime sql for node "model.vendas_dw.fct_vendas"
[0m20:21:28.795639 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m20:21:28.795918 [debug] [Thread-4 (]: On model.vendas_dw.fct_vendas: BEGIN
[0m20:21:28.796186 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:21:30.243777 [debug] [Thread-4 (]: SQL status: BEGIN in 1.0 seconds
[0m20:21:30.244300 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m20:21:30.244612 [debug] [Thread-4 (]: On model.vendas_dw.fct_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_vendas"} */

  
    

  create  table "general_rtxt"."bronze"."fct_vendas__dbt_tmp"
  
  
    as
  
  (
    

with ventes as (
    select * from "general_rtxt"."bronze"."stg_vendas"
),

dim_produtos   as (select * from "general_rtxt"."bronze"."dim_produtos" ),
dim_lojas      as (select * from "general_rtxt"."bronze"."dim_lojas" ),
dim_vendedores as (select * from "general_rtxt"."bronze"."dim_vendedores" )

select
    v.id_venda,
    v.id_produto,
    v.id_loja,
    v.id_vendedor,
    v.id_cliente,
    v.data_venda,
    v.quantidade,
    v.preco,
    v.quantidade * v.preco                                   as receita_bruta,
    v.meio_pagamento,
    v.parcelamento,

    -- dimensões
    p.nome_produto,
    p.categoria,
    l.nome_loja,
    l.cidade,
    ve.nome_vendedor
from ventes v
left join dim_produtos   p  on v.id_produto  = p.id_produto
left join dim_lojas      l  on v.id_loja     = l.id_loja
left join dim_vendedores ve on v.id_vendedor = ve.id_vendedor;
  );
  
[0m20:21:30.431104 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 44: ...ft join dim_vendedores ve on v.id_vendedor = ve.id_vendedor;
                                                                       ^

[0m20:21:30.432136 [debug] [Thread-4 (]: On model.vendas_dw.fct_vendas: ROLLBACK
[0m20:21:30.644653 [debug] [Thread-4 (]: Timing info for model.vendas_dw.fct_vendas (execute): 20:21:28.791984 => 20:21:30.644149
[0m20:21:30.645024 [debug] [Thread-4 (]: On model.vendas_dw.fct_vendas: Close
[0m20:21:30.646821 [debug] [Thread-4 (]: Database Error in model fct_vendas (models/vendas_dw/gold/fct_vendas.sql)
  syntax error at or near ";"
  LINE 44: ...ft join dim_vendedores ve on v.id_vendedor = ve.id_vendedor;
                                                                         ^
  compiled Code at target/run/vendas_dw/models/vendas_dw/gold/fct_vendas.sql
[0m20:21:30.647265 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '888124a2-2157-401b-b885-f578090b0b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f282bec3b10>]}
[0m20:21:30.647703 [error] [Thread-4 (]: 7 of 10 ERROR creating sql table model bronze.fct_vendas ....................... [[31mERROR[0m in 1.86s]
[0m20:21:30.648133 [debug] [Thread-4 (]: Finished running node model.vendas_dw.fct_vendas
[0m20:21:30.649653 [debug] [Thread-3 (]: Began running node model.vendas_dw.indicadores_vendas
[0m20:21:30.650237 [debug] [Thread-2 (]: Began running node model.vendas_dw.mart_receita_diaria_loja
[0m20:21:30.651112 [debug] [Thread-1 (]: Began running node model.vendas_dw.mart_receita_mensal_categoria
[0m20:21:30.651760 [info ] [Thread-3 (]: 8 of 10 SKIP relation bronze_silver.indicadores_vendas ......................... [[33mSKIP[0m]
[0m20:21:30.652411 [info ] [Thread-2 (]: 9 of 10 SKIP relation bronze.mart_receita_diaria_loja .......................... [[33mSKIP[0m]
[0m20:21:30.653480 [info ] [Thread-1 (]: 10 of 10 SKIP relation bronze.mart_receita_mensal_categoria .................... [[33mSKIP[0m]
[0m20:21:30.654333 [debug] [Thread-3 (]: Finished running node model.vendas_dw.indicadores_vendas
[0m20:21:30.654785 [debug] [Thread-2 (]: Finished running node model.vendas_dw.mart_receita_diaria_loja
[0m20:21:30.655217 [debug] [Thread-1 (]: Finished running node model.vendas_dw.mart_receita_mensal_categoria
[0m20:21:30.658673 [debug] [MainThread]: Using postgres connection "master"
[0m20:21:30.659067 [debug] [MainThread]: On master: BEGIN
[0m20:21:30.659347 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:21:32.057974 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m20:21:32.058610 [debug] [MainThread]: On master: COMMIT
[0m20:21:32.059097 [debug] [MainThread]: Using postgres connection "master"
[0m20:21:32.059356 [debug] [MainThread]: On master: COMMIT
[0m20:21:32.246548 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:21:32.247334 [debug] [MainThread]: On master: Close
[0m20:21:32.248014 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:21:32.248258 [debug] [MainThread]: Connection 'model.vendas_dw.stg_vendas' was properly closed.
[0m20:21:32.248475 [debug] [MainThread]: Connection 'model.vendas_dw.dim_lojas' was properly closed.
[0m20:21:32.248684 [debug] [MainThread]: Connection 'model.vendas_dw.fct_devolucoes' was properly closed.
[0m20:21:32.248888 [debug] [MainThread]: Connection 'model.vendas_dw.fct_vendas' was properly closed.
[0m20:21:32.249177 [info ] [MainThread]: 
[0m20:21:32.249484 [info ] [MainThread]: Finished running 10 table models in 0 hours 1 minutes and 25.30 seconds (85.30s).
[0m20:21:32.250615 [debug] [MainThread]: Command end result
[0m20:21:32.257080 [info ] [MainThread]: 
[0m20:21:32.257504 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m20:21:32.257767 [info ] [MainThread]: 
[0m20:21:32.258029 [error] [MainThread]: [33mDatabase Error in model fct_devolucoes (models/vendas_dw/gold/fct_devolucoes.sql)[0m
[0m20:21:32.258292 [error] [MainThread]:   syntax error at or near ";"
[0m20:21:32.258531 [error] [MainThread]:   LINE 30: from devol;
[0m20:21:32.258766 [error] [MainThread]:                      ^
[0m20:21:32.258996 [error] [MainThread]:   compiled Code at target/run/vendas_dw/models/vendas_dw/gold/fct_devolucoes.sql
[0m20:21:32.259255 [info ] [MainThread]: 
[0m20:21:32.259512 [error] [MainThread]: [33mDatabase Error in model fct_vendas (models/vendas_dw/gold/fct_vendas.sql)[0m
[0m20:21:32.259765 [error] [MainThread]:   syntax error at or near ";"
[0m20:21:32.259991 [error] [MainThread]:   LINE 44: ...ft join dim_vendedores ve on v.id_vendedor = ve.id_vendedor;
[0m20:21:32.260220 [error] [MainThread]:                                                                          ^
[0m20:21:32.260479 [error] [MainThread]:   compiled Code at target/run/vendas_dw/models/vendas_dw/gold/fct_vendas.sql
[0m20:21:32.260743 [info ] [MainThread]: 
[0m20:21:32.261018 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=3 TOTAL=10
[0m20:21:32.261453 [debug] [MainThread]: Command `dbt run` failed at 20:21:32.261364 after 85.93 seconds
[0m20:21:32.261773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f282cbbead0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f282c773110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f282c584450>]}
[0m20:21:32.262063 [debug] [MainThread]: Flushing usage events
[0m20:27:23.147220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb3377ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb337a8910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb33a9b0d0>]}


============================== 20:27:23.150653 | 53fcd6a7-3f27-48f2-b3e2-57e1c856e94b ==============================
[0m20:27:23.150653 [info ] [MainThread]: Running with dbt=1.6.0
[0m20:27:23.151105 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'printer_width': '80', 'log_format': 'default', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'introspect': 'True', 'static_parser': 'True', 'use_colors': 'True', 'profiles_dir': '/home/walterg/.dbt', 'indirect_selection': 'eager', 'version_check': 'True', 'log_cache_events': 'False', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'write_json': 'True', 'no_print': 'None', 'quiet': 'False'}
[0m20:27:23.177208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53fcd6a7-3f27-48f2-b3e2-57e1c856e94b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb33767d90>]}
[0m20:27:23.178384 [debug] [MainThread]: Command `dbt clean` succeeded at 20:27:23.178303 after 0.04 seconds
[0m20:27:23.178671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb338a6bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb338a6c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb34b411d0>]}
[0m20:27:23.178957 [debug] [MainThread]: Flushing usage events
[0m20:27:25.601148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe49de46790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe49f93ed10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe49d25ce10>]}


============================== 20:27:25.603959 | d791e673-727f-44a4-80a4-f609ca43ae3d ==============================
[0m20:27:25.603959 [info ] [MainThread]: Running with dbt=1.6.0
[0m20:27:25.604418 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'partial_parse': 'True', 'introspect': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/home/walterg/.dbt', 'cache_selected_only': 'False', 'no_print': 'None', 'warn_error': 'None', 'fail_fast': 'False', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'printer_width': '80', 'use_colors': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'indirect_selection': 'eager', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'version_check': 'True', 'target_path': 'None', 'static_parser': 'True'}
[0m20:27:25.604810 [info ] [MainThread]: dbt version: 1.6.0
[0m20:27:25.605093 [info ] [MainThread]: python version: 3.11.2
[0m20:27:25.605377 [info ] [MainThread]: python path: /home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/.venv/bin/python3
[0m20:27:25.605655 [info ] [MainThread]: os info: Linux-6.10.7-policorp-amd64-x86_64-with-glibc2.36
[0m20:27:25.638565 [info ] [MainThread]: Using profiles dir at /home/walterg/.dbt
[0m20:27:25.638979 [info ] [MainThread]: Using profiles.yml file at /home/walterg/.dbt/profiles.yml
[0m20:27:25.639254 [info ] [MainThread]: Using dbt_project.yml file at /home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/dbt_project.yml
[0m20:27:25.639680 [info ] [MainThread]: adapter type: postgres
[0m20:27:25.639961 [info ] [MainThread]: adapter version: 1.6.0
[0m20:27:25.656233 [info ] [MainThread]: Configuration:
[0m20:27:25.656688 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:27:25.656940 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:27:25.657190 [info ] [MainThread]: Required dependencies:
[0m20:27:25.657489 [debug] [MainThread]: Executing "git --help"
[0m20:27:25.659617 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:27:25.660370 [debug] [MainThread]: STDERR: "b''"
[0m20:27:25.660937 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:27:25.661683 [info ] [MainThread]: Connection:
[0m20:27:25.661974 [info ] [MainThread]:   host: dpg-d0khna8gjchc73ae1r1g-a.oregon-postgres.render.com
[0m20:27:25.662215 [info ] [MainThread]:   port: 5432
[0m20:27:25.662492 [info ] [MainThread]:   user: postgresadmin
[0m20:27:25.662748 [info ] [MainThread]:   database: general_rtxt
[0m20:27:25.662987 [info ] [MainThread]:   schema: bronze
[0m20:27:25.663231 [info ] [MainThread]:   connect_timeout: 10
[0m20:27:25.663482 [info ] [MainThread]:   role: None
[0m20:27:25.663711 [info ] [MainThread]:   search_path: None
[0m20:27:25.663933 [info ] [MainThread]:   keepalives_idle: 0
[0m20:27:25.664157 [info ] [MainThread]:   sslmode: None
[0m20:27:25.664395 [info ] [MainThread]:   sslcert: None
[0m20:27:25.664619 [info ] [MainThread]:   sslkey: None
[0m20:27:25.664838 [info ] [MainThread]:   sslrootcert: None
[0m20:27:25.665058 [info ] [MainThread]:   application_name: dbt
[0m20:27:25.665296 [info ] [MainThread]:   retries: 1
[0m20:27:25.665574 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m20:27:25.666030 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:27:25.666322 [debug] [MainThread]: Using postgres connection "debug"
[0m20:27:25.666549 [debug] [MainThread]: On debug: select 1 as id
[0m20:27:25.666772 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:27:27.215336 [debug] [MainThread]: SQL status: SELECT 1 in 2.0 seconds
[0m20:27:27.216707 [debug] [MainThread]: On debug: Close
[0m20:27:27.217083 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:27:27.217369 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:27:27.217756 [debug] [MainThread]: Command `dbt debug` succeeded at 20:27:27.217675 after 1.62 seconds
[0m20:27:27.218002 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:27:27.218271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4a1b16d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe49d2eb0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe49cf62c10>]}
[0m20:27:27.218576 [debug] [MainThread]: Flushing usage events
[0m20:27:29.593025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89c1497d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89c1ff2510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89c176bbd0>]}


============================== 20:27:29.595886 | 675f4b0d-2439-428f-b733-71dca2509899 ==============================
[0m20:27:29.595886 [info ] [MainThread]: Running with dbt=1.6.0
[0m20:27:29.596369 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'version_check': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'use_colors': 'True', 'partial_parse': 'True', 'quiet': 'False', 'log_format': 'default', 'no_print': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'fail_fast': 'False', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'profiles_dir': '/home/walterg/.dbt', 'warn_error': 'None', 'use_experimental_parser': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'debug': 'False'}
[0m20:27:29.597429 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt cannot run because no profile was specified for this dbt project.
  To specify a profile for this project, add a line like the this to
  your dbt_project.yml file:
  
  profile: [profile name]
  
  Here, [profile name] should be replaced with a profile name
  defined in your profiles.yml file. You can find profiles.yml here:
  
  /home/walterg/.dbt/profiles.yml
  
[0m20:27:29.597914 [debug] [MainThread]: Command `dbt run` failed at 20:27:29.597831 after 0.01 seconds
[0m20:27:29.598237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89c1409c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89c17502d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89c5e56f50>]}
[0m20:27:29.598578 [debug] [MainThread]: Flushing usage events
[0m20:28:55.731548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb95e7a7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb9853e990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb96a22010>]}


============================== 20:28:55.734401 | 1034a590-eb01-40c0-b548-d7956c9c1591 ==============================
[0m20:28:55.734401 [info ] [MainThread]: Running with dbt=1.6.0
[0m20:28:55.734859 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'static_parser': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'quiet': 'False', 'target_path': 'None', 'use_colors': 'True', 'version_check': 'True', 'introspect': 'True', 'fail_fast': 'False', 'debug': 'False', 'invocation_command': 'dbt clean', 'warn_error': 'None', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'profiles_dir': '/home/walterg/.dbt', 'log_cache_events': 'False', 'printer_width': '80'}
[0m20:28:55.760657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1034a590-eb01-40c0-b548-d7956c9c1591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb95e8eb90>]}
[0m20:28:55.762094 [debug] [MainThread]: Command `dbt clean` succeeded at 20:28:55.762012 after 0.04 seconds
[0m20:28:55.762401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb9a876650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb9a877450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb9a876f50>]}
[0m20:28:55.762684 [debug] [MainThread]: Flushing usage events
[0m20:28:58.324554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15e5981a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15e555a690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15e734b290>]}


============================== 20:28:58.327790 | 4086fbc5-6ee3-4260-b148-190a69a03d37 ==============================
[0m20:28:58.327790 [info ] [MainThread]: Running with dbt=1.6.0
[0m20:28:58.328233 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'static_parser': 'True', 'version_check': 'True', 'invocation_command': 'dbt run', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/home/walterg/.dbt', 'write_json': 'True', 'printer_width': '80', 'introspect': 'True', 'fail_fast': 'False', 'target_path': 'None', 'debug': 'False', 'log_format': 'default', 'no_print': 'None', 'partial_parse': 'True'}
[0m20:28:58.403961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4086fbc5-6ee3-4260-b148-190a69a03d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15e5836990>]}
[0m20:28:58.416128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4086fbc5-6ee3-4260-b148-190a69a03d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15e5643550>]}
[0m20:28:58.416754 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m20:28:58.423990 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m20:28:58.424522 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:28:58.424865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4086fbc5-6ee3-4260-b148-190a69a03d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15e4ebc8d0>]}
[0m20:28:58.933302 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.silver
- models.gold
[0m20:28:58.937192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4086fbc5-6ee3-4260-b148-190a69a03d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15e4f78990>]}
[0m20:28:58.945830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4086fbc5-6ee3-4260-b148-190a69a03d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15e4ebd650>]}
[0m20:28:58.946314 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m20:28:58.946618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4086fbc5-6ee3-4260-b148-190a69a03d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15e56a8510>]}
[0m20:28:58.948463 [info ] [MainThread]: 
[0m20:28:58.949292 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:28:58.951682 [debug] [ThreadPool]: Acquiring new postgres connection 'list_general_rtxt'
[0m20:28:58.953271 [debug] [ThreadPool]: Acquiring new postgres connection 'list_general_rtxt'
[0m20:28:58.962183 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt"
[0m20:28:58.964745 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt"
[0m20:28:58.965139 [debug] [ThreadPool]: On list_general_rtxt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt"} */

    select distinct nspname from pg_namespace
  
[0m20:28:58.965499 [debug] [ThreadPool]: On list_general_rtxt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt"} */

    select distinct nspname from pg_namespace
  
[0m20:28:58.965852 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:28:58.966642 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:29:00.417897 [debug] [ThreadPool]: SQL status: SELECT 7 in 1.0 seconds
[0m20:29:00.419563 [debug] [ThreadPool]: On list_general_rtxt: Close
[0m20:29:00.476521 [debug] [ThreadPool]: SQL status: SELECT 7 in 2.0 seconds
[0m20:29:00.478260 [debug] [ThreadPool]: On list_general_rtxt: Close
[0m20:29:00.480650 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_general_rtxt, now list_general_rtxt_bronze)
[0m20:29:00.481368 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_general_rtxt, now list_general_rtxt_bronze_silver)
[0m20:29:00.486387 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze"
[0m20:29:00.489339 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_silver"
[0m20:29:00.489879 [debug] [ThreadPool]: On list_general_rtxt_bronze: BEGIN
[0m20:29:00.490641 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: BEGIN
[0m20:29:00.490960 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:29:00.491284 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:29:01.901781 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m20:29:01.902715 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze"
[0m20:29:01.902983 [debug] [ThreadPool]: On list_general_rtxt_bronze: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt_bronze"} */
select
      'general_rtxt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze'
    union all
    select
      'general_rtxt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze'
    union all
    select
      'general_rtxt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze'
  
[0m20:29:02.064898 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m20:29:02.065606 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_silver"
[0m20:29:02.065913 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt_bronze_silver"} */
select
      'general_rtxt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze_silver'
    union all
    select
      'general_rtxt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze_silver'
    union all
    select
      'general_rtxt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze_silver'
  
[0m20:29:02.093474 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m20:29:02.094853 [debug] [ThreadPool]: On list_general_rtxt_bronze: ROLLBACK
[0m20:29:02.261667 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m20:29:02.263160 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: ROLLBACK
[0m20:29:02.278636 [debug] [ThreadPool]: On list_general_rtxt_bronze: Close
[0m20:29:02.462930 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: Close
[0m20:29:02.467682 [debug] [MainThread]: Using postgres connection "master"
[0m20:29:02.468066 [debug] [MainThread]: On master: BEGIN
[0m20:29:02.468338 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:29:04.025281 [debug] [MainThread]: SQL status: BEGIN in 2.0 seconds
[0m20:29:04.025972 [debug] [MainThread]: Using postgres connection "master"
[0m20:29:04.026273 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:29:04.219115 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m20:29:04.220845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4086fbc5-6ee3-4260-b148-190a69a03d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15e53a7810>]}
[0m20:29:04.221301 [debug] [MainThread]: On master: ROLLBACK
[0m20:29:04.407571 [debug] [MainThread]: Using postgres connection "master"
[0m20:29:04.408383 [debug] [MainThread]: On master: BEGIN
[0m20:29:04.777787 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:29:04.778480 [debug] [MainThread]: On master: COMMIT
[0m20:29:04.778726 [debug] [MainThread]: Using postgres connection "master"
[0m20:29:04.778962 [debug] [MainThread]: On master: COMMIT
[0m20:29:04.964035 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:29:04.964616 [debug] [MainThread]: On master: Close
[0m20:29:04.965226 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:29:04.965542 [info ] [MainThread]: 
[0m20:29:04.968177 [debug] [Thread-1 (]: Began running node model.vendas_dw.dim_lojas
[0m20:29:04.968806 [debug] [Thread-2 (]: Began running node model.vendas_dw.dim_produtos
[0m20:29:04.969398 [debug] [Thread-3 (]: Began running node model.vendas_dw.dim_vendedores
[0m20:29:04.970166 [info ] [Thread-1 (]: 1 of 10 START sql table model bronze.dim_lojas ................................. [RUN]
[0m20:29:04.970623 [debug] [Thread-4 (]: Began running node model.vendas_dw.stg_devolucoes
[0m20:29:04.971091 [info ] [Thread-2 (]: 2 of 10 START sql table model bronze.dim_produtos .............................. [RUN]
[0m20:29:04.971635 [info ] [Thread-3 (]: 3 of 10 START sql table model bronze.dim_vendedores ............................ [RUN]
[0m20:29:04.972479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_general_rtxt_bronze_silver, now model.vendas_dw.dim_lojas)
[0m20:29:04.972991 [info ] [Thread-4 (]: 4 of 10 START sql table model bronze.stg_devolucoes ............................ [RUN]
[0m20:29:04.973597 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_general_rtxt_bronze, now model.vendas_dw.dim_produtos)
[0m20:29:04.974264 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.vendas_dw.dim_vendedores'
[0m20:29:04.974772 [debug] [Thread-1 (]: Began compiling node model.vendas_dw.dim_lojas
[0m20:29:04.975585 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.vendas_dw.stg_devolucoes'
[0m20:29:04.975994 [debug] [Thread-2 (]: Began compiling node model.vendas_dw.dim_produtos
[0m20:29:04.976351 [debug] [Thread-3 (]: Began compiling node model.vendas_dw.dim_vendedores
[0m20:29:04.982308 [debug] [Thread-1 (]: Writing injected SQL for node "model.vendas_dw.dim_lojas"
[0m20:29:04.982903 [debug] [Thread-4 (]: Began compiling node model.vendas_dw.stg_devolucoes
[0m20:29:04.985584 [debug] [Thread-2 (]: Writing injected SQL for node "model.vendas_dw.dim_produtos"
[0m20:29:04.988657 [debug] [Thread-3 (]: Writing injected SQL for node "model.vendas_dw.dim_vendedores"
[0m20:29:04.991351 [debug] [Thread-4 (]: Writing injected SQL for node "model.vendas_dw.stg_devolucoes"
[0m20:29:04.992581 [debug] [Thread-3 (]: Timing info for model.vendas_dw.dim_vendedores (compile): 20:29:04.986012 => 20:29:04.992373
[0m20:29:04.992959 [debug] [Thread-3 (]: Began executing node model.vendas_dw.dim_vendedores
[0m20:29:04.993675 [debug] [Thread-2 (]: Timing info for model.vendas_dw.dim_produtos (compile): 20:29:04.983228 => 20:29:04.993345
[0m20:29:04.999582 [debug] [Thread-4 (]: Timing info for model.vendas_dw.stg_devolucoes (compile): 20:29:04.989269 => 20:29:04.999313
[0m20:29:05.000208 [debug] [Thread-1 (]: Timing info for model.vendas_dw.dim_lojas (compile): 20:29:04.976611 => 20:29:04.999897
[0m20:29:05.011422 [debug] [Thread-2 (]: Began executing node model.vendas_dw.dim_produtos
[0m20:29:05.025609 [debug] [Thread-3 (]: Writing runtime sql for node "model.vendas_dw.dim_vendedores"
[0m20:29:05.026261 [debug] [Thread-4 (]: Began executing node model.vendas_dw.stg_devolucoes
[0m20:29:05.026742 [debug] [Thread-1 (]: Began executing node model.vendas_dw.dim_lojas
[0m20:29:05.030333 [debug] [Thread-2 (]: Writing runtime sql for node "model.vendas_dw.dim_produtos"
[0m20:29:05.034399 [debug] [Thread-4 (]: Writing runtime sql for node "model.vendas_dw.stg_devolucoes"
[0m20:29:05.039293 [debug] [Thread-1 (]: Writing runtime sql for node "model.vendas_dw.dim_lojas"
[0m20:29:05.040727 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m20:29:05.041077 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m20:29:05.041477 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m20:29:05.041742 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: BEGIN
[0m20:29:05.042029 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m20:29:05.042365 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: BEGIN
[0m20:29:05.042659 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: BEGIN
[0m20:29:05.042968 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:29:05.043310 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: BEGIN
[0m20:29:05.043624 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:29:05.043941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:29:05.044433 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:29:06.611958 [debug] [Thread-2 (]: SQL status: BEGIN in 2.0 seconds
[0m20:29:06.612783 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m20:29:06.613065 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_produtos"} */

  
    

  create  table "general_rtxt"."bronze"."dim_produtos__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id_produto         as int)           as id_produto,
        nome_produto,
        categoria,
        cast(percentual_imposto as numeric(5,2))  as percentual_imposto
    from "general_rtxt"."bronze"."produtos"

)

select *
from src
  );
  
[0m20:29:06.614486 [debug] [Thread-3 (]: SQL status: BEGIN in 2.0 seconds
[0m20:29:06.615219 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m20:29:06.615620 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_vendedores"} */

  
    

  create  table "general_rtxt"."bronze"."dim_vendedores__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id                as int)   as id_vendedor,
        nome_vendedor,
        cast(data_admissao     as date)  as data_admissao,
        endereco_vendedor,
        cast(data_nascimento   as date)  as data_nascimento
    from "general_rtxt"."bronze"."vendedores"

)

select *
from src
  );
  
[0m20:29:06.736697 [debug] [Thread-4 (]: SQL status: BEGIN in 2.0 seconds
[0m20:29:06.737319 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m20:29:06.737622 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_devolucoes"} */

  
    

  create  table "general_rtxt"."bronze"."stg_devolucoes__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id_venda       as bigint)              as id_venda,
        cast(id_produto     as int)                 as id_produto,
        cast(preco          as numeric(12,2))       as preco,
        cast(quantidade     as int)                 as quantidade,
        cast(data_venda     as date)                as data_venda,
        cast(data_devolucao as date)                as data_devolucao,
        cast(id_cliente     as int)                 as id_cliente,
        cast(id_loja        as int)                 as id_loja,
        cast(id_vendedor    as int)                 as id_vendedor,
        motivo
    from "general_rtxt"."bronze"."devolucoes"

)

select *
from src
  );
  
[0m20:29:06.793306 [debug] [Thread-1 (]: SQL status: BEGIN in 2.0 seconds
[0m20:29:06.794131 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m20:29:06.794419 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_lojas"} */

  
    

  create  table "general_rtxt"."bronze"."dim_lojas__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id_loja  as int)   as id_loja,
        nome_loja,
        logradouro,
        cast("número" as int)   as numero,
        bairro,
        cidade,
        estado,
        cep
    from "general_rtxt"."bronze"."lojas"

)

select *
from src
  );
  
[0m20:29:06.809787 [debug] [Thread-2 (]: SQL status: SELECT 300 in 0.0 seconds
[0m20:29:06.810448 [debug] [Thread-3 (]: SQL status: SELECT 120 in 0.0 seconds
[0m20:29:06.815140 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m20:29:06.818172 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m20:29:06.818755 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_produtos"} */
alter table "general_rtxt"."bronze"."dim_produtos" rename to "dim_produtos__dbt_backup"
[0m20:29:06.819324 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_vendedores"} */
alter table "general_rtxt"."bronze"."dim_vendedores" rename to "dim_vendedores__dbt_backup"
[0m20:29:06.995071 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m20:29:06.997588 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m20:29:06.997920 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_lojas"} */
alter table "general_rtxt"."bronze"."dim_lojas" rename to "dim_lojas__dbt_backup"
[0m20:29:07.005151 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:29:07.005781 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:29:07.008291 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m20:29:07.011028 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m20:29:07.011595 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_vendedores"} */
alter table "general_rtxt"."bronze"."dim_vendedores__dbt_tmp" rename to "dim_vendedores"
[0m20:29:07.012147 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_produtos"} */
alter table "general_rtxt"."bronze"."dim_produtos__dbt_tmp" rename to "dim_produtos"
[0m20:29:07.219865 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:29:07.220427 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:29:07.220775 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:29:07.223283 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m20:29:07.240420 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: COMMIT
[0m20:29:07.242216 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: COMMIT
[0m20:29:07.242762 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_lojas"} */
alter table "general_rtxt"."bronze"."dim_lojas__dbt_tmp" rename to "dim_lojas"
[0m20:29:07.243495 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m20:29:07.244034 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m20:29:07.244622 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: COMMIT
[0m20:29:07.244958 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: COMMIT
[0m20:29:07.522401 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:29:07.524977 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: COMMIT
[0m20:29:07.525350 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m20:29:07.525644 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: COMMIT
[0m20:29:07.531149 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m20:29:07.538084 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m20:29:07.538590 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m20:29:07.539100 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_vendedores"} */
drop table if exists "general_rtxt"."bronze"."dim_vendedores__dbt_backup" cascade
[0m20:29:07.541355 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m20:29:07.541849 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_produtos"} */
drop table if exists "general_rtxt"."bronze"."dim_produtos__dbt_backup" cascade
[0m20:29:07.746898 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:29:07.749945 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m20:29:07.750416 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:29:07.750925 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_lojas"} */
drop table if exists "general_rtxt"."bronze"."dim_lojas__dbt_backup" cascade
[0m20:29:07.751353 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:29:07.752794 [debug] [Thread-3 (]: Timing info for model.vendas_dw.dim_vendedores (execute): 20:29:04.994098 => 20:29:07.752646
[0m20:29:07.754517 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: Close
[0m20:29:07.754115 [debug] [Thread-2 (]: Timing info for model.vendas_dw.dim_produtos (execute): 20:29:05.027064 => 20:29:07.753976
[0m20:29:07.755025 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: Close
[0m20:29:07.755844 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4086fbc5-6ee3-4260-b148-190a69a03d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15e4dfce90>]}
[0m20:29:07.756453 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4086fbc5-6ee3-4260-b148-190a69a03d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15e4dce550>]}
[0m20:29:07.756944 [info ] [Thread-3 (]: 3 of 10 OK created sql table model bronze.dim_vendedores ....................... [[32mSELECT 120[0m in 2.78s]
[0m20:29:07.757503 [info ] [Thread-2 (]: 2 of 10 OK created sql table model bronze.dim_produtos ......................... [[32mSELECT 300[0m in 2.78s]
[0m20:29:07.758135 [debug] [Thread-3 (]: Finished running node model.vendas_dw.dim_vendedores
[0m20:29:07.758637 [debug] [Thread-2 (]: Finished running node model.vendas_dw.dim_produtos
[0m20:29:07.759046 [debug] [Thread-3 (]: Began running node model.vendas_dw.stg_vendas
[0m20:29:07.759971 [info ] [Thread-3 (]: 5 of 10 START sql table model bronze.stg_vendas ................................ [RUN]
[0m20:29:07.760687 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.vendas_dw.dim_vendedores, now model.vendas_dw.stg_vendas)
[0m20:29:07.761413 [debug] [Thread-3 (]: Began compiling node model.vendas_dw.stg_vendas
[0m20:29:07.764020 [debug] [Thread-3 (]: Writing injected SQL for node "model.vendas_dw.stg_vendas"
[0m20:29:07.764838 [debug] [Thread-3 (]: Timing info for model.vendas_dw.stg_vendas (compile): 20:29:07.761691 => 20:29:07.764644
[0m20:29:07.765142 [debug] [Thread-3 (]: Began executing node model.vendas_dw.stg_vendas
[0m20:29:07.768420 [debug] [Thread-3 (]: Writing runtime sql for node "model.vendas_dw.stg_vendas"
[0m20:29:07.768975 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.stg_vendas"
[0m20:29:07.769348 [debug] [Thread-3 (]: On model.vendas_dw.stg_vendas: BEGIN
[0m20:29:07.769719 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:29:07.919957 [debug] [Thread-4 (]: SQL status: SELECT 30000 in 1.0 seconds
[0m20:29:07.924469 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m20:29:07.924870 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_devolucoes"} */
alter table "general_rtxt"."bronze"."stg_devolucoes" rename to "stg_devolucoes__dbt_backup"
[0m20:29:08.029850 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:29:08.031549 [debug] [Thread-1 (]: Timing info for model.vendas_dw.dim_lojas (execute): 20:29:05.034873 => 20:29:08.031407
[0m20:29:08.031882 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: Close
[0m20:29:08.032589 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4086fbc5-6ee3-4260-b148-190a69a03d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15e4d4e510>]}
[0m20:29:08.033086 [info ] [Thread-1 (]: 1 of 10 OK created sql table model bronze.dim_lojas ............................ [[32mSELECT 15[0m in 3.06s]
[0m20:29:08.033590 [debug] [Thread-1 (]: Finished running node model.vendas_dw.dim_lojas
[0m20:29:08.136485 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:29:08.139225 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m20:29:08.139587 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_devolucoes"} */
alter table "general_rtxt"."bronze"."stg_devolucoes__dbt_tmp" rename to "stg_devolucoes"
[0m20:29:08.326726 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:29:08.329102 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: COMMIT
[0m20:29:08.329467 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m20:29:08.329733 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: COMMIT
[0m20:29:08.516999 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m20:29:08.519284 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m20:29:08.519630 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_devolucoes"} */
drop table if exists "general_rtxt"."bronze"."stg_devolucoes__dbt_backup" cascade
[0m20:29:08.709202 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:29:08.711193 [debug] [Thread-4 (]: Timing info for model.vendas_dw.stg_devolucoes (execute): 20:29:05.030929 => 20:29:08.711046
[0m20:29:08.711517 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: Close
[0m20:29:08.712259 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4086fbc5-6ee3-4260-b148-190a69a03d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15e4d503d0>]}
[0m20:29:08.712758 [info ] [Thread-4 (]: 4 of 10 OK created sql table model bronze.stg_devolucoes ....................... [[32mSELECT 30000[0m in 3.74s]
[0m20:29:08.713256 [debug] [Thread-4 (]: Finished running node model.vendas_dw.stg_devolucoes
[0m20:29:08.714852 [debug] [Thread-2 (]: Began running node model.vendas_dw.fct_devolucoes
[0m20:29:08.715535 [info ] [Thread-2 (]: 6 of 10 START sql table model bronze.fct_devolucoes ............................ [RUN]
[0m20:29:08.716051 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.vendas_dw.dim_produtos, now model.vendas_dw.fct_devolucoes)
[0m20:29:08.716404 [debug] [Thread-2 (]: Began compiling node model.vendas_dw.fct_devolucoes
[0m20:29:08.718679 [debug] [Thread-2 (]: Writing injected SQL for node "model.vendas_dw.fct_devolucoes"
[0m20:29:08.719431 [debug] [Thread-2 (]: Timing info for model.vendas_dw.fct_devolucoes (compile): 20:29:08.716610 => 20:29:08.719184
[0m20:29:08.719866 [debug] [Thread-2 (]: Began executing node model.vendas_dw.fct_devolucoes
[0m20:29:08.722975 [debug] [Thread-2 (]: Writing runtime sql for node "model.vendas_dw.fct_devolucoes"
[0m20:29:08.723606 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.fct_devolucoes"
[0m20:29:08.723889 [debug] [Thread-2 (]: On model.vendas_dw.fct_devolucoes: BEGIN
[0m20:29:08.724141 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:29:09.159892 [debug] [Thread-3 (]: SQL status: BEGIN in 1.0 seconds
[0m20:29:09.160649 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.stg_vendas"
[0m20:29:09.160965 [debug] [Thread-3 (]: On model.vendas_dw.stg_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_vendas"} */

  
    

  create  table "general_rtxt"."bronze"."stg_vendas__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id_venda      as bigint)               as id_venda,
        cast(id_produto    as int)                  as id_produto,
        cast(preco         as numeric(12,2))        as preco,
        cast(quantidade    as int)                  as quantidade,
        cast(data_venda    as date)                 as data_venda,
        cast(id_cliente    as int)                  as id_cliente,
        cast(id_loja       as int)                  as id_loja,
        cast(id_vendedor   as int)                  as id_vendedor,
        lower(trim(meio_pagamento))                 as meio_pagamento,
        cast(parcelamento  as smallint)             as parcelamento
    from "general_rtxt"."bronze"."vendas"

)

select *
from src
  );
  
[0m20:29:10.317908 [debug] [Thread-2 (]: SQL status: BEGIN in 2.0 seconds
[0m20:29:10.318742 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.fct_devolucoes"
[0m20:29:10.319023 [debug] [Thread-2 (]: On model.vendas_dw.fct_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_devolucoes"} */

  
    

  create  table "general_rtxt"."bronze"."fct_devolucoes__dbt_tmp"
  
  
    as
  
  (
    

with devol as (
    select * from "general_rtxt"."bronze"."stg_devolucoes"
)

select
    id_venda,
    id_produto,
    id_loja,
    id_vendedor,
    id_cliente,
    data_venda,
    data_devolucao,
    quantidade,
    preco,
    quantidade * preco                             as valor_devolvido,
    motivo
from devol;
  );
  
[0m20:29:10.506678 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 30: from devol;
                   ^

[0m20:29:10.507421 [debug] [Thread-2 (]: On model.vendas_dw.fct_devolucoes: ROLLBACK
[0m20:29:10.713376 [debug] [Thread-2 (]: Timing info for model.vendas_dw.fct_devolucoes (execute): 20:29:08.720093 => 20:29:10.713016
[0m20:29:10.713746 [debug] [Thread-2 (]: On model.vendas_dw.fct_devolucoes: Close
[0m20:29:10.716839 [debug] [Thread-2 (]: Database Error in model fct_devolucoes (models/gold/fct_devolucoes.sql)
  syntax error at or near ";"
  LINE 30: from devol;
                     ^
  compiled Code at target/run/vendas_dw/models/gold/fct_devolucoes.sql
[0m20:29:10.717345 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4086fbc5-6ee3-4260-b148-190a69a03d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15e4d2e450>]}
[0m20:29:10.717831 [error] [Thread-2 (]: 6 of 10 ERROR creating sql table model bronze.fct_devolucoes ................... [[31mERROR[0m in 2.00s]
[0m20:29:10.718381 [debug] [Thread-2 (]: Finished running node model.vendas_dw.fct_devolucoes
[0m20:30:02.919139 [debug] [Thread-3 (]: Postgres adapter: Postgres error: could not extend file "base/16389/16665" with FileFallocate(): No space left on device
HINT:  Check free disk space.

[0m20:30:02.920295 [debug] [Thread-3 (]: On model.vendas_dw.stg_vendas: ROLLBACK
[0m20:30:03.105406 [debug] [Thread-3 (]: Timing info for model.vendas_dw.stg_vendas (execute): 20:29:07.765367 => 20:30:03.105114
[0m20:30:03.105780 [debug] [Thread-3 (]: On model.vendas_dw.stg_vendas: Close
[0m20:30:03.107607 [debug] [Thread-3 (]: Database Error in model stg_vendas (models/silver/stg_vendas.sql)
  could not extend file "base/16389/16665" with FileFallocate(): No space left on device
  HINT:  Check free disk space.
  compiled Code at target/run/vendas_dw/models/silver/stg_vendas.sql
[0m20:30:03.108016 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4086fbc5-6ee3-4260-b148-190a69a03d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15e4cc4250>]}
[0m20:30:03.108459 [error] [Thread-3 (]: 5 of 10 ERROR creating sql table model bronze.stg_vendas ....................... [[31mERROR[0m in 55.35s]
[0m20:30:03.108905 [debug] [Thread-3 (]: Finished running node model.vendas_dw.stg_vendas
[0m20:30:03.110603 [debug] [Thread-4 (]: Began running node model.vendas_dw.fct_vendas
[0m20:30:03.110991 [info ] [Thread-4 (]: 7 of 10 SKIP relation bronze.fct_vendas ........................................ [[33mSKIP[0m]
[0m20:30:03.111336 [debug] [Thread-4 (]: Finished running node model.vendas_dw.fct_vendas
[0m20:30:03.115452 [debug] [Thread-2 (]: Began running node model.vendas_dw.indicadores_vendas
[0m20:30:03.115985 [debug] [Thread-3 (]: Began running node model.vendas_dw.mart_receita_diaria_loja
[0m20:30:03.116502 [debug] [Thread-1 (]: Began running node model.vendas_dw.mart_receita_mensal_categoria
[0m20:30:03.116987 [info ] [Thread-2 (]: 8 of 10 SKIP relation bronze_silver.indicadores_vendas ......................... [[33mSKIP[0m]
[0m20:30:03.117576 [info ] [Thread-3 (]: 9 of 10 SKIP relation bronze.mart_receita_diaria_loja .......................... [[33mSKIP[0m]
[0m20:30:03.118223 [info ] [Thread-1 (]: 10 of 10 SKIP relation bronze.mart_receita_mensal_categoria .................... [[33mSKIP[0m]
[0m20:30:03.119209 [debug] [Thread-2 (]: Finished running node model.vendas_dw.indicadores_vendas
[0m20:30:03.119949 [debug] [Thread-3 (]: Finished running node model.vendas_dw.mart_receita_diaria_loja
[0m20:30:03.120625 [debug] [Thread-1 (]: Finished running node model.vendas_dw.mart_receita_mensal_categoria
[0m20:30:03.125101 [debug] [MainThread]: Using postgres connection "master"
[0m20:30:03.125638 [debug] [MainThread]: On master: BEGIN
[0m20:30:03.125917 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:30:04.602024 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m20:30:04.602539 [debug] [MainThread]: On master: COMMIT
[0m20:30:04.602782 [debug] [MainThread]: Using postgres connection "master"
[0m20:30:04.603029 [debug] [MainThread]: On master: COMMIT
[0m20:30:04.791890 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:30:04.792850 [debug] [MainThread]: On master: Close
[0m20:30:04.793479 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:30:04.793709 [debug] [MainThread]: Connection 'model.vendas_dw.fct_devolucoes' was properly closed.
[0m20:30:04.793920 [debug] [MainThread]: Connection 'model.vendas_dw.dim_lojas' was properly closed.
[0m20:30:04.794127 [debug] [MainThread]: Connection 'model.vendas_dw.stg_vendas' was properly closed.
[0m20:30:04.794362 [debug] [MainThread]: Connection 'model.vendas_dw.stg_devolucoes' was properly closed.
[0m20:30:04.794656 [info ] [MainThread]: 
[0m20:30:04.794931 [info ] [MainThread]: Finished running 10 table models in 0 hours 1 minutes and 5.85 seconds (65.85s).
[0m20:30:04.795940 [debug] [MainThread]: Command end result
[0m20:30:04.802168 [info ] [MainThread]: 
[0m20:30:04.802639 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m20:30:04.802919 [info ] [MainThread]: 
[0m20:30:04.803165 [error] [MainThread]: [33mDatabase Error in model fct_devolucoes (models/gold/fct_devolucoes.sql)[0m
[0m20:30:04.803436 [error] [MainThread]:   syntax error at or near ";"
[0m20:30:04.803663 [error] [MainThread]:   LINE 30: from devol;
[0m20:30:04.803883 [error] [MainThread]:                      ^
[0m20:30:04.804113 [error] [MainThread]:   compiled Code at target/run/vendas_dw/models/gold/fct_devolucoes.sql
[0m20:30:04.804363 [info ] [MainThread]: 
[0m20:30:04.804600 [error] [MainThread]: [33mDatabase Error in model stg_vendas (models/silver/stg_vendas.sql)[0m
[0m20:30:04.804832 [error] [MainThread]:   could not extend file "base/16389/16665" with FileFallocate(): No space left on device
[0m20:30:04.805055 [error] [MainThread]:   HINT:  Check free disk space.
[0m20:30:04.805301 [error] [MainThread]:   compiled Code at target/run/vendas_dw/models/silver/stg_vendas.sql
[0m20:30:04.805548 [info ] [MainThread]: 
[0m20:30:04.805807 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=4 TOTAL=10
[0m20:30:04.806193 [debug] [MainThread]: Command `dbt run` failed at 20:30:04.806119 after 66.49 seconds
[0m20:30:04.806516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15e4d3fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15e59a9310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15e7b07ed0>]}
[0m20:30:04.806806 [debug] [MainThread]: Flushing usage events
[0m20:32:18.949335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4348f32510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f434893a7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4348f4dcd0>]}


============================== 20:32:18.952566 | 458cca8c-f5aa-4d0d-a349-6a10052ff9cc ==============================
[0m20:32:18.952566 [info ] [MainThread]: Running with dbt=1.6.0
[0m20:32:18.953006 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'target_path': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'partial_parse': 'True', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'introspect': 'True', 'debug': 'False', 'version_check': 'True', 'fail_fast': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'write_json': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'use_colors': 'True', 'invocation_command': 'dbt clean', 'warn_error': 'None', 'static_parser': 'True', 'profiles_dir': '/home/walterg/.dbt'}
[0m20:32:18.978100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '458cca8c-f5aa-4d0d-a349-6a10052ff9cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4348c36150>]}
[0m20:32:18.980595 [debug] [MainThread]: Command `dbt clean` succeeded at 20:32:18.980508 after 0.04 seconds
[0m20:32:18.980918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f434b536390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4348e1a090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f434a894a50>]}
[0m20:32:18.981287 [debug] [MainThread]: Flushing usage events
[0m20:32:40.781617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b9ba762d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b9ba5d810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b9df1ad10>]}


============================== 20:32:40.784569 | 1f5a9b0b-8873-4d65-b6d8-d2773620d50a ==============================
[0m20:32:40.784569 [info ] [MainThread]: Running with dbt=1.6.0
[0m20:32:40.785037 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'log_cache_events': 'False', 'debug': 'False', 'write_json': 'True', 'introspect': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'partial_parse': 'True', 'printer_width': '80', 'warn_error': 'None', 'no_print': 'None', 'indirect_selection': 'eager', 'target_path': 'None', 'invocation_command': 'dbt run', 'quiet': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'profiles_dir': '/home/walterg/.dbt'}
[0m20:32:40.842612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f5a9b0b-8873-4d65-b6d8-d2773620d50a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b9b4da7d0>]}
[0m20:32:40.854861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f5a9b0b-8873-4d65-b6d8-d2773620d50a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b9b8d2490>]}
[0m20:32:40.855560 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m20:32:40.863126 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m20:32:40.863684 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:32:40.863996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1f5a9b0b-8873-4d65-b6d8-d2773620d50a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b9b797c50>]}
[0m20:32:41.379554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f5a9b0b-8873-4d65-b6d8-d2773620d50a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b9b80e010>]}
[0m20:32:41.388727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f5a9b0b-8873-4d65-b6d8-d2773620d50a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b9af61410>]}
[0m20:32:41.389345 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m20:32:41.389655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f5a9b0b-8873-4d65-b6d8-d2773620d50a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b9c656e50>]}
[0m20:32:41.391281 [info ] [MainThread]: 
[0m20:32:41.391983 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:32:41.393686 [debug] [ThreadPool]: Acquiring new postgres connection 'list_general_rtxt'
[0m20:32:41.399774 [debug] [ThreadPool]: Acquiring new postgres connection 'list_general_rtxt'
[0m20:32:41.403757 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt"
[0m20:32:41.406608 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt"
[0m20:32:41.407162 [debug] [ThreadPool]: On list_general_rtxt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt"} */

    select distinct nspname from pg_namespace
  
[0m20:32:41.407549 [debug] [ThreadPool]: On list_general_rtxt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt"} */

    select distinct nspname from pg_namespace
  
[0m20:32:41.407836 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:32:41.408098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:32:42.836433 [debug] [ThreadPool]: SQL status: SELECT 7 in 1.0 seconds
[0m20:32:42.837830 [debug] [ThreadPool]: On list_general_rtxt: Close
[0m20:32:43.225401 [debug] [ThreadPool]: SQL status: SELECT 7 in 2.0 seconds
[0m20:32:43.226824 [debug] [ThreadPool]: On list_general_rtxt: Close
[0m20:32:43.229676 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_general_rtxt, now list_general_rtxt_bronze_gold)
[0m20:32:43.230536 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_general_rtxt, now list_general_rtxt_bronze_silver)
[0m20:32:43.236167 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_gold"
[0m20:32:43.238064 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_silver"
[0m20:32:43.238444 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: BEGIN
[0m20:32:43.238776 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: BEGIN
[0m20:32:43.239173 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:32:43.239717 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:32:44.613429 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m20:32:44.614034 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_gold"
[0m20:32:44.614299 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt_bronze_gold"} */
select
      'general_rtxt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze_gold'
    union all
    select
      'general_rtxt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze_gold'
    union all
    select
      'general_rtxt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze_gold'
  
[0m20:32:44.798184 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m20:32:44.799017 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_silver"
[0m20:32:44.799274 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt_bronze_silver"} */
select
      'general_rtxt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze_silver'
    union all
    select
      'general_rtxt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze_silver'
    union all
    select
      'general_rtxt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze_silver'
  
[0m20:32:44.803782 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m20:32:44.805342 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: ROLLBACK
[0m20:32:44.987553 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m20:32:44.989001 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: ROLLBACK
[0m20:32:44.990054 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: Close
[0m20:32:45.173124 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: Close
[0m20:32:45.176963 [debug] [MainThread]: Using postgres connection "master"
[0m20:32:45.177351 [debug] [MainThread]: On master: BEGIN
[0m20:32:45.177585 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:32:46.749940 [debug] [MainThread]: SQL status: BEGIN in 2.0 seconds
[0m20:32:46.750751 [debug] [MainThread]: Using postgres connection "master"
[0m20:32:46.751042 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:32:46.955874 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m20:32:46.957295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f5a9b0b-8873-4d65-b6d8-d2773620d50a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b9cb0f710>]}
[0m20:32:46.957752 [debug] [MainThread]: On master: ROLLBACK
[0m20:32:47.145683 [debug] [MainThread]: Using postgres connection "master"
[0m20:32:47.146546 [debug] [MainThread]: On master: BEGIN
[0m20:32:47.548656 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:32:47.549372 [debug] [MainThread]: On master: COMMIT
[0m20:32:47.549614 [debug] [MainThread]: Using postgres connection "master"
[0m20:32:47.549843 [debug] [MainThread]: On master: COMMIT
[0m20:32:47.766667 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:32:47.767627 [debug] [MainThread]: On master: Close
[0m20:32:47.768806 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:32:47.769134 [info ] [MainThread]: 
[0m20:32:47.772225 [debug] [Thread-1 (]: Began running node model.vendas_dw.dim_lojas
[0m20:32:47.772936 [debug] [Thread-2 (]: Began running node model.vendas_dw.dim_produtos
[0m20:32:47.773635 [info ] [Thread-1 (]: 1 of 10 START sql table model bronze_silver.dim_lojas .......................... [RUN]
[0m20:32:47.774495 [debug] [Thread-3 (]: Began running node model.vendas_dw.dim_vendedores
[0m20:32:47.775062 [info ] [Thread-2 (]: 2 of 10 START sql table model bronze_silver.dim_produtos ....................... [RUN]
[0m20:32:47.775770 [debug] [Thread-4 (]: Began running node model.vendas_dw.stg_devolucoes
[0m20:32:47.776626 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_general_rtxt_bronze_silver, now model.vendas_dw.dim_lojas)
[0m20:32:47.777335 [info ] [Thread-3 (]: 3 of 10 START sql table model bronze_silver.dim_vendedores ..................... [RUN]
[0m20:32:47.778366 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_general_rtxt_bronze_gold, now model.vendas_dw.dim_produtos)
[0m20:32:47.779056 [info ] [Thread-4 (]: 4 of 10 START sql table model bronze_silver.stg_devolucoes ..................... [RUN]
[0m20:32:47.779954 [debug] [Thread-1 (]: Began compiling node model.vendas_dw.dim_lojas
[0m20:32:47.781110 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.vendas_dw.dim_vendedores'
[0m20:32:47.781951 [debug] [Thread-2 (]: Began compiling node model.vendas_dw.dim_produtos
[0m20:32:47.783212 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.vendas_dw.stg_devolucoes'
[0m20:32:47.789281 [debug] [Thread-1 (]: Writing injected SQL for node "model.vendas_dw.dim_lojas"
[0m20:32:47.789968 [debug] [Thread-3 (]: Began compiling node model.vendas_dw.dim_vendedores
[0m20:32:47.793380 [debug] [Thread-2 (]: Writing injected SQL for node "model.vendas_dw.dim_produtos"
[0m20:32:47.794082 [debug] [Thread-4 (]: Began compiling node model.vendas_dw.stg_devolucoes
[0m20:32:47.797811 [debug] [Thread-3 (]: Writing injected SQL for node "model.vendas_dw.dim_vendedores"
[0m20:32:47.800852 [debug] [Thread-4 (]: Writing injected SQL for node "model.vendas_dw.stg_devolucoes"
[0m20:32:47.802108 [debug] [Thread-4 (]: Timing info for model.vendas_dw.stg_devolucoes (compile): 20:32:47.798608 => 20:32:47.801914
[0m20:32:47.802730 [debug] [Thread-2 (]: Timing info for model.vendas_dw.dim_produtos (compile): 20:32:47.790630 => 20:32:47.802458
[0m20:32:47.803114 [debug] [Thread-4 (]: Began executing node model.vendas_dw.stg_devolucoes
[0m20:32:47.803547 [debug] [Thread-1 (]: Timing info for model.vendas_dw.dim_lojas (compile): 20:32:47.783840 => 20:32:47.803370
[0m20:32:47.803950 [debug] [Thread-3 (]: Timing info for model.vendas_dw.dim_vendedores (compile): 20:32:47.794864 => 20:32:47.803789
[0m20:32:47.804325 [debug] [Thread-2 (]: Began executing node model.vendas_dw.dim_produtos
[0m20:32:47.825699 [debug] [Thread-1 (]: Began executing node model.vendas_dw.dim_lojas
[0m20:32:47.834570 [debug] [Thread-4 (]: Writing runtime sql for node "model.vendas_dw.stg_devolucoes"
[0m20:32:47.835197 [debug] [Thread-3 (]: Began executing node model.vendas_dw.dim_vendedores
[0m20:32:47.839345 [debug] [Thread-2 (]: Writing runtime sql for node "model.vendas_dw.dim_produtos"
[0m20:32:47.844088 [debug] [Thread-1 (]: Writing runtime sql for node "model.vendas_dw.dim_lojas"
[0m20:32:47.850030 [debug] [Thread-3 (]: Writing runtime sql for node "model.vendas_dw.dim_vendedores"
[0m20:32:47.851205 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m20:32:47.851932 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m20:32:47.852323 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m20:32:47.852805 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: BEGIN
[0m20:32:47.853191 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m20:32:47.853553 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: BEGIN
[0m20:32:47.853984 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: BEGIN
[0m20:32:47.854357 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:32:47.854717 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: BEGIN
[0m20:32:47.855285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:32:47.855656 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:32:47.856168 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:32:49.250462 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m20:32:49.251070 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m20:32:49.251376 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_lojas"} */

  
    

  create  table "general_rtxt"."bronze_silver"."dim_lojas__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id_loja  as int)   as id_loja,
        nome_loja,
        logradouro,
        cast("número" as int)   as numero,
        bairro,
        cidade,
        estado,
        cep
    from "general_rtxt"."bronze"."lojas"

)

select *
from src
  );
  
[0m20:32:49.256752 [debug] [Thread-3 (]: SQL status: BEGIN in 1.0 seconds
[0m20:32:49.257567 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m20:32:49.257855 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_vendedores"} */

  
    

  create  table "general_rtxt"."bronze_silver"."dim_vendedores__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id                as int)   as id_vendedor,
        nome_vendedor,
        cast(data_admissao     as date)  as data_admissao,
        endereco_vendedor,
        cast(data_nascimento   as date)  as data_nascimento
    from "general_rtxt"."bronze"."vendedores"

)

select *
from src
  );
  
[0m20:32:49.320410 [debug] [Thread-4 (]: SQL status: BEGIN in 1.0 seconds
[0m20:32:49.321018 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m20:32:49.321334 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_devolucoes"} */

  
    

  create  table "general_rtxt"."bronze_silver"."stg_devolucoes__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id_venda       as bigint)              as id_venda,
        cast(id_produto     as int)                 as id_produto,
        cast(preco          as numeric(12,2))       as preco,
        cast(quantidade     as int)                 as quantidade,
        cast(data_venda     as date)                as data_venda,
        cast(data_devolucao as date)                as data_devolucao,
        cast(id_cliente     as int)                 as id_cliente,
        cast(id_loja        as int)                 as id_loja,
        cast(id_vendedor    as int)                 as id_vendedor,
        motivo
    from "general_rtxt"."bronze"."devolucoes"

)

select *
from src
  );
  
[0m20:32:49.385672 [debug] [Thread-2 (]: SQL status: BEGIN in 2.0 seconds
[0m20:32:49.386300 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m20:32:49.386597 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_produtos"} */

  
    

  create  table "general_rtxt"."bronze_silver"."dim_produtos__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id_produto         as int)           as id_produto,
        nome_produto,
        categoria,
        cast(percentual_imposto as numeric(5,2))  as percentual_imposto
    from "general_rtxt"."bronze"."produtos"

)

select *
from src
  );
  
[0m20:32:49.452467 [debug] [Thread-3 (]: SQL status: SELECT 120 in 0.0 seconds
[0m20:32:49.457905 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m20:32:49.458327 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_vendedores"} */
alter table "general_rtxt"."bronze_silver"."dim_vendedores__dbt_tmp" rename to "dim_vendedores"
[0m20:32:49.467012 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m20:32:49.469901 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m20:32:49.470220 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_lojas"} */
alter table "general_rtxt"."bronze_silver"."dim_lojas__dbt_tmp" rename to "dim_lojas"
[0m20:32:49.657579 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:32:49.670765 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: COMMIT
[0m20:32:49.671167 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m20:32:49.671450 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: COMMIT
[0m20:32:49.713795 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:32:49.714551 [debug] [Thread-2 (]: SQL status: SELECT 300 in 0.0 seconds
[0m20:32:49.716219 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: COMMIT
[0m20:32:49.718610 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m20:32:49.719020 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m20:32:49.719374 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_produtos"} */
alter table "general_rtxt"."bronze_silver"."dim_produtos__dbt_tmp" rename to "dim_produtos"
[0m20:32:49.719681 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: COMMIT
[0m20:32:49.914543 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:32:49.916377 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: COMMIT
[0m20:32:49.916759 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m20:32:49.917016 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: COMMIT
[0m20:32:49.918011 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:32:49.924840 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m20:32:49.925321 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m20:32:49.925716 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_lojas"} */
drop table if exists "general_rtxt"."bronze_silver"."dim_lojas__dbt_backup" cascade
[0m20:32:49.928364 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m20:32:49.929018 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_vendedores"} */
drop table if exists "general_rtxt"."bronze_silver"."dim_vendedores__dbt_backup" cascade
[0m20:32:50.116202 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:32:50.116768 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:32:50.117430 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m20:32:50.118624 [debug] [Thread-1 (]: Timing info for model.vendas_dw.dim_lojas (execute): 20:32:47.839770 => 20:32:50.118485
[0m20:32:50.120300 [debug] [Thread-3 (]: Timing info for model.vendas_dw.dim_vendedores (execute): 20:32:47.844835 => 20:32:50.120147
[0m20:32:50.122749 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m20:32:50.123164 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: Close
[0m20:32:50.123669 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: Close
[0m20:32:50.124183 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_produtos"} */
drop table if exists "general_rtxt"."bronze_silver"."dim_produtos__dbt_backup" cascade
[0m20:32:50.124993 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f5a9b0b-8873-4d65-b6d8-d2773620d50a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b9b5034d0>]}
[0m20:32:50.125558 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f5a9b0b-8873-4d65-b6d8-d2773620d50a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b9b4f8d10>]}
[0m20:32:50.126207 [info ] [Thread-3 (]: 3 of 10 OK created sql table model bronze_silver.dim_vendedores ................ [[32mSELECT 120[0m in 2.34s]
[0m20:32:50.126751 [info ] [Thread-1 (]: 1 of 10 OK created sql table model bronze_silver.dim_lojas ..................... [[32mSELECT 15[0m in 2.35s]
[0m20:32:50.127396 [debug] [Thread-3 (]: Finished running node model.vendas_dw.dim_vendedores
[0m20:32:50.127875 [debug] [Thread-1 (]: Finished running node model.vendas_dw.dim_lojas
[0m20:32:50.128291 [debug] [Thread-3 (]: Began running node model.vendas_dw.stg_vendas
[0m20:32:50.129459 [info ] [Thread-3 (]: 5 of 10 START sql table model bronze_silver.stg_vendas ......................... [RUN]
[0m20:32:50.130090 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.vendas_dw.dim_vendedores, now model.vendas_dw.stg_vendas)
[0m20:32:50.130481 [debug] [Thread-3 (]: Began compiling node model.vendas_dw.stg_vendas
[0m20:32:50.133024 [debug] [Thread-3 (]: Writing injected SQL for node "model.vendas_dw.stg_vendas"
[0m20:32:50.133896 [debug] [Thread-3 (]: Timing info for model.vendas_dw.stg_vendas (compile): 20:32:50.130935 => 20:32:50.133705
[0m20:32:50.134203 [debug] [Thread-3 (]: Began executing node model.vendas_dw.stg_vendas
[0m20:32:50.137656 [debug] [Thread-3 (]: Writing runtime sql for node "model.vendas_dw.stg_vendas"
[0m20:32:50.138233 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.stg_vendas"
[0m20:32:50.138556 [debug] [Thread-3 (]: On model.vendas_dw.stg_vendas: BEGIN
[0m20:32:50.138830 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:32:50.314419 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:32:50.315871 [debug] [Thread-2 (]: Timing info for model.vendas_dw.dim_produtos (execute): 20:32:47.835855 => 20:32:50.315732
[0m20:32:50.316192 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: Close
[0m20:32:50.316878 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f5a9b0b-8873-4d65-b6d8-d2773620d50a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b9ae43350>]}
[0m20:32:50.317379 [info ] [Thread-2 (]: 2 of 10 OK created sql table model bronze_silver.dim_produtos .................. [[32mSELECT 300[0m in 2.54s]
[0m20:32:50.317834 [debug] [Thread-2 (]: Finished running node model.vendas_dw.dim_produtos
[0m20:32:50.617798 [debug] [Thread-4 (]: SQL status: SELECT 30000 in 1.0 seconds
[0m20:32:50.620717 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m20:32:50.621031 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_devolucoes"} */
alter table "general_rtxt"."bronze_silver"."stg_devolucoes__dbt_tmp" rename to "stg_devolucoes"
[0m20:32:50.808546 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:32:50.810816 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: COMMIT
[0m20:32:50.811180 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m20:32:50.811468 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: COMMIT
[0m20:32:51.000752 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m20:32:51.003431 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m20:32:51.003739 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_devolucoes"} */
drop table if exists "general_rtxt"."bronze_silver"."stg_devolucoes__dbt_backup" cascade
[0m20:32:51.213522 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:32:51.215305 [debug] [Thread-4 (]: Timing info for model.vendas_dw.stg_devolucoes (execute): 20:32:47.804601 => 20:32:51.215151
[0m20:32:51.215621 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: Close
[0m20:32:51.216321 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f5a9b0b-8873-4d65-b6d8-d2773620d50a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b9ae66350>]}
[0m20:32:51.216815 [info ] [Thread-4 (]: 4 of 10 OK created sql table model bronze_silver.stg_devolucoes ................ [[32mSELECT 30000[0m in 3.43s]
[0m20:32:51.217522 [debug] [Thread-4 (]: Finished running node model.vendas_dw.stg_devolucoes
[0m20:32:51.219009 [debug] [Thread-1 (]: Began running node model.vendas_dw.fct_devolucoes
[0m20:32:51.219467 [info ] [Thread-1 (]: 6 of 10 START sql table model bronze_gold.fct_devolucoes ....................... [RUN]
[0m20:32:51.220074 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vendas_dw.dim_lojas, now model.vendas_dw.fct_devolucoes)
[0m20:32:51.220530 [debug] [Thread-1 (]: Began compiling node model.vendas_dw.fct_devolucoes
[0m20:32:51.222946 [debug] [Thread-1 (]: Writing injected SQL for node "model.vendas_dw.fct_devolucoes"
[0m20:32:51.223655 [debug] [Thread-1 (]: Timing info for model.vendas_dw.fct_devolucoes (compile): 20:32:51.220775 => 20:32:51.223463
[0m20:32:51.223993 [debug] [Thread-1 (]: Began executing node model.vendas_dw.fct_devolucoes
[0m20:32:51.228378 [debug] [Thread-1 (]: Writing runtime sql for node "model.vendas_dw.fct_devolucoes"
[0m20:32:51.229056 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_devolucoes"
[0m20:32:51.229381 [debug] [Thread-1 (]: On model.vendas_dw.fct_devolucoes: BEGIN
[0m20:32:51.229640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:32:51.590590 [debug] [Thread-3 (]: SQL status: BEGIN in 1.0 seconds
[0m20:32:51.591267 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.stg_vendas"
[0m20:32:51.591582 [debug] [Thread-3 (]: On model.vendas_dw.stg_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_vendas"} */

  
    

  create  table "general_rtxt"."bronze_silver"."stg_vendas__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id_venda      as bigint)               as id_venda,
        cast(id_produto    as int)                  as id_produto,
        cast(preco         as numeric(12,2))        as preco,
        cast(quantidade    as int)                  as quantidade,
        cast(data_venda    as date)                 as data_venda,
        cast(id_cliente    as int)                  as id_cliente,
        cast(id_loja       as int)                  as id_loja,
        cast(id_vendedor   as int)                  as id_vendedor,
        lower(trim(meio_pagamento))                 as meio_pagamento,
        cast(parcelamento  as smallint)             as parcelamento
    from "general_rtxt"."bronze"."vendas"

)

select *
from src
  );
  
[0m20:32:52.813620 [debug] [Thread-1 (]: SQL status: BEGIN in 2.0 seconds
[0m20:32:52.814288 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_devolucoes"
[0m20:32:52.814588 [debug] [Thread-1 (]: On model.vendas_dw.fct_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_devolucoes"} */

  
    

  create  table "general_rtxt"."bronze_gold"."fct_devolucoes__dbt_tmp"
  
  
    as
  
  (
    

with devol as (
    select * from "general_rtxt"."bronze_silver"."stg_devolucoes"
)

select
    id_venda,
    id_produto,
    id_loja,
    id_vendedor,
    id_cliente,
    data_venda,
    data_devolucao,
    quantidade,
    preco,
    quantidade * preco                             as valor_devolvido,
    motivo
from devol;
  );
  
[0m20:32:53.013740 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 30: from devol;
                   ^

[0m20:32:53.014607 [debug] [Thread-1 (]: On model.vendas_dw.fct_devolucoes: ROLLBACK
[0m20:32:53.213471 [debug] [Thread-1 (]: Timing info for model.vendas_dw.fct_devolucoes (execute): 20:32:51.224218 => 20:32:53.213104
[0m20:32:53.213937 [debug] [Thread-1 (]: On model.vendas_dw.fct_devolucoes: Close
[0m20:32:53.216734 [debug] [Thread-1 (]: Database Error in model fct_devolucoes (models/gold/fct_devolucoes.sql)
  syntax error at or near ";"
  LINE 30: from devol;
                     ^
  compiled Code at target/run/vendas_dw/models/gold/fct_devolucoes.sql
[0m20:32:53.217176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f5a9b0b-8873-4d65-b6d8-d2773620d50a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b9ad03490>]}
[0m20:32:53.217647 [error] [Thread-1 (]: 6 of 10 ERROR creating sql table model bronze_gold.fct_devolucoes .............. [[31mERROR[0m in 2.00s]
[0m20:32:53.218107 [debug] [Thread-1 (]: Finished running node model.vendas_dw.fct_devolucoes
[0m20:33:42.128784 [debug] [Thread-3 (]: Postgres adapter: Postgres error: could not extend file "base/16389/16691" with FileFallocate(): No space left on device
HINT:  Check free disk space.

[0m20:33:42.129537 [debug] [Thread-3 (]: On model.vendas_dw.stg_vendas: ROLLBACK
[0m20:33:42.332951 [debug] [Thread-3 (]: Timing info for model.vendas_dw.stg_vendas (execute): 20:32:50.134448 => 20:33:42.332488
[0m20:33:42.333355 [debug] [Thread-3 (]: On model.vendas_dw.stg_vendas: Close
[0m20:33:42.335121 [debug] [Thread-3 (]: Database Error in model stg_vendas (models/silver/stg_vendas.sql)
  could not extend file "base/16389/16691" with FileFallocate(): No space left on device
  HINT:  Check free disk space.
  compiled Code at target/run/vendas_dw/models/silver/stg_vendas.sql
[0m20:33:42.335539 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f5a9b0b-8873-4d65-b6d8-d2773620d50a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b9ad08150>]}
[0m20:33:42.336000 [error] [Thread-3 (]: 5 of 10 ERROR creating sql table model bronze_silver.stg_vendas ................ [[31mERROR[0m in 52.21s]
[0m20:33:42.336459 [debug] [Thread-3 (]: Finished running node model.vendas_dw.stg_vendas
[0m20:33:42.338442 [debug] [Thread-4 (]: Began running node model.vendas_dw.fct_vendas
[0m20:33:42.338907 [info ] [Thread-4 (]: 7 of 10 SKIP relation bronze_gold.fct_vendas ................................... [[33mSKIP[0m]
[0m20:33:42.339255 [debug] [Thread-4 (]: Finished running node model.vendas_dw.fct_vendas
[0m20:33:42.358078 [debug] [Thread-1 (]: Began running node model.vendas_dw.indicadores_vendas
[0m20:33:42.358785 [debug] [Thread-3 (]: Began running node model.vendas_dw.mart_receita_diaria_loja
[0m20:33:42.359370 [debug] [Thread-2 (]: Began running node model.vendas_dw.mart_receita_mensal_categoria
[0m20:33:42.359719 [info ] [Thread-1 (]: 8 of 10 SKIP relation bronze_silver.indicadores_vendas ......................... [[33mSKIP[0m]
[0m20:33:42.360145 [info ] [Thread-3 (]: 9 of 10 SKIP relation bronze_gold.mart_receita_diaria_loja ..................... [[33mSKIP[0m]
[0m20:33:42.360816 [info ] [Thread-2 (]: 10 of 10 SKIP relation bronze_gold.mart_receita_mensal_categoria ............... [[33mSKIP[0m]
[0m20:33:42.361574 [debug] [Thread-1 (]: Finished running node model.vendas_dw.indicadores_vendas
[0m20:33:42.362024 [debug] [Thread-3 (]: Finished running node model.vendas_dw.mart_receita_diaria_loja
[0m20:33:42.362398 [debug] [Thread-2 (]: Finished running node model.vendas_dw.mart_receita_mensal_categoria
[0m20:33:42.365929 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:42.366394 [debug] [MainThread]: On master: BEGIN
[0m20:33:42.366675 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:33:43.849454 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m20:33:43.850352 [debug] [MainThread]: On master: COMMIT
[0m20:33:43.850676 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:43.850899 [debug] [MainThread]: On master: COMMIT
[0m20:33:44.038944 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:33:44.039839 [debug] [MainThread]: On master: Close
[0m20:33:44.040605 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:33:44.040867 [debug] [MainThread]: Connection 'model.vendas_dw.fct_devolucoes' was properly closed.
[0m20:33:44.041072 [debug] [MainThread]: Connection 'model.vendas_dw.dim_produtos' was properly closed.
[0m20:33:44.041288 [debug] [MainThread]: Connection 'model.vendas_dw.stg_vendas' was properly closed.
[0m20:33:44.041496 [debug] [MainThread]: Connection 'model.vendas_dw.stg_devolucoes' was properly closed.
[0m20:33:44.041791 [info ] [MainThread]: 
[0m20:33:44.042079 [info ] [MainThread]: Finished running 10 table models in 0 hours 1 minutes and 2.65 seconds (62.65s).
[0m20:33:44.043193 [debug] [MainThread]: Command end result
[0m20:33:44.050196 [info ] [MainThread]: 
[0m20:33:44.050681 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m20:33:44.051102 [info ] [MainThread]: 
[0m20:33:44.051598 [error] [MainThread]: [33mDatabase Error in model fct_devolucoes (models/gold/fct_devolucoes.sql)[0m
[0m20:33:44.051986 [error] [MainThread]:   syntax error at or near ";"
[0m20:33:44.052385 [error] [MainThread]:   LINE 30: from devol;
[0m20:33:44.052692 [error] [MainThread]:                      ^
[0m20:33:44.052987 [error] [MainThread]:   compiled Code at target/run/vendas_dw/models/gold/fct_devolucoes.sql
[0m20:33:44.053336 [info ] [MainThread]: 
[0m20:33:44.053718 [error] [MainThread]: [33mDatabase Error in model stg_vendas (models/silver/stg_vendas.sql)[0m
[0m20:33:44.054017 [error] [MainThread]:   could not extend file "base/16389/16691" with FileFallocate(): No space left on device
[0m20:33:44.054373 [error] [MainThread]:   HINT:  Check free disk space.
[0m20:33:44.054658 [error] [MainThread]:   compiled Code at target/run/vendas_dw/models/silver/stg_vendas.sql
[0m20:33:44.054963 [info ] [MainThread]: 
[0m20:33:44.055307 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=4 TOTAL=10
[0m20:33:44.055868 [debug] [MainThread]: Command `dbt run` failed at 20:33:44.055731 after 63.28 seconds
[0m20:33:44.056340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b9af70d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ba01b6650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b9b7a4390>]}
[0m20:33:44.056741 [debug] [MainThread]: Flushing usage events
[0m20:37:15.602327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99bfaff990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99bfc08e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99bfc32d10>]}


============================== 20:37:15.605059 | bcc6a6b5-76ce-46c2-aeab-0537493299cf ==============================
[0m20:37:15.605059 [info ] [MainThread]: Running with dbt=1.6.0
[0m20:37:15.605534 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'quiet': 'False', 'invocation_command': 'dbt run', 'no_print': 'None', 'indirect_selection': 'eager', 'warn_error': 'None', 'log_format': 'default', 'introspect': 'True', 'profiles_dir': '/home/walterg/.dbt', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'write_json': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'fail_fast': 'False', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'debug': 'False'}
[0m20:37:15.662622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bcc6a6b5-76ce-46c2-aeab-0537493299cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99bf6ae410>]}
[0m20:37:15.674803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bcc6a6b5-76ce-46c2-aeab-0537493299cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99bf91ab50>]}
[0m20:37:15.675456 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m20:37:15.682971 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m20:37:15.699657 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m20:37:15.700236 [debug] [MainThread]: Partial parsing: updated file: vendas_dw://models/gold/mart_receita_diaria_loja.sql
[0m20:37:15.704510 [debug] [MainThread]: Partial parsing: updated file: vendas_dw://models/gold/mart_receita_mensal_categoria.sql
[0m20:37:15.705522 [debug] [MainThread]: Partial parsing: updated file: vendas_dw://models/gold/fct_vendas.sql
[0m20:37:15.706452 [debug] [MainThread]: Partial parsing: updated file: vendas_dw://models/gold/fct_devolucoes.sql
[0m20:37:15.750916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bcc6a6b5-76ce-46c2-aeab-0537493299cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99bf6d8250>]}
[0m20:37:15.759901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bcc6a6b5-76ce-46c2-aeab-0537493299cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99bf0f2d10>]}
[0m20:37:15.760352 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m20:37:15.760651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcc6a6b5-76ce-46c2-aeab-0537493299cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99bfd65d10>]}
[0m20:37:15.762279 [info ] [MainThread]: 
[0m20:37:15.762970 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:37:15.764954 [debug] [ThreadPool]: Acquiring new postgres connection 'list_general_rtxt'
[0m20:37:15.766116 [debug] [ThreadPool]: Acquiring new postgres connection 'list_general_rtxt'
[0m20:37:15.775062 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt"
[0m20:37:15.777490 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt"
[0m20:37:15.777888 [debug] [ThreadPool]: On list_general_rtxt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt"} */

    select distinct nspname from pg_namespace
  
[0m20:37:15.778182 [debug] [ThreadPool]: On list_general_rtxt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt"} */

    select distinct nspname from pg_namespace
  
[0m20:37:15.778488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:37:15.778774 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:37:17.180711 [debug] [ThreadPool]: SQL status: SELECT 7 in 1.0 seconds
[0m20:37:17.182315 [debug] [ThreadPool]: On list_general_rtxt: Close
[0m20:37:17.205365 [debug] [ThreadPool]: SQL status: SELECT 7 in 1.0 seconds
[0m20:37:17.206910 [debug] [ThreadPool]: On list_general_rtxt: Close
[0m20:37:17.209867 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_general_rtxt, now list_general_rtxt_bronze_silver)
[0m20:37:17.211087 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_general_rtxt, now list_general_rtxt_bronze_gold)
[0m20:37:17.216070 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_silver"
[0m20:37:17.217902 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_gold"
[0m20:37:17.218354 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: BEGIN
[0m20:37:17.218738 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: BEGIN
[0m20:37:17.219229 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:37:17.219526 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:37:18.644216 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m20:37:18.644855 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_silver"
[0m20:37:18.645142 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt_bronze_silver"} */
select
      'general_rtxt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze_silver'
    union all
    select
      'general_rtxt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze_silver'
    union all
    select
      'general_rtxt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze_silver'
  
[0m20:37:18.821886 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m20:37:18.822632 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_gold"
[0m20:37:18.823161 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt_bronze_gold"} */
select
      'general_rtxt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze_gold'
    union all
    select
      'general_rtxt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze_gold'
    union all
    select
      'general_rtxt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze_gold'
  
[0m20:37:18.845480 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m20:37:18.846631 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: ROLLBACK
[0m20:37:19.018442 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m20:37:19.020223 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: ROLLBACK
[0m20:37:19.029681 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: Close
[0m20:37:19.206369 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: Close
[0m20:37:19.211151 [debug] [MainThread]: Using postgres connection "master"
[0m20:37:19.211534 [debug] [MainThread]: On master: BEGIN
[0m20:37:19.211797 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:37:20.705460 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m20:37:20.706355 [debug] [MainThread]: Using postgres connection "master"
[0m20:37:20.706696 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:37:20.906718 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m20:37:20.908303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcc6a6b5-76ce-46c2-aeab-0537493299cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99bf1652d0>]}
[0m20:37:20.908688 [debug] [MainThread]: On master: ROLLBACK
[0m20:37:21.099164 [debug] [MainThread]: Using postgres connection "master"
[0m20:37:21.099998 [debug] [MainThread]: On master: BEGIN
[0m20:37:21.478061 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:37:21.478954 [debug] [MainThread]: On master: COMMIT
[0m20:37:21.479215 [debug] [MainThread]: Using postgres connection "master"
[0m20:37:21.479475 [debug] [MainThread]: On master: COMMIT
[0m20:37:21.669087 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:37:21.669943 [debug] [MainThread]: On master: Close
[0m20:37:21.670600 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:37:21.670911 [info ] [MainThread]: 
[0m20:37:21.674541 [debug] [Thread-1 (]: Began running node model.vendas_dw.dim_lojas
[0m20:37:21.675286 [debug] [Thread-2 (]: Began running node model.vendas_dw.dim_produtos
[0m20:37:21.675744 [debug] [Thread-3 (]: Began running node model.vendas_dw.dim_vendedores
[0m20:37:21.676312 [debug] [Thread-4 (]: Began running node model.vendas_dw.stg_devolucoes
[0m20:37:21.676736 [info ] [Thread-1 (]: 1 of 10 START sql table model bronze_silver.dim_lojas .......................... [RUN]
[0m20:37:21.677556 [info ] [Thread-2 (]: 2 of 10 START sql table model bronze_silver.dim_produtos ....................... [RUN]
[0m20:37:21.678349 [info ] [Thread-3 (]: 3 of 10 START sql table model bronze_silver.dim_vendedores ..................... [RUN]
[0m20:37:21.678943 [info ] [Thread-4 (]: 4 of 10 START sql table model bronze_silver.stg_devolucoes ..................... [RUN]
[0m20:37:21.679859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_general_rtxt_bronze_gold, now model.vendas_dw.dim_lojas)
[0m20:37:21.680397 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_general_rtxt_bronze_silver, now model.vendas_dw.dim_produtos)
[0m20:37:21.681149 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.vendas_dw.dim_vendedores'
[0m20:37:21.681874 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.vendas_dw.stg_devolucoes'
[0m20:37:21.682356 [debug] [Thread-1 (]: Began compiling node model.vendas_dw.dim_lojas
[0m20:37:21.682723 [debug] [Thread-2 (]: Began compiling node model.vendas_dw.dim_produtos
[0m20:37:21.683199 [debug] [Thread-3 (]: Began compiling node model.vendas_dw.dim_vendedores
[0m20:37:21.683684 [debug] [Thread-4 (]: Began compiling node model.vendas_dw.stg_devolucoes
[0m20:37:21.690626 [debug] [Thread-1 (]: Writing injected SQL for node "model.vendas_dw.dim_lojas"
[0m20:37:21.693516 [debug] [Thread-2 (]: Writing injected SQL for node "model.vendas_dw.dim_produtos"
[0m20:37:21.697145 [debug] [Thread-3 (]: Writing injected SQL for node "model.vendas_dw.dim_vendedores"
[0m20:37:21.700285 [debug] [Thread-4 (]: Writing injected SQL for node "model.vendas_dw.stg_devolucoes"
[0m20:37:21.701929 [debug] [Thread-1 (]: Timing info for model.vendas_dw.dim_lojas (compile): 20:37:21.684037 => 20:37:21.701565
[0m20:37:21.702496 [debug] [Thread-3 (]: Timing info for model.vendas_dw.dim_vendedores (compile): 20:37:21.694012 => 20:37:21.702222
[0m20:37:21.703073 [debug] [Thread-2 (]: Timing info for model.vendas_dw.dim_produtos (compile): 20:37:21.691048 => 20:37:21.702832
[0m20:37:21.703448 [debug] [Thread-1 (]: Began executing node model.vendas_dw.dim_lojas
[0m20:37:21.703912 [debug] [Thread-3 (]: Began executing node model.vendas_dw.dim_vendedores
[0m20:37:21.704376 [debug] [Thread-4 (]: Timing info for model.vendas_dw.stg_devolucoes (compile): 20:37:21.697719 => 20:37:21.704198
[0m20:37:21.705871 [debug] [Thread-2 (]: Began executing node model.vendas_dw.dim_produtos
[0m20:37:21.744478 [debug] [Thread-3 (]: Writing runtime sql for node "model.vendas_dw.dim_vendedores"
[0m20:37:21.747151 [debug] [Thread-1 (]: Writing runtime sql for node "model.vendas_dw.dim_lojas"
[0m20:37:21.747664 [debug] [Thread-4 (]: Began executing node model.vendas_dw.stg_devolucoes
[0m20:37:21.751170 [debug] [Thread-2 (]: Writing runtime sql for node "model.vendas_dw.dim_produtos"
[0m20:37:21.755492 [debug] [Thread-4 (]: Writing runtime sql for node "model.vendas_dw.stg_devolucoes"
[0m20:37:21.756224 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m20:37:21.757197 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m20:37:21.758160 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: BEGIN
[0m20:37:21.758641 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: BEGIN
[0m20:37:21.759068 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m20:37:21.759389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:37:21.759704 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m20:37:21.760055 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:37:21.760420 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: BEGIN
[0m20:37:21.760880 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: BEGIN
[0m20:37:21.761380 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:37:21.761692 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:37:23.191514 [debug] [Thread-2 (]: SQL status: BEGIN in 1.0 seconds
[0m20:37:23.192284 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m20:37:23.192608 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_produtos"} */

  
    

  create  table "general_rtxt"."bronze_silver"."dim_produtos__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id_produto         as int)           as id_produto,
        nome_produto,
        categoria,
        cast(percentual_imposto as numeric(5,2))  as percentual_imposto
    from "general_rtxt"."bronze"."produtos"

)

select *
from src
  );
  
[0m20:37:23.231910 [debug] [Thread-3 (]: SQL status: BEGIN in 1.0 seconds
[0m20:37:23.232868 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m20:37:23.233172 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_vendedores"} */

  
    

  create  table "general_rtxt"."bronze_silver"."dim_vendedores__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id                as int)   as id_vendedor,
        nome_vendedor,
        cast(data_admissao     as date)  as data_admissao,
        endereco_vendedor,
        cast(data_nascimento   as date)  as data_nascimento
    from "general_rtxt"."bronze"."vendedores"

)

select *
from src
  );
  
[0m20:37:23.331087 [debug] [Thread-4 (]: SQL status: BEGIN in 2.0 seconds
[0m20:37:23.331585 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m20:37:23.331871 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_devolucoes"} */

  
    

  create  table "general_rtxt"."bronze_silver"."stg_devolucoes__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id_venda       as bigint)              as id_venda,
        cast(id_produto     as int)                 as id_produto,
        cast(preco          as numeric(12,2))       as preco,
        cast(quantidade     as int)                 as quantidade,
        cast(data_venda     as date)                as data_venda,
        cast(data_devolucao as date)                as data_devolucao,
        cast(id_cliente     as int)                 as id_cliente,
        cast(id_loja        as int)                 as id_loja,
        cast(id_vendedor    as int)                 as id_vendedor,
        motivo
    from "general_rtxt"."bronze"."devolucoes"

)

select *
from src
  );
  
[0m20:37:23.379927 [debug] [Thread-1 (]: SQL status: BEGIN in 2.0 seconds
[0m20:37:23.380551 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m20:37:23.380824 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_lojas"} */

  
    

  create  table "general_rtxt"."bronze_silver"."dim_lojas__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id_loja  as int)   as id_loja,
        nome_loja,
        logradouro,
        cast("número" as int)   as numero,
        bairro,
        cidade,
        estado,
        cep
    from "general_rtxt"."bronze"."lojas"

)

select *
from src
  );
  
[0m20:37:23.403160 [debug] [Thread-2 (]: SQL status: SELECT 300 in 0.0 seconds
[0m20:37:23.408077 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m20:37:23.408512 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_produtos"} */
alter table "general_rtxt"."bronze_silver"."dim_produtos" rename to "dim_produtos__dbt_backup"
[0m20:37:23.467727 [debug] [Thread-3 (]: SQL status: SELECT 120 in 0.0 seconds
[0m20:37:23.470879 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m20:37:23.471215 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_vendedores"} */
alter table "general_rtxt"."bronze_silver"."dim_vendedores" rename to "dim_vendedores__dbt_backup"
[0m20:37:23.614366 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:37:23.617524 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m20:37:23.617900 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_produtos"} */
alter table "general_rtxt"."bronze_silver"."dim_produtos__dbt_tmp" rename to "dim_produtos"
[0m20:37:23.626746 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m20:37:23.629015 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m20:37:23.629375 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_lojas"} */
alter table "general_rtxt"."bronze_silver"."dim_lojas" rename to "dim_lojas__dbt_backup"
[0m20:37:23.659512 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:37:23.662470 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m20:37:23.662821 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_vendedores"} */
alter table "general_rtxt"."bronze_silver"."dim_vendedores__dbt_tmp" rename to "dim_vendedores"
[0m20:37:23.813626 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:37:23.825819 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:37:23.830597 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: COMMIT
[0m20:37:23.835450 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m20:37:23.836199 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m20:37:23.837002 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_lojas"} */
alter table "general_rtxt"."bronze_silver"."dim_lojas__dbt_tmp" rename to "dim_lojas"
[0m20:37:23.837382 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: COMMIT
[0m20:37:23.913318 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:37:23.916019 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: COMMIT
[0m20:37:23.916357 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m20:37:23.916618 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: COMMIT
[0m20:37:24.122837 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m20:37:24.123649 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m20:37:24.129802 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m20:37:24.133267 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m20:37:24.133952 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:37:24.134791 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_produtos"} */
drop table if exists "general_rtxt"."bronze_silver"."dim_produtos__dbt_backup" cascade
[0m20:37:24.135142 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_vendedores"} */
drop table if exists "general_rtxt"."bronze_silver"."dim_vendedores__dbt_backup" cascade
[0m20:37:24.136968 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: COMMIT
[0m20:37:24.137577 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m20:37:24.137862 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: COMMIT
[0m20:37:24.513218 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:37:24.515334 [debug] [Thread-3 (]: Timing info for model.vendas_dw.dim_vendedores (execute): 20:37:21.721650 => 20:37:24.515153
[0m20:37:24.515693 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: Close
[0m20:37:24.516050 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:37:24.516873 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcc6a6b5-76ce-46c2-aeab-0537493299cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99bf6fae50>]}
[0m20:37:24.518509 [debug] [Thread-2 (]: Timing info for model.vendas_dw.dim_produtos (execute): 20:37:21.748166 => 20:37:24.518295
[0m20:37:24.519208 [info ] [Thread-3 (]: 3 of 10 OK created sql table model bronze_silver.dim_vendedores ................ [[32mSELECT 120[0m in 2.84s]
[0m20:37:24.519872 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: Close
[0m20:37:24.520941 [debug] [Thread-3 (]: Finished running node model.vendas_dw.dim_vendedores
[0m20:37:24.521706 [debug] [Thread-3 (]: Began running node model.vendas_dw.stg_vendas
[0m20:37:24.522770 [info ] [Thread-3 (]: 5 of 10 START sql table model bronze_silver.stg_vendas ......................... [RUN]
[0m20:37:24.523630 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcc6a6b5-76ce-46c2-aeab-0537493299cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99bf6e7e90>]}
[0m20:37:24.524252 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.vendas_dw.dim_vendedores, now model.vendas_dw.stg_vendas)
[0m20:37:24.524999 [info ] [Thread-2 (]: 2 of 10 OK created sql table model bronze_silver.dim_produtos .................. [[32mSELECT 300[0m in 2.84s]
[0m20:37:24.525408 [debug] [Thread-3 (]: Began compiling node model.vendas_dw.stg_vendas
[0m20:37:24.526000 [debug] [Thread-2 (]: Finished running node model.vendas_dw.dim_produtos
[0m20:37:24.528829 [debug] [Thread-3 (]: Writing injected SQL for node "model.vendas_dw.stg_vendas"
[0m20:37:24.530921 [debug] [Thread-3 (]: Timing info for model.vendas_dw.stg_vendas (compile): 20:37:24.526359 => 20:37:24.530472
[0m20:37:24.531880 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:37:24.532639 [debug] [Thread-3 (]: Began executing node model.vendas_dw.stg_vendas
[0m20:37:24.535342 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m20:37:24.539886 [debug] [Thread-3 (]: Writing runtime sql for node "model.vendas_dw.stg_vendas"
[0m20:37:24.540535 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_lojas"} */
drop table if exists "general_rtxt"."bronze_silver"."dim_lojas__dbt_backup" cascade
[0m20:37:24.541236 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.stg_vendas"
[0m20:37:24.541626 [debug] [Thread-3 (]: On model.vendas_dw.stg_vendas: BEGIN
[0m20:37:24.541898 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:37:24.616774 [debug] [Thread-4 (]: SQL status: SELECT 30000 in 1.0 seconds
[0m20:37:24.619658 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m20:37:24.620029 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_devolucoes"} */
alter table "general_rtxt"."bronze_silver"."stg_devolucoes" rename to "stg_devolucoes__dbt_backup"
[0m20:37:24.730023 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:37:24.731764 [debug] [Thread-1 (]: Timing info for model.vendas_dw.dim_lojas (execute): 20:37:21.706176 => 20:37:24.731621
[0m20:37:24.732087 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: Close
[0m20:37:24.732746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcc6a6b5-76ce-46c2-aeab-0537493299cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99bf080510>]}
[0m20:37:24.733216 [info ] [Thread-1 (]: 1 of 10 OK created sql table model bronze_silver.dim_lojas ..................... [[32mSELECT 15[0m in 3.05s]
[0m20:37:24.733710 [debug] [Thread-1 (]: Finished running node model.vendas_dw.dim_lojas
[0m20:37:24.806396 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:37:24.809053 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m20:37:24.809421 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_devolucoes"} */
alter table "general_rtxt"."bronze_silver"."stg_devolucoes__dbt_tmp" rename to "stg_devolucoes"
[0m20:37:24.996062 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:37:24.998434 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: COMMIT
[0m20:37:24.998798 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m20:37:24.999065 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: COMMIT
[0m20:37:25.189869 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m20:37:25.192790 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m20:37:25.193102 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_devolucoes"} */
drop table if exists "general_rtxt"."bronze_silver"."stg_devolucoes__dbt_backup" cascade
[0m20:37:25.384742 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:37:25.386253 [debug] [Thread-4 (]: Timing info for model.vendas_dw.stg_devolucoes (execute): 20:37:21.751981 => 20:37:25.386100
[0m20:37:25.386566 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: Close
[0m20:37:25.387264 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcc6a6b5-76ce-46c2-aeab-0537493299cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99bf149e90>]}
[0m20:37:25.387724 [info ] [Thread-4 (]: 4 of 10 OK created sql table model bronze_silver.stg_devolucoes ................ [[32mSELECT 30000[0m in 3.71s]
[0m20:37:25.388165 [debug] [Thread-4 (]: Finished running node model.vendas_dw.stg_devolucoes
[0m20:37:25.389864 [debug] [Thread-2 (]: Began running node model.vendas_dw.fct_devolucoes
[0m20:37:25.390791 [info ] [Thread-2 (]: 6 of 10 START sql table model bronze_gold.fct_devolucoes ....................... [RUN]
[0m20:37:25.391428 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.vendas_dw.dim_produtos, now model.vendas_dw.fct_devolucoes)
[0m20:37:25.391751 [debug] [Thread-2 (]: Began compiling node model.vendas_dw.fct_devolucoes
[0m20:37:25.394177 [debug] [Thread-2 (]: Writing injected SQL for node "model.vendas_dw.fct_devolucoes"
[0m20:37:25.394970 [debug] [Thread-2 (]: Timing info for model.vendas_dw.fct_devolucoes (compile): 20:37:25.391963 => 20:37:25.394743
[0m20:37:25.395360 [debug] [Thread-2 (]: Began executing node model.vendas_dw.fct_devolucoes
[0m20:37:25.398837 [debug] [Thread-2 (]: Writing runtime sql for node "model.vendas_dw.fct_devolucoes"
[0m20:37:25.399540 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.fct_devolucoes"
[0m20:37:25.399937 [debug] [Thread-2 (]: On model.vendas_dw.fct_devolucoes: BEGIN
[0m20:37:25.400321 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:37:25.918239 [debug] [Thread-3 (]: SQL status: BEGIN in 1.0 seconds
[0m20:37:25.919014 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.stg_vendas"
[0m20:37:25.919681 [debug] [Thread-3 (]: On model.vendas_dw.stg_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_vendas"} */

  
    

  create  table "general_rtxt"."bronze_silver"."stg_vendas__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id_venda      as bigint)               as id_venda,
        cast(id_produto    as int)                  as id_produto,
        cast(preco         as numeric(12,2))        as preco,
        cast(quantidade    as int)                  as quantidade,
        cast(data_venda    as date)                 as data_venda,
        cast(id_cliente    as int)                  as id_cliente,
        cast(id_loja       as int)                  as id_loja,
        cast(id_vendedor   as int)                  as id_vendedor,
        lower(trim(meio_pagamento))                 as meio_pagamento,
        cast(parcelamento  as smallint)             as parcelamento
    from "general_rtxt"."bronze"."vendas"

)

select *
from src
  );
  
[0m20:37:27.098869 [debug] [Thread-2 (]: SQL status: BEGIN in 2.0 seconds
[0m20:37:27.099689 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.fct_devolucoes"
[0m20:37:27.099999 [debug] [Thread-2 (]: On model.vendas_dw.fct_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_devolucoes"} */

  
    

  create  table "general_rtxt"."bronze_gold"."fct_devolucoes__dbt_tmp"
  
  
    as
  
  (
    

with devol as (
    select * from "general_rtxt"."bronze_silver"."stg_devolucoes"
)

select
    id_venda,
    id_produto,
    id_loja,
    id_vendedor,
    id_cliente,
    data_venda,
    data_devolucao,
    quantidade,
    preco,
    quantidade * preco                             as valor_devolvido,
    motivo
from devol
  );
  
[0m20:37:28.214861 [debug] [Thread-2 (]: SQL status: SELECT 30000 in 1.0 seconds
[0m20:37:28.218001 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.fct_devolucoes"
[0m20:37:28.218407 [debug] [Thread-2 (]: On model.vendas_dw.fct_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_devolucoes"} */
alter table "general_rtxt"."bronze_gold"."fct_devolucoes__dbt_tmp" rename to "fct_devolucoes"
[0m20:37:28.403494 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:37:28.405664 [debug] [Thread-2 (]: On model.vendas_dw.fct_devolucoes: COMMIT
[0m20:37:28.405994 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.fct_devolucoes"
[0m20:37:28.406275 [debug] [Thread-2 (]: On model.vendas_dw.fct_devolucoes: COMMIT
[0m20:37:28.615997 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m20:37:28.618760 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.fct_devolucoes"
[0m20:37:28.619105 [debug] [Thread-2 (]: On model.vendas_dw.fct_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_devolucoes"} */
drop table if exists "general_rtxt"."bronze_gold"."fct_devolucoes__dbt_backup" cascade
[0m20:37:28.813194 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:37:28.815144 [debug] [Thread-2 (]: Timing info for model.vendas_dw.fct_devolucoes (execute): 20:37:25.395618 => 20:37:28.815004
[0m20:37:28.815478 [debug] [Thread-2 (]: On model.vendas_dw.fct_devolucoes: Close
[0m20:37:28.816156 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcc6a6b5-76ce-46c2-aeab-0537493299cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99beffeb90>]}
[0m20:37:28.816667 [info ] [Thread-2 (]: 6 of 10 OK created sql table model bronze_gold.fct_devolucoes .................. [[32mSELECT 30000[0m in 3.42s]
[0m20:37:28.817123 [debug] [Thread-2 (]: Finished running node model.vendas_dw.fct_devolucoes
[0m20:38:18.025288 [debug] [Thread-3 (]: Postgres adapter: Postgres error: could not extend file "base/16389/16716" with FileFallocate(): No space left on device
HINT:  Check free disk space.

[0m20:38:18.026098 [debug] [Thread-3 (]: On model.vendas_dw.stg_vendas: ROLLBACK
[0m20:38:18.227498 [debug] [Thread-3 (]: Timing info for model.vendas_dw.stg_vendas (execute): 20:37:24.535794 => 20:38:18.226957
[0m20:38:18.228044 [debug] [Thread-3 (]: On model.vendas_dw.stg_vendas: Close
[0m20:38:18.230884 [debug] [Thread-3 (]: Database Error in model stg_vendas (models/silver/stg_vendas.sql)
  could not extend file "base/16389/16716" with FileFallocate(): No space left on device
  HINT:  Check free disk space.
  compiled Code at target/run/vendas_dw/models/silver/stg_vendas.sql
[0m20:38:18.231368 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcc6a6b5-76ce-46c2-aeab-0537493299cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99befe5e10>]}
[0m20:38:18.231850 [error] [Thread-3 (]: 5 of 10 ERROR creating sql table model bronze_silver.stg_vendas ................ [[31mERROR[0m in 53.71s]
[0m20:38:18.232343 [debug] [Thread-3 (]: Finished running node model.vendas_dw.stg_vendas
[0m20:38:18.235185 [debug] [Thread-4 (]: Began running node model.vendas_dw.fct_vendas
[0m20:38:18.236061 [info ] [Thread-4 (]: 7 of 10 SKIP relation bronze_gold.fct_vendas ................................... [[33mSKIP[0m]
[0m20:38:18.236787 [debug] [Thread-4 (]: Finished running node model.vendas_dw.fct_vendas
[0m20:38:18.239479 [debug] [Thread-2 (]: Began running node model.vendas_dw.indicadores_vendas
[0m20:38:18.239946 [debug] [Thread-3 (]: Began running node model.vendas_dw.mart_receita_diaria_loja
[0m20:38:18.240378 [info ] [Thread-2 (]: 8 of 10 SKIP relation bronze_silver.indicadores_vendas ......................... [[33mSKIP[0m]
[0m20:38:18.240930 [debug] [Thread-1 (]: Began running node model.vendas_dw.mart_receita_mensal_categoria
[0m20:38:18.241403 [info ] [Thread-3 (]: 9 of 10 SKIP relation bronze_gold.mart_receita_diaria_loja ..................... [[33mSKIP[0m]
[0m20:38:18.241953 [debug] [Thread-2 (]: Finished running node model.vendas_dw.indicadores_vendas
[0m20:38:18.242434 [info ] [Thread-1 (]: 10 of 10 SKIP relation bronze_gold.mart_receita_mensal_categoria ............... [[33mSKIP[0m]
[0m20:38:18.242906 [debug] [Thread-3 (]: Finished running node model.vendas_dw.mart_receita_diaria_loja
[0m20:38:18.243967 [debug] [Thread-1 (]: Finished running node model.vendas_dw.mart_receita_mensal_categoria
[0m20:38:18.247651 [debug] [MainThread]: Using postgres connection "master"
[0m20:38:18.248282 [debug] [MainThread]: On master: BEGIN
[0m20:38:18.248724 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:38:19.943142 [debug] [MainThread]: SQL status: BEGIN in 2.0 seconds
[0m20:38:19.944012 [debug] [MainThread]: On master: COMMIT
[0m20:38:19.944259 [debug] [MainThread]: Using postgres connection "master"
[0m20:38:19.944488 [debug] [MainThread]: On master: COMMIT
[0m20:38:20.134377 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:38:20.135325 [debug] [MainThread]: On master: Close
[0m20:38:20.135986 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:38:20.136257 [debug] [MainThread]: Connection 'model.vendas_dw.dim_lojas' was properly closed.
[0m20:38:20.136475 [debug] [MainThread]: Connection 'model.vendas_dw.fct_devolucoes' was properly closed.
[0m20:38:20.136686 [debug] [MainThread]: Connection 'model.vendas_dw.stg_vendas' was properly closed.
[0m20:38:20.136896 [debug] [MainThread]: Connection 'model.vendas_dw.stg_devolucoes' was properly closed.
[0m20:38:20.137186 [info ] [MainThread]: 
[0m20:38:20.137483 [info ] [MainThread]: Finished running 10 table models in 0 hours 1 minutes and 4.37 seconds (64.37s).
[0m20:38:20.138496 [debug] [MainThread]: Command end result
[0m20:38:20.199847 [info ] [MainThread]: 
[0m20:38:20.200231 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:38:20.200516 [info ] [MainThread]: 
[0m20:38:20.200764 [error] [MainThread]: [33mDatabase Error in model stg_vendas (models/silver/stg_vendas.sql)[0m
[0m20:38:20.201004 [error] [MainThread]:   could not extend file "base/16389/16716" with FileFallocate(): No space left on device
[0m20:38:20.201251 [error] [MainThread]:   HINT:  Check free disk space.
[0m20:38:20.201501 [error] [MainThread]:   compiled Code at target/run/vendas_dw/models/silver/stg_vendas.sql
[0m20:38:20.201750 [info ] [MainThread]: 
[0m20:38:20.202019 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=4 TOTAL=10
[0m20:38:20.202446 [debug] [MainThread]: Command `dbt run` failed at 20:38:20.202364 after 64.61 seconds
[0m20:38:20.202752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c439af10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99bf984a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99bf984650>]}
[0m20:38:20.203036 [debug] [MainThread]: Flushing usage events
[0m16:14:03.574510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b5f1f1a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b5e21e890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b5dee8c10>]}


============================== 16:14:03.577982 | a25b8119-0a5c-4bd3-9ab6-f1d9fed5961b ==============================
[0m16:14:03.577982 [info ] [MainThread]: Running with dbt=1.6.0
[0m16:14:03.578448 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'quiet': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'version_check': 'True', 'introspect': 'True', 'profiles_dir': '/home/walterg/.dbt', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'fail_fast': 'False', 'log_format': 'default', 'warn_error': 'None'}
[0m16:14:03.648176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a25b8119-0a5c-4bd3-9ab6-f1d9fed5961b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b5e02ff10>]}
[0m16:14:03.660464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a25b8119-0a5c-4bd3-9ab6-f1d9fed5961b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b5db66e90>]}
[0m16:14:03.661230 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m16:14:03.668608 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m16:14:03.675802 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m16:14:03.676328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a25b8119-0a5c-4bd3-9ab6-f1d9fed5961b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b5db7dcd0>]}
[0m16:14:04.201149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a25b8119-0a5c-4bd3-9ab6-f1d9fed5961b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b5d9d5450>]}
[0m16:14:04.210221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a25b8119-0a5c-4bd3-9ab6-f1d9fed5961b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b5d5ac750>]}
[0m16:14:04.210676 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m16:14:04.210967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a25b8119-0a5c-4bd3-9ab6-f1d9fed5961b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b5d524150>]}
[0m16:14:04.212543 [info ] [MainThread]: 
[0m16:14:04.213210 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:14:04.215157 [debug] [ThreadPool]: Acquiring new postgres connection 'list_general_rtxt'
[0m16:14:04.221694 [debug] [ThreadPool]: Acquiring new postgres connection 'list_general_rtxt'
[0m16:14:04.225952 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt"
[0m16:14:04.228475 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt"
[0m16:14:04.229103 [debug] [ThreadPool]: On list_general_rtxt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt"} */

    select distinct nspname from pg_namespace
  
[0m16:14:04.229771 [debug] [ThreadPool]: On list_general_rtxt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt"} */

    select distinct nspname from pg_namespace
  
[0m16:14:04.230245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:14:04.230650 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:14:05.732670 [debug] [ThreadPool]: SQL status: SELECT 5 in 2.0 seconds
[0m16:14:05.734092 [debug] [ThreadPool]: On list_general_rtxt: Close
[0m16:14:05.959678 [debug] [ThreadPool]: SQL status: SELECT 5 in 2.0 seconds
[0m16:14:05.961471 [debug] [ThreadPool]: On list_general_rtxt: Close
[0m16:14:05.962930 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_general_rtxt, now create_general_rtxt_bronze_silver)
[0m16:14:05.963745 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_general_rtxt, now create_general_rtxt_bronze_gold)
[0m16:14:05.964393 [debug] [ThreadPool]: Creating schema "database: "general_rtxt"
schema: "bronze_silver"
"
[0m16:14:05.965036 [debug] [ThreadPool]: Creating schema "database: "general_rtxt"
schema: "bronze_gold"
"
[0m16:14:05.969408 [debug] [ThreadPool]: Using postgres connection "create_general_rtxt_bronze_silver"
[0m16:14:05.971662 [debug] [ThreadPool]: Using postgres connection "create_general_rtxt_bronze_gold"
[0m16:14:05.972206 [debug] [ThreadPool]: On create_general_rtxt_bronze_silver: BEGIN
[0m16:14:05.972809 [debug] [ThreadPool]: On create_general_rtxt_bronze_gold: BEGIN
[0m16:14:05.973253 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:14:05.973648 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:14:07.378068 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m16:14:07.378760 [debug] [ThreadPool]: Using postgres connection "create_general_rtxt_bronze_silver"
[0m16:14:07.379008 [debug] [ThreadPool]: On create_general_rtxt_bronze_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "create_general_rtxt_bronze_silver"} */
create schema if not exists "bronze_silver"
[0m16:14:07.557470 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m16:14:07.558523 [debug] [ThreadPool]: Using postgres connection "create_general_rtxt_bronze_gold"
[0m16:14:07.558816 [debug] [ThreadPool]: On create_general_rtxt_bronze_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "create_general_rtxt_bronze_gold"} */
create schema if not exists "bronze_gold"
[0m16:14:07.603445 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m16:14:07.604579 [debug] [ThreadPool]: On create_general_rtxt_bronze_silver: COMMIT
[0m16:14:07.604827 [debug] [ThreadPool]: Using postgres connection "create_general_rtxt_bronze_silver"
[0m16:14:07.605054 [debug] [ThreadPool]: On create_general_rtxt_bronze_silver: COMMIT
[0m16:14:07.754749 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m16:14:07.755888 [debug] [ThreadPool]: On create_general_rtxt_bronze_gold: COMMIT
[0m16:14:07.756138 [debug] [ThreadPool]: Using postgres connection "create_general_rtxt_bronze_gold"
[0m16:14:07.756391 [debug] [ThreadPool]: On create_general_rtxt_bronze_gold: COMMIT
[0m16:14:07.791736 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m16:14:07.792299 [debug] [ThreadPool]: On create_general_rtxt_bronze_silver: Close
[0m16:14:07.947278 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m16:14:07.948234 [debug] [ThreadPool]: On create_general_rtxt_bronze_gold: Close
[0m16:14:07.950811 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_general_rtxt_bronze_gold, now list_general_rtxt_bronze_silver)
[0m16:14:07.951731 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_general_rtxt_bronze_silver, now list_general_rtxt_bronze_gold)
[0m16:14:07.957112 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_silver"
[0m16:14:07.959912 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_gold"
[0m16:14:07.960314 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: BEGIN
[0m16:14:07.960875 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: BEGIN
[0m16:14:07.961276 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:14:07.961818 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:14:09.349428 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m16:14:09.350294 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_gold"
[0m16:14:09.350572 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt_bronze_gold"} */
select
      'general_rtxt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze_gold'
    union all
    select
      'general_rtxt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze_gold'
    union all
    select
      'general_rtxt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze_gold'
  
[0m16:14:09.465582 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m16:14:09.466504 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_silver"
[0m16:14:09.466765 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt_bronze_silver"} */
select
      'general_rtxt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze_silver'
    union all
    select
      'general_rtxt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze_silver'
    union all
    select
      'general_rtxt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze_silver'
  
[0m16:14:09.546852 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m16:14:09.548354 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: ROLLBACK
[0m16:14:09.688096 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m16:14:09.689484 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: ROLLBACK
[0m16:14:09.731040 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: Close
[0m16:14:09.876115 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: Close
[0m16:14:09.880738 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:09.881104 [debug] [MainThread]: On master: BEGIN
[0m16:14:09.881337 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:14:11.412243 [debug] [MainThread]: SQL status: BEGIN in 2.0 seconds
[0m16:14:11.413166 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:11.413457 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:14:11.613254 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:14:11.615199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a25b8119-0a5c-4bd3-9ab6-f1d9fed5961b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b5d9ae310>]}
[0m16:14:11.615900 [debug] [MainThread]: On master: ROLLBACK
[0m16:14:11.811538 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:11.812596 [debug] [MainThread]: On master: BEGIN
[0m16:14:12.188951 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:14:12.190054 [debug] [MainThread]: On master: COMMIT
[0m16:14:12.190606 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:12.190851 [debug] [MainThread]: On master: COMMIT
[0m16:14:12.377893 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:14:12.378875 [debug] [MainThread]: On master: Close
[0m16:14:12.380095 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:14:12.380419 [info ] [MainThread]: 
[0m16:14:12.403923 [debug] [Thread-1 (]: Began running node model.vendas_dw.dim_lojas
[0m16:14:12.404497 [debug] [Thread-2 (]: Began running node model.vendas_dw.dim_produtos
[0m16:14:12.405020 [debug] [Thread-3 (]: Began running node model.vendas_dw.dim_vendedores
[0m16:14:12.405422 [info ] [Thread-1 (]: 1 of 10 START sql table model bronze_silver.dim_lojas .......................... [RUN]
[0m16:14:12.405988 [debug] [Thread-4 (]: Began running node model.vendas_dw.stg_devolucoes
[0m16:14:12.406607 [info ] [Thread-2 (]: 2 of 10 START sql table model bronze_silver.dim_produtos ....................... [RUN]
[0m16:14:12.407072 [info ] [Thread-3 (]: 3 of 10 START sql table model bronze_silver.dim_vendedores ..................... [RUN]
[0m16:14:12.407704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_general_rtxt_bronze_silver, now model.vendas_dw.dim_lojas)
[0m16:14:12.408396 [info ] [Thread-4 (]: 4 of 10 START sql table model bronze_silver.stg_devolucoes ..................... [RUN]
[0m16:14:12.409070 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_general_rtxt_bronze_gold, now model.vendas_dw.dim_produtos)
[0m16:14:12.410003 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.vendas_dw.dim_vendedores'
[0m16:14:12.410424 [debug] [Thread-1 (]: Began compiling node model.vendas_dw.dim_lojas
[0m16:14:12.411245 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.vendas_dw.stg_devolucoes'
[0m16:14:12.411831 [debug] [Thread-2 (]: Began compiling node model.vendas_dw.dim_produtos
[0m16:14:12.412308 [debug] [Thread-3 (]: Began compiling node model.vendas_dw.dim_vendedores
[0m16:14:12.418875 [debug] [Thread-1 (]: Writing injected SQL for node "model.vendas_dw.dim_lojas"
[0m16:14:12.419551 [debug] [Thread-4 (]: Began compiling node model.vendas_dw.stg_devolucoes
[0m16:14:12.422026 [debug] [Thread-2 (]: Writing injected SQL for node "model.vendas_dw.dim_produtos"
[0m16:14:12.425324 [debug] [Thread-3 (]: Writing injected SQL for node "model.vendas_dw.dim_vendedores"
[0m16:14:12.428736 [debug] [Thread-4 (]: Writing injected SQL for node "model.vendas_dw.stg_devolucoes"
[0m16:14:12.429809 [debug] [Thread-1 (]: Timing info for model.vendas_dw.dim_lojas (compile): 16:14:12.412600 => 16:14:12.429446
[0m16:14:12.430627 [debug] [Thread-2 (]: Timing info for model.vendas_dw.dim_produtos (compile): 16:14:12.420023 => 16:14:12.430458
[0m16:14:12.431035 [debug] [Thread-1 (]: Began executing node model.vendas_dw.dim_lojas
[0m16:14:12.431409 [debug] [Thread-4 (]: Timing info for model.vendas_dw.stg_devolucoes (compile): 16:14:12.425963 => 16:14:12.431247
[0m16:14:12.432039 [debug] [Thread-3 (]: Timing info for model.vendas_dw.dim_vendedores (compile): 16:14:12.422397 => 16:14:12.431879
[0m16:14:12.432347 [debug] [Thread-2 (]: Began executing node model.vendas_dw.dim_produtos
[0m16:14:12.453668 [debug] [Thread-4 (]: Began executing node model.vendas_dw.stg_devolucoes
[0m16:14:12.462123 [debug] [Thread-1 (]: Writing runtime sql for node "model.vendas_dw.dim_lojas"
[0m16:14:12.462813 [debug] [Thread-3 (]: Began executing node model.vendas_dw.dim_vendedores
[0m16:14:12.466288 [debug] [Thread-2 (]: Writing runtime sql for node "model.vendas_dw.dim_produtos"
[0m16:14:12.471317 [debug] [Thread-4 (]: Writing runtime sql for node "model.vendas_dw.stg_devolucoes"
[0m16:14:12.476554 [debug] [Thread-3 (]: Writing runtime sql for node "model.vendas_dw.dim_vendedores"
[0m16:14:12.477332 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m16:14:12.478422 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m16:14:12.479021 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m16:14:12.479425 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: BEGIN
[0m16:14:12.479888 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: BEGIN
[0m16:14:12.480273 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: BEGIN
[0m16:14:12.480615 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m16:14:12.480962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:14:12.481304 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:14:12.481646 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:14:12.482001 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: BEGIN
[0m16:14:12.482851 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:14:13.850736 [debug] [Thread-3 (]: SQL status: BEGIN in 1.0 seconds
[0m16:14:13.851752 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m16:14:13.852034 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_vendedores"} */

  
    

  create  table "general_rtxt"."bronze_silver"."dim_vendedores__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id                as int)   as id_vendedor,
        nome_vendedor,
        cast(data_admissao     as date)  as data_admissao,
        endereco_vendedor,
        cast(data_nascimento   as date)  as data_nascimento
    from "general_rtxt"."bronze"."vendedores"

)

select *
from src
  );
  
[0m16:14:13.898174 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m16:14:13.898996 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m16:14:13.899299 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_lojas"} */

  
    

  create  table "general_rtxt"."bronze_silver"."dim_lojas__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id_loja  as int)   as id_loja,
        nome_loja,
        logradouro,
        cast("número" as int)   as numero,
        bairro,
        cidade,
        estado,
        cep
    from "general_rtxt"."bronze"."lojas"

)

select *
from src
  );
  
[0m16:14:13.987489 [debug] [Thread-2 (]: SQL status: BEGIN in 2.0 seconds
[0m16:14:13.988260 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m16:14:13.988559 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_produtos"} */

  
    

  create  table "general_rtxt"."bronze_silver"."dim_produtos__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id_produto         as int)           as id_produto,
        nome_produto,
        categoria,
        cast(percentual_imposto as numeric(5,2))  as percentual_imposto
    from "general_rtxt"."bronze"."produtos"

)

select *
from src
  );
  
[0m16:14:14.039093 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "id" does not exist
LINE 17:         cast(id                as int)   as id_vendedor,
                      ^

[0m16:14:14.040175 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: ROLLBACK
[0m16:14:14.086026 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "número" does not exist
LINE 20:         cast("número" as int)   as numero,
                      ^
HINT:  Perhaps you meant to reference the column "lojas.numero".

[0m16:14:14.086664 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: ROLLBACK
[0m16:14:14.103321 [debug] [Thread-4 (]: SQL status: BEGIN in 2.0 seconds
[0m16:14:14.104205 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m16:14:14.104504 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_devolucoes"} */

  
    

  create  table "general_rtxt"."bronze_silver"."stg_devolucoes__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id_venda       as bigint)              as id_venda,
        cast(id_produto     as int)                 as id_produto,
        cast(preco          as numeric(12,2))       as preco,
        cast(quantidade     as int)                 as quantidade,
        cast(data_venda     as date)                as data_venda,
        cast(data_devolucao as date)                as data_devolucao,
        cast(id_cliente     as int)                 as id_cliente,
        cast(id_loja        as int)                 as id_loja,
        cast(id_vendedor    as int)                 as id_vendedor,
        motivo
    from "general_rtxt"."bronze"."devolucoes"

)

select *
from src
  );
  
[0m16:14:14.195056 [debug] [Thread-2 (]: SQL status: SELECT 300 in 0.0 seconds
[0m16:14:14.199747 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m16:14:14.200135 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_produtos"} */
alter table "general_rtxt"."bronze_silver"."dim_produtos__dbt_tmp" rename to "dim_produtos"
[0m16:14:14.225072 [debug] [Thread-3 (]: Timing info for model.vendas_dw.dim_vendedores (execute): 16:14:12.472167 => 16:14:14.224798
[0m16:14:14.225463 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: Close
[0m16:14:14.234659 [debug] [Thread-3 (]: Database Error in model dim_vendedores (models/silver/dim_vendedores.sql)
  column "id" does not exist
  LINE 17:         cast(id                as int)   as id_vendedor,
                        ^
  compiled Code at target/run/vendas_dw/models/silver/dim_vendedores.sql
[0m16:14:14.235185 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a25b8119-0a5c-4bd3-9ab6-f1d9fed5961b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b5d94fd90>]}
[0m16:14:14.235770 [error] [Thread-3 (]: 3 of 10 ERROR creating sql table model bronze_silver.dim_vendedores ............ [[31mERROR[0m in 1.83s]
[0m16:14:14.236347 [debug] [Thread-3 (]: Finished running node model.vendas_dw.dim_vendedores
[0m16:14:14.236743 [debug] [Thread-3 (]: Began running node model.vendas_dw.stg_vendas
[0m16:14:14.237094 [info ] [Thread-3 (]: 5 of 10 START sql table model bronze_silver.stg_vendas ......................... [RUN]
[0m16:14:14.237688 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.vendas_dw.dim_vendedores, now model.vendas_dw.stg_vendas)
[0m16:14:14.239241 [debug] [Thread-3 (]: Began compiling node model.vendas_dw.stg_vendas
[0m16:14:14.242490 [debug] [Thread-3 (]: Writing injected SQL for node "model.vendas_dw.stg_vendas"
[0m16:14:14.243323 [debug] [Thread-3 (]: Timing info for model.vendas_dw.stg_vendas (compile): 16:14:14.239599 => 16:14:14.243114
[0m16:14:14.243672 [debug] [Thread-3 (]: Began executing node model.vendas_dw.stg_vendas
[0m16:14:14.248030 [debug] [Thread-3 (]: Writing runtime sql for node "model.vendas_dw.stg_vendas"
[0m16:14:14.248718 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.stg_vendas"
[0m16:14:14.249105 [debug] [Thread-3 (]: On model.vendas_dw.stg_vendas: BEGIN
[0m16:14:14.249507 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:14:14.271780 [debug] [Thread-1 (]: Timing info for model.vendas_dw.dim_lojas (execute): 16:14:12.432622 => 16:14:14.271332
[0m16:14:14.272402 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: Close
[0m16:14:14.274215 [debug] [Thread-1 (]: Database Error in model dim_lojas (models/silver/dim_lojas.sql)
  column "número" does not exist
  LINE 20:         cast("número" as int)   as numero,
                        ^
  HINT:  Perhaps you meant to reference the column "lojas.numero".
  compiled Code at target/run/vendas_dw/models/silver/dim_lojas.sql
[0m16:14:14.274684 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a25b8119-0a5c-4bd3-9ab6-f1d9fed5961b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b5db67890>]}
[0m16:14:14.275129 [error] [Thread-1 (]: 1 of 10 ERROR creating sql table model bronze_silver.dim_lojas ................. [[31mERROR[0m in 1.87s]
[0m16:14:14.275626 [debug] [Thread-1 (]: Finished running node model.vendas_dw.dim_lojas
[0m16:14:14.426422 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:14:14.440485 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: COMMIT
[0m16:14:14.440900 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m16:14:14.441185 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: COMMIT
[0m16:14:14.638170 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:14:14.645090 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m16:14:14.645498 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_produtos"} */
drop table if exists "general_rtxt"."bronze_silver"."dim_produtos__dbt_backup" cascade
[0m16:14:14.726046 [debug] [Thread-4 (]: SQL status: SELECT 30000 in 1.0 seconds
[0m16:14:14.729269 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m16:14:14.729593 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_devolucoes"} */
alter table "general_rtxt"."bronze_silver"."stg_devolucoes__dbt_tmp" rename to "stg_devolucoes"
[0m16:14:14.830547 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:14:14.832469 [debug] [Thread-2 (]: Timing info for model.vendas_dw.dim_produtos (execute): 16:14:12.463353 => 16:14:14.832311
[0m16:14:14.832784 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: Close
[0m16:14:14.833455 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a25b8119-0a5c-4bd3-9ab6-f1d9fed5961b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b5d436450>]}
[0m16:14:14.833933 [info ] [Thread-2 (]: 2 of 10 OK created sql table model bronze_silver.dim_produtos .................. [[32mSELECT 300[0m in 2.42s]
[0m16:14:14.834400 [debug] [Thread-2 (]: Finished running node model.vendas_dw.dim_produtos
[0m16:14:14.918231 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:14:14.920920 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: COMMIT
[0m16:14:14.921270 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m16:14:14.921552 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: COMMIT
[0m16:14:15.127055 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m16:14:15.130179 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m16:14:15.130545 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_devolucoes"} */
drop table if exists "general_rtxt"."bronze_silver"."stg_devolucoes__dbt_backup" cascade
[0m16:14:15.319173 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:14:15.320895 [debug] [Thread-4 (]: Timing info for model.vendas_dw.stg_devolucoes (execute): 16:14:12.466733 => 16:14:15.320757
[0m16:14:15.321196 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: Close
[0m16:14:15.321826 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a25b8119-0a5c-4bd3-9ab6-f1d9fed5961b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b5e21f3d0>]}
[0m16:14:15.322277 [info ] [Thread-4 (]: 4 of 10 OK created sql table model bronze_silver.stg_devolucoes ................ [[32mSELECT 30000[0m in 2.91s]
[0m16:14:15.322744 [debug] [Thread-4 (]: Finished running node model.vendas_dw.stg_devolucoes
[0m16:14:15.324479 [debug] [Thread-1 (]: Began running node model.vendas_dw.fct_devolucoes
[0m16:14:15.325486 [info ] [Thread-1 (]: 6 of 10 START sql table model bronze_gold.fct_devolucoes ....................... [RUN]
[0m16:14:15.325995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vendas_dw.dim_lojas, now model.vendas_dw.fct_devolucoes)
[0m16:14:15.326275 [debug] [Thread-1 (]: Began compiling node model.vendas_dw.fct_devolucoes
[0m16:14:15.328387 [debug] [Thread-1 (]: Writing injected SQL for node "model.vendas_dw.fct_devolucoes"
[0m16:14:15.329036 [debug] [Thread-1 (]: Timing info for model.vendas_dw.fct_devolucoes (compile): 16:14:15.326490 => 16:14:15.328855
[0m16:14:15.329431 [debug] [Thread-1 (]: Began executing node model.vendas_dw.fct_devolucoes
[0m16:14:15.333078 [debug] [Thread-1 (]: Writing runtime sql for node "model.vendas_dw.fct_devolucoes"
[0m16:14:15.333716 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_devolucoes"
[0m16:14:15.334011 [debug] [Thread-1 (]: On model.vendas_dw.fct_devolucoes: BEGIN
[0m16:14:15.334274 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:14:15.740979 [debug] [Thread-3 (]: SQL status: BEGIN in 1.0 seconds
[0m16:14:15.741642 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.stg_vendas"
[0m16:14:15.742265 [debug] [Thread-3 (]: On model.vendas_dw.stg_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_vendas"} */

  
    

  create  table "general_rtxt"."bronze_silver"."stg_vendas__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id_venda      as bigint)               as id_venda,
        cast(id_produto    as int)                  as id_produto,
        cast(preco         as numeric(12,2))        as preco,
        cast(quantidade    as int)                  as quantidade,
        cast(data_venda    as date)                 as data_venda,
        cast(id_cliente    as int)                  as id_cliente,
        cast(id_loja       as int)                  as id_loja,
        cast(id_vendedor   as int)                  as id_vendedor,
        lower(trim(meio_pagamento))                 as meio_pagamento,
        cast(parcelamento  as smallint)             as parcelamento
    from "general_rtxt"."bronze"."vendas"

)

select *
from src
  );
  
[0m16:14:17.028588 [debug] [Thread-1 (]: SQL status: BEGIN in 2.0 seconds
[0m16:14:17.029132 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_devolucoes"
[0m16:14:17.029422 [debug] [Thread-1 (]: On model.vendas_dw.fct_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_devolucoes"} */

  
    

  create  table "general_rtxt"."bronze_gold"."fct_devolucoes__dbt_tmp"
  
  
    as
  
  (
    

with devol as (
    select * from "general_rtxt"."bronze_silver"."stg_devolucoes"
)

select
    id_venda,
    id_produto,
    id_loja,
    id_vendedor,
    id_cliente,
    data_venda,
    data_devolucao,
    quantidade,
    preco,
    quantidade * preco                             as valor_devolvido,
    motivo
from devol
  );
  
[0m16:14:18.237816 [debug] [Thread-1 (]: SQL status: SELECT 30000 in 1.0 seconds
[0m16:14:18.240974 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_devolucoes"
[0m16:14:18.241289 [debug] [Thread-1 (]: On model.vendas_dw.fct_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_devolucoes"} */
alter table "general_rtxt"."bronze_gold"."fct_devolucoes__dbt_tmp" rename to "fct_devolucoes"
[0m16:14:18.429403 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:14:18.431756 [debug] [Thread-1 (]: On model.vendas_dw.fct_devolucoes: COMMIT
[0m16:14:18.432138 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_devolucoes"
[0m16:14:18.432414 [debug] [Thread-1 (]: On model.vendas_dw.fct_devolucoes: COMMIT
[0m16:14:18.731739 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:14:18.734509 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_devolucoes"
[0m16:14:18.734812 [debug] [Thread-1 (]: On model.vendas_dw.fct_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_devolucoes"} */
drop table if exists "general_rtxt"."bronze_gold"."fct_devolucoes__dbt_backup" cascade
[0m16:14:18.927962 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:14:18.929586 [debug] [Thread-1 (]: Timing info for model.vendas_dw.fct_devolucoes (execute): 16:14:15.329712 => 16:14:18.929452
[0m16:14:18.929906 [debug] [Thread-1 (]: On model.vendas_dw.fct_devolucoes: Close
[0m16:14:18.930558 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a25b8119-0a5c-4bd3-9ab6-f1d9fed5961b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b5d99be50>]}
[0m16:14:18.931018 [info ] [Thread-1 (]: 6 of 10 OK created sql table model bronze_gold.fct_devolucoes .................. [[32mSELECT 30000[0m in 3.60s]
[0m16:14:18.931463 [debug] [Thread-1 (]: Finished running node model.vendas_dw.fct_devolucoes
[0m16:14:59.052787 [debug] [Thread-3 (]: SQL status: SELECT 2000500 in 43.0 seconds
[0m16:14:59.056117 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.stg_vendas"
[0m16:14:59.056469 [debug] [Thread-3 (]: On model.vendas_dw.stg_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_vendas"} */
alter table "general_rtxt"."bronze_silver"."stg_vendas__dbt_tmp" rename to "stg_vendas"
[0m16:14:59.255163 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:14:59.257405 [debug] [Thread-3 (]: On model.vendas_dw.stg_vendas: COMMIT
[0m16:14:59.257742 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.stg_vendas"
[0m16:14:59.258005 [debug] [Thread-3 (]: On model.vendas_dw.stg_vendas: COMMIT
[0m16:14:59.446291 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m16:14:59.449195 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.stg_vendas"
[0m16:14:59.449557 [debug] [Thread-3 (]: On model.vendas_dw.stg_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_vendas"} */
drop table if exists "general_rtxt"."bronze_silver"."stg_vendas__dbt_backup" cascade
[0m16:14:59.635328 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:14:59.637206 [debug] [Thread-3 (]: Timing info for model.vendas_dw.stg_vendas (execute): 16:14:14.243875 => 16:14:59.637040
[0m16:14:59.637521 [debug] [Thread-3 (]: On model.vendas_dw.stg_vendas: Close
[0m16:14:59.638163 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a25b8119-0a5c-4bd3-9ab6-f1d9fed5961b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b5d501810>]}
[0m16:14:59.638617 [info ] [Thread-3 (]: 5 of 10 OK created sql table model bronze_silver.stg_vendas .................... [[32mSELECT 2000500[0m in 45.40s]
[0m16:14:59.639054 [debug] [Thread-3 (]: Finished running node model.vendas_dw.stg_vendas
[0m16:14:59.640287 [debug] [Thread-4 (]: Began running node model.vendas_dw.fct_vendas
[0m16:14:59.640716 [info ] [Thread-4 (]: 7 of 10 SKIP relation bronze_gold.fct_vendas ................................... [[33mSKIP[0m]
[0m16:14:59.641081 [debug] [Thread-4 (]: Finished running node model.vendas_dw.fct_vendas
[0m16:14:59.645280 [debug] [Thread-1 (]: Began running node model.vendas_dw.indicadores_vendas
[0m16:14:59.646269 [debug] [Thread-3 (]: Began running node model.vendas_dw.mart_receita_diaria_loja
[0m16:14:59.646840 [debug] [Thread-2 (]: Began running node model.vendas_dw.mart_receita_mensal_categoria
[0m16:14:59.647259 [info ] [Thread-1 (]: 8 of 10 SKIP relation bronze_silver.indicadores_vendas ......................... [[33mSKIP[0m]
[0m16:14:59.647881 [info ] [Thread-3 (]: 9 of 10 SKIP relation bronze_gold.mart_receita_diaria_loja ..................... [[33mSKIP[0m]
[0m16:14:59.648610 [info ] [Thread-2 (]: 10 of 10 SKIP relation bronze_gold.mart_receita_mensal_categoria ............... [[33mSKIP[0m]
[0m16:14:59.649318 [debug] [Thread-1 (]: Finished running node model.vendas_dw.indicadores_vendas
[0m16:14:59.650091 [debug] [Thread-3 (]: Finished running node model.vendas_dw.mart_receita_diaria_loja
[0m16:14:59.650570 [debug] [Thread-2 (]: Finished running node model.vendas_dw.mart_receita_mensal_categoria
[0m16:14:59.654106 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:59.655095 [debug] [MainThread]: On master: BEGIN
[0m16:14:59.655464 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:15:01.313410 [debug] [MainThread]: SQL status: BEGIN in 2.0 seconds
[0m16:15:01.314318 [debug] [MainThread]: On master: COMMIT
[0m16:15:01.314576 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:01.314796 [debug] [MainThread]: On master: COMMIT
[0m16:15:01.501150 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:15:01.502192 [debug] [MainThread]: On master: Close
[0m16:15:01.507220 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:15:01.507805 [debug] [MainThread]: Connection 'model.vendas_dw.dim_produtos' was properly closed.
[0m16:15:01.508075 [debug] [MainThread]: Connection 'model.vendas_dw.fct_devolucoes' was properly closed.
[0m16:15:01.508302 [debug] [MainThread]: Connection 'model.vendas_dw.stg_vendas' was properly closed.
[0m16:15:01.508549 [debug] [MainThread]: Connection 'model.vendas_dw.stg_devolucoes' was properly closed.
[0m16:15:01.508976 [info ] [MainThread]: 
[0m16:15:01.509330 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 57.30 seconds (57.30s).
[0m16:15:01.510661 [debug] [MainThread]: Command end result
[0m16:15:01.518344 [info ] [MainThread]: 
[0m16:15:01.518756 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:15:01.519015 [info ] [MainThread]: 
[0m16:15:01.519275 [error] [MainThread]: [33mDatabase Error in model dim_vendedores (models/silver/dim_vendedores.sql)[0m
[0m16:15:01.519559 [error] [MainThread]:   column "id" does not exist
[0m16:15:01.519843 [error] [MainThread]:   LINE 17:         cast(id                as int)   as id_vendedor,
[0m16:15:01.520108 [error] [MainThread]:                         ^
[0m16:15:01.520379 [error] [MainThread]:   compiled Code at target/run/vendas_dw/models/silver/dim_vendedores.sql
[0m16:15:01.520672 [info ] [MainThread]: 
[0m16:15:01.520966 [error] [MainThread]: [33mDatabase Error in model dim_lojas (models/silver/dim_lojas.sql)[0m
[0m16:15:01.521253 [error] [MainThread]:   column "número" does not exist
[0m16:15:01.521546 [error] [MainThread]:   LINE 20:         cast("número" as int)   as numero,
[0m16:15:01.521812 [error] [MainThread]:                         ^
[0m16:15:01.522166 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "lojas.numero".
[0m16:15:01.522587 [error] [MainThread]:   compiled Code at target/run/vendas_dw/models/silver/dim_lojas.sql
[0m16:15:01.523067 [info ] [MainThread]: 
[0m16:15:01.523619 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=4 TOTAL=10
[0m16:15:01.524336 [debug] [MainThread]: Command `dbt run` failed at 16:15:01.524185 after 57.96 seconds
[0m16:15:01.524951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b5e233710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b5e18aa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b5d930ad0>]}
[0m16:15:01.525578 [debug] [MainThread]: Flushing usage events
[0m16:19:47.322223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8e7c4a1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8e790ab50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8e7d9f9d0>]}


============================== 16:19:47.324923 | 6e6ae42f-0010-4e0d-a185-7b7227a4f11e ==============================
[0m16:19:47.324923 [info ] [MainThread]: Running with dbt=1.6.0
[0m16:19:47.325378 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/home/walterg/.dbt', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'static_parser': 'True', 'warn_error': 'None', 'version_check': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'log_format': 'default', 'write_json': 'True', 'printer_width': '80', 'debug': 'False', 'invocation_command': 'dbt run', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'no_print': 'None'}
[0m16:19:47.385648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e6ae42f-0010-4e0d-a185-7b7227a4f11e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8e7636b90>]}
[0m16:19:47.398042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e6ae42f-0010-4e0d-a185-7b7227a4f11e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8e76ab550>]}
[0m16:19:47.398705 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m16:19:47.406350 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m16:19:47.422305 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m16:19:47.422897 [debug] [MainThread]: Partial parsing: updated file: vendas_dw://models/silver/dim_vendedores.sql
[0m16:19:47.423228 [debug] [MainThread]: Partial parsing: updated file: vendas_dw://models/silver/dim_lojas.sql
[0m16:19:47.461810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e6ae42f-0010-4e0d-a185-7b7227a4f11e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8e7173490>]}
[0m16:19:47.478044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e6ae42f-0010-4e0d-a185-7b7227a4f11e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8e710b390>]}
[0m16:19:47.478570 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m16:19:47.478871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e6ae42f-0010-4e0d-a185-7b7227a4f11e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8e76ee7d0>]}
[0m16:19:47.480450 [info ] [MainThread]: 
[0m16:19:47.481125 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:19:47.482480 [debug] [ThreadPool]: Acquiring new postgres connection 'list_general_rtxt'
[0m16:19:47.488963 [debug] [ThreadPool]: Acquiring new postgres connection 'list_general_rtxt'
[0m16:19:47.493025 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt"
[0m16:19:47.495020 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt"
[0m16:19:47.495551 [debug] [ThreadPool]: On list_general_rtxt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt"} */

    select distinct nspname from pg_namespace
  
[0m16:19:47.496068 [debug] [ThreadPool]: On list_general_rtxt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt"} */

    select distinct nspname from pg_namespace
  
[0m16:19:47.496381 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:47.496679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:48.962768 [debug] [ThreadPool]: SQL status: SELECT 7 in 1.0 seconds
[0m16:19:48.964059 [debug] [ThreadPool]: On list_general_rtxt: Close
[0m16:19:48.968747 [debug] [ThreadPool]: SQL status: SELECT 7 in 1.0 seconds
[0m16:19:48.970498 [debug] [ThreadPool]: On list_general_rtxt: Close
[0m16:19:48.973130 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_general_rtxt, now list_general_rtxt_bronze_gold)
[0m16:19:48.974256 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_general_rtxt, now list_general_rtxt_bronze_silver)
[0m16:19:48.978684 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_gold"
[0m16:19:48.981386 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_silver"
[0m16:19:48.981865 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: BEGIN
[0m16:19:48.982579 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: BEGIN
[0m16:19:48.983034 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:48.983346 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:50.629664 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m16:19:50.630457 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_gold"
[0m16:19:50.630720 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt_bronze_gold"} */
select
      'general_rtxt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze_gold'
    union all
    select
      'general_rtxt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze_gold'
    union all
    select
      'general_rtxt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze_gold'
  
[0m16:19:50.823586 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m16:19:50.824699 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: ROLLBACK
[0m16:19:51.014969 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: Close
[0m16:19:51.814168 [debug] [ThreadPool]: SQL status: BEGIN in 3.0 seconds
[0m16:19:51.814816 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_silver"
[0m16:19:51.815083 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt_bronze_silver"} */
select
      'general_rtxt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze_silver'
    union all
    select
      'general_rtxt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze_silver'
    union all
    select
      'general_rtxt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze_silver'
  
[0m16:19:52.010526 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m16:19:52.011932 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: ROLLBACK
[0m16:19:52.212869 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: Close
[0m16:19:52.218031 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:52.218420 [debug] [MainThread]: On master: BEGIN
[0m16:19:52.218659 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:19:53.645478 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m16:19:53.646274 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:53.646619 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:19:53.839882 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:19:53.841105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e6ae42f-0010-4e0d-a185-7b7227a4f11e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8e71e1310>]}
[0m16:19:53.841619 [debug] [MainThread]: On master: ROLLBACK
[0m16:19:54.027889 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:54.028766 [debug] [MainThread]: On master: BEGIN
[0m16:19:54.403085 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:19:54.403665 [debug] [MainThread]: On master: COMMIT
[0m16:19:54.403897 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:54.404118 [debug] [MainThread]: On master: COMMIT
[0m16:19:54.591778 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:19:54.592408 [debug] [MainThread]: On master: Close
[0m16:19:54.593220 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:19:54.593542 [info ] [MainThread]: 
[0m16:19:54.596934 [debug] [Thread-1 (]: Began running node model.vendas_dw.dim_lojas
[0m16:19:54.597554 [debug] [Thread-2 (]: Began running node model.vendas_dw.dim_produtos
[0m16:19:54.598100 [debug] [Thread-3 (]: Began running node model.vendas_dw.dim_vendedores
[0m16:19:54.598805 [info ] [Thread-1 (]: 1 of 10 START sql table model bronze_silver.dim_lojas .......................... [RUN]
[0m16:19:54.599226 [debug] [Thread-4 (]: Began running node model.vendas_dw.stg_devolucoes
[0m16:19:54.599878 [info ] [Thread-2 (]: 2 of 10 START sql table model bronze_silver.dim_produtos ....................... [RUN]
[0m16:19:54.600440 [info ] [Thread-3 (]: 3 of 10 START sql table model bronze_silver.dim_vendedores ..................... [RUN]
[0m16:19:54.601089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_general_rtxt_bronze_silver, now model.vendas_dw.dim_lojas)
[0m16:19:54.601573 [info ] [Thread-4 (]: 4 of 10 START sql table model bronze_silver.stg_devolucoes ..................... [RUN]
[0m16:19:54.602247 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_general_rtxt_bronze_gold, now model.vendas_dw.dim_produtos)
[0m16:19:54.602898 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.vendas_dw.dim_vendedores'
[0m16:19:54.603258 [debug] [Thread-1 (]: Began compiling node model.vendas_dw.dim_lojas
[0m16:19:54.603878 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.vendas_dw.stg_devolucoes'
[0m16:19:54.604234 [debug] [Thread-2 (]: Began compiling node model.vendas_dw.dim_produtos
[0m16:19:54.604561 [debug] [Thread-3 (]: Began compiling node model.vendas_dw.dim_vendedores
[0m16:19:54.610306 [debug] [Thread-1 (]: Writing injected SQL for node "model.vendas_dw.dim_lojas"
[0m16:19:54.610822 [debug] [Thread-4 (]: Began compiling node model.vendas_dw.stg_devolucoes
[0m16:19:54.614044 [debug] [Thread-2 (]: Writing injected SQL for node "model.vendas_dw.dim_produtos"
[0m16:19:54.616501 [debug] [Thread-3 (]: Writing injected SQL for node "model.vendas_dw.dim_vendedores"
[0m16:19:54.619316 [debug] [Thread-4 (]: Writing injected SQL for node "model.vendas_dw.stg_devolucoes"
[0m16:19:54.620122 [debug] [Thread-1 (]: Timing info for model.vendas_dw.dim_lojas (compile): 16:19:54.604811 => 16:19:54.619785
[0m16:19:54.621121 [debug] [Thread-2 (]: Timing info for model.vendas_dw.dim_produtos (compile): 16:19:54.611161 => 16:19:54.620817
[0m16:19:54.622057 [debug] [Thread-3 (]: Timing info for model.vendas_dw.dim_vendedores (compile): 16:19:54.614414 => 16:19:54.621899
[0m16:19:54.622451 [debug] [Thread-1 (]: Began executing node model.vendas_dw.dim_lojas
[0m16:19:54.622925 [debug] [Thread-4 (]: Timing info for model.vendas_dw.stg_devolucoes (compile): 16:19:54.617071 => 16:19:54.622766
[0m16:19:54.623226 [debug] [Thread-2 (]: Began executing node model.vendas_dw.dim_produtos
[0m16:19:54.623565 [debug] [Thread-3 (]: Began executing node model.vendas_dw.dim_vendedores
[0m16:19:54.644715 [debug] [Thread-4 (]: Began executing node model.vendas_dw.stg_devolucoes
[0m16:19:54.652777 [debug] [Thread-1 (]: Writing runtime sql for node "model.vendas_dw.dim_lojas"
[0m16:19:54.656854 [debug] [Thread-2 (]: Writing runtime sql for node "model.vendas_dw.dim_produtos"
[0m16:19:54.660232 [debug] [Thread-3 (]: Writing runtime sql for node "model.vendas_dw.dim_vendedores"
[0m16:19:54.664050 [debug] [Thread-4 (]: Writing runtime sql for node "model.vendas_dw.stg_devolucoes"
[0m16:19:54.665480 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m16:19:54.666130 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: BEGIN
[0m16:19:54.666468 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m16:19:54.666797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:54.667174 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m16:19:54.667535 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m16:19:54.667836 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: BEGIN
[0m16:19:54.668305 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: BEGIN
[0m16:19:54.668812 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: BEGIN
[0m16:19:54.669136 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:19:54.669475 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:19:54.669788 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:19:56.107330 [debug] [Thread-3 (]: SQL status: BEGIN in 1.0 seconds
[0m16:19:56.108391 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m16:19:56.112555 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_vendedores"} */

  
    

  create  table "general_rtxt"."bronze_silver"."dim_vendedores__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id_vendedor                as int)   as id_vendedor,
        nome_vendedor,
        cast(data_admissao     as date)  as data_admissao,
        endereco_vendedor,
        cast(data_nascimento   as date)  as data_nascimento
    from "general_rtxt"."bronze"."vendedores"

)

select *
from src
  );
  
[0m16:19:56.159222 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m16:19:56.160246 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m16:19:56.160854 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_lojas"} */

  
    

  create  table "general_rtxt"."bronze_silver"."dim_lojas__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id_loja  as int)   as id_loja,
        nome_loja,
        logradouro,
        cast("numero" as int)   as numero,
        bairro,
        cidade,
        estado,
        cep
    from "general_rtxt"."bronze"."lojas"

)

select *
from src
  );
  
[0m16:19:56.243255 [debug] [Thread-4 (]: SQL status: BEGIN in 2.0 seconds
[0m16:19:56.244005 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m16:19:56.244296 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_devolucoes"} */

  
    

  create  table "general_rtxt"."bronze_silver"."stg_devolucoes__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id_venda       as bigint)              as id_venda,
        cast(id_produto     as int)                 as id_produto,
        cast(preco          as numeric(12,2))       as preco,
        cast(quantidade     as int)                 as quantidade,
        cast(data_venda     as date)                as data_venda,
        cast(data_devolucao as date)                as data_devolucao,
        cast(id_cliente     as int)                 as id_cliente,
        cast(id_loja        as int)                 as id_loja,
        cast(id_vendedor    as int)                 as id_vendedor,
        motivo
    from "general_rtxt"."bronze"."devolucoes"

)

select *
from src
  );
  
[0m16:19:56.290248 [debug] [Thread-2 (]: SQL status: BEGIN in 2.0 seconds
[0m16:19:56.290964 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m16:19:56.291275 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_produtos"} */

  
    

  create  table "general_rtxt"."bronze_silver"."dim_produtos__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id_produto         as int)           as id_produto,
        nome_produto,
        categoria,
        cast(percentual_imposto as numeric(5,2))  as percentual_imposto
    from "general_rtxt"."bronze"."produtos"

)

select *
from src
  );
  
[0m16:19:56.337387 [debug] [Thread-3 (]: SQL status: SELECT 120 in 0.0 seconds
[0m16:19:56.343100 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m16:19:56.343513 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_vendedores"} */
alter table "general_rtxt"."bronze_silver"."dim_vendedores__dbt_tmp" rename to "dim_vendedores"
[0m16:19:56.358315 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m16:19:56.361760 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m16:19:56.362115 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_lojas"} */
alter table "general_rtxt"."bronze_silver"."dim_lojas__dbt_tmp" rename to "dim_lojas"
[0m16:19:56.552385 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:19:56.561483 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:19:56.567414 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: COMMIT
[0m16:19:56.570516 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m16:19:56.570069 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: COMMIT
[0m16:19:56.570812 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: COMMIT
[0m16:19:56.571154 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m16:19:56.571568 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: COMMIT
[0m16:19:56.633665 [debug] [Thread-2 (]: SQL status: SELECT 300 in 0.0 seconds
[0m16:19:56.636502 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m16:19:56.636851 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_produtos"} */
alter table "general_rtxt"."bronze_silver"."dim_produtos" rename to "dim_produtos__dbt_backup"
[0m16:19:56.831043 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m16:19:56.837972 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m16:19:56.838380 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_vendedores"} */
drop table if exists "general_rtxt"."bronze_silver"."dim_vendedores__dbt_backup" cascade
[0m16:19:56.878663 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:19:56.879460 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:19:56.880040 [debug] [Thread-4 (]: SQL status: SELECT 30000 in 1.0 seconds
[0m16:19:56.882338 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m16:19:56.886297 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m16:19:56.889592 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m16:19:56.890294 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_lojas"} */
drop table if exists "general_rtxt"."bronze_silver"."dim_lojas__dbt_backup" cascade
[0m16:19:56.891313 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_produtos"} */
alter table "general_rtxt"."bronze_silver"."dim_produtos__dbt_tmp" rename to "dim_produtos"
[0m16:19:56.892329 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_devolucoes"} */
alter table "general_rtxt"."bronze_silver"."stg_devolucoes" rename to "stg_devolucoes__dbt_backup"
[0m16:19:57.026480 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:19:57.028307 [debug] [Thread-3 (]: Timing info for model.vendas_dw.dim_vendedores (execute): 16:19:54.657215 => 16:19:57.028163
[0m16:19:57.028637 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: Close
[0m16:19:57.029289 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e6ae42f-0010-4e0d-a185-7b7227a4f11e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8e6f0ed50>]}
[0m16:19:57.029803 [info ] [Thread-3 (]: 3 of 10 OK created sql table model bronze_silver.dim_vendedores ................ [[32mSELECT 120[0m in 2.43s]
[0m16:19:57.030277 [debug] [Thread-3 (]: Finished running node model.vendas_dw.dim_vendedores
[0m16:19:57.030688 [debug] [Thread-3 (]: Began running node model.vendas_dw.stg_vendas
[0m16:19:57.031031 [info ] [Thread-3 (]: 5 of 10 START sql table model bronze_silver.stg_vendas ......................... [RUN]
[0m16:19:57.031600 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.vendas_dw.dim_vendedores, now model.vendas_dw.stg_vendas)
[0m16:19:57.032195 [debug] [Thread-3 (]: Began compiling node model.vendas_dw.stg_vendas
[0m16:19:57.034690 [debug] [Thread-3 (]: Writing injected SQL for node "model.vendas_dw.stg_vendas"
[0m16:19:57.035609 [debug] [Thread-3 (]: Timing info for model.vendas_dw.stg_vendas (compile): 16:19:57.032529 => 16:19:57.035320
[0m16:19:57.035974 [debug] [Thread-3 (]: Began executing node model.vendas_dw.stg_vendas
[0m16:19:57.039150 [debug] [Thread-3 (]: Writing runtime sql for node "model.vendas_dw.stg_vendas"
[0m16:19:57.039784 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.stg_vendas"
[0m16:19:57.040079 [debug] [Thread-3 (]: On model.vendas_dw.stg_vendas: BEGIN
[0m16:19:57.040333 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:19:57.078415 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:19:57.080625 [debug] [Thread-1 (]: Timing info for model.vendas_dw.dim_lojas (execute): 16:19:54.623826 => 16:19:57.080469
[0m16:19:57.081139 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:19:57.081714 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: Close
[0m16:19:57.082203 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:19:57.086023 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: COMMIT
[0m16:19:57.087477 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e6ae42f-0010-4e0d-a185-7b7227a4f11e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8e6f545d0>]}
[0m16:19:57.090312 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m16:19:57.091037 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m16:19:57.092122 [info ] [Thread-1 (]: 1 of 10 OK created sql table model bronze_silver.dim_lojas ..................... [[32mSELECT 15[0m in 2.49s]
[0m16:19:57.092817 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_devolucoes"} */
alter table "general_rtxt"."bronze_silver"."stg_devolucoes__dbt_tmp" rename to "stg_devolucoes"
[0m16:19:57.093195 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: COMMIT
[0m16:19:57.093670 [debug] [Thread-1 (]: Finished running node model.vendas_dw.dim_lojas
[0m16:19:57.360638 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:19:57.361401 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:19:57.363787 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m16:19:57.366349 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: COMMIT
[0m16:19:57.367072 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_produtos"} */
drop table if exists "general_rtxt"."bronze_silver"."dim_produtos__dbt_backup" cascade
[0m16:19:57.367687 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m16:19:57.368144 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: COMMIT
[0m16:19:57.567828 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m16:19:57.568550 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:19:57.571923 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m16:19:57.573863 [debug] [Thread-2 (]: Timing info for model.vendas_dw.dim_produtos (execute): 16:19:54.653219 => 16:19:57.573715
[0m16:19:57.574276 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_devolucoes"} */
drop table if exists "general_rtxt"."bronze_silver"."stg_devolucoes__dbt_backup" cascade
[0m16:19:57.574664 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: Close
[0m16:19:57.575473 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e6ae42f-0010-4e0d-a185-7b7227a4f11e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8e71711d0>]}
[0m16:19:57.576030 [info ] [Thread-2 (]: 2 of 10 OK created sql table model bronze_silver.dim_produtos .................. [[32mSELECT 300[0m in 2.97s]
[0m16:19:57.576562 [debug] [Thread-2 (]: Finished running node model.vendas_dw.dim_produtos
[0m16:19:57.779264 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:19:57.781347 [debug] [Thread-4 (]: Timing info for model.vendas_dw.stg_devolucoes (execute): 16:19:54.660666 => 16:19:57.781199
[0m16:19:57.781670 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: Close
[0m16:19:57.782463 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e6ae42f-0010-4e0d-a185-7b7227a4f11e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8e761f590>]}
[0m16:19:57.782971 [info ] [Thread-4 (]: 4 of 10 OK created sql table model bronze_silver.stg_devolucoes ................ [[32mSELECT 30000[0m in 3.18s]
[0m16:19:57.783414 [debug] [Thread-4 (]: Finished running node model.vendas_dw.stg_devolucoes
[0m16:19:57.784768 [debug] [Thread-1 (]: Began running node model.vendas_dw.fct_devolucoes
[0m16:19:57.785130 [info ] [Thread-1 (]: 6 of 10 START sql table model bronze_gold.fct_devolucoes ....................... [RUN]
[0m16:19:57.785625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vendas_dw.dim_lojas, now model.vendas_dw.fct_devolucoes)
[0m16:19:57.785911 [debug] [Thread-1 (]: Began compiling node model.vendas_dw.fct_devolucoes
[0m16:19:57.788015 [debug] [Thread-1 (]: Writing injected SQL for node "model.vendas_dw.fct_devolucoes"
[0m16:19:57.788734 [debug] [Thread-1 (]: Timing info for model.vendas_dw.fct_devolucoes (compile): 16:19:57.786123 => 16:19:57.788544
[0m16:19:57.789104 [debug] [Thread-1 (]: Began executing node model.vendas_dw.fct_devolucoes
[0m16:19:57.792830 [debug] [Thread-1 (]: Writing runtime sql for node "model.vendas_dw.fct_devolucoes"
[0m16:19:57.793483 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_devolucoes"
[0m16:19:57.793786 [debug] [Thread-1 (]: On model.vendas_dw.fct_devolucoes: BEGIN
[0m16:19:57.794040 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:58.417169 [debug] [Thread-3 (]: SQL status: BEGIN in 1.0 seconds
[0m16:19:58.417591 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.stg_vendas"
[0m16:19:58.417877 [debug] [Thread-3 (]: On model.vendas_dw.stg_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_vendas"} */

  
    

  create  table "general_rtxt"."bronze_silver"."stg_vendas__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id_venda      as bigint)               as id_venda,
        cast(id_produto    as int)                  as id_produto,
        cast(preco         as numeric(12,2))        as preco,
        cast(quantidade    as int)                  as quantidade,
        cast(data_venda    as date)                 as data_venda,
        cast(id_cliente    as int)                  as id_cliente,
        cast(id_loja       as int)                  as id_loja,
        cast(id_vendedor   as int)                  as id_vendedor,
        lower(trim(meio_pagamento))                 as meio_pagamento,
        cast(parcelamento  as smallint)             as parcelamento
    from "general_rtxt"."bronze"."vendas"

)

select *
from src
  );
  
[0m16:19:59.229012 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m16:19:59.229832 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_devolucoes"
[0m16:19:59.230108 [debug] [Thread-1 (]: On model.vendas_dw.fct_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_devolucoes"} */

  
    

  create  table "general_rtxt"."bronze_gold"."fct_devolucoes__dbt_tmp"
  
  
    as
  
  (
    

with devol as (
    select * from "general_rtxt"."bronze_silver"."stg_devolucoes"
)

select
    id_venda,
    id_produto,
    id_loja,
    id_vendedor,
    id_cliente,
    data_venda,
    data_devolucao,
    quantidade,
    preco,
    quantidade * preco                             as valor_devolvido,
    motivo
from devol
  );
  
[0m16:20:00.530501 [debug] [Thread-1 (]: SQL status: SELECT 30000 in 1.0 seconds
[0m16:20:00.533153 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_devolucoes"
[0m16:20:00.533554 [debug] [Thread-1 (]: On model.vendas_dw.fct_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_devolucoes"} */
alter table "general_rtxt"."bronze_gold"."fct_devolucoes" rename to "fct_devolucoes__dbt_backup"
[0m16:20:00.739316 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:20:00.742461 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_devolucoes"
[0m16:20:00.742775 [debug] [Thread-1 (]: On model.vendas_dw.fct_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_devolucoes"} */
alter table "general_rtxt"."bronze_gold"."fct_devolucoes__dbt_tmp" rename to "fct_devolucoes"
[0m16:20:00.929103 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:20:00.931454 [debug] [Thread-1 (]: On model.vendas_dw.fct_devolucoes: COMMIT
[0m16:20:00.931773 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_devolucoes"
[0m16:20:00.932029 [debug] [Thread-1 (]: On model.vendas_dw.fct_devolucoes: COMMIT
[0m16:20:01.235801 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:20:01.239142 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_devolucoes"
[0m16:20:01.239536 [debug] [Thread-1 (]: On model.vendas_dw.fct_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_devolucoes"} */
drop table if exists "general_rtxt"."bronze_gold"."fct_devolucoes__dbt_backup" cascade
[0m16:20:01.529156 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:20:01.531275 [debug] [Thread-1 (]: Timing info for model.vendas_dw.fct_devolucoes (execute): 16:19:57.789391 => 16:20:01.531126
[0m16:20:01.531594 [debug] [Thread-1 (]: On model.vendas_dw.fct_devolucoes: Close
[0m16:20:01.532306 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e6ae42f-0010-4e0d-a185-7b7227a4f11e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8e70c87d0>]}
[0m16:20:01.532765 [info ] [Thread-1 (]: 6 of 10 OK created sql table model bronze_gold.fct_devolucoes .................. [[32mSELECT 30000[0m in 3.75s]
[0m16:20:01.533194 [debug] [Thread-1 (]: Finished running node model.vendas_dw.fct_devolucoes
[0m16:20:46.444202 [debug] [Thread-3 (]: SQL status: SELECT 2000500 in 48.0 seconds
[0m16:20:46.447822 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.stg_vendas"
[0m16:20:46.448242 [debug] [Thread-3 (]: On model.vendas_dw.stg_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_vendas"} */
alter table "general_rtxt"."bronze_silver"."stg_vendas" rename to "stg_vendas__dbt_backup"
[0m16:20:46.637512 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:20:46.642121 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.stg_vendas"
[0m16:20:46.642540 [debug] [Thread-3 (]: On model.vendas_dw.stg_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_vendas"} */
alter table "general_rtxt"."bronze_silver"."stg_vendas__dbt_tmp" rename to "stg_vendas"
[0m16:20:46.829083 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:20:46.831120 [debug] [Thread-3 (]: On model.vendas_dw.stg_vendas: COMMIT
[0m16:20:46.831531 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.stg_vendas"
[0m16:20:46.831796 [debug] [Thread-3 (]: On model.vendas_dw.stg_vendas: COMMIT
[0m16:20:47.017814 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m16:20:47.065864 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.stg_vendas"
[0m16:20:47.066277 [debug] [Thread-3 (]: On model.vendas_dw.stg_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_vendas"} */
drop table if exists "general_rtxt"."bronze_silver"."stg_vendas__dbt_backup" cascade
[0m16:20:47.334172 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:20:47.335844 [debug] [Thread-3 (]: Timing info for model.vendas_dw.stg_vendas (execute): 16:19:57.036183 => 16:20:47.335710
[0m16:20:47.336144 [debug] [Thread-3 (]: On model.vendas_dw.stg_vendas: Close
[0m16:20:47.336788 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e6ae42f-0010-4e0d-a185-7b7227a4f11e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8e76f2110>]}
[0m16:20:47.337239 [info ] [Thread-3 (]: 5 of 10 OK created sql table model bronze_silver.stg_vendas .................... [[32mSELECT 2000500[0m in 50.31s]
[0m16:20:47.337693 [debug] [Thread-3 (]: Finished running node model.vendas_dw.stg_vendas
[0m16:20:47.339465 [debug] [Thread-4 (]: Began running node model.vendas_dw.fct_vendas
[0m16:20:47.340194 [info ] [Thread-4 (]: 7 of 10 START sql table model bronze_gold.fct_vendas ........................... [RUN]
[0m16:20:47.341501 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.vendas_dw.stg_devolucoes, now model.vendas_dw.fct_vendas)
[0m16:20:47.341789 [debug] [Thread-4 (]: Began compiling node model.vendas_dw.fct_vendas
[0m16:20:47.344585 [debug] [Thread-4 (]: Writing injected SQL for node "model.vendas_dw.fct_vendas"
[0m16:20:47.345239 [debug] [Thread-4 (]: Timing info for model.vendas_dw.fct_vendas (compile): 16:20:47.341980 => 16:20:47.345067
[0m16:20:47.345610 [debug] [Thread-4 (]: Began executing node model.vendas_dw.fct_vendas
[0m16:20:47.348809 [debug] [Thread-4 (]: Writing runtime sql for node "model.vendas_dw.fct_vendas"
[0m16:20:47.349402 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m16:20:47.349689 [debug] [Thread-4 (]: On model.vendas_dw.fct_vendas: BEGIN
[0m16:20:47.349949 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:20:49.020860 [debug] [Thread-4 (]: SQL status: BEGIN in 2.0 seconds
[0m16:20:49.021491 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m16:20:49.021801 [debug] [Thread-4 (]: On model.vendas_dw.fct_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_vendas"} */

  
    

  create  table "general_rtxt"."bronze_gold"."fct_vendas__dbt_tmp"
  
  
    as
  
  (
    

with ventes as (
    select * from "general_rtxt"."bronze_silver"."stg_vendas"
),

dim_produtos   as (select * from "general_rtxt"."bronze_silver"."dim_produtos" ),
dim_lojas      as (select * from "general_rtxt"."bronze_silver"."dim_lojas" ),
dim_vendedores as (select * from "general_rtxt"."bronze_silver"."dim_vendedores" )

select
    v.id_venda,
    v.id_produto,
    v.id_loja,
    v.id_vendedor,
    v.id_cliente,
    v.data_venda,
    v.quantidade,
    v.preco,
    v.quantidade * v.preco                                   as receita_bruta,
    v.meio_pagamento,
    v.parcelamento,

    -- dimensões
    p.nome_produto,
    p.categoria,
    l.nome_loja,
    l.cidade,
    ve.nome_vendedor
from ventes v
left join dim_produtos   p  on v.id_produto  = p.id_produto
left join dim_lojas      l  on v.id_loja     = l.id_loja
left join dim_vendedores ve on v.id_vendedor = ve.id_vendedor
  );
  
[0m16:22:05.934935 [debug] [Thread-4 (]: SQL status: SELECT 2000500 in 77.0 seconds
[0m16:22:05.938728 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m16:22:05.939093 [debug] [Thread-4 (]: On model.vendas_dw.fct_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_vendas"} */
alter table "general_rtxt"."bronze_gold"."fct_vendas__dbt_tmp" rename to "fct_vendas"
[0m16:22:06.145254 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:22:06.147274 [debug] [Thread-4 (]: On model.vendas_dw.fct_vendas: COMMIT
[0m16:22:06.147616 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m16:22:06.147880 [debug] [Thread-4 (]: On model.vendas_dw.fct_vendas: COMMIT
[0m16:22:06.341723 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m16:22:06.344393 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m16:22:06.344749 [debug] [Thread-4 (]: On model.vendas_dw.fct_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_vendas"} */
drop table if exists "general_rtxt"."bronze_gold"."fct_vendas__dbt_backup" cascade
[0m16:22:06.532632 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:22:06.534522 [debug] [Thread-4 (]: Timing info for model.vendas_dw.fct_vendas (execute): 16:20:47.345829 => 16:22:06.534387
[0m16:22:06.534826 [debug] [Thread-4 (]: On model.vendas_dw.fct_vendas: Close
[0m16:22:06.535453 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e6ae42f-0010-4e0d-a185-7b7227a4f11e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8e93a6e50>]}
[0m16:22:06.535880 [info ] [Thread-4 (]: 7 of 10 OK created sql table model bronze_gold.fct_vendas ...................... [[32mSELECT 2000500[0m in 79.19s]
[0m16:22:06.536332 [debug] [Thread-4 (]: Finished running node model.vendas_dw.fct_vendas
[0m16:22:06.538212 [debug] [Thread-1 (]: Began running node model.vendas_dw.indicadores_vendas
[0m16:22:06.538696 [debug] [Thread-3 (]: Began running node model.vendas_dw.mart_receita_diaria_loja
[0m16:22:06.539150 [info ] [Thread-1 (]: 8 of 10 START sql table model bronze_silver.indicadores_vendas ................. [RUN]
[0m16:22:06.539700 [debug] [Thread-2 (]: Began running node model.vendas_dw.mart_receita_mensal_categoria
[0m16:22:06.540082 [info ] [Thread-3 (]: 9 of 10 START sql table model bronze_gold.mart_receita_diaria_loja ............. [RUN]
[0m16:22:06.540691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vendas_dw.fct_devolucoes, now model.vendas_dw.indicadores_vendas)
[0m16:22:06.541114 [info ] [Thread-2 (]: 10 of 10 START sql table model bronze_gold.mart_receita_mensal_categoria ....... [RUN]
[0m16:22:06.541653 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.vendas_dw.stg_vendas, now model.vendas_dw.mart_receita_diaria_loja)
[0m16:22:06.542380 [debug] [Thread-1 (]: Began compiling node model.vendas_dw.indicadores_vendas
[0m16:22:06.543302 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.vendas_dw.dim_produtos, now model.vendas_dw.mart_receita_mensal_categoria)
[0m16:22:06.543804 [debug] [Thread-3 (]: Began compiling node model.vendas_dw.mart_receita_diaria_loja
[0m16:22:06.546477 [debug] [Thread-1 (]: Writing injected SQL for node "model.vendas_dw.indicadores_vendas"
[0m16:22:06.547070 [debug] [Thread-2 (]: Began compiling node model.vendas_dw.mart_receita_mensal_categoria
[0m16:22:06.549798 [debug] [Thread-3 (]: Writing injected SQL for node "model.vendas_dw.mart_receita_diaria_loja"
[0m16:22:06.552871 [debug] [Thread-2 (]: Writing injected SQL for node "model.vendas_dw.mart_receita_mensal_categoria"
[0m16:22:06.553807 [debug] [Thread-1 (]: Timing info for model.vendas_dw.indicadores_vendas (compile): 16:22:06.544104 => 16:22:06.553477
[0m16:22:06.554529 [debug] [Thread-3 (]: Timing info for model.vendas_dw.mart_receita_diaria_loja (compile): 16:22:06.547463 => 16:22:06.554351
[0m16:22:06.554986 [debug] [Thread-1 (]: Began executing node model.vendas_dw.indicadores_vendas
[0m16:22:06.555782 [debug] [Thread-2 (]: Timing info for model.vendas_dw.mart_receita_mensal_categoria (compile): 16:22:06.550399 => 16:22:06.555510
[0m16:22:06.556121 [debug] [Thread-3 (]: Began executing node model.vendas_dw.mart_receita_diaria_loja
[0m16:22:06.559712 [debug] [Thread-1 (]: Writing runtime sql for node "model.vendas_dw.indicadores_vendas"
[0m16:22:06.560233 [debug] [Thread-2 (]: Began executing node model.vendas_dw.mart_receita_mensal_categoria
[0m16:22:06.563910 [debug] [Thread-3 (]: Writing runtime sql for node "model.vendas_dw.mart_receita_diaria_loja"
[0m16:22:06.568044 [debug] [Thread-2 (]: Writing runtime sql for node "model.vendas_dw.mart_receita_mensal_categoria"
[0m16:22:06.568760 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.indicadores_vendas"
[0m16:22:06.569663 [debug] [Thread-1 (]: On model.vendas_dw.indicadores_vendas: BEGIN
[0m16:22:06.570165 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.mart_receita_mensal_categoria"
[0m16:22:06.570481 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.mart_receita_diaria_loja"
[0m16:22:06.570795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:22:06.571129 [debug] [Thread-2 (]: On model.vendas_dw.mart_receita_mensal_categoria: BEGIN
[0m16:22:06.571441 [debug] [Thread-3 (]: On model.vendas_dw.mart_receita_diaria_loja: BEGIN
[0m16:22:06.571891 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:22:06.572205 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:22:08.126591 [debug] [Thread-3 (]: SQL status: BEGIN in 2.0 seconds
[0m16:22:08.127264 [debug] [Thread-2 (]: SQL status: BEGIN in 2.0 seconds
[0m16:22:08.127629 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.mart_receita_diaria_loja"
[0m16:22:08.127927 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.mart_receita_mensal_categoria"
[0m16:22:08.128244 [debug] [Thread-3 (]: On model.vendas_dw.mart_receita_diaria_loja: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.mart_receita_diaria_loja"} */

  
    

  create  table "general_rtxt"."bronze_gold"."mart_receita_diaria_loja__dbt_tmp"
  
  
    as
  
  (
    

with fct as (
    select * from "general_rtxt"."bronze_gold"."fct_vendas"
)

select
    data_venda,
    id_loja,
    nome_loja,
    sum(receita_bruta)                           as receita_diaria,
    count(distinct id_venda)                     as qtd_vendas,
    sum(quantidade)                              as itens_vendidos
from fct
group by data_venda, id_loja, nome_loja
  );
  
[0m16:22:08.128579 [debug] [Thread-2 (]: On model.vendas_dw.mart_receita_mensal_categoria: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.mart_receita_mensal_categoria"} */

  
    

  create  table "general_rtxt"."bronze_gold"."mart_receita_mensal_categoria__dbt_tmp"
  
  
    as
  
  (
    

with fct as (
    select * from "general_rtxt"."bronze_gold"."fct_vendas"
),

base as (
    select
        date_trunc('month', data_venda)::date    as mes,
        categoria,
        sum(receita_bruta)                       as receita_mensal,
        sum(quantidade)                          as itens_vendidos
    from fct
    group by 1, 2
)

select * from base
  );
  
[0m16:22:08.249611 [debug] [Thread-1 (]: SQL status: BEGIN in 2.0 seconds
[0m16:22:08.250392 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.indicadores_vendas"
[0m16:22:08.250971 [debug] [Thread-1 (]: On model.vendas_dw.indicadores_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.indicadores_vendas"} */

  
    

  create  table "general_rtxt"."bronze_silver"."indicadores_vendas__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT
        data_venda,
        id_loja,
        preco,
        quantidade,
        id_venda
    FROM "general_rtxt"."bronze_gold"."fct_vendas"
)
SELECT
    data_venda,
    id_loja,
    SUM(preco * quantidade) AS receita_total,
    COUNT(DISTINCT id_venda) AS qtd_vendas
FROM base
GROUP BY data_venda, id_loja
  );
  
[0m16:22:20.231917 [debug] [Thread-1 (]: Postgres adapter: Postgres error: could not write to file "base/pgsql_tmp/pgsql_tmp1371318.0": No space left on device

[0m16:22:20.232562 [debug] [Thread-1 (]: On model.vendas_dw.indicadores_vendas: ROLLBACK
[0m16:22:20.533032 [debug] [Thread-1 (]: Timing info for model.vendas_dw.indicadores_vendas (execute): 16:22:06.556390 => 16:22:20.532606
[0m16:22:20.533645 [debug] [Thread-1 (]: On model.vendas_dw.indicadores_vendas: Close
[0m16:22:20.536417 [debug] [Thread-1 (]: Database Error in model indicadores_vendas (models/gold/indicadores_vendas.sql)
  could not write to file "base/pgsql_tmp/pgsql_tmp1371318.0": No space left on device
  compiled Code at target/run/vendas_dw/models/gold/indicadores_vendas.sql
[0m16:22:20.536886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e6ae42f-0010-4e0d-a185-7b7227a4f11e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8e761f310>]}
[0m16:22:20.537326 [error] [Thread-1 (]: 8 of 10 ERROR creating sql table model bronze_silver.indicadores_vendas ........ [[31mERROR[0m in 14.00s]
[0m16:22:20.537792 [debug] [Thread-1 (]: Finished running node model.vendas_dw.indicadores_vendas
[0m16:22:26.435562 [debug] [Thread-3 (]: Postgres adapter: Postgres error: could not write to file "base/pgsql_tmp/pgsql_tmp1371317.0": No space left on device

[0m16:22:26.436342 [debug] [Thread-3 (]: On model.vendas_dw.mart_receita_diaria_loja: ROLLBACK
[0m16:22:26.626536 [debug] [Thread-3 (]: Timing info for model.vendas_dw.mart_receita_diaria_loja (execute): 16:22:06.560715 => 16:22:26.625989
[0m16:22:26.627019 [debug] [Thread-3 (]: On model.vendas_dw.mart_receita_diaria_loja: Close
[0m16:22:26.629052 [debug] [Thread-3 (]: Database Error in model mart_receita_diaria_loja (models/gold/mart_receita_diaria_loja.sql)
  could not write to file "base/pgsql_tmp/pgsql_tmp1371317.0": No space left on device
  compiled Code at target/run/vendas_dw/models/gold/mart_receita_diaria_loja.sql
[0m16:22:26.629478 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e6ae42f-0010-4e0d-a185-7b7227a4f11e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8e7c7b850>]}
[0m16:22:26.629982 [error] [Thread-3 (]: 9 of 10 ERROR creating sql table model bronze_gold.mart_receita_diaria_loja .... [[31mERROR[0m in 20.09s]
[0m16:22:26.630459 [debug] [Thread-3 (]: Finished running node model.vendas_dw.mart_receita_diaria_loja
[0m16:23:03.938547 [debug] [Thread-2 (]: SQL status: SELECT 890 in 56.0 seconds
[0m16:23:03.941485 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.mart_receita_mensal_categoria"
[0m16:23:03.941847 [debug] [Thread-2 (]: On model.vendas_dw.mart_receita_mensal_categoria: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.mart_receita_mensal_categoria"} */
alter table "general_rtxt"."bronze_gold"."mart_receita_mensal_categoria__dbt_tmp" rename to "mart_receita_mensal_categoria"
[0m16:23:04.135542 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:23:04.137672 [debug] [Thread-2 (]: On model.vendas_dw.mart_receita_mensal_categoria: COMMIT
[0m16:23:04.137996 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.mart_receita_mensal_categoria"
[0m16:23:04.138258 [debug] [Thread-2 (]: On model.vendas_dw.mart_receita_mensal_categoria: COMMIT
[0m16:23:04.329226 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:23:04.334007 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.mart_receita_mensal_categoria"
[0m16:23:04.334442 [debug] [Thread-2 (]: On model.vendas_dw.mart_receita_mensal_categoria: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.mart_receita_mensal_categoria"} */
drop table if exists "general_rtxt"."bronze_gold"."mart_receita_mensal_categoria__dbt_backup" cascade
[0m16:23:04.529622 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:23:04.531555 [debug] [Thread-2 (]: Timing info for model.vendas_dw.mart_receita_mensal_categoria (execute): 16:22:06.564659 => 16:23:04.531389
[0m16:23:04.549690 [debug] [Thread-2 (]: On model.vendas_dw.mart_receita_mensal_categoria: Close
[0m16:23:04.550570 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e6ae42f-0010-4e0d-a185-7b7227a4f11e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8e70fbc90>]}
[0m16:23:04.551056 [info ] [Thread-2 (]: 10 of 10 OK created sql table model bronze_gold.mart_receita_mensal_categoria .. [[32mSELECT 890[0m in 58.01s]
[0m16:23:04.551495 [debug] [Thread-2 (]: Finished running node model.vendas_dw.mart_receita_mensal_categoria
[0m16:23:04.554220 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:04.554572 [debug] [MainThread]: On master: BEGIN
[0m16:23:04.554809 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:23:06.034885 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m16:23:06.035556 [debug] [MainThread]: On master: COMMIT
[0m16:23:06.035787 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:06.036005 [debug] [MainThread]: On master: COMMIT
[0m16:23:06.235865 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:23:06.236274 [debug] [MainThread]: On master: Close
[0m16:23:06.236887 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:23:06.237131 [debug] [MainThread]: Connection 'model.vendas_dw.indicadores_vendas' was properly closed.
[0m16:23:06.237348 [debug] [MainThread]: Connection 'model.vendas_dw.mart_receita_mensal_categoria' was properly closed.
[0m16:23:06.237578 [debug] [MainThread]: Connection 'model.vendas_dw.mart_receita_diaria_loja' was properly closed.
[0m16:23:06.237788 [debug] [MainThread]: Connection 'model.vendas_dw.fct_vendas' was properly closed.
[0m16:23:06.238084 [info ] [MainThread]: 
[0m16:23:06.238394 [info ] [MainThread]: Finished running 10 table models in 0 hours 3 minutes and 18.76 seconds (198.76s).
[0m16:23:06.239745 [debug] [MainThread]: Command end result
[0m16:23:06.246314 [info ] [MainThread]: 
[0m16:23:06.246720 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:23:06.246989 [info ] [MainThread]: 
[0m16:23:06.247343 [error] [MainThread]: [33mDatabase Error in model indicadores_vendas (models/gold/indicadores_vendas.sql)[0m
[0m16:23:06.247738 [error] [MainThread]:   could not write to file "base/pgsql_tmp/pgsql_tmp1371318.0": No space left on device
[0m16:23:06.248004 [error] [MainThread]:   compiled Code at target/run/vendas_dw/models/gold/indicadores_vendas.sql
[0m16:23:06.248246 [info ] [MainThread]: 
[0m16:23:06.248505 [error] [MainThread]: [33mDatabase Error in model mart_receita_diaria_loja (models/gold/mart_receita_diaria_loja.sql)[0m
[0m16:23:06.248737 [error] [MainThread]:   could not write to file "base/pgsql_tmp/pgsql_tmp1371317.0": No space left on device
[0m16:23:06.248992 [error] [MainThread]:   compiled Code at target/run/vendas_dw/models/gold/mart_receita_diaria_loja.sql
[0m16:23:06.249330 [info ] [MainThread]: 
[0m16:23:06.249707 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=2 SKIP=0 TOTAL=10
[0m16:23:06.250219 [debug] [MainThread]: Command `dbt run` failed at 16:23:06.250124 after 198.93 seconds
[0m16:23:06.250571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8e7cdc450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8e9fff2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8e7c57d90>]}
[0m16:23:06.250893 [debug] [MainThread]: Flushing usage events
[0m16:46:10.409617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90fc60fe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90f86a73d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90f8533850>]}


============================== 16:46:10.412479 | 896a1afa-2f28-4d5d-aac4-130afb3a2932 ==============================
[0m16:46:10.412479 [info ] [MainThread]: Running with dbt=1.6.0
[0m16:46:10.412918 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'write_json': 'True', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'static_parser': 'True', 'use_colors': 'True', 'log_format': 'default', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'profiles_dir': '/home/walterg/.dbt', 'cache_selected_only': 'False', 'no_print': 'None', 'fail_fast': 'False', 'printer_width': '80', 'debug': 'False', 'introspect': 'True', 'warn_error': 'None', 'target_path': 'None', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'version_check': 'True'}
[0m16:46:10.471624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '896a1afa-2f28-4d5d-aac4-130afb3a2932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90f86be010>]}
[0m16:46:10.483831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '896a1afa-2f28-4d5d-aac4-130afb3a2932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90f7b3f290>]}
[0m16:46:10.484442 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m16:46:10.491653 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m16:46:10.507418 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m16:46:10.507947 [debug] [MainThread]: Partial parsing: updated file: vendas_dw://models/gold/fct_vendas.sql
[0m16:46:10.508254 [debug] [MainThread]: Partial parsing: updated file: vendas_dw://models/silver/stg_vendas.sql
[0m16:46:10.552496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '896a1afa-2f28-4d5d-aac4-130afb3a2932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90f7ab8950>]}
[0m16:46:10.561009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '896a1afa-2f28-4d5d-aac4-130afb3a2932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90f7a157d0>]}
[0m16:46:10.561474 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m16:46:10.561762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '896a1afa-2f28-4d5d-aac4-130afb3a2932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90fbc01e50>]}
[0m16:46:10.563277 [info ] [MainThread]: 
[0m16:46:10.563944 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:46:10.565611 [debug] [ThreadPool]: Acquiring new postgres connection 'list_general_rtxt'
[0m16:46:10.566721 [debug] [ThreadPool]: Acquiring new postgres connection 'list_general_rtxt'
[0m16:46:10.575405 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt"
[0m16:46:10.577349 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt"
[0m16:46:10.577862 [debug] [ThreadPool]: On list_general_rtxt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt"} */

    select distinct nspname from pg_namespace
  
[0m16:46:10.578196 [debug] [ThreadPool]: On list_general_rtxt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt"} */

    select distinct nspname from pg_namespace
  
[0m16:46:10.578581 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:46:10.578901 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:46:12.072635 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.0 seconds
[0m16:46:12.074004 [debug] [ThreadPool]: On list_general_rtxt: Close
[0m16:46:12.240932 [debug] [ThreadPool]: SQL status: SELECT 5 in 2.0 seconds
[0m16:46:12.242511 [debug] [ThreadPool]: On list_general_rtxt: Close
[0m16:46:12.243647 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_general_rtxt, now create_general_rtxt_bronze_silver)
[0m16:46:12.244400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_general_rtxt, now create_general_rtxt_bronze_gold)
[0m16:46:12.245030 [debug] [ThreadPool]: Creating schema "database: "general_rtxt"
schema: "bronze_silver"
"
[0m16:46:12.245673 [debug] [ThreadPool]: Creating schema "database: "general_rtxt"
schema: "bronze_gold"
"
[0m16:46:12.249513 [debug] [ThreadPool]: Using postgres connection "create_general_rtxt_bronze_silver"
[0m16:46:12.251582 [debug] [ThreadPool]: Using postgres connection "create_general_rtxt_bronze_gold"
[0m16:46:12.252066 [debug] [ThreadPool]: On create_general_rtxt_bronze_silver: BEGIN
[0m16:46:12.252579 [debug] [ThreadPool]: On create_general_rtxt_bronze_gold: BEGIN
[0m16:46:12.252854 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:46:12.253130 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:46:13.683518 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m16:46:13.684183 [debug] [ThreadPool]: Using postgres connection "create_general_rtxt_bronze_silver"
[0m16:46:13.703319 [debug] [ThreadPool]: On create_general_rtxt_bronze_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "create_general_rtxt_bronze_silver"} */
create schema if not exists "bronze_silver"
[0m16:46:13.727334 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m16:46:13.728044 [debug] [ThreadPool]: Using postgres connection "create_general_rtxt_bronze_gold"
[0m16:46:13.728477 [debug] [ThreadPool]: On create_general_rtxt_bronze_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "create_general_rtxt_bronze_gold"} */
create schema if not exists "bronze_gold"
[0m16:46:13.896466 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m16:46:13.897872 [debug] [ThreadPool]: On create_general_rtxt_bronze_silver: COMMIT
[0m16:46:13.898140 [debug] [ThreadPool]: Using postgres connection "create_general_rtxt_bronze_silver"
[0m16:46:13.898392 [debug] [ThreadPool]: On create_general_rtxt_bronze_silver: COMMIT
[0m16:46:13.918502 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m16:46:13.919876 [debug] [ThreadPool]: On create_general_rtxt_bronze_gold: COMMIT
[0m16:46:13.920131 [debug] [ThreadPool]: Using postgres connection "create_general_rtxt_bronze_gold"
[0m16:46:13.920380 [debug] [ThreadPool]: On create_general_rtxt_bronze_gold: COMMIT
[0m16:46:14.086638 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m16:46:14.087231 [debug] [ThreadPool]: On create_general_rtxt_bronze_silver: Close
[0m16:46:14.188632 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m16:46:14.189498 [debug] [ThreadPool]: On create_general_rtxt_bronze_gold: Close
[0m16:46:14.191341 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_general_rtxt_bronze_gold, now list_general_rtxt_bronze_silver)
[0m16:46:14.192733 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_general_rtxt_bronze_silver, now list_general_rtxt_bronze_gold)
[0m16:46:14.198322 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_silver"
[0m16:46:14.200342 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_gold"
[0m16:46:14.200745 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: BEGIN
[0m16:46:14.201065 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: BEGIN
[0m16:46:14.201539 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:46:14.202237 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:46:15.573044 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m16:46:15.573922 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_silver"
[0m16:46:15.574181 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt_bronze_silver"} */
select
      'general_rtxt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze_silver'
    union all
    select
      'general_rtxt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze_silver'
    union all
    select
      'general_rtxt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze_silver'
  
[0m16:46:15.766775 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m16:46:15.767161 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_gold"
[0m16:46:15.767428 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt_bronze_gold"} */
select
      'general_rtxt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze_gold'
    union all
    select
      'general_rtxt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze_gold'
    union all
    select
      'general_rtxt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze_gold'
  
[0m16:46:15.773098 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m16:46:15.774774 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: ROLLBACK
[0m16:46:15.959575 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: Close
[0m16:46:15.983707 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m16:46:15.985280 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: ROLLBACK
[0m16:46:16.173443 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: Close
[0m16:46:16.178013 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:16.178396 [debug] [MainThread]: On master: BEGIN
[0m16:46:16.178631 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:46:17.751306 [debug] [MainThread]: SQL status: BEGIN in 2.0 seconds
[0m16:46:17.752260 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:17.752591 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:46:17.955821 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:46:17.957247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '896a1afa-2f28-4d5d-aac4-130afb3a2932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90f7af13d0>]}
[0m16:46:17.957624 [debug] [MainThread]: On master: ROLLBACK
[0m16:46:18.144690 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:18.145091 [debug] [MainThread]: On master: BEGIN
[0m16:46:18.530607 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:46:18.531273 [debug] [MainThread]: On master: COMMIT
[0m16:46:18.531603 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:18.531920 [debug] [MainThread]: On master: COMMIT
[0m16:46:18.720082 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:46:18.721115 [debug] [MainThread]: On master: Close
[0m16:46:18.721776 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:46:18.725252 [info ] [MainThread]: 
[0m16:46:18.728793 [debug] [Thread-1 (]: Began running node model.vendas_dw.dim_lojas
[0m16:46:18.729423 [debug] [Thread-2 (]: Began running node model.vendas_dw.dim_produtos
[0m16:46:18.730191 [debug] [Thread-3 (]: Began running node model.vendas_dw.dim_vendedores
[0m16:46:18.730891 [info ] [Thread-1 (]: 1 of 10 START sql table model bronze_silver.dim_lojas .......................... [RUN]
[0m16:46:18.731549 [debug] [Thread-4 (]: Began running node model.vendas_dw.stg_devolucoes
[0m16:46:18.732151 [info ] [Thread-2 (]: 2 of 10 START sql table model bronze_silver.dim_produtos ....................... [RUN]
[0m16:46:18.732796 [info ] [Thread-3 (]: 3 of 10 START sql table model bronze_silver.dim_vendedores ..................... [RUN]
[0m16:46:18.733600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_general_rtxt_bronze_gold, now model.vendas_dw.dim_lojas)
[0m16:46:18.734080 [info ] [Thread-4 (]: 4 of 10 START sql table model bronze_silver.stg_devolucoes ..................... [RUN]
[0m16:46:18.734771 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_general_rtxt_bronze_silver, now model.vendas_dw.dim_produtos)
[0m16:46:18.735709 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.vendas_dw.dim_vendedores'
[0m16:46:18.736441 [debug] [Thread-1 (]: Began compiling node model.vendas_dw.dim_lojas
[0m16:46:18.737663 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.vendas_dw.stg_devolucoes'
[0m16:46:18.738240 [debug] [Thread-2 (]: Began compiling node model.vendas_dw.dim_produtos
[0m16:46:18.738709 [debug] [Thread-3 (]: Began compiling node model.vendas_dw.dim_vendedores
[0m16:46:18.745955 [debug] [Thread-1 (]: Writing injected SQL for node "model.vendas_dw.dim_lojas"
[0m16:46:18.746532 [debug] [Thread-4 (]: Began compiling node model.vendas_dw.stg_devolucoes
[0m16:46:18.749904 [debug] [Thread-2 (]: Writing injected SQL for node "model.vendas_dw.dim_produtos"
[0m16:46:18.753175 [debug] [Thread-3 (]: Writing injected SQL for node "model.vendas_dw.dim_vendedores"
[0m16:46:18.756718 [debug] [Thread-4 (]: Writing injected SQL for node "model.vendas_dw.stg_devolucoes"
[0m16:46:18.757985 [debug] [Thread-1 (]: Timing info for model.vendas_dw.dim_lojas (compile): 16:46:18.739040 => 16:46:18.757447
[0m16:46:18.758673 [debug] [Thread-1 (]: Began executing node model.vendas_dw.dim_lojas
[0m16:46:18.764733 [debug] [Thread-2 (]: Timing info for model.vendas_dw.dim_produtos (compile): 16:46:18.746877 => 16:46:18.764232
[0m16:46:18.776285 [debug] [Thread-2 (]: Began executing node model.vendas_dw.dim_produtos
[0m16:46:18.788239 [debug] [Thread-3 (]: Timing info for model.vendas_dw.dim_vendedores (compile): 16:46:18.750345 => 16:46:18.787830
[0m16:46:18.799504 [debug] [Thread-3 (]: Began executing node model.vendas_dw.dim_vendedores
[0m16:46:18.800554 [debug] [Thread-4 (]: Timing info for model.vendas_dw.stg_devolucoes (compile): 16:46:18.753783 => 16:46:18.800192
[0m16:46:18.803118 [debug] [Thread-1 (]: Writing runtime sql for node "model.vendas_dw.dim_lojas"
[0m16:46:18.806723 [debug] [Thread-3 (]: Writing runtime sql for node "model.vendas_dw.dim_vendedores"
[0m16:46:18.809926 [debug] [Thread-2 (]: Writing runtime sql for node "model.vendas_dw.dim_produtos"
[0m16:46:18.810356 [debug] [Thread-4 (]: Began executing node model.vendas_dw.stg_devolucoes
[0m16:46:18.811645 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m16:46:18.816213 [debug] [Thread-4 (]: Writing runtime sql for node "model.vendas_dw.stg_devolucoes"
[0m16:46:18.817133 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: BEGIN
[0m16:46:18.817639 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m16:46:18.818013 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m16:46:18.818464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:46:18.818844 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: BEGIN
[0m16:46:18.819313 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m16:46:18.819825 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: BEGIN
[0m16:46:18.820346 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:46:18.820696 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: BEGIN
[0m16:46:18.821144 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:46:18.821850 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:46:20.241145 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m16:46:20.241754 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m16:46:20.242053 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_lojas"} */

  
    

  create  table "general_rtxt"."bronze_silver"."dim_lojas__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id_loja  as int)   as id_loja,
        nome_loja,
        logradouro,
        cast("numero" as int)   as numero,
        bairro,
        cidade,
        estado,
        cep
    from "general_rtxt"."bronze"."lojas"

)

select *
from src
  );
  
[0m16:46:20.321201 [debug] [Thread-2 (]: SQL status: BEGIN in 1.0 seconds
[0m16:46:20.321633 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m16:46:20.321907 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_produtos"} */

  
    

  create  table "general_rtxt"."bronze_silver"."dim_produtos__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id_produto         as int)           as id_produto,
        nome_produto,
        categoria,
        cast(percentual_imposto as numeric(5,2))  as percentual_imposto
    from "general_rtxt"."bronze"."produtos"

)

select *
from src
  );
  
[0m16:46:20.341555 [debug] [Thread-4 (]: SQL status: BEGIN in 2.0 seconds
[0m16:46:20.342300 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m16:46:20.342596 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_devolucoes"} */

  
    

  create  table "general_rtxt"."bronze_silver"."stg_devolucoes__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id_venda       as bigint)              as id_venda,
        cast(id_produto     as int)                 as id_produto,
        cast(preco          as numeric(12,2))       as preco,
        cast(quantidade     as int)                 as quantidade,
        cast(data_venda     as date)                as data_venda,
        cast(data_devolucao as date)                as data_devolucao,
        cast(id_cliente     as int)                 as id_cliente,
        cast(id_loja        as int)                 as id_loja,
        cast(id_vendedor    as int)                 as id_vendedor,
        motivo
    from "general_rtxt"."bronze"."devolucoes"

)

select *
from src
  );
  
[0m16:46:20.430670 [debug] [Thread-3 (]: SQL status: BEGIN in 2.0 seconds
[0m16:46:20.431565 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m16:46:20.431840 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_vendedores"} */

  
    

  create  table "general_rtxt"."bronze_silver"."dim_vendedores__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id_vendedor                as int)   as id_vendedor,
        nome_vendedor,
        cast(data_admissao     as date)  as data_admissao,
        endereco_vendedor,
        cast(data_nascimento   as date)  as data_nascimento
    from "general_rtxt"."bronze"."vendedores"

)

select *
from src
  );
  
[0m16:46:20.456095 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m16:46:20.461698 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m16:46:20.462081 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_lojas"} */
alter table "general_rtxt"."bronze_silver"."dim_lojas__dbt_tmp" rename to "dim_lojas"
[0m16:46:20.516187 [debug] [Thread-2 (]: SQL status: SELECT 300 in 0.0 seconds
[0m16:46:20.518860 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m16:46:20.519216 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_produtos"} */
alter table "general_rtxt"."bronze_silver"."dim_produtos__dbt_tmp" rename to "dim_produtos"
[0m16:46:20.709074 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:46:20.722351 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: COMMIT
[0m16:46:20.722762 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m16:46:20.723042 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: COMMIT
[0m16:46:20.744643 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:46:20.745331 [debug] [Thread-3 (]: SQL status: SELECT 120 in 0.0 seconds
[0m16:46:20.747200 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: COMMIT
[0m16:46:20.751055 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m16:46:20.751666 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m16:46:20.752206 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_vendedores"} */
alter table "general_rtxt"."bronze_silver"."dim_vendedores__dbt_tmp" rename to "dim_vendedores"
[0m16:46:20.752676 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: COMMIT
[0m16:46:20.937080 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:46:20.943534 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m16:46:20.943927 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:46:20.944278 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_produtos"} */
drop table if exists "general_rtxt"."bronze_silver"."dim_produtos__dbt_backup" cascade
[0m16:46:20.946260 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: COMMIT
[0m16:46:20.946794 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m16:46:20.947088 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: COMMIT
[0m16:46:20.949785 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:46:20.952216 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m16:46:20.952812 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_lojas"} */
drop table if exists "general_rtxt"."bronze_silver"."dim_lojas__dbt_backup" cascade
[0m16:46:20.953439 [debug] [Thread-4 (]: SQL status: SELECT 30000 in 1.0 seconds
[0m16:46:20.956020 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m16:46:20.956380 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_devolucoes"} */
alter table "general_rtxt"."bronze_silver"."stg_devolucoes__dbt_tmp" rename to "stg_devolucoes"
[0m16:46:21.236229 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:46:21.237090 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m16:46:21.238963 [debug] [Thread-2 (]: Timing info for model.vendas_dw.dim_produtos (execute): 16:46:18.782440 => 16:46:21.238805
[0m16:46:21.239379 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:46:21.241438 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m16:46:21.241865 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:46:21.242396 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: Close
[0m16:46:21.244194 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: COMMIT
[0m16:46:21.244611 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_vendedores"} */
drop table if exists "general_rtxt"."bronze_silver"."dim_vendedores__dbt_backup" cascade
[0m16:46:21.245756 [debug] [Thread-1 (]: Timing info for model.vendas_dw.dim_lojas (execute): 16:46:18.759013 => 16:46:21.245618
[0m16:46:21.246229 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m16:46:21.247008 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '896a1afa-2f28-4d5d-aac4-130afb3a2932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90f8087710>]}
[0m16:46:21.247455 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: Close
[0m16:46:21.247941 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: COMMIT
[0m16:46:21.248683 [info ] [Thread-2 (]: 2 of 10 OK created sql table model bronze_silver.dim_produtos .................. [[32mSELECT 300[0m in 2.51s]
[0m16:46:21.249674 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '896a1afa-2f28-4d5d-aac4-130afb3a2932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90f7b12ed0>]}
[0m16:46:21.250216 [debug] [Thread-2 (]: Finished running node model.vendas_dw.dim_produtos
[0m16:46:21.250699 [info ] [Thread-1 (]: 1 of 10 OK created sql table model bronze_silver.dim_lojas ..................... [[32mSELECT 15[0m in 2.52s]
[0m16:46:21.251143 [debug] [Thread-2 (]: Began running node model.vendas_dw.stg_vendas
[0m16:46:21.251853 [debug] [Thread-1 (]: Finished running node model.vendas_dw.dim_lojas
[0m16:46:21.252278 [info ] [Thread-2 (]: 5 of 10 START sql incremental model bronze_silver.stg_vendas ................... [RUN]
[0m16:46:21.253058 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.vendas_dw.dim_produtos, now model.vendas_dw.stg_vendas)
[0m16:46:21.253394 [debug] [Thread-2 (]: Began compiling node model.vendas_dw.stg_vendas
[0m16:46:21.256619 [debug] [Thread-2 (]: Writing injected SQL for node "model.vendas_dw.stg_vendas"
[0m16:46:21.257542 [debug] [Thread-2 (]: Timing info for model.vendas_dw.stg_vendas (compile): 16:46:21.253966 => 16:46:21.257311
[0m16:46:21.257861 [debug] [Thread-2 (]: Began executing node model.vendas_dw.stg_vendas
[0m16:46:21.279877 [debug] [Thread-2 (]: Writing runtime sql for node "model.vendas_dw.stg_vendas"
[0m16:46:21.280572 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.stg_vendas"
[0m16:46:21.280890 [debug] [Thread-2 (]: On model.vendas_dw.stg_vendas: BEGIN
[0m16:46:21.281144 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:46:21.437988 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:46:21.439849 [debug] [Thread-3 (]: Timing info for model.vendas_dw.dim_vendedores (execute): 16:46:18.803421 => 16:46:21.439697
[0m16:46:21.440294 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m16:46:21.440849 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: Close
[0m16:46:21.443053 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m16:46:21.443645 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_devolucoes"} */
drop table if exists "general_rtxt"."bronze_silver"."stg_devolucoes__dbt_backup" cascade
[0m16:46:21.444398 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '896a1afa-2f28-4d5d-aac4-130afb3a2932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90f79c2210>]}
[0m16:46:21.444933 [info ] [Thread-3 (]: 3 of 10 OK created sql table model bronze_silver.dim_vendedores ................ [[32mSELECT 120[0m in 2.71s]
[0m16:46:21.445393 [debug] [Thread-3 (]: Finished running node model.vendas_dw.dim_vendedores
[0m16:46:21.631925 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:46:21.633674 [debug] [Thread-4 (]: Timing info for model.vendas_dw.stg_devolucoes (execute): 16:46:18.811994 => 16:46:21.633536
[0m16:46:21.633991 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: Close
[0m16:46:21.634703 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '896a1afa-2f28-4d5d-aac4-130afb3a2932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90f7ae0c10>]}
[0m16:46:21.635154 [info ] [Thread-4 (]: 4 of 10 OK created sql table model bronze_silver.stg_devolucoes ................ [[32mSELECT 30000[0m in 2.90s]
[0m16:46:21.635631 [debug] [Thread-4 (]: Finished running node model.vendas_dw.stg_devolucoes
[0m16:46:21.636884 [debug] [Thread-1 (]: Began running node model.vendas_dw.fct_devolucoes
[0m16:46:21.637290 [info ] [Thread-1 (]: 6 of 10 START sql table model bronze_gold.fct_devolucoes ....................... [RUN]
[0m16:46:21.637827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vendas_dw.dim_lojas, now model.vendas_dw.fct_devolucoes)
[0m16:46:21.638109 [debug] [Thread-1 (]: Began compiling node model.vendas_dw.fct_devolucoes
[0m16:46:21.640474 [debug] [Thread-1 (]: Writing injected SQL for node "model.vendas_dw.fct_devolucoes"
[0m16:46:21.641125 [debug] [Thread-1 (]: Timing info for model.vendas_dw.fct_devolucoes (compile): 16:46:21.638306 => 16:46:21.640956
[0m16:46:21.641433 [debug] [Thread-1 (]: Began executing node model.vendas_dw.fct_devolucoes
[0m16:46:21.644729 [debug] [Thread-1 (]: Writing runtime sql for node "model.vendas_dw.fct_devolucoes"
[0m16:46:21.645412 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_devolucoes"
[0m16:46:21.645802 [debug] [Thread-1 (]: On model.vendas_dw.fct_devolucoes: BEGIN
[0m16:46:21.646085 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:46:22.660397 [debug] [Thread-2 (]: SQL status: BEGIN in 1.0 seconds
[0m16:46:22.660939 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.stg_vendas"
[0m16:46:22.661255 [debug] [Thread-2 (]: On model.vendas_dw.stg_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_vendas"} */

      
  
    

  create  table "general_rtxt"."bronze_silver"."stg_vendas"
  
  
    as
  
  (
    

WITH src AS (

    SELECT
        CAST(id_venda       AS BIGINT)        AS id_venda,
        CAST(id_produto     AS INTEGER)       AS id_produto,
        CAST(preco          AS NUMERIC(12,2)) AS preco,
        CAST(quantidade     AS INTEGER)       AS quantidade,
        CAST(data_venda     AS DATE)          AS data_venda,
        CAST(id_cliente     AS INTEGER)       AS id_cliente,
        CAST(id_loja        AS INTEGER)       AS id_loja,
        CAST(id_vendedor    AS INTEGER)       AS id_vendedor,
        LOWER(TRIM(meio_pagamento))           AS meio_pagamento,
        CAST(parcelamento   AS SMALLINT)      AS parcelamento
    FROM "general_rtxt"."bronze"."vendas"

    

)

SELECT *
FROM src
  );
  
  
[0m16:46:23.267472 [debug] [Thread-1 (]: SQL status: BEGIN in 2.0 seconds
[0m16:46:23.268013 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_devolucoes"
[0m16:46:23.268286 [debug] [Thread-1 (]: On model.vendas_dw.fct_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_devolucoes"} */

  
    

  create  table "general_rtxt"."bronze_gold"."fct_devolucoes__dbt_tmp"
  
  
    as
  
  (
    

with devol as (
    select * from "general_rtxt"."bronze_silver"."stg_devolucoes"
)

select
    id_venda,
    id_produto,
    id_loja,
    id_vendedor,
    id_cliente,
    data_venda,
    data_devolucao,
    quantidade,
    preco,
    quantidade * preco                             as valor_devolvido,
    motivo
from devol
  );
  
[0m16:46:24.559544 [debug] [Thread-1 (]: SQL status: SELECT 30000 in 1.0 seconds
[0m16:46:24.562395 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_devolucoes"
[0m16:46:24.562760 [debug] [Thread-1 (]: On model.vendas_dw.fct_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_devolucoes"} */
alter table "general_rtxt"."bronze_gold"."fct_devolucoes__dbt_tmp" rename to "fct_devolucoes"
[0m16:46:24.847309 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:46:24.849323 [debug] [Thread-1 (]: On model.vendas_dw.fct_devolucoes: COMMIT
[0m16:46:24.849649 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_devolucoes"
[0m16:46:24.849926 [debug] [Thread-1 (]: On model.vendas_dw.fct_devolucoes: COMMIT
[0m16:46:25.150719 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:46:25.153219 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_devolucoes"
[0m16:46:25.153624 [debug] [Thread-1 (]: On model.vendas_dw.fct_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_devolucoes"} */
drop table if exists "general_rtxt"."bronze_gold"."fct_devolucoes__dbt_backup" cascade
[0m16:46:25.343683 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:46:25.345492 [debug] [Thread-1 (]: Timing info for model.vendas_dw.fct_devolucoes (execute): 16:46:21.641639 => 16:46:25.345330
[0m16:46:25.345829 [debug] [Thread-1 (]: On model.vendas_dw.fct_devolucoes: Close
[0m16:46:25.346501 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '896a1afa-2f28-4d5d-aac4-130afb3a2932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90f7915750>]}
[0m16:46:25.346942 [info ] [Thread-1 (]: 6 of 10 OK created sql table model bronze_gold.fct_devolucoes .................. [[32mSELECT 30000[0m in 3.71s]
[0m16:46:25.347386 [debug] [Thread-1 (]: Finished running node model.vendas_dw.fct_devolucoes
[0m16:47:06.634684 [debug] [Thread-2 (]: SQL status: SELECT 2000500 in 44.0 seconds
[0m16:47:06.636907 [debug] [Thread-2 (]: On model.vendas_dw.stg_vendas: COMMIT
[0m16:47:06.637221 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.stg_vendas"
[0m16:47:06.637521 [debug] [Thread-2 (]: On model.vendas_dw.stg_vendas: COMMIT
[0m16:47:06.829501 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:47:06.830747 [debug] [Thread-2 (]: Timing info for model.vendas_dw.stg_vendas (execute): 16:46:21.258061 => 16:47:06.830618
[0m16:47:06.831030 [debug] [Thread-2 (]: On model.vendas_dw.stg_vendas: Close
[0m16:47:06.831655 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '896a1afa-2f28-4d5d-aac4-130afb3a2932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90f79cf4d0>]}
[0m16:47:06.832106 [info ] [Thread-2 (]: 5 of 10 OK created sql incremental model bronze_silver.stg_vendas .............. [[32mSELECT 2000500[0m in 45.58s]
[0m16:47:06.832551 [debug] [Thread-2 (]: Finished running node model.vendas_dw.stg_vendas
[0m16:47:06.834252 [debug] [Thread-4 (]: Began running node model.vendas_dw.fct_vendas
[0m16:47:06.834943 [info ] [Thread-4 (]: 7 of 10 START sql incremental model bronze_gold.fct_vendas ..................... [RUN]
[0m16:47:06.835468 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.vendas_dw.stg_devolucoes, now model.vendas_dw.fct_vendas)
[0m16:47:06.835754 [debug] [Thread-4 (]: Began compiling node model.vendas_dw.fct_vendas
[0m16:47:06.840410 [debug] [Thread-4 (]: Writing injected SQL for node "model.vendas_dw.fct_vendas"
[0m16:47:06.841093 [debug] [Thread-4 (]: Timing info for model.vendas_dw.fct_vendas (compile): 16:47:06.835956 => 16:47:06.840927
[0m16:47:06.841397 [debug] [Thread-4 (]: Began executing node model.vendas_dw.fct_vendas
[0m16:47:06.897510 [debug] [Thread-4 (]: Writing runtime sql for node "model.vendas_dw.fct_vendas"
[0m16:47:06.898170 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m16:47:06.898541 [debug] [Thread-4 (]: On model.vendas_dw.fct_vendas: BEGIN
[0m16:47:06.898802 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:47:08.536257 [debug] [Thread-4 (]: SQL status: BEGIN in 2.0 seconds
[0m16:47:08.537002 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m16:47:08.537331 [debug] [Thread-4 (]: On model.vendas_dw.fct_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_vendas"} */

      
  
    

  create  table "general_rtxt"."bronze_gold"."fct_vendas"
  
  
    as
  
  (
    

WITH ventes AS (
    SELECT * FROM "general_rtxt"."bronze_silver"."stg_vendas"
    
),

dim_produtos   AS (SELECT * FROM "general_rtxt"."bronze_silver"."dim_produtos"),
dim_lojas      AS (SELECT * FROM "general_rtxt"."bronze_silver"."dim_lojas"),
dim_vendedores AS (SELECT * FROM "general_rtxt"."bronze_silver"."dim_vendedores")

SELECT
    v.id_venda,
    v.id_produto,
    v.id_loja,
    v.id_vendedor,
    v.id_cliente,
    v.data_venda,
    v.quantidade,
    v.preco,
    v.quantidade * v.preco                                   AS receita_bruta,
    v.meio_pagamento,
    v.parcelamento,

    -- dimensões
    p.nome_produto,
    p.categoria,
    l.nome_loja,
    l.cidade,
    ve.nome_vendedor
FROM ventes v
LEFT JOIN dim_produtos   p  ON v.id_produto  = p.id_produto
LEFT JOIN dim_lojas      l  ON v.id_loja     = l.id_loja
LEFT JOIN dim_vendedores ve ON v.id_vendedor = ve.id_vendedor
  );
  
  
[0m16:48:23.041026 [debug] [Thread-4 (]: SQL status: SELECT 2000500 in 75.0 seconds
[0m16:48:23.043047 [debug] [Thread-4 (]: On model.vendas_dw.fct_vendas: COMMIT
[0m16:48:23.043412 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m16:48:23.043680 [debug] [Thread-4 (]: On model.vendas_dw.fct_vendas: COMMIT
[0m16:48:23.231544 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m16:48:23.232531 [debug] [Thread-4 (]: Timing info for model.vendas_dw.fct_vendas (execute): 16:47:06.841602 => 16:48:23.232394
[0m16:48:23.232828 [debug] [Thread-4 (]: On model.vendas_dw.fct_vendas: Close
[0m16:48:23.233515 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '896a1afa-2f28-4d5d-aac4-130afb3a2932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90f7b62450>]}
[0m16:48:23.233980 [info ] [Thread-4 (]: 7 of 10 OK created sql incremental model bronze_gold.fct_vendas ................ [[32mSELECT 2000500[0m in 76.40s]
[0m16:48:23.234426 [debug] [Thread-4 (]: Finished running node model.vendas_dw.fct_vendas
[0m16:48:23.235969 [debug] [Thread-1 (]: Began running node model.vendas_dw.indicadores_vendas
[0m16:48:23.236527 [debug] [Thread-2 (]: Began running node model.vendas_dw.mart_receita_diaria_loja
[0m16:48:23.237098 [info ] [Thread-1 (]: 8 of 10 START sql table model bronze_silver.indicadores_vendas ................. [RUN]
[0m16:48:23.237693 [debug] [Thread-3 (]: Began running node model.vendas_dw.mart_receita_mensal_categoria
[0m16:48:23.238118 [info ] [Thread-2 (]: 9 of 10 START sql table model bronze_gold.mart_receita_diaria_loja ............. [RUN]
[0m16:48:23.238711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vendas_dw.fct_devolucoes, now model.vendas_dw.indicadores_vendas)
[0m16:48:23.239164 [info ] [Thread-3 (]: 10 of 10 START sql table model bronze_gold.mart_receita_mensal_categoria ....... [RUN]
[0m16:48:23.239794 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.vendas_dw.stg_vendas, now model.vendas_dw.mart_receita_diaria_loja)
[0m16:48:23.240389 [debug] [Thread-1 (]: Began compiling node model.vendas_dw.indicadores_vendas
[0m16:48:23.241159 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.vendas_dw.dim_vendedores, now model.vendas_dw.mart_receita_mensal_categoria)
[0m16:48:23.241720 [debug] [Thread-2 (]: Began compiling node model.vendas_dw.mart_receita_diaria_loja
[0m16:48:23.244869 [debug] [Thread-1 (]: Writing injected SQL for node "model.vendas_dw.indicadores_vendas"
[0m16:48:23.245424 [debug] [Thread-3 (]: Began compiling node model.vendas_dw.mart_receita_mensal_categoria
[0m16:48:23.249049 [debug] [Thread-2 (]: Writing injected SQL for node "model.vendas_dw.mart_receita_diaria_loja"
[0m16:48:23.253885 [debug] [Thread-3 (]: Writing injected SQL for node "model.vendas_dw.mart_receita_mensal_categoria"
[0m16:48:23.254832 [debug] [Thread-1 (]: Timing info for model.vendas_dw.indicadores_vendas (compile): 16:48:23.242098 => 16:48:23.254522
[0m16:48:23.256166 [debug] [Thread-3 (]: Timing info for model.vendas_dw.mart_receita_mensal_categoria (compile): 16:48:23.249731 => 16:48:23.255670
[0m16:48:23.256938 [debug] [Thread-1 (]: Began executing node model.vendas_dw.indicadores_vendas
[0m16:48:23.257845 [debug] [Thread-3 (]: Began executing node model.vendas_dw.mart_receita_mensal_categoria
[0m16:48:23.258802 [debug] [Thread-2 (]: Timing info for model.vendas_dw.mart_receita_diaria_loja (compile): 16:48:23.245859 => 16:48:23.258431
[0m16:48:23.266468 [debug] [Thread-1 (]: Writing runtime sql for node "model.vendas_dw.indicadores_vendas"
[0m16:48:23.272139 [debug] [Thread-3 (]: Writing runtime sql for node "model.vendas_dw.mart_receita_mensal_categoria"
[0m16:48:23.272894 [debug] [Thread-2 (]: Began executing node model.vendas_dw.mart_receita_diaria_loja
[0m16:48:23.279304 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.indicadores_vendas"
[0m16:48:23.278872 [debug] [Thread-2 (]: Writing runtime sql for node "model.vendas_dw.mart_receita_diaria_loja"
[0m16:48:23.280507 [debug] [Thread-1 (]: On model.vendas_dw.indicadores_vendas: BEGIN
[0m16:48:23.281485 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.mart_receita_mensal_categoria"
[0m16:48:23.282418 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:23.283351 [debug] [Thread-3 (]: On model.vendas_dw.mart_receita_mensal_categoria: BEGIN
[0m16:48:23.284207 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.mart_receita_diaria_loja"
[0m16:48:23.285379 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:48:23.286288 [debug] [Thread-2 (]: On model.vendas_dw.mart_receita_diaria_loja: BEGIN
[0m16:48:23.287433 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:48:24.833032 [debug] [Thread-1 (]: SQL status: BEGIN in 2.0 seconds
[0m16:48:24.833854 [debug] [Thread-2 (]: SQL status: BEGIN in 2.0 seconds
[0m16:48:24.834398 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.indicadores_vendas"
[0m16:48:24.835064 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.mart_receita_diaria_loja"
[0m16:48:24.835457 [debug] [Thread-1 (]: On model.vendas_dw.indicadores_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.indicadores_vendas"} */

  
    

  create  table "general_rtxt"."bronze_silver"."indicadores_vendas__dbt_tmp"
  
  
    as
  
  (
    

WITH base AS (
    SELECT
        data_venda,
        id_loja,
        preco,
        quantidade,
        id_venda
    FROM "general_rtxt"."bronze_gold"."fct_vendas"
)
SELECT
    data_venda,
    id_loja,
    SUM(preco * quantidade) AS receita_total,
    COUNT(DISTINCT id_venda) AS qtd_vendas
FROM base
GROUP BY data_venda, id_loja
  );
  
[0m16:48:24.835863 [debug] [Thread-2 (]: On model.vendas_dw.mart_receita_diaria_loja: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.mart_receita_diaria_loja"} */

  
    

  create  table "general_rtxt"."bronze_gold"."mart_receita_diaria_loja__dbt_tmp"
  
  
    as
  
  (
    

with fct as (
    select * from "general_rtxt"."bronze_gold"."fct_vendas"
)

select
    data_venda,
    id_loja,
    nome_loja,
    sum(receita_bruta)                           as receita_diaria,
    count(distinct id_venda)                     as qtd_vendas,
    sum(quantidade)                              as itens_vendidos
from fct
group by data_venda, id_loja, nome_loja
  );
  
[0m16:48:24.936674 [debug] [Thread-3 (]: SQL status: BEGIN in 2.0 seconds
[0m16:48:24.937431 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.mart_receita_mensal_categoria"
[0m16:48:24.937712 [debug] [Thread-3 (]: On model.vendas_dw.mart_receita_mensal_categoria: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.mart_receita_mensal_categoria"} */

  
    

  create  table "general_rtxt"."bronze_gold"."mart_receita_mensal_categoria__dbt_tmp"
  
  
    as
  
  (
    

with fct as (
    select * from "general_rtxt"."bronze_gold"."fct_vendas"
),

base as (
    select
        date_trunc('month', data_venda)::date    as mes,
        categoria,
        sum(receita_bruta)                       as receita_mensal,
        sum(quantidade)                          as itens_vendidos
    from fct
    group by 1, 2
)

select * from base
  );
  
[0m16:48:37.169230 [debug] [Thread-1 (]: Postgres adapter: Postgres error: could not write to file "base/pgsql_tmp/pgsql_tmp1372819.0": No space left on device

[0m16:48:37.170048 [debug] [Thread-1 (]: On model.vendas_dw.indicadores_vendas: ROLLBACK
[0m16:48:37.237818 [debug] [Thread-2 (]: Postgres adapter: Postgres error: could not write to file "base/pgsql_tmp/pgsql_tmp1372820.0": No space left on device

[0m16:48:37.238241 [debug] [Thread-2 (]: On model.vendas_dw.mart_receita_diaria_loja: ROLLBACK
[0m16:48:37.434736 [debug] [Thread-2 (]: Timing info for model.vendas_dw.mart_receita_diaria_loja (execute): 16:48:23.273747 => 16:48:37.434289
[0m16:48:37.435263 [debug] [Thread-2 (]: On model.vendas_dw.mart_receita_diaria_loja: Close
[0m16:48:37.435717 [debug] [Thread-1 (]: Timing info for model.vendas_dw.indicadores_vendas (execute): 16:48:23.259286 => 16:48:37.435572
[0m16:48:37.436831 [debug] [Thread-1 (]: On model.vendas_dw.indicadores_vendas: Close
[0m16:48:37.440381 [debug] [Thread-2 (]: Database Error in model mart_receita_diaria_loja (models/gold/mart_receita_diaria_loja.sql)
  could not write to file "base/pgsql_tmp/pgsql_tmp1372820.0": No space left on device
  compiled Code at target/run/vendas_dw/models/gold/mart_receita_diaria_loja.sql
[0m16:48:37.441215 [debug] [Thread-1 (]: Database Error in model indicadores_vendas (models/gold/indicadores_vendas.sql)
  could not write to file "base/pgsql_tmp/pgsql_tmp1372819.0": No space left on device
  compiled Code at target/run/vendas_dw/models/gold/indicadores_vendas.sql
[0m16:48:37.441630 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '896a1afa-2f28-4d5d-aac4-130afb3a2932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90f7b2eb90>]}
[0m16:48:37.441976 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '896a1afa-2f28-4d5d-aac4-130afb3a2932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90f79ff490>]}
[0m16:48:37.442450 [error] [Thread-2 (]: 9 of 10 ERROR creating sql table model bronze_gold.mart_receita_diaria_loja .... [[31mERROR[0m in 14.20s]
[0m16:48:37.443023 [error] [Thread-1 (]: 8 of 10 ERROR creating sql table model bronze_silver.indicadores_vendas ........ [[31mERROR[0m in 14.20s]
[0m16:48:37.443619 [debug] [Thread-2 (]: Finished running node model.vendas_dw.mart_receita_diaria_loja
[0m16:48:37.444088 [debug] [Thread-1 (]: Finished running node model.vendas_dw.indicadores_vendas
[0m16:49:17.441713 [debug] [Thread-3 (]: SQL status: SELECT 890 in 53.0 seconds
[0m16:49:17.445155 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.mart_receita_mensal_categoria"
[0m16:49:17.445532 [debug] [Thread-3 (]: On model.vendas_dw.mart_receita_mensal_categoria: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.mart_receita_mensal_categoria"} */
alter table "general_rtxt"."bronze_gold"."mart_receita_mensal_categoria__dbt_tmp" rename to "mart_receita_mensal_categoria"
[0m16:49:17.677762 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:49:17.679619 [debug] [Thread-3 (]: On model.vendas_dw.mart_receita_mensal_categoria: COMMIT
[0m16:49:17.679969 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.mart_receita_mensal_categoria"
[0m16:49:17.680228 [debug] [Thread-3 (]: On model.vendas_dw.mart_receita_mensal_categoria: COMMIT
[0m16:49:17.870018 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m16:49:17.872508 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.mart_receita_mensal_categoria"
[0m16:49:17.872893 [debug] [Thread-3 (]: On model.vendas_dw.mart_receita_mensal_categoria: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.mart_receita_mensal_categoria"} */
drop table if exists "general_rtxt"."bronze_gold"."mart_receita_mensal_categoria__dbt_backup" cascade
[0m16:49:18.061593 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:49:18.063228 [debug] [Thread-3 (]: Timing info for model.vendas_dw.mart_receita_mensal_categoria (execute): 16:48:23.267195 => 16:49:18.063088
[0m16:49:18.063538 [debug] [Thread-3 (]: On model.vendas_dw.mart_receita_mensal_categoria: Close
[0m16:49:18.064158 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '896a1afa-2f28-4d5d-aac4-130afb3a2932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90f7916b90>]}
[0m16:49:18.064592 [info ] [Thread-3 (]: 10 of 10 OK created sql table model bronze_gold.mart_receita_mensal_categoria .. [[32mSELECT 890[0m in 54.82s]
[0m16:49:18.065022 [debug] [Thread-3 (]: Finished running node model.vendas_dw.mart_receita_mensal_categoria
[0m16:49:18.067526 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:18.067887 [debug] [MainThread]: On master: BEGIN
[0m16:49:18.068129 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:49:19.553547 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m16:49:19.553955 [debug] [MainThread]: On master: COMMIT
[0m16:49:19.554183 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:19.554422 [debug] [MainThread]: On master: COMMIT
[0m16:49:19.748144 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:49:19.748820 [debug] [MainThread]: On master: Close
[0m16:49:19.749448 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:49:19.749700 [debug] [MainThread]: Connection 'model.vendas_dw.mart_receita_diaria_loja' was properly closed.
[0m16:49:19.749910 [debug] [MainThread]: Connection 'model.vendas_dw.indicadores_vendas' was properly closed.
[0m16:49:19.750116 [debug] [MainThread]: Connection 'model.vendas_dw.mart_receita_mensal_categoria' was properly closed.
[0m16:49:19.750320 [debug] [MainThread]: Connection 'model.vendas_dw.fct_vendas' was properly closed.
[0m16:49:19.750637 [info ] [MainThread]: 
[0m16:49:19.750918 [info ] [MainThread]: Finished running 8 table models, 2 incremental models in 0 hours 3 minutes and 9.19 seconds (189.19s).
[0m16:49:19.752264 [debug] [MainThread]: Command end result
[0m16:49:19.759657 [info ] [MainThread]: 
[0m16:49:19.760150 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:49:19.760559 [info ] [MainThread]: 
[0m16:49:19.760990 [error] [MainThread]: [33mDatabase Error in model mart_receita_diaria_loja (models/gold/mart_receita_diaria_loja.sql)[0m
[0m16:49:19.761386 [error] [MainThread]:   could not write to file "base/pgsql_tmp/pgsql_tmp1372820.0": No space left on device
[0m16:49:19.761771 [error] [MainThread]:   compiled Code at target/run/vendas_dw/models/gold/mart_receita_diaria_loja.sql
[0m16:49:19.762232 [info ] [MainThread]: 
[0m16:49:19.762805 [error] [MainThread]: [33mDatabase Error in model indicadores_vendas (models/gold/indicadores_vendas.sql)[0m
[0m16:49:19.763250 [error] [MainThread]:   could not write to file "base/pgsql_tmp/pgsql_tmp1372819.0": No space left on device
[0m16:49:19.763705 [error] [MainThread]:   compiled Code at target/run/vendas_dw/models/gold/indicadores_vendas.sql
[0m16:49:19.764112 [info ] [MainThread]: 
[0m16:49:19.764443 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=2 SKIP=0 TOTAL=10
[0m16:49:19.765161 [debug] [MainThread]: Command `dbt run` failed at 16:49:19.764982 after 189.36 seconds
[0m16:49:19.765683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90f8f6e790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90f8574550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90f8084150>]}
[0m16:49:19.766235 [debug] [MainThread]: Flushing usage events
[0m16:52:19.907529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f545fc2a790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f545f922e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f545f923c50>]}


============================== 16:52:19.910708 | b38f442c-422b-4e25-9eeb-c3cea6ab3973 ==============================
[0m16:52:19.910708 [info ] [MainThread]: Running with dbt=1.6.0
[0m16:52:19.911302 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'warn_error': 'None', 'invocation_command': 'dbt run', 'use_colors': 'True', 'write_json': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'profiles_dir': '/home/walterg/.dbt', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'version_check': 'True'}
[0m16:52:19.969683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b38f442c-422b-4e25-9eeb-c3cea6ab3973', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f545f9234d0>]}
[0m16:52:19.982034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b38f442c-422b-4e25-9eeb-c3cea6ab3973', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f545ff5fe50>]}
[0m16:52:19.982691 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m16:52:19.990392 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m16:52:20.006655 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m16:52:20.007188 [debug] [MainThread]: Partial parsing: updated file: vendas_dw://models/gold/mart_receita_mensal_categoria.sql
[0m16:52:20.007530 [debug] [MainThread]: Partial parsing: updated file: vendas_dw://models/gold/indicadores_vendas.sql
[0m16:52:20.007817 [debug] [MainThread]: Partial parsing: updated file: vendas_dw://models/gold/fct_vendas.sql
[0m16:52:20.008106 [debug] [MainThread]: Partial parsing: updated file: vendas_dw://models/gold/mart_receita_diaria_loja.sql
[0m16:52:20.008404 [debug] [MainThread]: Partial parsing: updated file: vendas_dw://models/gold/fct_devolucoes.sql
[0m16:52:20.056579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b38f442c-422b-4e25-9eeb-c3cea6ab3973', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f545f320250>]}
[0m16:52:20.067115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b38f442c-422b-4e25-9eeb-c3cea6ab3973', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f545f384b90>]}
[0m16:52:20.067599 [info ] [MainThread]: Found 10 models, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m16:52:20.067903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b38f442c-422b-4e25-9eeb-c3cea6ab3973', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f545ff83c50>]}
[0m16:52:20.069694 [info ] [MainThread]: 
[0m16:52:20.070417 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:52:20.071735 [debug] [ThreadPool]: Acquiring new postgres connection 'list_general_rtxt'
[0m16:52:20.078327 [debug] [ThreadPool]: Acquiring new postgres connection 'list_general_rtxt'
[0m16:52:20.082389 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt"
[0m16:52:20.085345 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt"
[0m16:52:20.086024 [debug] [ThreadPool]: On list_general_rtxt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt"} */

    select distinct nspname from pg_namespace
  
[0m16:52:20.086641 [debug] [ThreadPool]: On list_general_rtxt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt"} */

    select distinct nspname from pg_namespace
  
[0m16:52:20.086957 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:20.087246 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:21.652691 [debug] [ThreadPool]: SQL status: SELECT 7 in 2.0 seconds
[0m16:52:21.654244 [debug] [ThreadPool]: On list_general_rtxt: Close
[0m16:52:21.844695 [debug] [ThreadPool]: SQL status: SELECT 7 in 2.0 seconds
[0m16:52:21.846107 [debug] [ThreadPool]: On list_general_rtxt: Close
[0m16:52:21.848785 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_general_rtxt, now list_general_rtxt_bronze_silver)
[0m16:52:21.855355 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_general_rtxt, now list_general_rtxt_bronze_gold)
[0m16:52:21.854491 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_silver"
[0m16:52:21.858620 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_gold"
[0m16:52:21.859196 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: BEGIN
[0m16:52:21.859902 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: BEGIN
[0m16:52:21.860308 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:52:21.860652 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:52:23.485913 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m16:52:23.486628 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_silver"
[0m16:52:23.487164 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt_bronze_silver"} */
select
      'general_rtxt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze_silver'
    union all
    select
      'general_rtxt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze_silver'
    union all
    select
      'general_rtxt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze_silver'
  
[0m16:52:23.501676 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m16:52:23.502142 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_gold"
[0m16:52:23.502722 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt_bronze_gold"} */
select
      'general_rtxt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze_gold'
    union all
    select
      'general_rtxt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze_gold'
    union all
    select
      'general_rtxt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze_gold'
  
[0m16:52:23.698052 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m16:52:23.698790 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m16:52:23.699986 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: ROLLBACK
[0m16:52:23.701794 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: ROLLBACK
[0m16:52:23.887623 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: Close
[0m16:52:23.889181 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: Close
[0m16:52:23.894566 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:23.894947 [debug] [MainThread]: On master: BEGIN
[0m16:52:23.895184 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:52:25.391633 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m16:52:25.392523 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:25.392977 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:52:25.612056 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:52:25.613788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b38f442c-422b-4e25-9eeb-c3cea6ab3973', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f545f9eb490>]}
[0m16:52:25.614162 [debug] [MainThread]: On master: ROLLBACK
[0m16:52:25.798961 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:25.799700 [debug] [MainThread]: On master: BEGIN
[0m16:52:26.168935 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:52:26.169612 [debug] [MainThread]: On master: COMMIT
[0m16:52:26.169847 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:26.170101 [debug] [MainThread]: On master: COMMIT
[0m16:52:26.392200 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:52:26.392853 [debug] [MainThread]: On master: Close
[0m16:52:26.393510 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:52:26.393835 [info ] [MainThread]: 
[0m16:52:26.397411 [debug] [Thread-1 (]: Began running node model.vendas_dw.dim_lojas
[0m16:52:26.398090 [debug] [Thread-2 (]: Began running node model.vendas_dw.dim_produtos
[0m16:52:26.398633 [debug] [Thread-3 (]: Began running node model.vendas_dw.dim_vendedores
[0m16:52:26.399402 [info ] [Thread-1 (]: 1 of 10 START sql table model bronze_silver.dim_lojas .......................... [RUN]
[0m16:52:26.399922 [debug] [Thread-4 (]: Began running node model.vendas_dw.stg_devolucoes
[0m16:52:26.400276 [info ] [Thread-2 (]: 2 of 10 START sql table model bronze_silver.dim_produtos ....................... [RUN]
[0m16:52:26.400754 [info ] [Thread-3 (]: 3 of 10 START sql table model bronze_silver.dim_vendedores ..................... [RUN]
[0m16:52:26.401381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_general_rtxt_bronze_gold, now model.vendas_dw.dim_lojas)
[0m16:52:26.401807 [info ] [Thread-4 (]: 4 of 10 START sql table model bronze_silver.stg_devolucoes ..................... [RUN]
[0m16:52:26.402341 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_general_rtxt_bronze_silver, now model.vendas_dw.dim_produtos)
[0m16:52:26.403053 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.vendas_dw.dim_vendedores'
[0m16:52:26.403497 [debug] [Thread-1 (]: Began compiling node model.vendas_dw.dim_lojas
[0m16:52:26.404110 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.vendas_dw.stg_devolucoes'
[0m16:52:26.404447 [debug] [Thread-2 (]: Began compiling node model.vendas_dw.dim_produtos
[0m16:52:26.404918 [debug] [Thread-3 (]: Began compiling node model.vendas_dw.dim_vendedores
[0m16:52:26.410969 [debug] [Thread-1 (]: Writing injected SQL for node "model.vendas_dw.dim_lojas"
[0m16:52:26.411814 [debug] [Thread-4 (]: Began compiling node model.vendas_dw.stg_devolucoes
[0m16:52:26.415197 [debug] [Thread-2 (]: Writing injected SQL for node "model.vendas_dw.dim_produtos"
[0m16:52:26.418332 [debug] [Thread-3 (]: Writing injected SQL for node "model.vendas_dw.dim_vendedores"
[0m16:52:26.422154 [debug] [Thread-4 (]: Writing injected SQL for node "model.vendas_dw.stg_devolucoes"
[0m16:52:26.423011 [debug] [Thread-1 (]: Timing info for model.vendas_dw.dim_lojas (compile): 16:52:26.405374 => 16:52:26.422745
[0m16:52:26.423657 [debug] [Thread-1 (]: Began executing node model.vendas_dw.dim_lojas
[0m16:52:26.424042 [debug] [Thread-2 (]: Timing info for model.vendas_dw.dim_produtos (compile): 16:52:26.412396 => 16:52:26.423886
[0m16:52:26.429843 [debug] [Thread-3 (]: Timing info for model.vendas_dw.dim_vendedores (compile): 16:52:26.415648 => 16:52:26.429452
[0m16:52:26.440087 [debug] [Thread-4 (]: Timing info for model.vendas_dw.stg_devolucoes (compile): 16:52:26.418989 => 16:52:26.439689
[0m16:52:26.446045 [debug] [Thread-2 (]: Began executing node model.vendas_dw.dim_produtos
[0m16:52:26.459082 [debug] [Thread-1 (]: Writing runtime sql for node "model.vendas_dw.dim_lojas"
[0m16:52:26.459699 [debug] [Thread-3 (]: Began executing node model.vendas_dw.dim_vendedores
[0m16:52:26.460182 [debug] [Thread-4 (]: Began executing node model.vendas_dw.stg_devolucoes
[0m16:52:26.463634 [debug] [Thread-2 (]: Writing runtime sql for node "model.vendas_dw.dim_produtos"
[0m16:52:26.467203 [debug] [Thread-3 (]: Writing runtime sql for node "model.vendas_dw.dim_vendedores"
[0m16:52:26.472074 [debug] [Thread-4 (]: Writing runtime sql for node "model.vendas_dw.stg_devolucoes"
[0m16:52:26.472877 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m16:52:26.473875 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m16:52:26.474399 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: BEGIN
[0m16:52:26.474801 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m16:52:26.475162 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m16:52:26.475522 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: BEGIN
[0m16:52:26.475860 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:52:26.476306 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: BEGIN
[0m16:52:26.476943 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: BEGIN
[0m16:52:26.477597 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:52:26.478251 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:52:26.478598 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:52:27.902021 [debug] [Thread-4 (]: SQL status: BEGIN in 1.0 seconds
[0m16:52:27.902614 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m16:52:27.902946 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_devolucoes"} */

  
    

  create  table "general_rtxt"."bronze_silver"."stg_devolucoes__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id_venda       as bigint)              as id_venda,
        cast(id_produto     as int)                 as id_produto,
        cast(preco          as numeric(12,2))       as preco,
        cast(quantidade     as int)                 as quantidade,
        cast(data_venda     as date)                as data_venda,
        cast(data_devolucao as date)                as data_devolucao,
        cast(id_cliente     as int)                 as id_cliente,
        cast(id_loja        as int)                 as id_loja,
        cast(id_vendedor    as int)                 as id_vendedor,
        motivo
    from "general_rtxt"."bronze"."devolucoes"

)

select *
from src
  );
  
[0m16:52:28.065740 [debug] [Thread-1 (]: SQL status: BEGIN in 2.0 seconds
[0m16:52:28.066193 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m16:52:28.066490 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_lojas"} */

  
    

  create  table "general_rtxt"."bronze_silver"."dim_lojas__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id_loja  as int)   as id_loja,
        nome_loja,
        logradouro,
        cast("numero" as int)   as numero,
        bairro,
        cidade,
        estado,
        cep
    from "general_rtxt"."bronze"."lojas"

)

select *
from src
  );
  
[0m16:52:28.138530 [debug] [Thread-2 (]: SQL status: BEGIN in 2.0 seconds
[0m16:52:28.139269 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m16:52:28.139565 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_produtos"} */

  
    

  create  table "general_rtxt"."bronze_silver"."dim_produtos__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id_produto         as int)           as id_produto,
        nome_produto,
        categoria,
        cast(percentual_imposto as numeric(5,2))  as percentual_imposto
    from "general_rtxt"."bronze"."produtos"

)

select *
from src
  );
  
[0m16:52:28.444337 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m16:52:28.444941 [debug] [Thread-3 (]: SQL status: BEGIN in 2.0 seconds
[0m16:52:28.449742 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m16:52:28.450336 [debug] [Thread-2 (]: SQL status: SELECT 300 in 0.0 seconds
[0m16:52:28.450972 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m16:52:28.451602 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_lojas"} */
alter table "general_rtxt"."bronze_silver"."dim_lojas" rename to "dim_lojas__dbt_backup"
[0m16:52:28.454141 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m16:52:28.454711 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_vendedores"} */

  
    

  create  table "general_rtxt"."bronze_silver"."dim_vendedores__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id_vendedor                as int)   as id_vendedor,
        nome_vendedor,
        cast(data_admissao     as date)  as data_admissao,
        endereco_vendedor,
        cast(data_nascimento   as date)  as data_nascimento
    from "general_rtxt"."bronze"."vendedores"

)

select *
from src
  );
  
[0m16:52:28.455433 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_produtos"} */
alter table "general_rtxt"."bronze_silver"."dim_produtos" rename to "dim_produtos__dbt_backup"
[0m16:52:28.539249 [debug] [Thread-4 (]: SQL status: SELECT 30000 in 1.0 seconds
[0m16:52:28.542838 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m16:52:28.543161 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_devolucoes"} */
alter table "general_rtxt"."bronze_silver"."stg_devolucoes" rename to "stg_devolucoes__dbt_backup"
[0m16:52:28.654118 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:52:28.655097 [debug] [Thread-3 (]: SQL status: SELECT 120 in 0.0 seconds
[0m16:52:28.657539 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m16:52:28.660225 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m16:52:28.660803 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_lojas"} */
alter table "general_rtxt"."bronze_silver"."dim_lojas__dbt_tmp" rename to "dim_lojas"
[0m16:52:28.661356 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_vendedores"} */
alter table "general_rtxt"."bronze_silver"."dim_vendedores" rename to "dim_vendedores__dbt_backup"
[0m16:52:28.667001 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:52:28.670018 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m16:52:28.670419 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_produtos"} */
alter table "general_rtxt"."bronze_silver"."dim_produtos__dbt_tmp" rename to "dim_produtos"
[0m16:52:28.727786 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:52:28.730832 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m16:52:28.731214 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_devolucoes"} */
alter table "general_rtxt"."bronze_silver"."stg_devolucoes__dbt_tmp" rename to "stg_devolucoes"
[0m16:52:28.848198 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:52:28.852145 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m16:52:28.852587 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:52:28.852912 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_vendedores"} */
alter table "general_rtxt"."bronze_silver"."dim_vendedores__dbt_tmp" rename to "dim_vendedores"
[0m16:52:28.858805 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:52:28.869099 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: COMMIT
[0m16:52:28.871656 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: COMMIT
[0m16:52:28.872113 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m16:52:28.872481 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m16:52:28.873055 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: COMMIT
[0m16:52:28.873632 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: COMMIT
[0m16:52:28.916880 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:52:28.919188 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: COMMIT
[0m16:52:28.919529 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m16:52:28.919801 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: COMMIT
[0m16:52:29.068151 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:52:29.075167 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m16:52:29.075833 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:52:29.076335 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_produtos"} */
drop table if exists "general_rtxt"."bronze_silver"."dim_produtos__dbt_backup" cascade
[0m16:52:29.076755 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:52:29.078830 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: COMMIT
[0m16:52:29.081235 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m16:52:29.081679 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m16:52:29.082209 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_lojas"} */
drop table if exists "general_rtxt"."bronze_silver"."dim_lojas__dbt_backup" cascade
[0m16:52:29.082663 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: COMMIT
[0m16:52:29.133087 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m16:52:29.135811 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m16:52:29.136164 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_devolucoes"} */
drop table if exists "general_rtxt"."bronze_silver"."stg_devolucoes__dbt_backup" cascade
[0m16:52:29.272550 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m16:52:29.273563 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:52:29.273879 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:52:29.276035 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m16:52:29.277792 [debug] [Thread-2 (]: Timing info for model.vendas_dw.dim_produtos (execute): 16:52:26.460663 => 16:52:29.277647
[0m16:52:29.279447 [debug] [Thread-1 (]: Timing info for model.vendas_dw.dim_lojas (execute): 16:52:26.424311 => 16:52:29.279293
[0m16:52:29.279964 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_vendedores"} */
drop table if exists "general_rtxt"."bronze_silver"."dim_vendedores__dbt_backup" cascade
[0m16:52:29.280736 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: Close
[0m16:52:29.281354 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: Close
[0m16:52:29.282509 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b38f442c-422b-4e25-9eeb-c3cea6ab3973', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f545ff5e450>]}
[0m16:52:29.283085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b38f442c-422b-4e25-9eeb-c3cea6ab3973', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f545fc0c510>]}
[0m16:52:29.283673 [info ] [Thread-2 (]: 2 of 10 OK created sql table model bronze_silver.dim_produtos .................. [[32mSELECT 300[0m in 2.88s]
[0m16:52:29.284201 [info ] [Thread-1 (]: 1 of 10 OK created sql table model bronze_silver.dim_lojas ..................... [[32mSELECT 15[0m in 2.88s]
[0m16:52:29.284803 [debug] [Thread-2 (]: Finished running node model.vendas_dw.dim_produtos
[0m16:52:29.285529 [debug] [Thread-1 (]: Finished running node model.vendas_dw.dim_lojas
[0m16:52:29.286141 [debug] [Thread-2 (]: Began running node model.vendas_dw.stg_vendas
[0m16:52:29.287269 [info ] [Thread-2 (]: 5 of 10 START sql incremental model bronze_silver.stg_vendas ................... [RUN]
[0m16:52:29.287935 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.vendas_dw.dim_produtos, now model.vendas_dw.stg_vendas)
[0m16:52:29.288522 [debug] [Thread-2 (]: Began compiling node model.vendas_dw.stg_vendas
[0m16:52:29.296113 [debug] [Thread-2 (]: Writing injected SQL for node "model.vendas_dw.stg_vendas"
[0m16:52:29.297252 [debug] [Thread-2 (]: Timing info for model.vendas_dw.stg_vendas (compile): 16:52:29.288736 => 16:52:29.296941
[0m16:52:29.297776 [debug] [Thread-2 (]: Began executing node model.vendas_dw.stg_vendas
[0m16:52:29.319555 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.stg_vendas"
[0m16:52:29.319964 [debug] [Thread-2 (]: On model.vendas_dw.stg_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_vendas"} */

    
  
    

  create temporary table "stg_vendas__dbt_tmp165229314699"
  
  
    as
  
  (
    

WITH src AS (

    SELECT
        CAST(id_venda       AS BIGINT)        AS id_venda,
        CAST(id_produto     AS INTEGER)       AS id_produto,
        CAST(preco          AS NUMERIC(12,2)) AS preco,
        CAST(quantidade     AS INTEGER)       AS quantidade,
        CAST(data_venda     AS DATE)          AS data_venda,
        CAST(id_cliente     AS INTEGER)       AS id_cliente,
        CAST(id_loja        AS INTEGER)       AS id_loja,
        CAST(id_vendedor    AS INTEGER)       AS id_vendedor,
        LOWER(TRIM(meio_pagamento))           AS meio_pagamento,
        CAST(parcelamento   AS SMALLINT)      AS parcelamento
    FROM "general_rtxt"."bronze"."vendas"

    
      WHERE id_venda NOT IN (
        SELECT id_venda FROM "general_rtxt"."bronze_silver"."stg_vendas"
      )
    

)

SELECT *
FROM src
  );
  
  
[0m16:52:29.320274 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:52:29.326153 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:52:29.328585 [debug] [Thread-4 (]: Timing info for model.vendas_dw.stg_devolucoes (execute): 16:52:26.467682 => 16:52:29.328441
[0m16:52:29.328922 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: Close
[0m16:52:29.329665 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b38f442c-422b-4e25-9eeb-c3cea6ab3973', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f545f20cfd0>]}
[0m16:52:29.330160 [info ] [Thread-4 (]: 4 of 10 OK created sql table model bronze_silver.stg_devolucoes ................ [[32mSELECT 30000[0m in 2.93s]
[0m16:52:29.330647 [debug] [Thread-4 (]: Finished running node model.vendas_dw.stg_devolucoes
[0m16:52:29.332434 [debug] [Thread-1 (]: Began running node model.vendas_dw.fct_devolucoes
[0m16:52:29.333200 [info ] [Thread-1 (]: 6 of 10 START sql view model bronze_gold.fct_devolucoes ........................ [RUN]
[0m16:52:29.334238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vendas_dw.dim_lojas, now model.vendas_dw.fct_devolucoes)
[0m16:52:29.334599 [debug] [Thread-1 (]: Began compiling node model.vendas_dw.fct_devolucoes
[0m16:52:29.336973 [debug] [Thread-1 (]: Writing injected SQL for node "model.vendas_dw.fct_devolucoes"
[0m16:52:29.337916 [debug] [Thread-1 (]: Timing info for model.vendas_dw.fct_devolucoes (compile): 16:52:29.334799 => 16:52:29.337638
[0m16:52:29.338429 [debug] [Thread-1 (]: Began executing node model.vendas_dw.fct_devolucoes
[0m16:52:29.354279 [debug] [Thread-1 (]: Writing runtime sql for node "model.vendas_dw.fct_devolucoes"
[0m16:52:29.354903 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_devolucoes"
[0m16:52:29.355192 [debug] [Thread-1 (]: On model.vendas_dw.fct_devolucoes: BEGIN
[0m16:52:29.355474 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:52:29.470491 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:52:29.472982 [debug] [Thread-3 (]: Timing info for model.vendas_dw.dim_vendedores (execute): 16:52:26.464156 => 16:52:29.472840
[0m16:52:29.473305 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: Close
[0m16:52:29.473996 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b38f442c-422b-4e25-9eeb-c3cea6ab3973', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f545f28f610>]}
[0m16:52:29.474499 [info ] [Thread-3 (]: 3 of 10 OK created sql table model bronze_silver.dim_vendedores ................ [[32mSELECT 120[0m in 3.07s]
[0m16:52:29.474991 [debug] [Thread-3 (]: Finished running node model.vendas_dw.dim_vendedores
[0m16:52:30.732442 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m16:52:30.733178 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_devolucoes"
[0m16:52:30.733507 [debug] [Thread-1 (]: On model.vendas_dw.fct_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_devolucoes"} */

  create view "general_rtxt"."bronze_gold"."fct_devolucoes__dbt_tmp"
    
    
  as (
    

with devol as (
    select * from "general_rtxt"."bronze_silver"."stg_devolucoes"
)

select
    id_venda,
    id_produto,
    id_loja,
    id_vendedor,
    id_cliente,
    data_venda,
    data_devolucao,
    quantidade,
    preco,
    quantidade * preco                             as valor_devolvido,
    motivo
from devol
  );
[0m16:52:30.938344 [debug] [Thread-1 (]: Postgres adapter: Postgres error: schema "bronze_gold" does not exist

[0m16:52:30.938971 [debug] [Thread-1 (]: On model.vendas_dw.fct_devolucoes: ROLLBACK
[0m16:52:31.133786 [debug] [Thread-1 (]: Timing info for model.vendas_dw.fct_devolucoes (execute): 16:52:29.338741 => 16:52:31.133066
[0m16:52:31.134506 [debug] [Thread-1 (]: On model.vendas_dw.fct_devolucoes: Close
[0m16:52:31.137755 [debug] [Thread-1 (]: Database Error in model fct_devolucoes (models/gold/fct_devolucoes.sql)
  schema "bronze_gold" does not exist
  compiled Code at target/run/vendas_dw/models/gold/fct_devolucoes.sql
[0m16:52:31.138201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b38f442c-422b-4e25-9eeb-c3cea6ab3973', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f545f114990>]}
[0m16:52:31.138673 [error] [Thread-1 (]: 6 of 10 ERROR creating sql view model bronze_gold.fct_devolucoes ............... [[31mERROR[0m in 1.80s]
[0m16:52:31.139135 [debug] [Thread-1 (]: Finished running node model.vendas_dw.fct_devolucoes
[0m17:20:36.116039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab60e7be10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab614a4810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab60e7a590>]}


============================== 17:20:36.118795 | 2dba38ee-dccd-4d65-8afa-f84a2cbcf230 ==============================
[0m17:20:36.118795 [info ] [MainThread]: Running with dbt=1.6.0
[0m17:20:36.119303 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'partial_parse': 'True', 'log_format': 'default', 'quiet': 'False', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'invocation_command': 'dbt docs generate', 'printer_width': '80', 'target_path': 'None', 'fail_fast': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'static_parser': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'profiles_dir': '/home/walterg/.dbt', 'version_check': 'True'}
[0m17:20:36.177084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2dba38ee-dccd-4d65-8afa-f84a2cbcf230', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab6093e390>]}
[0m17:20:36.189607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2dba38ee-dccd-4d65-8afa-f84a2cbcf230', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab60913cd0>]}
[0m17:20:36.190271 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m17:20:36.198062 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m17:20:36.215487 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 0 files changed.
[0m17:20:36.216140 [debug] [MainThread]: Partial parsing: added file: vendas_dw://models/gold/gold_ticket_medio_categoria.sql
[0m17:20:36.216563 [debug] [MainThread]: Partial parsing: added file: vendas_dw://models/gold/gold_taxa_devolucao.sql
[0m17:20:36.216868 [debug] [MainThread]: Partial parsing: added file: vendas_dw://models/gold/gold_crescimento_receita_categoria.sql
[0m17:20:36.217162 [debug] [MainThread]: Partial parsing: added file: vendas_dw://models/gold/gold_media_movel_7d.sql
[0m17:20:36.217477 [debug] [MainThread]: Partial parsing: added file: vendas_dw://models/gold/gold_receita_acumulada_loja.sql
[0m17:20:36.266982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2dba38ee-dccd-4d65-8afa-f84a2cbcf230', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab614a4990>]}
[0m17:20:36.269468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2dba38ee-dccd-4d65-8afa-f84a2cbcf230', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab614cda90>]}
[0m17:20:36.269913 [info ] [MainThread]: Found 15 models, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m17:20:36.270210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2dba38ee-dccd-4d65-8afa-f84a2cbcf230', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab61189bd0>]}
[0m17:20:36.271880 [info ] [MainThread]: 
[0m17:20:36.272563 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:20:36.273964 [debug] [ThreadPool]: Acquiring new postgres connection 'list_general_rtxt_bronze_gold'
[0m17:20:36.274720 [debug] [ThreadPool]: Acquiring new postgres connection 'list_general_rtxt_bronze_silver'
[0m17:20:36.283695 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_gold"
[0m17:20:36.286410 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_silver"
[0m17:20:36.286850 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: BEGIN
[0m17:20:36.287139 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: BEGIN
[0m17:20:36.287438 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:36.287717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:37.926558 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m17:20:37.927388 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_silver"
[0m17:20:37.927634 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt_bronze_silver"} */
select
      'general_rtxt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze_silver'
    union all
    select
      'general_rtxt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze_silver'
    union all
    select
      'general_rtxt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze_silver'
  
[0m17:20:37.944155 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m17:20:37.945071 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_gold"
[0m17:20:37.945480 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt_bronze_gold"} */
select
      'general_rtxt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze_gold'
    union all
    select
      'general_rtxt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze_gold'
    union all
    select
      'general_rtxt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze_gold'
  
[0m17:20:38.119124 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m17:20:38.120859 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: ROLLBACK
[0m17:20:38.317954 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: Close
[0m17:20:38.341870 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m17:20:38.343791 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: ROLLBACK
[0m17:20:38.618901 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: Close
[0m17:20:38.623417 [debug] [MainThread]: Using postgres connection "master"
[0m17:20:38.623767 [debug] [MainThread]: On master: BEGIN
[0m17:20:38.624000 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:20:40.217921 [debug] [MainThread]: SQL status: BEGIN in 2.0 seconds
[0m17:20:40.218846 [debug] [MainThread]: Using postgres connection "master"
[0m17:20:40.219668 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:20:40.526732 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m17:20:40.528043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2dba38ee-dccd-4d65-8afa-f84a2cbcf230', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab6149b150>]}
[0m17:20:40.528502 [debug] [MainThread]: On master: ROLLBACK
[0m17:20:40.715276 [debug] [MainThread]: On master: Close
[0m17:20:40.716605 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:20:40.716941 [info ] [MainThread]: 
[0m17:20:40.720800 [debug] [Thread-1 (]: Began running node model.vendas_dw.dim_lojas
[0m17:20:40.721419 [debug] [Thread-2 (]: Began running node model.vendas_dw.dim_produtos
[0m17:20:40.722270 [debug] [Thread-3 (]: Began running node model.vendas_dw.dim_vendedores
[0m17:20:40.722965 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_general_rtxt_bronze_gold, now model.vendas_dw.dim_lojas)
[0m17:20:40.723403 [debug] [Thread-4 (]: Began running node model.vendas_dw.stg_devolucoes
[0m17:20:40.724057 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_general_rtxt_bronze_silver, now model.vendas_dw.dim_produtos)
[0m17:20:40.724850 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.vendas_dw.dim_vendedores'
[0m17:20:40.725218 [debug] [Thread-1 (]: Began compiling node model.vendas_dw.dim_lojas
[0m17:20:40.725845 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.vendas_dw.stg_devolucoes'
[0m17:20:40.726182 [debug] [Thread-2 (]: Began compiling node model.vendas_dw.dim_produtos
[0m17:20:40.726553 [debug] [Thread-3 (]: Began compiling node model.vendas_dw.dim_vendedores
[0m17:20:40.732247 [debug] [Thread-1 (]: Writing injected SQL for node "model.vendas_dw.dim_lojas"
[0m17:20:40.732875 [debug] [Thread-4 (]: Began compiling node model.vendas_dw.stg_devolucoes
[0m17:20:40.735617 [debug] [Thread-2 (]: Writing injected SQL for node "model.vendas_dw.dim_produtos"
[0m17:20:40.738971 [debug] [Thread-3 (]: Writing injected SQL for node "model.vendas_dw.dim_vendedores"
[0m17:20:40.741502 [debug] [Thread-4 (]: Writing injected SQL for node "model.vendas_dw.stg_devolucoes"
[0m17:20:40.742288 [debug] [Thread-1 (]: Timing info for model.vendas_dw.dim_lojas (compile): 17:20:40.727006 => 17:20:40.742100
[0m17:20:40.742936 [debug] [Thread-2 (]: Timing info for model.vendas_dw.dim_produtos (compile): 17:20:40.733214 => 17:20:40.742768
[0m17:20:40.743291 [debug] [Thread-3 (]: Timing info for model.vendas_dw.dim_vendedores (compile): 17:20:40.736111 => 17:20:40.743148
[0m17:20:40.743717 [debug] [Thread-1 (]: Began executing node model.vendas_dw.dim_lojas
[0m17:20:40.744073 [debug] [Thread-2 (]: Began executing node model.vendas_dw.dim_produtos
[0m17:20:40.744437 [debug] [Thread-3 (]: Began executing node model.vendas_dw.dim_vendedores
[0m17:20:40.744810 [debug] [Thread-4 (]: Timing info for model.vendas_dw.stg_devolucoes (compile): 17:20:40.739509 => 17:20:40.744654
[0m17:20:40.745239 [debug] [Thread-1 (]: Timing info for model.vendas_dw.dim_lojas (execute): 17:20:40.745079 => 17:20:40.745096
[0m17:20:40.745667 [debug] [Thread-2 (]: Timing info for model.vendas_dw.dim_produtos (execute): 17:20:40.745512 => 17:20:40.745521
[0m17:20:40.746053 [debug] [Thread-3 (]: Timing info for model.vendas_dw.dim_vendedores (execute): 17:20:40.745910 => 17:20:40.745916
[0m17:20:40.746385 [debug] [Thread-4 (]: Began executing node model.vendas_dw.stg_devolucoes
[0m17:20:40.747628 [debug] [Thread-1 (]: Finished running node model.vendas_dw.dim_lojas
[0m17:20:40.748677 [debug] [Thread-2 (]: Finished running node model.vendas_dw.dim_produtos
[0m17:20:40.749876 [debug] [Thread-3 (]: Finished running node model.vendas_dw.dim_vendedores
[0m17:20:40.750729 [debug] [Thread-4 (]: Timing info for model.vendas_dw.stg_devolucoes (execute): 17:20:40.750411 => 17:20:40.750425
[0m17:20:40.751385 [debug] [Thread-1 (]: Began running node model.vendas_dw.stg_vendas
[0m17:20:40.753817 [debug] [Thread-4 (]: Finished running node model.vendas_dw.stg_devolucoes
[0m17:20:40.754551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vendas_dw.dim_lojas, now model.vendas_dw.stg_vendas)
[0m17:20:40.755312 [debug] [Thread-1 (]: Began compiling node model.vendas_dw.stg_vendas
[0m17:20:40.761937 [debug] [Thread-1 (]: Writing injected SQL for node "model.vendas_dw.stg_vendas"
[0m17:20:40.763166 [debug] [Thread-1 (]: Timing info for model.vendas_dw.stg_vendas (compile): 17:20:40.755713 => 17:20:40.762913
[0m17:20:40.763557 [debug] [Thread-1 (]: Began executing node model.vendas_dw.stg_vendas
[0m17:20:40.763890 [debug] [Thread-1 (]: Timing info for model.vendas_dw.stg_vendas (execute): 17:20:40.763766 => 17:20:40.763774
[0m17:20:40.764542 [debug] [Thread-1 (]: Finished running node model.vendas_dw.stg_vendas
[0m17:20:40.765771 [debug] [Thread-2 (]: Began running node model.vendas_dw.fct_devolucoes
[0m17:20:40.766710 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.vendas_dw.dim_produtos, now model.vendas_dw.fct_devolucoes)
[0m17:20:40.767244 [debug] [Thread-2 (]: Began compiling node model.vendas_dw.fct_devolucoes
[0m17:20:40.767626 [debug] [Thread-4 (]: Began running node model.vendas_dw.fct_vendas
[0m17:20:40.770094 [debug] [Thread-2 (]: Writing injected SQL for node "model.vendas_dw.fct_devolucoes"
[0m17:20:40.771075 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.vendas_dw.stg_devolucoes, now model.vendas_dw.fct_vendas)
[0m17:20:40.772192 [debug] [Thread-4 (]: Began compiling node model.vendas_dw.fct_vendas
[0m17:20:40.775209 [debug] [Thread-4 (]: Writing injected SQL for node "model.vendas_dw.fct_vendas"
[0m17:20:40.775854 [debug] [Thread-2 (]: Timing info for model.vendas_dw.fct_devolucoes (compile): 17:20:40.768076 => 17:20:40.775537
[0m17:20:40.776592 [debug] [Thread-2 (]: Began executing node model.vendas_dw.fct_devolucoes
[0m17:20:40.776976 [debug] [Thread-2 (]: Timing info for model.vendas_dw.fct_devolucoes (execute): 17:20:40.776850 => 17:20:40.776856
[0m17:20:40.777623 [debug] [Thread-2 (]: Finished running node model.vendas_dw.fct_devolucoes
[0m17:20:40.778063 [debug] [Thread-4 (]: Timing info for model.vendas_dw.fct_vendas (compile): 17:20:40.772679 => 17:20:40.777902
[0m17:20:40.778936 [debug] [Thread-4 (]: Began executing node model.vendas_dw.fct_vendas
[0m17:20:40.779415 [debug] [Thread-4 (]: Timing info for model.vendas_dw.fct_vendas (execute): 17:20:40.779254 => 17:20:40.779263
[0m17:20:40.780074 [debug] [Thread-4 (]: Finished running node model.vendas_dw.fct_vendas
[0m17:20:40.781887 [debug] [Thread-3 (]: Began running node model.vendas_dw.gold_crescimento_receita_categoria
[0m17:20:40.783276 [debug] [Thread-1 (]: Began running node model.vendas_dw.gold_media_movel_7d
[0m17:20:40.784011 [debug] [Thread-2 (]: Began running node model.vendas_dw.gold_receita_acumulada_loja
[0m17:20:40.784795 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.vendas_dw.dim_vendedores, now model.vendas_dw.gold_crescimento_receita_categoria)
[0m17:20:40.785099 [debug] [Thread-4 (]: Began running node model.vendas_dw.gold_taxa_devolucao
[0m17:20:40.785610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vendas_dw.stg_vendas, now model.vendas_dw.gold_media_movel_7d)
[0m17:20:40.786243 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.vendas_dw.fct_devolucoes, now model.vendas_dw.gold_receita_acumulada_loja)
[0m17:20:40.786709 [debug] [Thread-3 (]: Began compiling node model.vendas_dw.gold_crescimento_receita_categoria
[0m17:20:40.787199 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.vendas_dw.fct_vendas, now model.vendas_dw.gold_taxa_devolucao)
[0m17:20:40.787583 [debug] [Thread-1 (]: Began compiling node model.vendas_dw.gold_media_movel_7d
[0m17:20:40.787905 [debug] [Thread-2 (]: Began compiling node model.vendas_dw.gold_receita_acumulada_loja
[0m17:20:40.790108 [debug] [Thread-3 (]: Writing injected SQL for node "model.vendas_dw.gold_crescimento_receita_categoria"
[0m17:20:40.790694 [debug] [Thread-4 (]: Began compiling node model.vendas_dw.gold_taxa_devolucao
[0m17:20:40.793146 [debug] [Thread-1 (]: Writing injected SQL for node "model.vendas_dw.gold_media_movel_7d"
[0m17:20:40.797114 [debug] [Thread-2 (]: Writing injected SQL for node "model.vendas_dw.gold_receita_acumulada_loja"
[0m17:20:40.799868 [debug] [Thread-4 (]: Writing injected SQL for node "model.vendas_dw.gold_taxa_devolucao"
[0m17:20:40.800609 [debug] [Thread-3 (]: Timing info for model.vendas_dw.gold_crescimento_receita_categoria (compile): 17:20:40.788146 => 17:20:40.800434
[0m17:20:40.801396 [debug] [Thread-2 (]: Timing info for model.vendas_dw.gold_receita_acumulada_loja (compile): 17:20:40.793555 => 17:20:40.801220
[0m17:20:40.801984 [debug] [Thread-1 (]: Timing info for model.vendas_dw.gold_media_movel_7d (compile): 17:20:40.791160 => 17:20:40.801642
[0m17:20:40.802817 [debug] [Thread-3 (]: Began executing node model.vendas_dw.gold_crescimento_receita_categoria
[0m17:20:40.803202 [debug] [Thread-4 (]: Timing info for model.vendas_dw.gold_taxa_devolucao (compile): 17:20:40.797588 => 17:20:40.803065
[0m17:20:40.803507 [debug] [Thread-2 (]: Began executing node model.vendas_dw.gold_receita_acumulada_loja
[0m17:20:40.803856 [debug] [Thread-1 (]: Began executing node model.vendas_dw.gold_media_movel_7d
[0m17:20:40.804490 [debug] [Thread-3 (]: Timing info for model.vendas_dw.gold_crescimento_receita_categoria (execute): 17:20:40.804153 => 17:20:40.804173
[0m17:20:40.804926 [debug] [Thread-4 (]: Began executing node model.vendas_dw.gold_taxa_devolucao
[0m17:20:40.805306 [debug] [Thread-2 (]: Timing info for model.vendas_dw.gold_receita_acumulada_loja (execute): 17:20:40.805162 => 17:20:40.805168
[0m17:20:40.805701 [debug] [Thread-1 (]: Timing info for model.vendas_dw.gold_media_movel_7d (execute): 17:20:40.805555 => 17:20:40.805560
[0m17:20:40.806432 [debug] [Thread-3 (]: Finished running node model.vendas_dw.gold_crescimento_receita_categoria
[0m17:20:40.806826 [debug] [Thread-4 (]: Timing info for model.vendas_dw.gold_taxa_devolucao (execute): 17:20:40.806687 => 17:20:40.806693
[0m17:20:40.807500 [debug] [Thread-2 (]: Finished running node model.vendas_dw.gold_receita_acumulada_loja
[0m17:20:40.808170 [debug] [Thread-1 (]: Finished running node model.vendas_dw.gold_media_movel_7d
[0m17:20:40.808578 [debug] [Thread-3 (]: Began running node model.vendas_dw.gold_ticket_medio_categoria
[0m17:20:40.809578 [debug] [Thread-4 (]: Finished running node model.vendas_dw.gold_taxa_devolucao
[0m17:20:40.810227 [debug] [Thread-2 (]: Began running node model.vendas_dw.indicadores_vendas
[0m17:20:40.811332 [debug] [Thread-1 (]: Began running node model.vendas_dw.mart_receita_diaria_loja
[0m17:20:40.812227 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.vendas_dw.gold_crescimento_receita_categoria, now model.vendas_dw.gold_ticket_medio_categoria)
[0m17:20:40.813127 [debug] [Thread-4 (]: Began running node model.vendas_dw.mart_receita_mensal_categoria
[0m17:20:40.814556 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.vendas_dw.gold_receita_acumulada_loja, now model.vendas_dw.indicadores_vendas)
[0m17:20:40.815570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vendas_dw.gold_media_movel_7d, now model.vendas_dw.mart_receita_diaria_loja)
[0m17:20:40.816394 [debug] [Thread-3 (]: Began compiling node model.vendas_dw.gold_ticket_medio_categoria
[0m17:20:40.817236 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.vendas_dw.gold_taxa_devolucao, now model.vendas_dw.mart_receita_mensal_categoria)
[0m17:20:40.817949 [debug] [Thread-2 (]: Began compiling node model.vendas_dw.indicadores_vendas
[0m17:20:40.818544 [debug] [Thread-1 (]: Began compiling node model.vendas_dw.mart_receita_diaria_loja
[0m17:20:40.820828 [debug] [Thread-3 (]: Writing injected SQL for node "model.vendas_dw.gold_ticket_medio_categoria"
[0m17:20:40.821252 [debug] [Thread-4 (]: Began compiling node model.vendas_dw.mart_receita_mensal_categoria
[0m17:20:40.824182 [debug] [Thread-2 (]: Writing injected SQL for node "model.vendas_dw.indicadores_vendas"
[0m17:20:40.827603 [debug] [Thread-1 (]: Writing injected SQL for node "model.vendas_dw.mart_receita_diaria_loja"
[0m17:20:40.831238 [debug] [Thread-4 (]: Writing injected SQL for node "model.vendas_dw.mart_receita_mensal_categoria"
[0m17:20:40.831843 [debug] [Thread-3 (]: Timing info for model.vendas_dw.gold_ticket_medio_categoria (compile): 17:20:40.818874 => 17:20:40.831673
[0m17:20:40.833032 [debug] [Thread-1 (]: Timing info for model.vendas_dw.mart_receita_diaria_loja (compile): 17:20:40.824897 => 17:20:40.832643
[0m17:20:40.833556 [debug] [Thread-3 (]: Began executing node model.vendas_dw.gold_ticket_medio_categoria
[0m17:20:40.833941 [debug] [Thread-2 (]: Timing info for model.vendas_dw.indicadores_vendas (compile): 17:20:40.821565 => 17:20:40.833790
[0m17:20:40.834309 [debug] [Thread-4 (]: Timing info for model.vendas_dw.mart_receita_mensal_categoria (compile): 17:20:40.828179 => 17:20:40.834167
[0m17:20:40.834607 [debug] [Thread-1 (]: Began executing node model.vendas_dw.mart_receita_diaria_loja
[0m17:20:40.834977 [debug] [Thread-3 (]: Timing info for model.vendas_dw.gold_ticket_medio_categoria (execute): 17:20:40.834834 => 17:20:40.834842
[0m17:20:40.835284 [debug] [Thread-2 (]: Began executing node model.vendas_dw.indicadores_vendas
[0m17:20:40.835640 [debug] [Thread-4 (]: Began executing node model.vendas_dw.mart_receita_mensal_categoria
[0m17:20:40.836035 [debug] [Thread-1 (]: Timing info for model.vendas_dw.mart_receita_diaria_loja (execute): 17:20:40.835888 => 17:20:40.835895
[0m17:20:40.836754 [debug] [Thread-3 (]: Finished running node model.vendas_dw.gold_ticket_medio_categoria
[0m17:20:40.837162 [debug] [Thread-2 (]: Timing info for model.vendas_dw.indicadores_vendas (execute): 17:20:40.837016 => 17:20:40.837022
[0m17:20:40.837555 [debug] [Thread-4 (]: Timing info for model.vendas_dw.mart_receita_mensal_categoria (execute): 17:20:40.837405 => 17:20:40.837411
[0m17:20:40.838233 [debug] [Thread-1 (]: Finished running node model.vendas_dw.mart_receita_diaria_loja
[0m17:20:40.839904 [debug] [Thread-2 (]: Finished running node model.vendas_dw.indicadores_vendas
[0m17:20:40.840646 [debug] [Thread-4 (]: Finished running node model.vendas_dw.mart_receita_mensal_categoria
[0m17:20:40.844054 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:20:40.844727 [debug] [MainThread]: Connection 'model.vendas_dw.mart_receita_diaria_loja' was properly closed.
[0m17:20:40.845041 [debug] [MainThread]: Connection 'model.vendas_dw.indicadores_vendas' was properly closed.
[0m17:20:40.845260 [debug] [MainThread]: Connection 'model.vendas_dw.gold_ticket_medio_categoria' was properly closed.
[0m17:20:40.845511 [debug] [MainThread]: Connection 'model.vendas_dw.mart_receita_mensal_categoria' was properly closed.
[0m17:20:40.847321 [debug] [MainThread]: Command end result
[0m17:20:40.859922 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m17:20:40.860262 [info ] [MainThread]: Building catalog
[0m17:20:40.863272 [debug] [ThreadPool]: Acquiring new postgres connection 'general_rtxt.information_schema'
[0m17:20:40.869776 [debug] [ThreadPool]: Using postgres connection "general_rtxt.information_schema"
[0m17:20:40.870155 [debug] [ThreadPool]: On general_rtxt.information_schema: BEGIN
[0m17:20:40.870407 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:42.817233 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m17:20:42.817890 [debug] [ThreadPool]: Using postgres connection "general_rtxt.information_schema"
[0m17:20:42.818484 [debug] [ThreadPool]: On general_rtxt.information_schema: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "general_rtxt.information_schema"} */

    
    

    select
        'general_rtxt' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('bronze_silver') or upper(sch.nspname) = upper('bronze_gold') or upper(sch.nspname) = upper('bronze'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m17:20:43.128073 [debug] [ThreadPool]: SQL status: SELECT 79 in 0.0 seconds
[0m17:20:43.133919 [debug] [ThreadPool]: On general_rtxt.information_schema: ROLLBACK
[0m17:20:43.329224 [debug] [ThreadPool]: On general_rtxt.information_schema: Close
[0m17:20:43.340446 [info ] [MainThread]: Catalog written to /home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/target/catalog.json
[0m17:20:43.341037 [debug] [MainThread]: Command `dbt docs generate` succeeded at 17:20:43.340954 after 7.23 seconds
[0m17:20:43.341296 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m17:20:43.341538 [debug] [MainThread]: Connection 'general_rtxt.information_schema' was properly closed.
[0m17:20:43.341792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab65a5ad10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab65bb6610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab61deec50>]}
[0m17:20:43.342095 [debug] [MainThread]: Flushing usage events
[0m17:26:08.574669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28c6c65650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28c71d9dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28c6f4a710>]}


============================== 17:26:08.577511 | 6f764bf1-e51a-4f22-8a3e-20530fe3a797 ==============================
[0m17:26:08.577511 [info ] [MainThread]: Running with dbt=1.6.0
[0m17:26:08.577947 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'introspect': 'True', 'version_check': 'True', 'fail_fast': 'False', 'profiles_dir': '/home/walterg/.dbt', 'static_parser': 'True', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'write_json': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'no_print': 'None', 'use_colors': 'True', 'warn_error': 'None', 'debug': 'False', 'quiet': 'False', 'invocation_command': 'dbt docs serve', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'log_format': 'default', 'cache_selected_only': 'False'}
[0m17:26:08.635757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f764bf1-e51a-4f22-8a3e-20530fe3a797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28c92cd890>]}
[0m17:26:08.648070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f764bf1-e51a-4f22-8a3e-20530fe3a797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28c6aa7710>]}
[0m17:26:08.802952 [error] [MainThread]: Encountered an error:
[Errno 98] Address already in use
[0m17:26:08.806618 [error] [MainThread]: Traceback (most recent call last):
  File "/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 87, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 72, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 143, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 172, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/.venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 219, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/.venv/lib/python3.11/site-packages/dbt/cli/main.py", line 306, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/.venv/lib/python3.11/site-packages/dbt/task/serve.py", line 23, in run
    with socketserver.TCPServer(("", port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/socketserver.py", line 456, in __init__
    self.server_bind()
  File "/usr/lib/python3.11/socketserver.py", line 472, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

[0m17:26:08.807974 [debug] [MainThread]: Command `dbt docs serve` failed at 17:26:08.807640 after 0.24 seconds
[0m17:26:08.808733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28c8814150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28c65386d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28c70d4510>]}
[0m17:26:08.809496 [debug] [MainThread]: Flushing usage events
[0m17:27:52.831262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd09a68650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd09d9d950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd09d93210>]}


============================== 17:27:52.834602 | 1c2e8801-3e69-4182-9459-7a964a2824b1 ==============================
[0m17:27:52.834602 [info ] [MainThread]: Running with dbt=1.6.0
[0m17:27:52.835025 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'invocation_command': 'dbt docs serve --port 8085', 'target_path': 'None', 'no_print': 'None', 'printer_width': '80', 'log_format': 'default', 'warn_error': 'None', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/home/walterg/.dbt', 'version_check': 'True', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'debug': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False'}
[0m17:27:52.895354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c2e8801-3e69-4182-9459-7a964a2824b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd0978b450>]}
[0m17:27:52.907842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c2e8801-3e69-4182-9459-7a964a2824b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd09946f90>]}
[0m17:43:10.409206 [debug] [Thread-2 (]: Postgres adapter: Postgres error: SSL connection has been closed unexpectedly

[0m17:43:10.409879 [debug] [Thread-2 (]: Timing info for model.vendas_dw.stg_vendas (execute): 16:52:29.298085 => 17:43:10.409734
[0m17:43:10.410157 [debug] [Thread-2 (]: On model.vendas_dw.stg_vendas: Close
[0m17:43:10.412086 [debug] [Thread-2 (]: Database Error in model stg_vendas (models/silver/stg_vendas.sql)
  SSL connection has been closed unexpectedly
[0m17:43:10.412492 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b38f442c-422b-4e25-9eeb-c3cea6ab3973', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f545f370450>]}
[0m17:43:10.412966 [error] [Thread-2 (]: 5 of 10 ERROR creating sql incremental model bronze_silver.stg_vendas .......... [[31mERROR[0m in 3041.12s]
[0m17:43:10.413571 [debug] [Thread-2 (]: Finished running node model.vendas_dw.stg_vendas
[0m17:43:10.415274 [debug] [Thread-4 (]: Began running node model.vendas_dw.fct_vendas
[0m17:43:10.416079 [info ] [Thread-4 (]: 7 of 10 SKIP relation bronze_gold.fct_vendas ................................... [[33mSKIP[0m]
[0m17:43:10.416941 [debug] [Thread-4 (]: Finished running node model.vendas_dw.fct_vendas
[0m17:43:10.435655 [debug] [Thread-1 (]: Began running node model.vendas_dw.indicadores_vendas
[0m17:43:10.436253 [debug] [Thread-2 (]: Began running node model.vendas_dw.mart_receita_diaria_loja
[0m17:43:10.436644 [info ] [Thread-1 (]: 8 of 10 SKIP relation bronze_silver.indicadores_vendas ......................... [[33mSKIP[0m]
[0m17:43:10.437199 [debug] [Thread-3 (]: Began running node model.vendas_dw.mart_receita_mensal_categoria
[0m17:43:10.437638 [info ] [Thread-2 (]: 9 of 10 SKIP relation bronze_gold.mart_receita_diaria_loja ..................... [[33mSKIP[0m]
[0m17:43:10.438075 [debug] [Thread-1 (]: Finished running node model.vendas_dw.indicadores_vendas
[0m17:43:10.438451 [info ] [Thread-3 (]: 10 of 10 SKIP relation bronze_gold.mart_receita_mensal_categoria ............... [[33mSKIP[0m]
[0m17:43:10.438871 [debug] [Thread-2 (]: Finished running node model.vendas_dw.mart_receita_diaria_loja
[0m17:43:10.439432 [debug] [Thread-3 (]: Finished running node model.vendas_dw.mart_receita_mensal_categoria
[0m17:43:10.442754 [debug] [MainThread]: Using postgres connection "master"
[0m17:43:10.443113 [debug] [MainThread]: On master: BEGIN
[0m17:43:10.443342 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:43:11.297898 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "dpg-d0khna8gjchc73ae1r1g-a.oregon-postgres.render.com" (35.227.164.209), port 5432 failed: SSL connection has been closed unexpectedly

[0m17:43:12.304538 [debug] [MainThread]: Postgres adapter: Error running SQL: BEGIN
[0m17:43:12.304910 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m17:43:12.305150 [info ] [MainThread]: Database error while running on-run-end
[0m17:43:12.305451 [debug] [MainThread]: On master: No close available on handle
[0m17:43:12.305913 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:43:12.306132 [debug] [MainThread]: Connection 'model.vendas_dw.stg_vendas' was properly closed.
[0m17:43:12.306340 [debug] [MainThread]: Connection 'model.vendas_dw.fct_devolucoes' was properly closed.
[0m17:43:12.306563 [debug] [MainThread]: Connection 'model.vendas_dw.dim_vendedores' was properly closed.
[0m17:43:12.306775 [debug] [MainThread]: Connection 'model.vendas_dw.stg_devolucoes' was properly closed.
[0m17:43:12.307067 [info ] [MainThread]: 
[0m17:43:12.307339 [info ] [MainThread]: Finished running 4 table models, 5 view models, 1 incremental model in 0 hours 50 minutes and 52.24 seconds (3052.24s).
[0m17:43:12.308415 [debug] [MainThread]: Command end result
[0m17:43:12.366136 [info ] [MainThread]: 
[0m17:43:12.366608 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m17:43:12.366930 [info ] [MainThread]: 
[0m17:43:12.367241 [error] [MainThread]: [33mDatabase Error in model fct_devolucoes (models/gold/fct_devolucoes.sql)[0m
[0m17:43:12.367559 [error] [MainThread]:   schema "bronze_gold" does not exist
[0m17:43:12.367846 [error] [MainThread]:   compiled Code at target/run/vendas_dw/models/gold/fct_devolucoes.sql
[0m17:43:12.368132 [info ] [MainThread]: 
[0m17:43:12.368452 [error] [MainThread]: [33mDatabase Error in model stg_vendas (models/silver/stg_vendas.sql)[0m
[0m17:43:12.368755 [error] [MainThread]:   SSL connection has been closed unexpectedly
[0m17:43:12.369052 [info ] [MainThread]: 
[0m17:43:12.369341 [error] [MainThread]: [33mon-run-end failed, error:[0m
[0m17:43:12.369648 [error] [MainThread]:  connection to server at "dpg-d0khna8gjchc73ae1r1g-a.oregon-postgres.render.com" (35.227.164.209), port 5432 failed: SSL connection has been closed unexpectedly
[0m17:43:12.369923 [error] [MainThread]: 
[0m17:43:12.370221 [info ] [MainThread]: 
[0m17:43:12.370567 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=3 SKIP=4 TOTAL=11
[0m17:43:12.371038 [debug] [MainThread]: Command `dbt run` failed at 17:43:12.370940 after 3052.47 seconds
[0m17:43:12.371425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54623334d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f545f33e090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f545f33fd50>]}
[0m17:43:12.371806 [debug] [MainThread]: Flushing usage events
[0m18:33:52.990519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc63c99bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc6367ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc63960490>]}


============================== 18:33:52.993267 | ec45fd87-8758-482b-bda2-7545dffb5731 ==============================
[0m18:33:52.993267 [info ] [MainThread]: Running with dbt=1.6.0
[0m18:33:52.993782 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt debug', 'debug': 'False', 'introspect': 'True', 'no_print': 'None', 'fail_fast': 'False', 'printer_width': '80', 'version_check': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/home/walterg/.dbt', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'target_path': 'None', 'log_format': 'default', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'use_experimental_parser': 'False', 'static_parser': 'True'}
[0m18:33:52.994183 [info ] [MainThread]: dbt version: 1.6.0
[0m18:33:52.994503 [info ] [MainThread]: python version: 3.11.2
[0m18:33:52.994785 [info ] [MainThread]: python path: /home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/.venv/bin/python3
[0m18:33:52.995047 [info ] [MainThread]: os info: Linux-6.10.7-policorp-amd64-x86_64-with-glibc2.36
[0m18:33:53.029494 [info ] [MainThread]: Using profiles dir at /home/walterg/.dbt
[0m18:33:53.029983 [info ] [MainThread]: Using profiles.yml file at /home/walterg/.dbt/profiles.yml
[0m18:33:53.030262 [info ] [MainThread]: Using dbt_project.yml file at /home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/dbt_project.yml
[0m18:33:53.030782 [info ] [MainThread]: adapter type: postgres
[0m18:33:53.031043 [info ] [MainThread]: adapter version: 1.6.0
[0m18:33:53.046772 [info ] [MainThread]: Configuration:
[0m18:33:53.047178 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:33:53.047478 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:33:53.047759 [info ] [MainThread]: Required dependencies:
[0m18:33:53.048055 [debug] [MainThread]: Executing "git --help"
[0m18:33:53.051106 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:33:53.051573 [debug] [MainThread]: STDERR: "b''"
[0m18:33:53.051822 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:33:53.052082 [info ] [MainThread]: Connection:
[0m18:33:53.052354 [info ] [MainThread]:   host: dpg-d0khna8gjchc73ae1r1g-a.oregon-postgres.render.com
[0m18:33:53.052789 [info ] [MainThread]:   port: 5432
[0m18:33:53.053094 [info ] [MainThread]:   user: postgresadmin
[0m18:33:53.053344 [info ] [MainThread]:   database: general_rtxt
[0m18:33:53.053615 [info ] [MainThread]:   schema: bronze
[0m18:33:53.053860 [info ] [MainThread]:   connect_timeout: 10
[0m18:33:53.054137 [info ] [MainThread]:   role: None
[0m18:33:53.054425 [info ] [MainThread]:   search_path: None
[0m18:33:53.054713 [info ] [MainThread]:   keepalives_idle: 0
[0m18:33:53.054974 [info ] [MainThread]:   sslmode: None
[0m18:33:53.055227 [info ] [MainThread]:   sslcert: None
[0m18:33:53.055510 [info ] [MainThread]:   sslkey: None
[0m18:33:53.055767 [info ] [MainThread]:   sslrootcert: None
[0m18:33:53.056033 [info ] [MainThread]:   application_name: dbt
[0m18:33:53.056302 [info ] [MainThread]:   retries: 1
[0m18:33:53.056680 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m18:33:53.057251 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:33:53.057573 [debug] [MainThread]: Using postgres connection "debug"
[0m18:33:53.057824 [debug] [MainThread]: On debug: select 1 as id
[0m18:33:53.058069 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:33:54.502766 [debug] [MainThread]: SQL status: SELECT 1 in 1.0 seconds
[0m18:33:54.504094 [debug] [MainThread]: On debug: Close
[0m18:33:54.504661 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:33:54.504963 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:33:54.505404 [debug] [MainThread]: Command `dbt debug` succeeded at 18:33:54.505297 after 1.52 seconds
[0m18:33:54.505662 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:33:54.505924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc63b3fe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc63c9b090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc6365a050>]}
[0m18:33:54.506231 [debug] [MainThread]: Flushing usage events
[0m18:36:29.880600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b785dcd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7649abd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b75792b50>]}


============================== 18:36:29.883395 | ad7c9794-b37e-4dfe-979e-1a50bb9efff1 ==============================
[0m18:36:29.883395 [info ] [MainThread]: Running with dbt=1.6.0
[0m18:36:29.883828 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'target_path': 'None', 'warn_error': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --select silver', 'debug': 'False', 'log_format': 'default', 'printer_width': '80', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'profiles_dir': '/home/walterg/.dbt', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs'}
[0m18:36:29.942831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad7c9794-b37e-4dfe-979e-1a50bb9efff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b75ac6b90>]}
[0m18:36:29.955091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad7c9794-b37e-4dfe-979e-1a50bb9efff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b75bde490>]}
[0m18:36:29.955733 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m18:36:29.963466 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m18:36:29.982084 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:36:29.982487 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:36:29.986938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad7c9794-b37e-4dfe-979e-1a50bb9efff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b75a85410>]}
[0m18:36:29.996638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad7c9794-b37e-4dfe-979e-1a50bb9efff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b74f7b850>]}
[0m18:36:29.997096 [info ] [MainThread]: Found 15 models, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m18:36:29.997407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad7c9794-b37e-4dfe-979e-1a50bb9efff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b75ac7a10>]}
[0m18:36:29.998780 [info ] [MainThread]: 
[0m18:36:29.999507 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:36:30.000985 [debug] [ThreadPool]: Acquiring new postgres connection 'list_general_rtxt'
[0m18:36:30.009483 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt"
[0m18:36:30.009952 [debug] [ThreadPool]: On list_general_rtxt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt"} */

    select distinct nspname from pg_namespace
  
[0m18:36:30.010512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:36:31.469553 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.0 seconds
[0m18:36:31.471019 [debug] [ThreadPool]: On list_general_rtxt: Close
[0m18:36:31.472153 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_general_rtxt, now create_general_rtxt_bronze_silver)
[0m18:36:31.472712 [debug] [ThreadPool]: Creating schema "database: "general_rtxt"
schema: "bronze_silver"
"
[0m18:36:31.476410 [debug] [ThreadPool]: Using postgres connection "create_general_rtxt_bronze_silver"
[0m18:36:31.476767 [debug] [ThreadPool]: On create_general_rtxt_bronze_silver: BEGIN
[0m18:36:31.476990 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:36:33.173835 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m18:36:33.174757 [debug] [ThreadPool]: Using postgres connection "create_general_rtxt_bronze_silver"
[0m18:36:33.175260 [debug] [ThreadPool]: On create_general_rtxt_bronze_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "create_general_rtxt_bronze_silver"} */
create schema if not exists "bronze_silver"
[0m18:36:33.366129 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m18:36:33.367739 [debug] [ThreadPool]: On create_general_rtxt_bronze_silver: COMMIT
[0m18:36:33.368003 [debug] [ThreadPool]: Using postgres connection "create_general_rtxt_bronze_silver"
[0m18:36:33.368227 [debug] [ThreadPool]: On create_general_rtxt_bronze_silver: COMMIT
[0m18:36:33.558785 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m18:36:33.559837 [debug] [ThreadPool]: On create_general_rtxt_bronze_silver: Close
[0m18:36:33.562714 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_general_rtxt_bronze_silver, now list_general_rtxt_bronze_gold)
[0m18:36:33.567118 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_gold"
[0m18:36:33.568408 [debug] [ThreadPool]: Acquiring new postgres connection 'list_general_rtxt_bronze_silver'
[0m18:36:33.569154 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: BEGIN
[0m18:36:33.571138 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_silver"
[0m18:36:33.571506 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:36:33.571843 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: BEGIN
[0m18:36:33.572411 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:36:34.945788 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m18:36:34.946599 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_gold"
[0m18:36:34.946840 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt_bronze_gold"} */
select
      'general_rtxt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze_gold'
    union all
    select
      'general_rtxt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze_gold'
    union all
    select
      'general_rtxt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze_gold'
  
[0m18:36:35.140585 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m18:36:35.142561 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: ROLLBACK
[0m18:36:35.167830 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m18:36:35.168746 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_silver"
[0m18:36:35.169152 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt_bronze_silver"} */
select
      'general_rtxt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze_silver'
    union all
    select
      'general_rtxt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze_silver'
    union all
    select
      'general_rtxt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze_silver'
  
[0m18:36:35.329663 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: Close
[0m18:36:35.369826 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m18:36:35.371099 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: ROLLBACK
[0m18:36:35.557044 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: Close
[0m18:36:35.562463 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:35.562852 [debug] [MainThread]: On master: BEGIN
[0m18:36:35.563083 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:36:36.935704 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m18:36:36.936529 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:36.936812 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:36:37.152250 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m18:36:37.154112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad7c9794-b37e-4dfe-979e-1a50bb9efff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7553e090>]}
[0m18:36:37.154480 [debug] [MainThread]: On master: ROLLBACK
[0m18:36:37.342291 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:37.343102 [debug] [MainThread]: On master: BEGIN
[0m18:36:37.719180 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:36:37.720096 [debug] [MainThread]: On master: COMMIT
[0m18:36:37.720333 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:37.720582 [debug] [MainThread]: On master: COMMIT
[0m18:36:37.906685 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:36:37.907613 [debug] [MainThread]: On master: Close
[0m18:36:37.908649 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:36:37.908950 [info ] [MainThread]: 
[0m18:36:37.911850 [debug] [Thread-1 (]: Began running node model.vendas_dw.dim_lojas
[0m18:36:37.912339 [debug] [Thread-2 (]: Began running node model.vendas_dw.dim_produtos
[0m18:36:37.912750 [info ] [Thread-1 (]: 1 of 5 START sql table model bronze_silver.dim_lojas ........................... [RUN]
[0m18:36:37.913357 [debug] [Thread-3 (]: Began running node model.vendas_dw.dim_vendedores
[0m18:36:37.913985 [info ] [Thread-2 (]: 2 of 5 START sql table model bronze_silver.dim_produtos ........................ [RUN]
[0m18:36:37.914368 [debug] [Thread-4 (]: Began running node model.vendas_dw.stg_devolucoes
[0m18:36:37.914976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_general_rtxt_bronze_silver, now model.vendas_dw.dim_lojas)
[0m18:36:37.915459 [info ] [Thread-3 (]: 3 of 5 START sql table model bronze_silver.dim_vendedores ...................... [RUN]
[0m18:36:37.916048 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_general_rtxt_bronze_gold, now model.vendas_dw.dim_produtos)
[0m18:36:37.916527 [info ] [Thread-4 (]: 4 of 5 START sql table model bronze_silver.stg_devolucoes ...................... [RUN]
[0m18:36:37.916909 [debug] [Thread-1 (]: Began compiling node model.vendas_dw.dim_lojas
[0m18:36:37.917570 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.vendas_dw.dim_vendedores'
[0m18:36:37.917919 [debug] [Thread-2 (]: Began compiling node model.vendas_dw.dim_produtos
[0m18:36:37.919149 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.vendas_dw.stg_devolucoes'
[0m18:36:37.924964 [debug] [Thread-1 (]: Writing injected SQL for node "model.vendas_dw.dim_lojas"
[0m18:36:37.925655 [debug] [Thread-3 (]: Began compiling node model.vendas_dw.dim_vendedores
[0m18:36:37.928415 [debug] [Thread-2 (]: Writing injected SQL for node "model.vendas_dw.dim_produtos"
[0m18:36:37.928975 [debug] [Thread-4 (]: Began compiling node model.vendas_dw.stg_devolucoes
[0m18:36:37.931961 [debug] [Thread-3 (]: Writing injected SQL for node "model.vendas_dw.dim_vendedores"
[0m18:36:37.933009 [debug] [Thread-1 (]: Timing info for model.vendas_dw.dim_lojas (compile): 18:36:37.919469 => 18:36:37.932633
[0m18:36:37.935972 [debug] [Thread-4 (]: Writing injected SQL for node "model.vendas_dw.stg_devolucoes"
[0m18:36:37.936907 [debug] [Thread-2 (]: Timing info for model.vendas_dw.dim_produtos (compile): 18:36:37.926178 => 18:36:37.936560
[0m18:36:37.937450 [debug] [Thread-1 (]: Began executing node model.vendas_dw.dim_lojas
[0m18:36:37.937897 [debug] [Thread-3 (]: Timing info for model.vendas_dw.dim_vendedores (compile): 18:36:37.929612 => 18:36:37.937739
[0m18:36:37.938259 [debug] [Thread-2 (]: Began executing node model.vendas_dw.dim_produtos
[0m18:36:37.949171 [debug] [Thread-3 (]: Began executing node model.vendas_dw.dim_vendedores
[0m18:36:37.950025 [debug] [Thread-4 (]: Timing info for model.vendas_dw.stg_devolucoes (compile): 18:36:37.933418 => 18:36:37.949701
[0m18:36:37.968920 [debug] [Thread-1 (]: Writing runtime sql for node "model.vendas_dw.dim_lojas"
[0m18:36:37.972586 [debug] [Thread-2 (]: Writing runtime sql for node "model.vendas_dw.dim_produtos"
[0m18:36:37.976476 [debug] [Thread-3 (]: Writing runtime sql for node "model.vendas_dw.dim_vendedores"
[0m18:36:37.977166 [debug] [Thread-4 (]: Began executing node model.vendas_dw.stg_devolucoes
[0m18:36:37.978388 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m18:36:37.981933 [debug] [Thread-4 (]: Writing runtime sql for node "model.vendas_dw.stg_devolucoes"
[0m18:36:37.982658 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: BEGIN
[0m18:36:37.983543 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m18:36:37.984262 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m18:36:37.984570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:36:37.984929 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: BEGIN
[0m18:36:37.985249 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m18:36:37.985590 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: BEGIN
[0m18:36:37.986046 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:36:37.986401 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: BEGIN
[0m18:36:37.986736 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:36:37.987175 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:36:39.379016 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m18:36:39.379969 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m18:36:39.380272 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_lojas"} */

  
    

  create  table "general_rtxt"."bronze_silver"."dim_lojas__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id_loja  as int)   as id_loja,
        nome_loja,
        logradouro,
        cast("numero" as int)   as numero,
        bairro,
        cidade,
        estado,
        cep
    from "general_rtxt"."bronze"."lojas"

)

select *
from src
  );
  
[0m18:36:39.410884 [debug] [Thread-2 (]: SQL status: BEGIN in 1.0 seconds
[0m18:36:39.411402 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m18:36:39.411917 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_produtos"} */

  
    

  create  table "general_rtxt"."bronze_silver"."dim_produtos__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id_produto         as int)           as id_produto,
        nome_produto,
        categoria,
        cast(percentual_imposto as numeric(5,2))  as percentual_imposto
    from "general_rtxt"."bronze"."produtos"

)

select *
from src
  );
  
[0m18:36:39.591751 [debug] [Thread-4 (]: SQL status: BEGIN in 2.0 seconds
[0m18:36:39.592208 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m18:36:39.592515 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_devolucoes"} */

  
    

  create  table "general_rtxt"."bronze_silver"."stg_devolucoes__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id_venda       as bigint)              as id_venda,
        cast(id_produto     as int)                 as id_produto,
        cast(preco          as numeric(12,2))       as preco,
        cast(quantidade     as int)                 as quantidade,
        cast(data_venda     as date)                as data_venda,
        cast(data_devolucao as date)                as data_devolucao,
        cast(id_cliente     as int)                 as id_cliente,
        cast(id_loja        as int)                 as id_loja,
        cast(id_vendedor    as int)                 as id_vendedor,
        motivo
    from "general_rtxt"."bronze"."devolucoes"

)

select *
from src
  );
  
[0m18:36:39.616619 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:36:39.621647 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m18:36:39.622062 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_lojas"} */
alter table "general_rtxt"."bronze_silver"."dim_lojas__dbt_tmp" rename to "dim_lojas"
[0m18:36:39.622504 [debug] [Thread-2 (]: SQL status: SELECT 300 in 0.0 seconds
[0m18:36:39.626588 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m18:36:39.626996 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_produtos"} */
alter table "general_rtxt"."bronze_silver"."dim_produtos__dbt_tmp" rename to "dim_produtos"
[0m18:36:39.746655 [debug] [Thread-3 (]: SQL status: BEGIN in 2.0 seconds
[0m18:36:39.747258 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m18:36:39.747586 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_vendedores"} */

  
    

  create  table "general_rtxt"."bronze_silver"."dim_vendedores__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id_vendedor                as int)   as id_vendedor,
        nome_vendedor,
        cast(data_admissao     as date)  as data_admissao,
        endereco_vendedor,
        cast(data_nascimento   as date)  as data_nascimento
    from "general_rtxt"."bronze"."vendedores"

)

select *
from src
  );
  
[0m18:36:39.811071 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:36:39.821315 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:36:39.825281 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: COMMIT
[0m18:36:39.828028 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: COMMIT
[0m18:36:39.828597 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m18:36:39.829134 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m18:36:39.829619 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: COMMIT
[0m18:36:39.829985 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: COMMIT
[0m18:36:40.021750 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:36:40.028786 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:36:40.029737 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m18:36:40.031794 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m18:36:40.032200 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_produtos"} */
drop table if exists "general_rtxt"."bronze_silver"."dim_produtos__dbt_backup" cascade
[0m18:36:40.032564 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_lojas"} */
drop table if exists "general_rtxt"."bronze_silver"."dim_lojas__dbt_backup" cascade
[0m18:36:40.116578 [debug] [Thread-3 (]: SQL status: SELECT 120 in 0.0 seconds
[0m18:36:40.119219 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m18:36:40.119610 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_vendedores"} */
alter table "general_rtxt"."bronze_silver"."dim_vendedores__dbt_tmp" rename to "dim_vendedores"
[0m18:36:40.220846 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:36:40.222613 [debug] [Thread-1 (]: Timing info for model.vendas_dw.dim_lojas (execute): 18:36:37.938542 => 18:36:40.222462
[0m18:36:40.222967 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: Close
[0m18:36:40.223758 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad7c9794-b37e-4dfe-979e-1a50bb9efff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b74d71790>]}
[0m18:36:40.224338 [info ] [Thread-1 (]: 1 of 5 OK created sql table model bronze_silver.dim_lojas ...................... [[32mSELECT 15[0m in 2.31s]
[0m18:36:40.224915 [debug] [Thread-1 (]: Finished running node model.vendas_dw.dim_lojas
[0m18:36:40.225314 [debug] [Thread-1 (]: Began running node model.vendas_dw.stg_vendas
[0m18:36:40.226190 [info ] [Thread-1 (]: 5 of 5 START sql incremental model bronze_silver.stg_vendas .................... [RUN]
[0m18:36:40.226940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vendas_dw.dim_lojas, now model.vendas_dw.stg_vendas)
[0m18:36:40.227339 [debug] [Thread-1 (]: Began compiling node model.vendas_dw.stg_vendas
[0m18:36:40.232979 [debug] [Thread-1 (]: Writing injected SQL for node "model.vendas_dw.stg_vendas"
[0m18:36:40.233539 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:36:40.233918 [debug] [Thread-4 (]: SQL status: SELECT 30000 in 1.0 seconds
[0m18:36:40.235711 [debug] [Thread-2 (]: Timing info for model.vendas_dw.dim_produtos (execute): 18:36:37.969343 => 18:36:40.235553
[0m18:36:40.238768 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m18:36:40.239608 [debug] [Thread-1 (]: Timing info for model.vendas_dw.stg_vendas (compile): 18:36:40.227703 => 18:36:40.239234
[0m18:36:40.240032 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: Close
[0m18:36:40.240519 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_devolucoes"} */
alter table "general_rtxt"."bronze_silver"."stg_devolucoes__dbt_tmp" rename to "stg_devolucoes"
[0m18:36:40.240943 [debug] [Thread-1 (]: Began executing node model.vendas_dw.stg_vendas
[0m18:36:40.247178 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad7c9794-b37e-4dfe-979e-1a50bb9efff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b74d38990>]}
[0m18:36:40.253224 [info ] [Thread-2 (]: 2 of 5 OK created sql table model bronze_silver.dim_produtos ................... [[32mSELECT 300[0m in 2.33s]
[0m18:36:40.264743 [debug] [Thread-2 (]: Finished running node model.vendas_dw.dim_produtos
[0m18:36:40.268014 [debug] [Thread-1 (]: Writing runtime sql for node "model.vendas_dw.stg_vendas"
[0m18:36:40.269087 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.stg_vendas"
[0m18:36:40.269457 [debug] [Thread-1 (]: On model.vendas_dw.stg_vendas: BEGIN
[0m18:36:40.269732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:36:40.313347 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:36:40.315574 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: COMMIT
[0m18:36:40.315929 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m18:36:40.316205 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: COMMIT
[0m18:36:40.426356 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:36:40.428451 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: COMMIT
[0m18:36:40.428806 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m18:36:40.429096 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: COMMIT
[0m18:36:40.506033 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m18:36:40.509557 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m18:36:40.509917 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_vendedores"} */
drop table if exists "general_rtxt"."bronze_silver"."dim_vendedores__dbt_backup" cascade
[0m18:36:40.621760 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m18:36:40.624614 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m18:36:40.624956 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_devolucoes"} */
drop table if exists "general_rtxt"."bronze_silver"."stg_devolucoes__dbt_backup" cascade
[0m18:36:40.715163 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:36:40.716773 [debug] [Thread-3 (]: Timing info for model.vendas_dw.dim_vendedores (execute): 18:36:37.973036 => 18:36:40.716630
[0m18:36:40.717105 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: Close
[0m18:36:40.717779 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad7c9794-b37e-4dfe-979e-1a50bb9efff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b74d388d0>]}
[0m18:36:40.718286 [info ] [Thread-3 (]: 3 of 5 OK created sql table model bronze_silver.dim_vendedores ................. [[32mSELECT 120[0m in 2.80s]
[0m18:36:40.718782 [debug] [Thread-3 (]: Finished running node model.vendas_dw.dim_vendedores
[0m18:36:40.810735 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:36:40.812451 [debug] [Thread-4 (]: Timing info for model.vendas_dw.stg_devolucoes (execute): 18:36:37.978832 => 18:36:40.812294
[0m18:36:40.812798 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: Close
[0m18:36:40.813503 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad7c9794-b37e-4dfe-979e-1a50bb9efff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b74d72010>]}
[0m18:36:40.813996 [info ] [Thread-4 (]: 4 of 5 OK created sql table model bronze_silver.stg_devolucoes ................. [[32mSELECT 30000[0m in 2.90s]
[0m18:36:40.814473 [debug] [Thread-4 (]: Finished running node model.vendas_dw.stg_devolucoes
[0m18:36:41.676683 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m18:36:41.677319 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.stg_vendas"
[0m18:36:41.677629 [debug] [Thread-1 (]: On model.vendas_dw.stg_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_vendas"} */

      
  
    

  create  table "general_rtxt"."bronze_silver"."stg_vendas"
  
  
    as
  
  (
    

WITH src AS (

    SELECT
        CAST(id_venda       AS BIGINT)        AS id_venda,
        CAST(id_produto     AS INTEGER)       AS id_produto,
        CAST(preco          AS NUMERIC(12,2)) AS preco,
        CAST(quantidade     AS INTEGER)       AS quantidade,
        CAST(data_venda     AS DATE)          AS data_venda,
        CAST(id_cliente     AS INTEGER)       AS id_cliente,
        CAST(id_loja        AS INTEGER)       AS id_loja,
        CAST(id_vendedor    AS INTEGER)       AS id_vendedor,
        LOWER(TRIM(meio_pagamento))           AS meio_pagamento,
        CAST(parcelamento   AS SMALLINT)      AS parcelamento
    FROM "general_rtxt"."bronze"."vendas"

    

)

SELECT *
FROM src
  );
  
  
[0m18:36:52.116522 [debug] [Thread-1 (]: SQL status: SELECT 500500 in 10.0 seconds
[0m18:36:52.118963 [debug] [Thread-1 (]: On model.vendas_dw.stg_vendas: COMMIT
[0m18:36:52.119321 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.stg_vendas"
[0m18:36:52.119595 [debug] [Thread-1 (]: On model.vendas_dw.stg_vendas: COMMIT
[0m18:36:52.309344 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:36:52.310440 [debug] [Thread-1 (]: Timing info for model.vendas_dw.stg_vendas (execute): 18:36:40.241453 => 18:36:52.310294
[0m18:36:52.310741 [debug] [Thread-1 (]: On model.vendas_dw.stg_vendas: Close
[0m18:36:52.311420 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad7c9794-b37e-4dfe-979e-1a50bb9efff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b74d2db10>]}
[0m18:36:52.311894 [info ] [Thread-1 (]: 5 of 5 OK created sql incremental model bronze_silver.stg_vendas ............... [[32mSELECT 500500[0m in 12.08s]
[0m18:36:52.312429 [debug] [Thread-1 (]: Finished running node model.vendas_dw.stg_vendas
[0m18:36:52.314813 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:52.315167 [debug] [MainThread]: On master: BEGIN
[0m18:36:52.315406 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:36:54.220821 [debug] [MainThread]: SQL status: BEGIN in 2.0 seconds
[0m18:36:54.221950 [debug] [MainThread]: On master: COMMIT
[0m18:36:54.222518 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:54.222766 [debug] [MainThread]: On master: COMMIT
[0m18:36:54.409207 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:36:54.409902 [debug] [MainThread]: On master: Close
[0m18:36:54.410535 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:36:54.410791 [debug] [MainThread]: Connection 'model.vendas_dw.dim_produtos' was properly closed.
[0m18:36:54.411001 [debug] [MainThread]: Connection 'model.vendas_dw.stg_vendas' was properly closed.
[0m18:36:54.411207 [debug] [MainThread]: Connection 'model.vendas_dw.dim_vendedores' was properly closed.
[0m18:36:54.411443 [debug] [MainThread]: Connection 'model.vendas_dw.stg_devolucoes' was properly closed.
[0m18:36:54.411729 [info ] [MainThread]: 
[0m18:36:54.412011 [info ] [MainThread]: Finished running 4 table models, 1 incremental model in 0 hours 0 minutes and 24.41 seconds (24.41s).
[0m18:36:54.412897 [debug] [MainThread]: Command end result
[0m18:36:54.420392 [info ] [MainThread]: 
[0m18:36:54.420814 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:36:54.421095 [info ] [MainThread]: 
[0m18:36:54.421385 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:36:54.421817 [debug] [MainThread]: Command `dbt run` succeeded at 18:36:54.421730 after 24.55 seconds
[0m18:36:54.422115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7567bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7638edd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b7a1bb2d0>]}
[0m18:36:54.422421 [debug] [MainThread]: Flushing usage events
[0m18:38:09.619132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96a939ded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96aaee7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96a939e110>]}


============================== 18:38:09.621958 | 850f45e8-a9c2-4160-aafc-639fc22b0158 ==============================
[0m18:38:09.621958 [info ] [MainThread]: Running with dbt=1.6.0
[0m18:38:09.622480 [debug] [MainThread]: running dbt with arguments {'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'log_format': 'default', 'version_check': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'no_print': 'None', 'warn_error': 'None', 'quiet': 'False', 'invocation_command': 'dbt run --select silver', 'fail_fast': 'False', 'target_path': 'None', 'profiles_dir': '/home/walterg/.dbt', 'use_experimental_parser': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True'}
[0m18:38:09.681091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '850f45e8-a9c2-4160-aafc-639fc22b0158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96a8d5af10>]}
[0m18:38:09.693377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '850f45e8-a9c2-4160-aafc-639fc22b0158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96a8d5b390>]}
[0m18:38:09.694012 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m18:38:09.701765 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m18:38:09.718743 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:38:09.719106 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:38:09.723784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '850f45e8-a9c2-4160-aafc-639fc22b0158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96a90477d0>]}
[0m18:38:09.734373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '850f45e8-a9c2-4160-aafc-639fc22b0158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96a8bd1950>]}
[0m18:38:09.734840 [info ] [MainThread]: Found 15 models, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m18:38:09.735161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '850f45e8-a9c2-4160-aafc-639fc22b0158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96a8ba8090>]}
[0m18:38:09.736695 [info ] [MainThread]: 
[0m18:38:09.737445 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:38:09.739410 [debug] [ThreadPool]: Acquiring new postgres connection 'list_general_rtxt'
[0m18:38:09.749136 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt"
[0m18:38:09.749537 [debug] [ThreadPool]: On list_general_rtxt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt"} */

    select distinct nspname from pg_namespace
  
[0m18:38:09.749775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:38:11.289807 [debug] [ThreadPool]: SQL status: SELECT 6 in 2.0 seconds
[0m18:38:11.292280 [debug] [ThreadPool]: On list_general_rtxt: Close
[0m18:38:11.295680 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_general_rtxt, now list_general_rtxt_bronze_silver)
[0m18:38:11.302311 [debug] [ThreadPool]: Acquiring new postgres connection 'list_general_rtxt_bronze_gold'
[0m18:38:11.302863 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_silver"
[0m18:38:11.304493 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_gold"
[0m18:38:11.304983 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: BEGIN
[0m18:38:11.305338 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: BEGIN
[0m18:38:11.305736 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:38:11.306154 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:38:12.705346 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m18:38:12.706353 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_silver"
[0m18:38:12.706632 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt_bronze_silver"} */
select
      'general_rtxt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze_silver'
    union all
    select
      'general_rtxt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze_silver'
    union all
    select
      'general_rtxt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze_silver'
  
[0m18:38:12.908562 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m18:38:12.909210 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_gold"
[0m18:38:12.909737 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m18:38:12.910021 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt_bronze_gold"} */
select
      'general_rtxt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze_gold'
    union all
    select
      'general_rtxt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze_gold'
    union all
    select
      'general_rtxt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze_gold'
  
[0m18:38:12.911536 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: ROLLBACK
[0m18:38:13.111146 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: Close
[0m18:38:13.122028 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m18:38:13.132560 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: ROLLBACK
[0m18:38:13.317070 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: Close
[0m18:38:13.321718 [debug] [MainThread]: Using postgres connection "master"
[0m18:38:13.322086 [debug] [MainThread]: On master: BEGIN
[0m18:38:13.322320 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:38:14.798784 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m18:38:14.799615 [debug] [MainThread]: Using postgres connection "master"
[0m18:38:14.799906 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:38:14.991324 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m18:38:14.993040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '850f45e8-a9c2-4160-aafc-639fc22b0158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96a93adb50>]}
[0m18:38:14.993507 [debug] [MainThread]: On master: ROLLBACK
[0m18:38:15.179994 [debug] [MainThread]: Using postgres connection "master"
[0m18:38:15.180634 [debug] [MainThread]: On master: BEGIN
[0m18:38:15.569320 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:38:15.570115 [debug] [MainThread]: On master: COMMIT
[0m18:38:15.570640 [debug] [MainThread]: Using postgres connection "master"
[0m18:38:15.570873 [debug] [MainThread]: On master: COMMIT
[0m18:38:15.757087 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:38:15.757907 [debug] [MainThread]: On master: Close
[0m18:38:15.759140 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:38:15.759528 [info ] [MainThread]: 
[0m18:38:15.762168 [debug] [Thread-1 (]: Began running node model.vendas_dw.dim_lojas
[0m18:38:15.762610 [debug] [Thread-2 (]: Began running node model.vendas_dw.dim_produtos
[0m18:38:15.762997 [info ] [Thread-1 (]: 1 of 5 START sql table model bronze_silver.dim_lojas ........................... [RUN]
[0m18:38:15.763774 [debug] [Thread-3 (]: Began running node model.vendas_dw.dim_vendedores
[0m18:38:15.764337 [info ] [Thread-2 (]: 2 of 5 START sql table model bronze_silver.dim_produtos ........................ [RUN]
[0m18:38:15.764721 [debug] [Thread-4 (]: Began running node model.vendas_dw.stg_devolucoes
[0m18:38:15.765397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_general_rtxt_bronze_gold, now model.vendas_dw.dim_lojas)
[0m18:38:15.765952 [info ] [Thread-3 (]: 3 of 5 START sql table model bronze_silver.dim_vendedores ...................... [RUN]
[0m18:38:15.768006 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_general_rtxt_bronze_silver, now model.vendas_dw.dim_produtos)
[0m18:38:15.768683 [info ] [Thread-4 (]: 4 of 5 START sql table model bronze_silver.stg_devolucoes ...................... [RUN]
[0m18:38:15.769187 [debug] [Thread-1 (]: Began compiling node model.vendas_dw.dim_lojas
[0m18:38:15.769956 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.vendas_dw.dim_vendedores'
[0m18:38:15.770336 [debug] [Thread-2 (]: Began compiling node model.vendas_dw.dim_produtos
[0m18:38:15.771028 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.vendas_dw.stg_devolucoes'
[0m18:38:15.777590 [debug] [Thread-1 (]: Writing injected SQL for node "model.vendas_dw.dim_lojas"
[0m18:38:15.778095 [debug] [Thread-3 (]: Began compiling node model.vendas_dw.dim_vendedores
[0m18:38:15.781291 [debug] [Thread-2 (]: Writing injected SQL for node "model.vendas_dw.dim_produtos"
[0m18:38:15.781851 [debug] [Thread-4 (]: Began compiling node model.vendas_dw.stg_devolucoes
[0m18:38:15.784321 [debug] [Thread-3 (]: Writing injected SQL for node "model.vendas_dw.dim_vendedores"
[0m18:38:15.784968 [debug] [Thread-1 (]: Timing info for model.vendas_dw.dim_lojas (compile): 18:38:15.771504 => 18:38:15.784792
[0m18:38:15.788136 [debug] [Thread-4 (]: Writing injected SQL for node "model.vendas_dw.stg_devolucoes"
[0m18:38:15.788882 [debug] [Thread-2 (]: Timing info for model.vendas_dw.dim_produtos (compile): 18:38:15.778568 => 18:38:15.788614
[0m18:38:15.789332 [debug] [Thread-1 (]: Began executing node model.vendas_dw.dim_lojas
[0m18:38:15.789867 [debug] [Thread-3 (]: Timing info for model.vendas_dw.dim_vendedores (compile): 18:38:15.782211 => 18:38:15.789693
[0m18:38:15.790265 [debug] [Thread-2 (]: Began executing node model.vendas_dw.dim_produtos
[0m18:38:15.790752 [debug] [Thread-4 (]: Timing info for model.vendas_dw.stg_devolucoes (compile): 18:38:15.785337 => 18:38:15.790601
[0m18:38:15.812070 [debug] [Thread-3 (]: Began executing node model.vendas_dw.dim_vendedores
[0m18:38:15.819343 [debug] [Thread-1 (]: Writing runtime sql for node "model.vendas_dw.dim_lojas"
[0m18:38:15.824712 [debug] [Thread-2 (]: Writing runtime sql for node "model.vendas_dw.dim_produtos"
[0m18:38:15.825329 [debug] [Thread-4 (]: Began executing node model.vendas_dw.stg_devolucoes
[0m18:38:15.830187 [debug] [Thread-3 (]: Writing runtime sql for node "model.vendas_dw.dim_vendedores"
[0m18:38:15.831253 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m18:38:15.834541 [debug] [Thread-4 (]: Writing runtime sql for node "model.vendas_dw.stg_devolucoes"
[0m18:38:15.835054 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m18:38:15.835938 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: BEGIN
[0m18:38:15.836820 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m18:38:15.837628 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: BEGIN
[0m18:38:15.838226 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:38:15.838601 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m18:38:15.838885 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: BEGIN
[0m18:38:15.839198 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:38:15.839827 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: BEGIN
[0m18:38:15.840584 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:38:15.841427 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:38:17.244595 [debug] [Thread-3 (]: SQL status: BEGIN in 1.0 seconds
[0m18:38:17.245256 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m18:38:17.245545 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_vendedores"} */

  
    

  create  table "general_rtxt"."bronze_silver"."dim_vendedores__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id_vendedor                as int)   as id_vendedor,
        nome_vendedor,
        cast(data_admissao     as date)  as data_admissao,
        endereco_vendedor,
        cast(data_nascimento   as date)  as data_nascimento
    from "general_rtxt"."bronze"."vendedores"

)

select *
from src
  );
  
[0m18:38:17.291678 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m18:38:17.292435 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m18:38:17.292740 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_lojas"} */

  
    

  create  table "general_rtxt"."bronze_silver"."dim_lojas__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id_loja  as int)   as id_loja,
        nome_loja,
        logradouro,
        cast("numero" as int)   as numero,
        bairro,
        cidade,
        estado,
        cep
    from "general_rtxt"."bronze"."lojas"

)

select *
from src
  );
  
[0m18:38:17.293179 [debug] [Thread-2 (]: SQL status: BEGIN in 1.0 seconds
[0m18:38:17.293798 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m18:38:17.294156 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_produtos"} */

  
    

  create  table "general_rtxt"."bronze_silver"."dim_produtos__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id_produto         as int)           as id_produto,
        nome_produto,
        categoria,
        cast(percentual_imposto as numeric(5,2))  as percentual_imposto
    from "general_rtxt"."bronze"."produtos"

)

select *
from src
  );
  
[0m18:38:17.440202 [debug] [Thread-3 (]: SQL status: SELECT 120 in 0.0 seconds
[0m18:38:17.446417 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m18:38:17.446793 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_vendedores"} */
alter table "general_rtxt"."bronze_silver"."dim_vendedores" rename to "dim_vendedores__dbt_backup"
[0m18:38:17.523154 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:38:17.526193 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m18:38:17.526564 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_lojas"} */
alter table "general_rtxt"."bronze_silver"."dim_lojas" rename to "dim_lojas__dbt_backup"
[0m18:38:17.531635 [debug] [Thread-2 (]: SQL status: SELECT 300 in 0.0 seconds
[0m18:38:17.534334 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m18:38:17.534686 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_produtos"} */
alter table "general_rtxt"."bronze_silver"."dim_produtos" rename to "dim_produtos__dbt_backup"
[0m18:38:17.591215 [debug] [Thread-4 (]: SQL status: BEGIN in 2.0 seconds
[0m18:38:17.592034 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m18:38:17.592325 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_devolucoes"} */

  
    

  create  table "general_rtxt"."bronze_silver"."stg_devolucoes__dbt_tmp"
  
  
    as
  
  (
    

with src as (

    select
        cast(id_venda       as bigint)              as id_venda,
        cast(id_produto     as int)                 as id_produto,
        cast(preco          as numeric(12,2))       as preco,
        cast(quantidade     as int)                 as quantidade,
        cast(data_venda     as date)                as data_venda,
        cast(data_devolucao as date)                as data_devolucao,
        cast(id_cliente     as int)                 as id_cliente,
        cast(id_loja        as int)                 as id_loja,
        cast(id_vendedor    as int)                 as id_vendedor,
        motivo
    from "general_rtxt"."bronze"."devolucoes"

)

select *
from src
  );
  
[0m18:38:17.633073 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:38:17.637040 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m18:38:17.637435 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_vendedores"} */
alter table "general_rtxt"."bronze_silver"."dim_vendedores__dbt_tmp" rename to "dim_vendedores"
[0m18:38:17.713725 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:38:17.716580 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m18:38:17.716930 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_lojas"} */
alter table "general_rtxt"."bronze_silver"."dim_lojas__dbt_tmp" rename to "dim_lojas"
[0m18:38:17.748259 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:38:17.751668 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m18:38:17.752081 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_produtos"} */
alter table "general_rtxt"."bronze_silver"."dim_produtos__dbt_tmp" rename to "dim_produtos"
[0m18:38:17.904317 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:38:17.919180 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:38:17.921604 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: COMMIT
[0m18:38:17.923468 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: COMMIT
[0m18:38:17.923886 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m18:38:17.924273 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m18:38:17.924944 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: COMMIT
[0m18:38:17.925506 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: COMMIT
[0m18:38:18.014108 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:38:18.016191 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: COMMIT
[0m18:38:18.016619 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m18:38:18.016912 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: COMMIT
[0m18:38:18.122414 [debug] [Thread-4 (]: SQL status: SELECT 30000 in 1.0 seconds
[0m18:38:18.125384 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m18:38:18.125876 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m18:38:18.127198 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_devolucoes"} */
alter table "general_rtxt"."bronze_silver"."stg_devolucoes" rename to "stg_devolucoes__dbt_backup"
[0m18:38:18.132838 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:38:18.134796 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.dim_vendedores"
[0m18:38:18.137443 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.dim_lojas"
[0m18:38:18.138088 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_vendedores"} */
drop table if exists "general_rtxt"."bronze_silver"."dim_vendedores__dbt_backup" cascade
[0m18:38:18.138919 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_lojas"} */
drop table if exists "general_rtxt"."bronze_silver"."dim_lojas__dbt_backup" cascade
[0m18:38:18.205914 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:38:18.208450 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.dim_produtos"
[0m18:38:18.208813 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.dim_produtos"} */
drop table if exists "general_rtxt"."bronze_silver"."dim_produtos__dbt_backup" cascade
[0m18:38:18.330260 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:38:18.332675 [debug] [Thread-3 (]: Timing info for model.vendas_dw.dim_vendedores (execute): 18:38:15.825854 => 18:38:18.332531
[0m18:38:18.333006 [debug] [Thread-3 (]: On model.vendas_dw.dim_vendedores: Close
[0m18:38:18.333683 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '850f45e8-a9c2-4160-aafc-639fc22b0158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96a8b9b6d0>]}
[0m18:38:18.334167 [info ] [Thread-3 (]: 3 of 5 OK created sql table model bronze_silver.dim_vendedores ................. [[32mSELECT 120[0m in 2.56s]
[0m18:38:18.334644 [debug] [Thread-3 (]: Finished running node model.vendas_dw.dim_vendedores
[0m18:38:18.334982 [debug] [Thread-3 (]: Began running node model.vendas_dw.stg_vendas
[0m18:38:18.335780 [info ] [Thread-3 (]: 5 of 5 START sql incremental model bronze_silver.stg_vendas .................... [RUN]
[0m18:38:18.336431 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.vendas_dw.dim_vendedores, now model.vendas_dw.stg_vendas)
[0m18:38:18.336851 [debug] [Thread-3 (]: Began compiling node model.vendas_dw.stg_vendas
[0m18:38:18.343665 [debug] [Thread-3 (]: Writing injected SQL for node "model.vendas_dw.stg_vendas"
[0m18:38:18.344274 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:38:18.346064 [debug] [Thread-1 (]: Timing info for model.vendas_dw.dim_lojas (execute): 18:38:15.790965 => 18:38:18.345914
[0m18:38:18.346428 [debug] [Thread-1 (]: On model.vendas_dw.dim_lojas: Close
[0m18:38:18.346928 [debug] [Thread-3 (]: Timing info for model.vendas_dw.stg_vendas (compile): 18:38:18.337082 => 18:38:18.346688
[0m18:38:18.347294 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:38:18.347772 [debug] [Thread-3 (]: Began executing node model.vendas_dw.stg_vendas
[0m18:38:18.348519 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '850f45e8-a9c2-4160-aafc-639fc22b0158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96a8b9eb50>]}
[0m18:38:18.351158 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m18:38:18.372888 [info ] [Thread-1 (]: 1 of 5 OK created sql table model bronze_silver.dim_lojas ...................... [[32mSELECT 15[0m in 2.58s]
[0m18:38:18.375076 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.stg_vendas"
[0m18:38:18.375834 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_devolucoes"} */
alter table "general_rtxt"."bronze_silver"."stg_devolucoes__dbt_tmp" rename to "stg_devolucoes"
[0m18:38:18.376860 [debug] [Thread-1 (]: Finished running node model.vendas_dw.dim_lojas
[0m18:38:18.377291 [debug] [Thread-3 (]: On model.vendas_dw.stg_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_vendas"} */

    
  
    

  create temporary table "stg_vendas__dbt_tmp183818368442"
  
  
    as
  
  (
    

WITH src AS (

    SELECT
        CAST(id_venda       AS BIGINT)        AS id_venda,
        CAST(id_produto     AS INTEGER)       AS id_produto,
        CAST(preco          AS NUMERIC(12,2)) AS preco,
        CAST(quantidade     AS INTEGER)       AS quantidade,
        CAST(data_venda     AS DATE)          AS data_venda,
        CAST(id_cliente     AS INTEGER)       AS id_cliente,
        CAST(id_loja        AS INTEGER)       AS id_loja,
        CAST(id_vendedor    AS INTEGER)       AS id_vendedor,
        LOWER(TRIM(meio_pagamento))           AS meio_pagamento,
        CAST(parcelamento   AS SMALLINT)      AS parcelamento
    FROM "general_rtxt"."bronze"."vendas"

    
      WHERE id_venda NOT IN (
        SELECT id_venda FROM "general_rtxt"."bronze_silver"."stg_vendas"
      )
    

)

SELECT *
FROM src
  );
  
  
[0m18:38:18.378138 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:38:18.414855 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:38:18.416443 [debug] [Thread-2 (]: Timing info for model.vendas_dw.dim_produtos (execute): 18:38:15.819796 => 18:38:18.416287
[0m18:38:18.416773 [debug] [Thread-2 (]: On model.vendas_dw.dim_produtos: Close
[0m18:38:18.417444 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '850f45e8-a9c2-4160-aafc-639fc22b0158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96a87b3a90>]}
[0m18:38:18.417919 [info ] [Thread-2 (]: 2 of 5 OK created sql table model bronze_silver.dim_produtos ................... [[32mSELECT 300[0m in 2.65s]
[0m18:38:18.418402 [debug] [Thread-2 (]: Finished running node model.vendas_dw.dim_produtos
[0m18:38:18.566555 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:38:18.569118 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: COMMIT
[0m18:38:18.569525 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m18:38:18.569789 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: COMMIT
[0m18:38:18.758663 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m18:38:18.763769 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.stg_devolucoes"
[0m18:38:18.764180 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.stg_devolucoes"} */
drop table if exists "general_rtxt"."bronze_silver"."stg_devolucoes__dbt_backup" cascade
[0m18:38:18.962041 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:38:18.963644 [debug] [Thread-4 (]: Timing info for model.vendas_dw.stg_devolucoes (execute): 18:38:15.831565 => 18:38:18.963507
[0m18:38:18.963958 [debug] [Thread-4 (]: On model.vendas_dw.stg_devolucoes: Close
[0m18:38:18.964663 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '850f45e8-a9c2-4160-aafc-639fc22b0158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96a86d6750>]}
[0m18:38:18.965133 [info ] [Thread-4 (]: 4 of 5 OK created sql table model bronze_silver.stg_devolucoes ................. [[32mSELECT 30000[0m in 3.19s]
[0m18:38:18.965597 [debug] [Thread-4 (]: Finished running node model.vendas_dw.stg_devolucoes
[0m18:48:48.346053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d3dad1f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d3d84df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d3dacbe50>]}


============================== 18:48:48.349876 | b4e834c2-3e0f-4a9a-827c-8b3abc24ed19 ==============================
[0m18:48:48.349876 [info ] [MainThread]: Running with dbt=1.6.0
[0m18:48:48.350341 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'log_path': '/home/walterg/Documentos/Data_projects/Data-Warehouse-postgres-DBT-airflow-/logs', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'log_format': 'default', 'use_colors': 'True', 'profiles_dir': '/home/walterg/.dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'warn_error': 'None', 'debug': 'False', 'invocation_command': 'dbt run --select gold', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m18:48:48.406921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4e834c2-3e0f-4a9a-827c-8b3abc24ed19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d3d42b050>]}
[0m18:48:48.419154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4e834c2-3e0f-4a9a-827c-8b3abc24ed19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d3d71a910>]}
[0m18:48:48.419792 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m18:48:48.427197 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m18:48:48.444292 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:48:48.444665 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:48:48.449072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4e834c2-3e0f-4a9a-827c-8b3abc24ed19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d3d4e81d0>]}
[0m18:48:48.459123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4e834c2-3e0f-4a9a-827c-8b3abc24ed19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d3ceb7650>]}
[0m18:48:48.459598 [info ] [MainThread]: Found 15 models, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m18:48:48.459898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4e834c2-3e0f-4a9a-827c-8b3abc24ed19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d3d4dc0d0>]}
[0m18:48:48.461334 [info ] [MainThread]: 
[0m18:48:48.462033 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:48:48.463977 [debug] [ThreadPool]: Acquiring new postgres connection 'list_general_rtxt'
[0m18:48:48.470635 [debug] [ThreadPool]: Acquiring new postgres connection 'list_general_rtxt'
[0m18:48:48.476819 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt"
[0m18:48:48.481075 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt"
[0m18:48:48.481563 [debug] [ThreadPool]: On list_general_rtxt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt"} */

    select distinct nspname from pg_namespace
  
[0m18:48:48.482159 [debug] [ThreadPool]: On list_general_rtxt: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt"} */

    select distinct nspname from pg_namespace
  
[0m18:48:48.482696 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:48:48.483241 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:48:50.411216 [debug] [ThreadPool]: SQL status: SELECT 6 in 2.0 seconds
[0m18:48:50.413281 [debug] [ThreadPool]: On list_general_rtxt: Close
[0m18:48:50.414160 [debug] [ThreadPool]: SQL status: SELECT 6 in 2.0 seconds
[0m18:48:50.415577 [debug] [ThreadPool]: On list_general_rtxt: Close
[0m18:48:50.417302 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_general_rtxt, now create_general_rtxt_bronze_gold)
[0m18:48:50.418038 [debug] [ThreadPool]: Creating schema "database: "general_rtxt"
schema: "bronze_gold"
"
[0m18:48:50.422145 [debug] [ThreadPool]: Using postgres connection "create_general_rtxt_bronze_gold"
[0m18:48:50.422521 [debug] [ThreadPool]: On create_general_rtxt_bronze_gold: BEGIN
[0m18:48:50.422756 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:48:52.211602 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m18:48:52.212326 [debug] [ThreadPool]: Using postgres connection "create_general_rtxt_bronze_gold"
[0m18:48:52.212611 [debug] [ThreadPool]: On create_general_rtxt_bronze_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "create_general_rtxt_bronze_gold"} */
create schema if not exists "bronze_gold"
[0m18:48:52.512464 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m18:48:52.514031 [debug] [ThreadPool]: On create_general_rtxt_bronze_gold: COMMIT
[0m18:48:52.514278 [debug] [ThreadPool]: Using postgres connection "create_general_rtxt_bronze_gold"
[0m18:48:52.514519 [debug] [ThreadPool]: On create_general_rtxt_bronze_gold: COMMIT
[0m18:48:52.711483 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m18:48:52.712408 [debug] [ThreadPool]: On create_general_rtxt_bronze_gold: Close
[0m18:48:52.715629 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_general_rtxt_bronze_gold, now list_general_rtxt_bronze_silver)
[0m18:48:52.716389 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_general_rtxt, now list_general_rtxt_bronze_gold)
[0m18:48:52.720843 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_silver"
[0m18:48:52.724492 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_gold"
[0m18:48:52.725107 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: BEGIN
[0m18:48:52.725845 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: BEGIN
[0m18:48:52.726163 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:48:52.726485 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:48:54.410567 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m18:48:54.411039 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_silver"
[0m18:48:54.411284 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt_bronze_silver"} */
select
      'general_rtxt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze_silver'
    union all
    select
      'general_rtxt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze_silver'
    union all
    select
      'general_rtxt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze_silver'
  
[0m18:48:54.415467 [debug] [ThreadPool]: SQL status: BEGIN in 2.0 seconds
[0m18:48:54.416193 [debug] [ThreadPool]: Using postgres connection "list_general_rtxt_bronze_gold"
[0m18:48:54.416684 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "list_general_rtxt_bronze_gold"} */
select
      'general_rtxt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze_gold'
    union all
    select
      'general_rtxt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze_gold'
    union all
    select
      'general_rtxt' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze_gold'
  
[0m18:48:54.719219 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m18:48:54.720922 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: ROLLBACK
[0m18:48:54.721270 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m18:48:54.722712 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: ROLLBACK
[0m18:48:54.912528 [debug] [ThreadPool]: On list_general_rtxt_bronze_silver: Close
[0m18:48:54.914472 [debug] [ThreadPool]: On list_general_rtxt_bronze_gold: Close
[0m18:48:54.918591 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:54.918951 [debug] [MainThread]: On master: BEGIN
[0m18:48:54.919176 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:48:56.513473 [debug] [MainThread]: SQL status: BEGIN in 2.0 seconds
[0m18:48:56.514076 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:56.514357 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:48:57.014899 [debug] [MainThread]: SQL status: SELECT 0 in 1.0 seconds
[0m18:48:57.016613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4e834c2-3e0f-4a9a-827c-8b3abc24ed19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d3d451250>]}
[0m18:48:57.017013 [debug] [MainThread]: On master: ROLLBACK
[0m18:48:57.211827 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:57.212464 [debug] [MainThread]: On master: BEGIN
[0m18:48:57.611700 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:48:57.612405 [debug] [MainThread]: On master: COMMIT
[0m18:48:57.612839 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:57.613058 [debug] [MainThread]: On master: COMMIT
[0m18:48:57.811709 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:48:57.812424 [debug] [MainThread]: On master: Close
[0m18:48:57.813063 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:48:57.813400 [info ] [MainThread]: 
[0m18:48:57.815914 [debug] [Thread-1 (]: Began running node model.vendas_dw.fct_devolucoes
[0m18:48:57.816461 [debug] [Thread-2 (]: Began running node model.vendas_dw.fct_vendas
[0m18:48:57.816884 [info ] [Thread-1 (]: 1 of 10 START sql view model bronze_gold.fct_devolucoes ........................ [RUN]
[0m18:48:57.817631 [info ] [Thread-2 (]: 2 of 10 START sql view model bronze_gold.fct_vendas ............................ [RUN]
[0m18:48:57.818523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_general_rtxt_bronze_gold, now model.vendas_dw.fct_devolucoes)
[0m18:48:57.819272 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_general_rtxt_bronze_silver, now model.vendas_dw.fct_vendas)
[0m18:48:57.819720 [debug] [Thread-1 (]: Began compiling node model.vendas_dw.fct_devolucoes
[0m18:48:57.820335 [debug] [Thread-2 (]: Began compiling node model.vendas_dw.fct_vendas
[0m18:48:57.825885 [debug] [Thread-1 (]: Writing injected SQL for node "model.vendas_dw.fct_devolucoes"
[0m18:48:57.829379 [debug] [Thread-2 (]: Writing injected SQL for node "model.vendas_dw.fct_vendas"
[0m18:48:57.830264 [debug] [Thread-1 (]: Timing info for model.vendas_dw.fct_devolucoes (compile): 18:48:57.820719 => 18:48:57.830052
[0m18:48:57.830647 [debug] [Thread-2 (]: Timing info for model.vendas_dw.fct_vendas (compile): 18:48:57.826315 => 18:48:57.830502
[0m18:48:57.830970 [debug] [Thread-1 (]: Began executing node model.vendas_dw.fct_devolucoes
[0m18:48:57.831437 [debug] [Thread-2 (]: Began executing node model.vendas_dw.fct_vendas
[0m18:48:57.866453 [debug] [Thread-2 (]: Writing runtime sql for node "model.vendas_dw.fct_vendas"
[0m18:48:57.867272 [debug] [Thread-1 (]: Writing runtime sql for node "model.vendas_dw.fct_devolucoes"
[0m18:48:57.868371 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m18:48:57.868848 [debug] [Thread-2 (]: On model.vendas_dw.fct_vendas: BEGIN
[0m18:48:57.869124 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:48:57.869650 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_devolucoes"
[0m18:48:57.870084 [debug] [Thread-1 (]: On model.vendas_dw.fct_devolucoes: BEGIN
[0m18:48:57.870402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:48:59.513253 [debug] [Thread-2 (]: SQL status: BEGIN in 2.0 seconds
[0m18:48:59.514287 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m18:48:59.514848 [debug] [Thread-2 (]: On model.vendas_dw.fct_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_vendas"} */

  create view "general_rtxt"."bronze_gold"."fct_vendas__dbt_tmp"
    
    
  as (
    

WITH ventes AS (
    SELECT * FROM "general_rtxt"."bronze_silver"."stg_vendas"
),

dim_produtos   AS (SELECT * FROM "general_rtxt"."bronze_silver"."dim_produtos"),
dim_lojas      AS (SELECT * FROM "general_rtxt"."bronze_silver"."dim_lojas"),
dim_vendedores AS (SELECT * FROM "general_rtxt"."bronze_silver"."dim_vendedores")

SELECT
    v.id_venda,
    v.id_produto,
    v.id_loja,
    v.id_vendedor,
    v.id_cliente,
    v.data_venda,
    v.quantidade,
    v.preco,
    v.quantidade * v.preco AS receita_bruta,
    v.meio_pagamento,
    v.parcelamento,

    -- dimensões
    p.nome_produto,
    p.categoria,
    l.nome_loja,
    l.cidade,
    ve.nome_vendedor
FROM ventes v
LEFT JOIN dim_produtos   p  ON v.id_produto  = p.id_produto
LEFT JOIN dim_lojas      l  ON v.id_loja     = l.id_loja
LEFT JOIN dim_vendedores ve ON v.id_vendedor = ve.id_vendedor
  );
[0m18:48:59.610699 [debug] [Thread-1 (]: SQL status: BEGIN in 2.0 seconds
[0m18:48:59.611703 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_devolucoes"
[0m18:48:59.611977 [debug] [Thread-1 (]: On model.vendas_dw.fct_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_devolucoes"} */

  create view "general_rtxt"."bronze_gold"."fct_devolucoes__dbt_tmp"
    
    
  as (
    

with devol as (
    select * from "general_rtxt"."bronze_silver"."stg_devolucoes"
)

select
    id_venda,
    id_produto,
    id_loja,
    id_vendedor,
    id_cliente,
    data_venda,
    data_devolucao,
    quantidade,
    preco,
    quantidade * preco                             as valor_devolvido,
    motivo
from devol
  );
[0m18:48:59.913599 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:48:59.918541 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_devolucoes"
[0m18:48:59.919193 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:48:59.919542 [debug] [Thread-1 (]: On model.vendas_dw.fct_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_devolucoes"} */
alter table "general_rtxt"."bronze_gold"."fct_devolucoes__dbt_tmp" rename to "fct_devolucoes"
[0m18:48:59.921817 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m18:48:59.922399 [debug] [Thread-2 (]: On model.vendas_dw.fct_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_vendas"} */
alter table "general_rtxt"."bronze_gold"."fct_vendas__dbt_tmp" rename to "fct_vendas"
[0m18:49:00.113954 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:49:00.120387 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:49:00.125893 [debug] [Thread-1 (]: On model.vendas_dw.fct_devolucoes: COMMIT
[0m18:49:00.127870 [debug] [Thread-2 (]: On model.vendas_dw.fct_vendas: COMMIT
[0m18:49:00.128839 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_devolucoes"
[0m18:49:00.129392 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m18:49:00.129728 [debug] [Thread-1 (]: On model.vendas_dw.fct_devolucoes: COMMIT
[0m18:49:00.130048 [debug] [Thread-2 (]: On model.vendas_dw.fct_vendas: COMMIT
[0m18:49:00.416624 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:49:00.417480 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:49:00.423723 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.fct_vendas"
[0m18:49:00.426432 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.fct_devolucoes"
[0m18:49:00.426862 [debug] [Thread-2 (]: On model.vendas_dw.fct_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_vendas"} */
drop view if exists "general_rtxt"."bronze_gold"."fct_vendas__dbt_backup" cascade
[0m18:49:00.427213 [debug] [Thread-1 (]: On model.vendas_dw.fct_devolucoes: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.fct_devolucoes"} */
drop view if exists "general_rtxt"."bronze_gold"."fct_devolucoes__dbt_backup" cascade
[0m18:49:00.710662 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:49:00.712422 [debug] [Thread-1 (]: Timing info for model.vendas_dw.fct_devolucoes (execute): 18:48:57.831894 => 18:49:00.712268
[0m18:49:00.712827 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:49:00.713373 [debug] [Thread-1 (]: On model.vendas_dw.fct_devolucoes: Close
[0m18:49:00.715052 [debug] [Thread-2 (]: Timing info for model.vendas_dw.fct_vendas (execute): 18:48:57.852718 => 18:49:00.714915
[0m18:49:00.715492 [debug] [Thread-2 (]: On model.vendas_dw.fct_vendas: Close
[0m18:49:00.716451 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4e834c2-3e0f-4a9a-827c-8b3abc24ed19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d3cf5b510>]}
[0m18:49:00.717122 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4e834c2-3e0f-4a9a-827c-8b3abc24ed19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d3d78e490>]}
[0m18:49:00.717669 [info ] [Thread-1 (]: 1 of 10 OK created sql view model bronze_gold.fct_devolucoes ................... [[32mCREATE VIEW[0m in 2.90s]
[0m18:49:00.718163 [info ] [Thread-2 (]: 2 of 10 OK created sql view model bronze_gold.fct_vendas ....................... [[32mCREATE VIEW[0m in 2.90s]
[0m18:49:00.718754 [debug] [Thread-1 (]: Finished running node model.vendas_dw.fct_devolucoes
[0m18:49:00.719213 [debug] [Thread-2 (]: Finished running node model.vendas_dw.fct_vendas
[0m18:49:00.725071 [debug] [Thread-4 (]: Began running node model.vendas_dw.gold_crescimento_receita_categoria
[0m18:49:00.725508 [debug] [Thread-3 (]: Began running node model.vendas_dw.gold_media_movel_7d
[0m18:49:00.725942 [info ] [Thread-4 (]: 3 of 10 START sql view model bronze_gold.gold_crescimento_receita_categoria .... [RUN]
[0m18:49:00.726480 [debug] [Thread-1 (]: Began running node model.vendas_dw.gold_receita_acumulada_loja
[0m18:49:00.726899 [info ] [Thread-3 (]: 4 of 10 START sql view model bronze_gold.gold_media_movel_7d ................... [RUN]
[0m18:49:00.727331 [debug] [Thread-2 (]: Began running node model.vendas_dw.gold_taxa_devolucao
[0m18:49:00.728089 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.vendas_dw.gold_crescimento_receita_categoria'
[0m18:49:00.728720 [info ] [Thread-1 (]: 5 of 10 START sql view model bronze_gold.gold_receita_acumulada_loja ........... [RUN]
[0m18:49:00.729590 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.vendas_dw.gold_media_movel_7d'
[0m18:49:00.730063 [info ] [Thread-2 (]: 6 of 10 START sql view model bronze_gold.gold_taxa_devolucao ................... [RUN]
[0m18:49:00.730668 [debug] [Thread-4 (]: Began compiling node model.vendas_dw.gold_crescimento_receita_categoria
[0m18:49:00.731547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vendas_dw.fct_devolucoes, now model.vendas_dw.gold_receita_acumulada_loja)
[0m18:49:00.732290 [debug] [Thread-3 (]: Began compiling node model.vendas_dw.gold_media_movel_7d
[0m18:49:00.733176 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.vendas_dw.fct_vendas, now model.vendas_dw.gold_taxa_devolucao)
[0m18:49:00.738886 [debug] [Thread-4 (]: Writing injected SQL for node "model.vendas_dw.gold_crescimento_receita_categoria"
[0m18:49:00.739373 [debug] [Thread-1 (]: Began compiling node model.vendas_dw.gold_receita_acumulada_loja
[0m18:49:00.741734 [debug] [Thread-3 (]: Writing injected SQL for node "model.vendas_dw.gold_media_movel_7d"
[0m18:49:00.742319 [debug] [Thread-2 (]: Began compiling node model.vendas_dw.gold_taxa_devolucao
[0m18:49:00.745077 [debug] [Thread-1 (]: Writing injected SQL for node "model.vendas_dw.gold_receita_acumulada_loja"
[0m18:49:00.748664 [debug] [Thread-2 (]: Writing injected SQL for node "model.vendas_dw.gold_taxa_devolucao"
[0m18:49:00.749292 [debug] [Thread-4 (]: Timing info for model.vendas_dw.gold_crescimento_receita_categoria (compile): 18:49:00.733534 => 18:49:00.748972
[0m18:49:00.750731 [debug] [Thread-3 (]: Timing info for model.vendas_dw.gold_media_movel_7d (compile): 18:49:00.739647 => 18:49:00.750308
[0m18:49:00.751823 [debug] [Thread-1 (]: Timing info for model.vendas_dw.gold_receita_acumulada_loja (compile): 18:49:00.742798 => 18:49:00.751428
[0m18:49:00.752172 [debug] [Thread-4 (]: Began executing node model.vendas_dw.gold_crescimento_receita_categoria
[0m18:49:00.752687 [debug] [Thread-2 (]: Timing info for model.vendas_dw.gold_taxa_devolucao (compile): 18:49:00.745685 => 18:49:00.752455
[0m18:49:00.753049 [debug] [Thread-3 (]: Began executing node model.vendas_dw.gold_media_movel_7d
[0m18:49:00.753415 [debug] [Thread-1 (]: Began executing node model.vendas_dw.gold_receita_acumulada_loja
[0m18:49:00.757426 [debug] [Thread-4 (]: Writing runtime sql for node "model.vendas_dw.gold_crescimento_receita_categoria"
[0m18:49:00.758033 [debug] [Thread-2 (]: Began executing node model.vendas_dw.gold_taxa_devolucao
[0m18:49:00.761653 [debug] [Thread-3 (]: Writing runtime sql for node "model.vendas_dw.gold_media_movel_7d"
[0m18:49:00.765623 [debug] [Thread-1 (]: Writing runtime sql for node "model.vendas_dw.gold_receita_acumulada_loja"
[0m18:49:00.769584 [debug] [Thread-2 (]: Writing runtime sql for node "model.vendas_dw.gold_taxa_devolucao"
[0m18:49:00.770169 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.gold_crescimento_receita_categoria"
[0m18:49:00.770627 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.gold_media_movel_7d"
[0m18:49:00.771176 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.gold_receita_acumulada_loja"
[0m18:49:00.771580 [debug] [Thread-4 (]: On model.vendas_dw.gold_crescimento_receita_categoria: BEGIN
[0m18:49:00.772174 [debug] [Thread-3 (]: On model.vendas_dw.gold_media_movel_7d: BEGIN
[0m18:49:00.772835 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.gold_taxa_devolucao"
[0m18:49:00.773173 [debug] [Thread-1 (]: On model.vendas_dw.gold_receita_acumulada_loja: BEGIN
[0m18:49:00.773523 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:49:00.773868 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:49:00.774205 [debug] [Thread-2 (]: On model.vendas_dw.gold_taxa_devolucao: BEGIN
[0m18:49:00.774542 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:49:00.775171 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:49:02.313998 [debug] [Thread-3 (]: SQL status: BEGIN in 2.0 seconds
[0m18:49:02.315003 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.gold_media_movel_7d"
[0m18:49:02.315312 [debug] [Thread-3 (]: On model.vendas_dw.gold_media_movel_7d: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.gold_media_movel_7d"} */

  create view "general_rtxt"."bronze_gold"."gold_media_movel_7d__dbt_tmp"
    
    
  as (
    

WITH receita_diaria AS (
    SELECT
        data_venda,
        id_loja,
        nome_loja,
        SUM(receita_bruta) AS receita_diaria
    FROM "general_rtxt"."bronze_gold"."fct_vendas"
    GROUP BY data_venda, id_loja, nome_loja
)

SELECT
    *,
    AVG(receita_diaria) OVER (
        PARTITION BY id_loja
        ORDER BY data_venda
        ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
    ) AS media_movel_7d
FROM receita_diaria
  );
[0m18:49:02.417009 [debug] [Thread-2 (]: SQL status: BEGIN in 2.0 seconds
[0m18:49:02.417836 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.gold_taxa_devolucao"
[0m18:49:02.418152 [debug] [Thread-2 (]: On model.vendas_dw.gold_taxa_devolucao: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.gold_taxa_devolucao"} */

  create view "general_rtxt"."bronze_gold"."gold_taxa_devolucao__dbt_tmp"
    
    
  as (
    

WITH vendas AS (
    SELECT id_venda, id_produto, data_venda, receita_bruta
    FROM "general_rtxt"."bronze_gold"."fct_vendas"
),
devolucoes AS (
    SELECT id_venda, data_devolucao
    FROM "general_rtxt"."bronze_gold"."fct_devolucoes"
)

SELECT
    v.data_venda,
    COUNT(DISTINCT v.id_venda) AS vendas_totais,
    COUNT(DISTINCT d.id_venda) AS vendas_devolvidas,
    ROUND(
        COUNT(DISTINCT d.id_venda)::numeric / NULLIF(COUNT(DISTINCT v.id_venda), 0),
        4
    ) AS taxa_devolucao
FROM vendas v
LEFT JOIN devolucoes d ON v.id_venda = d.id_venda
GROUP BY v.data_venda
  );
[0m18:49:02.616983 [debug] [Thread-1 (]: SQL status: BEGIN in 2.0 seconds
[0m18:49:02.617641 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.gold_receita_acumulada_loja"
[0m18:49:02.617918 [debug] [Thread-1 (]: On model.vendas_dw.gold_receita_acumulada_loja: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.gold_receita_acumulada_loja"} */

  create view "general_rtxt"."bronze_gold"."gold_receita_acumulada_loja__dbt_tmp"
    
    
  as (
    

WITH base AS (
    SELECT
        data_venda,
        id_loja,
        nome_loja,
        EXTRACT(YEAR FROM data_venda) AS ano,
        receita_bruta
    FROM "general_rtxt"."bronze_gold"."fct_vendas"
),

acumulado AS (
    SELECT
        data_venda,
        id_loja,
        nome_loja,
        ano,
        SUM(receita_bruta) OVER (
            PARTITION BY id_loja, ano ORDER BY data_venda
        ) AS receita_acumulada
    FROM base
)

SELECT * FROM acumulado
  );
[0m18:49:02.715443 [debug] [Thread-4 (]: SQL status: BEGIN in 2.0 seconds
[0m18:49:02.716112 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.gold_crescimento_receita_categoria"
[0m18:49:02.716424 [debug] [Thread-4 (]: On model.vendas_dw.gold_crescimento_receita_categoria: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.gold_crescimento_receita_categoria"} */

  create view "general_rtxt"."bronze_gold"."gold_crescimento_receita_categoria__dbt_tmp"
    
    
  as (
    

WITH base AS (
    SELECT
        DATE_TRUNC('month', data_venda)::date AS mes,
        categoria,
        SUM(receita_bruta) AS receita_mensal
    FROM "general_rtxt"."bronze_gold"."fct_vendas"
    GROUP BY 1, 2
),

crescimento AS (
    SELECT
        mes,
        categoria,
        receita_mensal,
        LAG(receita_mensal) OVER (PARTITION BY categoria ORDER BY mes) AS receita_mes_anterior
    FROM base
)

SELECT
    *,
    ROUND(
        CASE
            WHEN receita_mes_anterior > 0 THEN 
                (receita_mensal - receita_mes_anterior) / receita_mes_anterior::numeric
            ELSE NULL
        END, 4
    ) AS crescimento_pct
FROM crescimento
  );
[0m18:49:02.721811 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:49:02.722900 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:49:02.725402 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.gold_taxa_devolucao"
[0m18:49:02.728941 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.gold_media_movel_7d"
[0m18:49:02.729682 [debug] [Thread-2 (]: On model.vendas_dw.gold_taxa_devolucao: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.gold_taxa_devolucao"} */
alter table "general_rtxt"."bronze_gold"."gold_taxa_devolucao__dbt_tmp" rename to "gold_taxa_devolucao"
[0m18:49:02.730493 [debug] [Thread-3 (]: On model.vendas_dw.gold_media_movel_7d: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.gold_media_movel_7d"} */
alter table "general_rtxt"."bronze_gold"."gold_media_movel_7d__dbt_tmp" rename to "gold_media_movel_7d"
[0m18:49:02.920468 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:49:02.922852 [debug] [Thread-2 (]: On model.vendas_dw.gold_taxa_devolucao: COMMIT
[0m18:49:02.923236 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.gold_taxa_devolucao"
[0m18:49:02.923517 [debug] [Thread-2 (]: On model.vendas_dw.gold_taxa_devolucao: COMMIT
[0m18:49:02.925329 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:49:02.927837 [debug] [Thread-3 (]: On model.vendas_dw.gold_media_movel_7d: COMMIT
[0m18:49:02.928195 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.gold_media_movel_7d"
[0m18:49:02.928493 [debug] [Thread-3 (]: On model.vendas_dw.gold_media_movel_7d: COMMIT
[0m18:49:03.013217 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:49:03.016775 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.gold_receita_acumulada_loja"
[0m18:49:03.017168 [debug] [Thread-1 (]: On model.vendas_dw.gold_receita_acumulada_loja: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.gold_receita_acumulada_loja"} */
alter table "general_rtxt"."bronze_gold"."gold_receita_acumulada_loja__dbt_tmp" rename to "gold_receita_acumulada_loja"
[0m18:49:03.114297 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:49:03.115082 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:49:03.115609 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m18:49:03.118476 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.gold_crescimento_receita_categoria"
[0m18:49:03.120692 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.gold_taxa_devolucao"
[0m18:49:03.125179 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.gold_media_movel_7d"
[0m18:49:03.125815 [debug] [Thread-4 (]: On model.vendas_dw.gold_crescimento_receita_categoria: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.gold_crescimento_receita_categoria"} */
alter table "general_rtxt"."bronze_gold"."gold_crescimento_receita_categoria__dbt_tmp" rename to "gold_crescimento_receita_categoria"
[0m18:49:03.126730 [debug] [Thread-2 (]: On model.vendas_dw.gold_taxa_devolucao: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.gold_taxa_devolucao"} */
drop view if exists "general_rtxt"."bronze_gold"."gold_taxa_devolucao__dbt_backup" cascade
[0m18:49:03.127522 [debug] [Thread-3 (]: On model.vendas_dw.gold_media_movel_7d: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.gold_media_movel_7d"} */
drop view if exists "general_rtxt"."bronze_gold"."gold_media_movel_7d__dbt_backup" cascade
[0m18:49:03.212251 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:49:03.214128 [debug] [Thread-1 (]: On model.vendas_dw.gold_receita_acumulada_loja: COMMIT
[0m18:49:03.214455 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.gold_receita_acumulada_loja"
[0m18:49:03.214716 [debug] [Thread-1 (]: On model.vendas_dw.gold_receita_acumulada_loja: COMMIT
[0m18:49:03.315353 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:49:03.317433 [debug] [Thread-3 (]: Timing info for model.vendas_dw.gold_media_movel_7d (execute): 18:49:00.758526 => 18:49:03.317266
[0m18:49:03.317804 [debug] [Thread-3 (]: On model.vendas_dw.gold_media_movel_7d: Close
[0m18:49:03.318385 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:49:03.319277 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4e834c2-3e0f-4a9a-827c-8b3abc24ed19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d3ccf7cd0>]}
[0m18:49:03.320512 [debug] [Thread-2 (]: Timing info for model.vendas_dw.gold_taxa_devolucao (execute): 18:49:00.766242 => 18:49:03.320353
[0m18:49:03.321028 [info ] [Thread-3 (]: 4 of 10 OK created sql view model bronze_gold.gold_media_movel_7d .............. [[32mCREATE VIEW[0m in 2.59s]
[0m18:49:03.321477 [debug] [Thread-2 (]: On model.vendas_dw.gold_taxa_devolucao: Close
[0m18:49:03.322005 [debug] [Thread-3 (]: Finished running node model.vendas_dw.gold_media_movel_7d
[0m18:49:03.322520 [debug] [Thread-3 (]: Began running node model.vendas_dw.gold_ticket_medio_categoria
[0m18:49:03.323580 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4e834c2-3e0f-4a9a-827c-8b3abc24ed19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d3ceee710>]}
[0m18:49:03.323997 [info ] [Thread-3 (]: 7 of 10 START sql view model bronze_gold.gold_ticket_medio_categoria ........... [RUN]
[0m18:49:03.324564 [info ] [Thread-2 (]: 6 of 10 OK created sql view model bronze_gold.gold_taxa_devolucao .............. [[32mCREATE VIEW[0m in 2.59s]
[0m18:49:03.325245 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.vendas_dw.gold_media_movel_7d, now model.vendas_dw.gold_ticket_medio_categoria)
[0m18:49:03.325893 [debug] [Thread-2 (]: Finished running node model.vendas_dw.gold_taxa_devolucao
[0m18:49:03.326264 [debug] [Thread-3 (]: Began compiling node model.vendas_dw.gold_ticket_medio_categoria
[0m18:49:03.326697 [debug] [Thread-2 (]: Began running node model.vendas_dw.indicadores_vendas
[0m18:49:03.329793 [debug] [Thread-3 (]: Writing injected SQL for node "model.vendas_dw.gold_ticket_medio_categoria"
[0m18:49:03.330454 [info ] [Thread-2 (]: 8 of 10 START sql view model bronze_silver.indicadores_vendas .................. [RUN]
[0m18:49:03.331825 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.vendas_dw.gold_taxa_devolucao, now model.vendas_dw.indicadores_vendas)
[0m18:49:03.332286 [debug] [Thread-2 (]: Began compiling node model.vendas_dw.indicadores_vendas
[0m18:49:03.332789 [debug] [Thread-3 (]: Timing info for model.vendas_dw.gold_ticket_medio_categoria (compile): 18:49:03.327300 => 18:49:03.332545
[0m18:49:03.335474 [debug] [Thread-2 (]: Writing injected SQL for node "model.vendas_dw.indicadores_vendas"
[0m18:49:03.336312 [debug] [Thread-3 (]: Began executing node model.vendas_dw.gold_ticket_medio_categoria
[0m18:49:03.341058 [debug] [Thread-3 (]: Writing runtime sql for node "model.vendas_dw.gold_ticket_medio_categoria"
[0m18:49:03.342191 [debug] [Thread-2 (]: Timing info for model.vendas_dw.indicadores_vendas (compile): 18:49:03.333120 => 18:49:03.341623
[0m18:49:03.343247 [debug] [Thread-2 (]: Began executing node model.vendas_dw.indicadores_vendas
[0m18:49:03.346970 [debug] [Thread-2 (]: Writing runtime sql for node "model.vendas_dw.indicadores_vendas"
[0m18:49:03.347907 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.gold_ticket_medio_categoria"
[0m18:49:03.348895 [debug] [Thread-3 (]: On model.vendas_dw.gold_ticket_medio_categoria: BEGIN
[0m18:49:03.349646 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:49:03.350104 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.indicadores_vendas"
[0m18:49:03.350438 [debug] [Thread-2 (]: On model.vendas_dw.indicadores_vendas: BEGIN
[0m18:49:03.350693 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:49:03.413150 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:49:03.415828 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.gold_receita_acumulada_loja"
[0m18:49:03.416393 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:49:03.416950 [debug] [Thread-1 (]: On model.vendas_dw.gold_receita_acumulada_loja: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.gold_receita_acumulada_loja"} */
drop view if exists "general_rtxt"."bronze_gold"."gold_receita_acumulada_loja__dbt_backup" cascade
[0m18:49:03.418881 [debug] [Thread-4 (]: On model.vendas_dw.gold_crescimento_receita_categoria: COMMIT
[0m18:49:03.419951 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.gold_crescimento_receita_categoria"
[0m18:49:03.420368 [debug] [Thread-4 (]: On model.vendas_dw.gold_crescimento_receita_categoria: COMMIT
[0m18:49:03.613649 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:49:03.615484 [debug] [Thread-1 (]: Timing info for model.vendas_dw.gold_receita_acumulada_loja (execute): 18:49:00.762075 => 18:49:03.615333
[0m18:49:03.615966 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m18:49:03.616462 [debug] [Thread-1 (]: On model.vendas_dw.gold_receita_acumulada_loja: Close
[0m18:49:03.618722 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.gold_crescimento_receita_categoria"
[0m18:49:03.619298 [debug] [Thread-4 (]: On model.vendas_dw.gold_crescimento_receita_categoria: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.gold_crescimento_receita_categoria"} */
drop view if exists "general_rtxt"."bronze_gold"."gold_crescimento_receita_categoria__dbt_backup" cascade
[0m18:49:03.620182 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4e834c2-3e0f-4a9a-827c-8b3abc24ed19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d3cc9c3d0>]}
[0m18:49:03.620779 [info ] [Thread-1 (]: 5 of 10 OK created sql view model bronze_gold.gold_receita_acumulada_loja ...... [[32mCREATE VIEW[0m in 2.89s]
[0m18:49:03.621244 [debug] [Thread-1 (]: Finished running node model.vendas_dw.gold_receita_acumulada_loja
[0m18:49:03.621592 [debug] [Thread-1 (]: Began running node model.vendas_dw.mart_receita_diaria_loja
[0m18:49:03.622209 [info ] [Thread-1 (]: 9 of 10 START sql view model bronze_gold.mart_receita_diaria_loja .............. [RUN]
[0m18:49:03.622746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.vendas_dw.gold_receita_acumulada_loja, now model.vendas_dw.mart_receita_diaria_loja)
[0m18:49:03.623028 [debug] [Thread-1 (]: Began compiling node model.vendas_dw.mart_receita_diaria_loja
[0m18:49:03.625197 [debug] [Thread-1 (]: Writing injected SQL for node "model.vendas_dw.mart_receita_diaria_loja"
[0m18:49:03.625995 [debug] [Thread-1 (]: Timing info for model.vendas_dw.mart_receita_diaria_loja (compile): 18:49:03.623222 => 18:49:03.625794
[0m18:49:03.626439 [debug] [Thread-1 (]: Began executing node model.vendas_dw.mart_receita_diaria_loja
[0m18:49:03.630024 [debug] [Thread-1 (]: Writing runtime sql for node "model.vendas_dw.mart_receita_diaria_loja"
[0m18:49:03.630690 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.mart_receita_diaria_loja"
[0m18:49:03.631010 [debug] [Thread-1 (]: On model.vendas_dw.mart_receita_diaria_loja: BEGIN
[0m18:49:03.631266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:49:03.813170 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:49:03.814866 [debug] [Thread-4 (]: Timing info for model.vendas_dw.gold_crescimento_receita_categoria (execute): 18:49:00.753752 => 18:49:03.814729
[0m18:49:03.815181 [debug] [Thread-4 (]: On model.vendas_dw.gold_crescimento_receita_categoria: Close
[0m18:49:03.815868 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4e834c2-3e0f-4a9a-827c-8b3abc24ed19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d3ccd1c90>]}
[0m18:49:03.816333 [info ] [Thread-4 (]: 3 of 10 OK created sql view model bronze_gold.gold_crescimento_receita_categoria  [[32mCREATE VIEW[0m in 3.09s]
[0m18:49:03.816837 [debug] [Thread-4 (]: Finished running node model.vendas_dw.gold_crescimento_receita_categoria
[0m18:49:03.817205 [debug] [Thread-4 (]: Began running node model.vendas_dw.mart_receita_mensal_categoria
[0m18:49:03.818068 [info ] [Thread-4 (]: 10 of 10 START sql view model bronze_gold.mart_receita_mensal_categoria ........ [RUN]
[0m18:49:03.818746 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.vendas_dw.gold_crescimento_receita_categoria, now model.vendas_dw.mart_receita_mensal_categoria)
[0m18:49:03.819116 [debug] [Thread-4 (]: Began compiling node model.vendas_dw.mart_receita_mensal_categoria
[0m18:49:03.821526 [debug] [Thread-4 (]: Writing injected SQL for node "model.vendas_dw.mart_receita_mensal_categoria"
[0m18:49:03.822379 [debug] [Thread-4 (]: Timing info for model.vendas_dw.mart_receita_mensal_categoria (compile): 18:49:03.819344 => 18:49:03.822131
[0m18:49:03.822758 [debug] [Thread-4 (]: Began executing node model.vendas_dw.mart_receita_mensal_categoria
[0m18:49:03.826038 [debug] [Thread-4 (]: Writing runtime sql for node "model.vendas_dw.mart_receita_mensal_categoria"
[0m18:49:03.826650 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.mart_receita_mensal_categoria"
[0m18:49:03.826969 [debug] [Thread-4 (]: On model.vendas_dw.mart_receita_mensal_categoria: BEGIN
[0m18:49:03.827252 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:49:05.011430 [debug] [Thread-3 (]: SQL status: BEGIN in 2.0 seconds
[0m18:49:05.012032 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.gold_ticket_medio_categoria"
[0m18:49:05.012310 [debug] [Thread-3 (]: On model.vendas_dw.gold_ticket_medio_categoria: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.gold_ticket_medio_categoria"} */

  create view "general_rtxt"."bronze_gold"."gold_ticket_medio_categoria__dbt_tmp"
    
    
  as (
    

WITH base AS (
    SELECT
        DATE_TRUNC('month', data_venda)::date AS mes,
        categoria,
        SUM(receita_bruta) AS receita,
        SUM(quantidade) AS itens
    FROM "general_rtxt"."bronze_gold"."fct_vendas"
    GROUP BY 1, 2
)

SELECT
    mes,
    categoria,
    receita,
    itens,
    ROUND(receita / NULLIF(itens, 0), 2) AS ticket_medio
FROM base
  );
[0m18:49:05.115006 [debug] [Thread-2 (]: SQL status: BEGIN in 2.0 seconds
[0m18:49:05.116065 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.indicadores_vendas"
[0m18:49:05.116616 [debug] [Thread-2 (]: On model.vendas_dw.indicadores_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.indicadores_vendas"} */

  create view "general_rtxt"."bronze_silver"."indicadores_vendas__dbt_tmp"
    
    
  as (
    

WITH base AS (
    SELECT
        data_venda,
        id_loja,
        preco,
        quantidade,
        id_venda
    FROM "general_rtxt"."bronze_gold"."fct_vendas"
)
SELECT
    data_venda,
    id_loja,
    SUM(preco * quantidade) AS receita_total,
    COUNT(DISTINCT id_venda) AS qtd_vendas
FROM base
GROUP BY data_venda, id_loja
  );
[0m18:49:05.310412 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:49:05.312919 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.gold_ticket_medio_categoria"
[0m18:49:05.313286 [debug] [Thread-3 (]: On model.vendas_dw.gold_ticket_medio_categoria: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.gold_ticket_medio_categoria"} */
alter table "general_rtxt"."bronze_gold"."gold_ticket_medio_categoria__dbt_tmp" rename to "gold_ticket_medio_categoria"
[0m18:49:05.319545 [debug] [Thread-1 (]: SQL status: BEGIN in 2.0 seconds
[0m18:49:05.320005 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.mart_receita_diaria_loja"
[0m18:49:05.320286 [debug] [Thread-1 (]: On model.vendas_dw.mart_receita_diaria_loja: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.mart_receita_diaria_loja"} */

  create view "general_rtxt"."bronze_gold"."mart_receita_diaria_loja__dbt_tmp"
    
    
  as (
    

with fct as (
    select * from "general_rtxt"."bronze_gold"."fct_vendas"
)

select
    data_venda,
    id_loja,
    nome_loja,
    sum(receita_bruta)                           as receita_diaria,
    count(distinct id_venda)                     as qtd_vendas,
    sum(quantidade)                              as itens_vendidos
from fct
group by data_venda, id_loja, nome_loja
  );
[0m18:49:05.411423 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:49:05.414353 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.indicadores_vendas"
[0m18:49:05.414723 [debug] [Thread-2 (]: On model.vendas_dw.indicadores_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.indicadores_vendas"} */
alter table "general_rtxt"."bronze_silver"."indicadores_vendas__dbt_tmp" rename to "indicadores_vendas"
[0m18:49:05.499885 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:49:05.501835 [debug] [Thread-3 (]: On model.vendas_dw.gold_ticket_medio_categoria: COMMIT
[0m18:49:05.502726 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.gold_ticket_medio_categoria"
[0m18:49:05.503158 [debug] [Thread-3 (]: On model.vendas_dw.gold_ticket_medio_categoria: COMMIT
[0m18:49:05.513720 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:49:05.516127 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.mart_receita_diaria_loja"
[0m18:49:05.516536 [debug] [Thread-1 (]: On model.vendas_dw.mart_receita_diaria_loja: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.mart_receita_diaria_loja"} */
alter table "general_rtxt"."bronze_gold"."mart_receita_diaria_loja__dbt_tmp" rename to "mart_receita_diaria_loja"
[0m18:49:05.599661 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:49:05.601581 [debug] [Thread-2 (]: On model.vendas_dw.indicadores_vendas: COMMIT
[0m18:49:05.602546 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.indicadores_vendas"
[0m18:49:05.603110 [debug] [Thread-2 (]: On model.vendas_dw.indicadores_vendas: COMMIT
[0m18:49:05.612070 [debug] [Thread-4 (]: SQL status: BEGIN in 2.0 seconds
[0m18:49:05.613095 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.mart_receita_mensal_categoria"
[0m18:49:05.613407 [debug] [Thread-4 (]: On model.vendas_dw.mart_receita_mensal_categoria: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.mart_receita_mensal_categoria"} */

  create view "general_rtxt"."bronze_gold"."mart_receita_mensal_categoria__dbt_tmp"
    
    
  as (
    

with fct as (
    select * from "general_rtxt"."bronze_gold"."fct_vendas"
),

base as (
    select
        date_trunc('month', data_venda)::date    as mes,
        categoria,
        sum(receita_bruta)                       as receita_mensal,
        sum(quantidade)                          as itens_vendidos
    from fct
    group by 1, 2
)

select * from base
  );
[0m18:49:05.711457 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m18:49:05.765575 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:49:05.767585 [debug] [Thread-3 (]: Using postgres connection "model.vendas_dw.gold_ticket_medio_categoria"
[0m18:49:05.769026 [debug] [Thread-1 (]: On model.vendas_dw.mart_receita_diaria_loja: COMMIT
[0m18:49:05.769667 [debug] [Thread-3 (]: On model.vendas_dw.gold_ticket_medio_categoria: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.gold_ticket_medio_categoria"} */
drop view if exists "general_rtxt"."bronze_gold"."gold_ticket_medio_categoria__dbt_backup" cascade
[0m18:49:05.770129 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.mart_receita_diaria_loja"
[0m18:49:05.770926 [debug] [Thread-1 (]: On model.vendas_dw.mart_receita_diaria_loja: COMMIT
[0m18:49:05.817301 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m18:49:05.821579 [debug] [Thread-2 (]: Using postgres connection "model.vendas_dw.indicadores_vendas"
[0m18:49:05.821996 [debug] [Thread-2 (]: On model.vendas_dw.indicadores_vendas: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.indicadores_vendas"} */
drop view if exists "general_rtxt"."bronze_silver"."indicadores_vendas__dbt_backup" cascade
[0m18:49:05.914705 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:49:05.918118 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.mart_receita_mensal_categoria"
[0m18:49:05.918806 [debug] [Thread-4 (]: On model.vendas_dw.mart_receita_mensal_categoria: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.mart_receita_mensal_categoria"} */
alter table "general_rtxt"."bronze_gold"."mart_receita_mensal_categoria__dbt_tmp" rename to "mart_receita_mensal_categoria"
[0m18:49:05.955326 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:49:05.956818 [debug] [Thread-3 (]: Timing info for model.vendas_dw.gold_ticket_medio_categoria (execute): 18:49:03.337250 => 18:49:05.956673
[0m18:49:05.957157 [debug] [Thread-3 (]: On model.vendas_dw.gold_ticket_medio_categoria: Close
[0m18:49:05.957850 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4e834c2-3e0f-4a9a-827c-8b3abc24ed19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d3cd8b350>]}
[0m18:49:05.958345 [info ] [Thread-3 (]: 7 of 10 OK created sql view model bronze_gold.gold_ticket_medio_categoria ...... [[32mCREATE VIEW[0m in 2.63s]
[0m18:49:05.958842 [debug] [Thread-3 (]: Finished running node model.vendas_dw.gold_ticket_medio_categoria
[0m18:49:05.961116 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:49:05.963978 [debug] [Thread-1 (]: Using postgres connection "model.vendas_dw.mart_receita_diaria_loja"
[0m18:49:05.964325 [debug] [Thread-1 (]: On model.vendas_dw.mart_receita_diaria_loja: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.mart_receita_diaria_loja"} */
drop view if exists "general_rtxt"."bronze_gold"."mart_receita_diaria_loja__dbt_backup" cascade
[0m18:49:06.009657 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:49:06.011391 [debug] [Thread-2 (]: Timing info for model.vendas_dw.indicadores_vendas (execute): 18:49:03.343803 => 18:49:06.011225
[0m18:49:06.011736 [debug] [Thread-2 (]: On model.vendas_dw.indicadores_vendas: Close
[0m18:49:06.012428 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4e834c2-3e0f-4a9a-827c-8b3abc24ed19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d3cf3f250>]}
[0m18:49:06.012920 [info ] [Thread-2 (]: 8 of 10 OK created sql view model bronze_silver.indicadores_vendas ............. [[32mCREATE VIEW[0m in 2.68s]
[0m18:49:06.013357 [debug] [Thread-2 (]: Finished running node model.vendas_dw.indicadores_vendas
[0m18:49:06.110396 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:49:06.112278 [debug] [Thread-4 (]: On model.vendas_dw.mart_receita_mensal_categoria: COMMIT
[0m18:49:06.112631 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.mart_receita_mensal_categoria"
[0m18:49:06.112891 [debug] [Thread-4 (]: On model.vendas_dw.mart_receita_mensal_categoria: COMMIT
[0m18:49:06.225038 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:49:06.226871 [debug] [Thread-1 (]: Timing info for model.vendas_dw.mart_receita_diaria_loja (execute): 18:49:03.626734 => 18:49:06.226731
[0m18:49:06.227194 [debug] [Thread-1 (]: On model.vendas_dw.mart_receita_diaria_loja: Close
[0m18:49:06.227873 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4e834c2-3e0f-4a9a-827c-8b3abc24ed19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d3cea0190>]}
[0m18:49:06.228348 [info ] [Thread-1 (]: 9 of 10 OK created sql view model bronze_gold.mart_receita_diaria_loja ......... [[32mCREATE VIEW[0m in 2.61s]
[0m18:49:06.228811 [debug] [Thread-1 (]: Finished running node model.vendas_dw.mart_receita_diaria_loja
[0m18:49:06.313052 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m18:49:06.316230 [debug] [Thread-4 (]: Using postgres connection "model.vendas_dw.mart_receita_mensal_categoria"
[0m18:49:06.316811 [debug] [Thread-4 (]: On model.vendas_dw.mart_receita_mensal_categoria: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "vendas_dw", "target_name": "dev", "node_id": "model.vendas_dw.mart_receita_mensal_categoria"} */
drop view if exists "general_rtxt"."bronze_gold"."mart_receita_mensal_categoria__dbt_backup" cascade
[0m18:49:06.510095 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:49:06.511806 [debug] [Thread-4 (]: Timing info for model.vendas_dw.mart_receita_mensal_categoria (execute): 18:49:03.822967 => 18:49:06.511662
[0m18:49:06.512130 [debug] [Thread-4 (]: On model.vendas_dw.mart_receita_mensal_categoria: Close
[0m18:49:06.512767 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4e834c2-3e0f-4a9a-827c-8b3abc24ed19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d3cf83310>]}
[0m18:49:06.513209 [info ] [Thread-4 (]: 10 of 10 OK created sql view model bronze_gold.mart_receita_mensal_categoria ... [[32mCREATE VIEW[0m in 2.69s]
[0m18:49:06.513698 [debug] [Thread-4 (]: Finished running node model.vendas_dw.mart_receita_mensal_categoria
[0m18:49:06.516452 [debug] [MainThread]: Using postgres connection "master"
[0m18:49:06.516944 [debug] [MainThread]: On master: BEGIN
[0m18:49:06.517543 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:49:08.309319 [debug] [MainThread]: SQL status: BEGIN in 2.0 seconds
[0m18:49:08.309917 [debug] [MainThread]: On master: COMMIT
[0m18:49:08.310166 [debug] [MainThread]: Using postgres connection "master"
[0m18:49:08.310411 [debug] [MainThread]: On master: COMMIT
[0m18:49:08.510732 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:49:08.511737 [debug] [MainThread]: On master: Close
[0m18:49:08.512346 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:49:08.512606 [debug] [MainThread]: Connection 'model.vendas_dw.indicadores_vendas' was properly closed.
[0m18:49:08.512819 [debug] [MainThread]: Connection 'model.vendas_dw.mart_receita_diaria_loja' was properly closed.
[0m18:49:08.513027 [debug] [MainThread]: Connection 'model.vendas_dw.mart_receita_mensal_categoria' was properly closed.
[0m18:49:08.513235 [debug] [MainThread]: Connection 'model.vendas_dw.gold_ticket_medio_categoria' was properly closed.
[0m18:49:08.513577 [info ] [MainThread]: 
[0m18:49:08.513897 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 20.05 seconds (20.05s).
[0m18:49:08.515257 [debug] [MainThread]: Command end result
[0m18:49:08.521927 [info ] [MainThread]: 
[0m18:49:08.522321 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:49:08.522623 [info ] [MainThread]: 
[0m18:49:08.522888 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m18:49:08.523277 [debug] [MainThread]: Command `dbt run` succeeded at 18:49:08.523203 after 20.18 seconds
[0m18:49:08.523588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d3d703750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d420b6690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d420b76d0>]}
[0m18:49:08.523879 [debug] [MainThread]: Flushing usage events
